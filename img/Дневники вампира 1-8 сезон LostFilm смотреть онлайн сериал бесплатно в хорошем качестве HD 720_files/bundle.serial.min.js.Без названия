
var ancestorOrig;
if(!window.location.ancestorOrigins) ancestorOrig = document.referrer || "firefox";
else ancestorOrig = window.location.ancestorOrigins[window.location.ancestorOrigins.length-1];
if(!ancestorOrig) ancestorOrig = document.referrer || "empty";


// modal.report.js

"use strict";function createReportForm(e){var t=document.querySelector(e),n=document.createElement("div"),a=document.createElement("div"),t=document.querySelector(e),o=document.createElement("div"),c=document.createElement("div"),i=document.createElement("div"),l=document.querySelector("body");function s(){a.className="fp-reportMenu_wrapper",n.className="fp-modal_bg",o.className="fp-ui_contextMenu_bg",c.className="fp-ui_contextMenu"}a.className="fp-reportMenu_wrapper",c.className="fp-ui_contextMenu",o.className="fp-ui_contextMenu_bg",i.className="fp-container_form",a.addEventListener("click",function(e){e.stopPropagation()}),e=document.querySelector("meta[name=csrf-token]").content,n.className="fp-modal_bg",a.innerHTML='<form id="feedBack-form" autocomplete="off">                                <div class="fp-modal_title">Сообщить о проблеме</div>                                <div class="fp-modal_close"></div>                                <label class="fp-form_field">                                    <div class="fp-text-label">Опишите вашу проблему</div>                                    <textarea name="description" class="fp-modal_text"></textarea>                                </label>                                <label class="fp-form_field">                                    <div class="fp-mail-label">Оставьте ваши контакты (e-mail)</div>                                    <input name="email" class="fp-modal-mail" type="mail">                                </label>                                <input hidden name="ancestor" class="fp-modal-mail" type="text" value="'+ancestorOrig+'">                                <input hidden name="token" class="fp-modal-mail" type="text" value="'+e+'">                                <button class="fp-modal-button" type="submit" name="submit">Отправить</button>                            </form>',i.appendChild(n),i.appendChild(a),i.appendChild(o),i.appendChild(c),t.appendChild(i),c.addEventListener("click",function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,a.className="fp-reportMenu_wrapper fp-active",n.className="fp-modal_bg fp-active",c.className="fp-ui_contextMenu",o.className="fp-ui_contextMenu_bg"}),c.innerText="Сообщить о проблеме",l.addEventListener("contextmenu",function(e){return e.preventDefault(),document.querySelector(".is-touch")?(console.log("touсh device. Contextmenu canceled"),!1):(c.style.left=e.pageX+120+"px",c.style.top=e.pageY+"px",c.className="fp-ui_contextMenu active",void(o.className="fp-ui_contextMenu_bg active"))}),document.querySelector("#vpaid-but").onclick=function(e){if("fp-ui_contextMenu active"!==e.target.className)return!1},n.addEventListener("click",function(e){e.stopPropagation(),s()}),o.addEventListener("click",function(e){e.stopPropagation(),s()}),document.querySelector(".fp-modal_close").addEventListener("click",function(e){s()}),document.querySelector(".fp-modal-button").addEventListener("click",function(e){s()})}function sendform(){document.querySelector("form").addEventListener("submit",function(e){e.preventDefault();var t=new FormData(this);return console.log("Проверяем что хранится в FormData:  ",Object.fromEntries(t.entries())),e=new URLSearchParams(Array.from(t)).toString(),(t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).open("POST","/sendfeedback",!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.onload=function(){200<=this.status&&this.status<400&&this.response},t.onerror=function(){},t.send(e),!1})}createReportForm("body"),sendform();



//Flowplayer.js


var supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=!0}});window.addEventListener("testPassive",null,opts),window.removeEventListener("testPassive",null,opts)}catch(e){}!function(i){function l(e,t,n,o){for(var r=n.slice(),i=(n=e,(t=t).currentTarget=n,t.eventPhase=t.target===t.currentTarget?2:3,t),a=0,s=r.length;a<s&&(handler=r[a],"object"==typeof handler&&"function"==typeof handler.handleEvent?handler.handleEvent(i):handler.call(e,i),!i.stoppedImmediatePropagation);a++);return t=!i.stoppedPropagation,o&&t&&e.parentNode?e.parentNode.dispatchEvent(i):!i.defaultPrevented}function r(e,t){return{configurable:!0,get:e,set:t}}function e(e,t,n){var o=v(t||e,n);g(e,"textContent",r(function(){return o.get.call(this)},function(e){o.set.call(this,e)}))}function c(e,t){for(var n=e.length;n--&&e[n]!==t;);return n}function t(){if("BR"===this.tagName)return"\n";for(var e=this.firstChild,t=[];e;)8!==e.nodeType&&7!==e.nodeType&&t.push(e.textContent),e=e.nextSibling;return t.join("")}function a(e){!o&&C.test(document.readyState)&&(o=!o,document.detachEvent(f,a),(e=document.createEvent("Event")).initEvent(d,!0,!0),document.dispatchEvent(e))}function n(e){for(var t;t=this.lastChild;)this.removeChild(t);null!=e&&this.appendChild(document.createTextNode(e))}function u(e,t){return(t=t||i.event).target||(t.target=t.srcElement||t.fromElement||document),t.timeStamp||(t.timeStamp=(new Date).getTime()),t}var s,o,f,d,p,h,g,m,v,y,b,w,E,C,x,k,I,S,T,A;function N(e){this._=e}function M(){}function P(e,t){return t.toUpperCase()}document.createEvent||(o=!(s=!0),f="onreadystatechange",d="DOMContentLoaded",p="__IE8__"+Math.random(),h=i.Object,g=h.defineProperty||function(e,t,n){e[t]=n.value},m=h.defineProperties||function(t,e){for(var n in e)if(y.call(e,n))try{g(t,n,e[n])}catch(e){i.console&&console.log(n+" failed on object:",t,e.message)}},v=h.getOwnPropertyDescriptor,y=h.prototype.hasOwnProperty,b=i.Element.prototype,w=i.Text.prototype,E=/^[a-z]+$/,C=/loaded|complete/,x={},k=document.createElement("div"),e(i.HTMLCommentElement.prototype,b,"nodeValue"),e(i.HTMLScriptElement.prototype,null,"text"),e(w,null,"nodeValue"),e(i.HTMLTitleElement.prototype,null,"text"),g(i.HTMLStyleElement.prototype,"textContent",(A=v(i.CSSStyleSheet.prototype,"cssText"),r(function(){return A.get.call(this.styleSheet)},function(e){A.set.call(this.styleSheet,e)}))),m(b,{textContent:{get:t,set:n},firstElementChild:{get:function(){for(var e=this.childNodes||[],t=0,n=e.length;t<n;t++)if(1==e[t].nodeType)return e[t]}},lastElementChild:{get:function(){for(var e=this.childNodes||[],t=e.length;t--;)if(1==e[t].nodeType)return e[t]}},previousElementSibling:{get:function(){for(var e=this.previousSibling;e&&1!=e.nodeType;)e=e.previousSibling;return e}},nextElementSibling:{get:function(){for(var e=this.nextSibling;e&&1!=e.nodeType;)e=e.nextSibling;return e}},childElementCount:{get:function(){for(var e=0,t=this.childNodes||[],n=t.length;n--;e+=1==t[n].nodeType);return e}},addEventListener:{value:function(e,t,n){var o,r=this,i="on"+e,a=r[p]||g(r,p,{value:{}})[p],a=a[i]||(a[i]={}),s=a.h||(a.h=[]);if(!y.call(a,"w")){if(a.w=function(e){return e[p]||l(r,u(0,e),s,!1)},!y.call(x,i))if(E.test(e))try{(o=document.createEventObject())[p]=!0,9!=r.nodeType&&null==r.parentNode&&k.appendChild(r),r.fireEvent(i,o),x[i]=!0}catch(o){for(x[i]=!1;k.hasChildNodes();)k.removeChild(k.firstChild)}else x[i]=!1;(a.n=x[i])&&r.attachEvent(i,a.w)}c(s,t)<0&&s[n?"unshift":"push"](t)}},dispatchEvent:{value:function(e){var t=this,n="on"+e.type,o=t[p],r=o&&o[n],o=!!r;return e.target||(e.target=t),o?r.n?t.fireEvent(n,e):l(t,e,r.h,!0):(t=t.parentNode)&&t.dispatchEvent(e),!e.defaultPrevented}},removeEventListener:{value:function(e,t,n){var o="on"+e,e=this[p],o=e&&e[o],o=o&&o.h,t=o?c(o,t):-1;-1<t&&o.splice(t,1)}}}),m(w,{addEventListener:{value:b.addEventListener},dispatchEvent:{value:b.dispatchEvent},removeEventListener:{value:b.removeEventListener}}),m(i.XMLHttpRequest.prototype,{addEventListener:{value:function(t,e,n){var o=this,r="on"+t,i=o[p]||g(o,p,{value:{}})[p],i=i[r]||(i[r]={}),i=i.h||(i.h=[]);c(i,e)<0&&(o[r]||(o[r]=function(){var e=document.createEvent("Event");e.initEvent(t,!0,!0),o.dispatchEvent(e)}),i[n?"unshift":"push"](e))}},dispatchEvent:{value:function(e){var t="on"+e.type,n=this[p],n=n&&n[t];return!!n&&(n.n?this.fireEvent(t,e):l(this,e,n.h,!0))}},removeEventListener:{value:b.removeEventListener}}),m(i.Event.prototype,{bubbles:{value:!0,writable:!0},cancelable:{value:!0,writable:!0},preventDefault:{value:function(){this.cancelable&&(this.defaultPrevented=!0,this.returnValue=!1)}},stopPropagation:{value:function(){this.stoppedPropagation=!0,this.cancelBubble=!0}},stopImmediatePropagation:{value:function(){this.stoppedImmediatePropagation=!0,this.stopPropagation()}},initEvent:{value:function(e,t,n){this.type=e,this.bubbles=!!t,this.cancelable=!!n,this.bubbles||this.stopPropagation()}}}),m(i.HTMLDocument.prototype,{textContent:{get:function(){return 11===this.nodeType?t.call(this):null},set:function(e){11===this.nodeType&&n.call(this,e)}},addEventListener:{value:function(e,t,n){var o=this;b.addEventListener.call(o,e,t,n),s&&e===d&&!C.test(o.readyState)&&(s=!1,o.attachEvent(f,a),i==top&&function t(e){try{o.documentElement.doScroll("left"),a()}catch(e){setTimeout(t,50)}}())}},dispatchEvent:{value:b.dispatchEvent},removeEventListener:{value:b.removeEventListener},createEvent:{value:function(e){if("Event"!==e)throw new Error("unsupported "+e);return(e=document.createEventObject()).timeStamp=(new Date).getTime(),e}}}),m(i.Window.prototype,{getComputedStyle:{value:(I=/^(?:[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|))(?!px)[a-z%]+$/,S=/^(top|right|bottom|left)$/,T=/\-([a-z])/g,N.prototype.getPropertyValue=function(e){var t,n=this._,o=n.style,r=n.currentStyle,i=n.runtimeStyle,a=(r||o)[e=("float"===e?"style-float":e).replace(T,P)];return I.test(a)&&!S.test(e)&&(t=o.left,(n=i&&i.left)&&(i.left=r.left),o.left="fontSize"===e?"1em":a,a=o.pixelLeft+"px",o.left=t,n&&(i.left=n)),null==a?a:a+""||"auto"},M.prototype.getPropertyValue=function(){return null},function(e,t){return new(t?M:N)(e)})},addEventListener:{value:function(e,t,n){var o,r=i,e="on"+e;r[e]||(r[e]=function(e){return l(r,u(0,e),o,!1)}),c(o=r[e][p]||(r[e][p]=[]),t)<0&&o[n?"unshift":"push"](t)}},dispatchEvent:{value:function(e){var t=i["on"+e.type];return!t||!1!==t.call(i,e)&&!e.defaultPrevented}},removeEventListener:{value:function(e,t,n){e=(i["on"+e]||h)[p],t=e?c(e,t):-1;-1<t&&e.splice(t,1)}}}))}(this),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).flowplayer=e()}(function(){return function o(r,i,a){function s(t,e){if(!i[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},r[t][0].call(n.exports,function(e){return s(r[t][1][e]||e)},n,n.exports,o,r,i,a)}return i[t].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,n){"use strict";var i=t.exports={},o=e("class-list"),a=window.jQuery,r=e("punycode"),s=e("computed-style");function l(e){return e.replace(/-[a-z]/g,function(e){return e[1].toUpperCase()})}i.noop=function(){},i.identity=function(e){return e},i.removeNode=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},i.find=function(e,t){return a?a(e,t).toArray():(t=t||document,Array.prototype.map.call(t.querySelectorAll(e),function(e){return e}))},i.text=function(e,t){e["innerText"in e?"innerText":"textContent"]=t},i.findDirect=function(e,t){return i.find(e,t).filter(function(e){return e.parentNode===t})},i.hasClass=function(e,t){return"string"==typeof e.className&&o(e).contains(t)},i.isSameDomain=function(e){var t=window.location,e=i.createElement("a",{href:e});return t.hostname===e.hostname&&t.protocol===e.protocol&&t.port===e.port},i.css=function(t,n,e){return"object"==typeof n?Object.keys(n).forEach(function(e){i.css(t,e,n[e])}):void 0!==e?""===e?t?t.style.removeProperty(n):void 0:t?t.style.setProperty(n,e):void 0:t?s(t,n):void 0},i.createElement=function(t,n,o){try{var e,r=document.createElement(t);for(e in n)n.hasOwnProperty(e)&&("css"===e?i.css(r,n[e]):i.attr(r,e,n[e]));return o&&(r.innerHTML=o),r}catch(e){if(!a)throw e;return a("<"+t+">"+o+"</"+t+">").attr(n)[0]}},i.toggleClass=function(e,t,n){e&&(e=o(e),void 0===n?e.toggle(t):n?e.add(t):n||e.remove(t))},i.addClass=function(e,t){return i.toggleClass(e,t,!0)},i.removeClass=function(e,t){return i.toggleClass(e,t,!1)},i.append=function(e,t){return e.appendChild(t),e},i.appendTo=function(e,t){return i.append(t,e),e},i.prepend=function(e,t){e.insertBefore(t,e.firstChild)},i.insertAfter=function(e,t,n){t==i.lastChild(e)&&e.appendChild(n);t=Array.prototype.indexOf.call(e.children,t);e.insertBefore(n,e.children[t+1])},i.html=function(e,t){(e=e.length?e:[e]).forEach(function(e){e.innerHTML=t})},i.attr=function(t,n,o){if("class"===n&&(n="className"),i.hasOwnOrPrototypeProperty(t,n))try{t[n]=o}catch(e){if(!a)throw e;a(t).attr(n,o)}else!1===o?t.removeAttribute(n):t.setAttribute(n,o);return t},i.prop=function(e,t,n){if(void 0===n)return e&&e[t];e[t]=n},i.offset=function(e){var t=e.getBoundingClientRect();return e.offsetWidth/e.offsetHeight>e.clientWidth/e.clientHeight&&(t={left:100*t.left,right:100*t.right,top:100*t.top,bottom:100*t.bottom,width:100*t.width,height:100*t.height}),t},i.width=function(e,t){if(t)return e.style.width=(""+t).replace(/px$/,"")+"px";t=i.offset(e).width;return void 0===t?e.offsetWidth:t},i.height=function(e,t){if(t)return e.style.height=(""+t).replace(/px$/,"")+"px";t=i.offset(e).height;return void 0===t?e.offsetHeight:t},i.lastChild=function(e){return e.children[e.children.length-1]},i.hasParent=function(e,t){for(var n=e.parentElement;n;){if("string"!=typeof t){if(n===t)return!0}else if(i.matches(n,t))return!0;n=n.parentElement}return!1},i.createAbsoluteUrl=function(e){return i.createElement("a",{href:e}).href},i.xhrGet=function(e,t,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===this.readyState)return 400<=this.status?n():void t(this.responseText)},o.open("get",e,!0),o.send()},i.pick=function(t,e){var n={};return e.forEach(function(e){t.hasOwnProperty(e)&&(n[e]=t[e])}),n},i.hostname=function(e){return r.toUnicode(e||window.location.hostname)},i.browser={webkit:"WebkitAppearance"in document.documentElement.style},i.getPrototype=function(e){return Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__},i.hasOwnOrPrototypeProperty=function(e,t){for(var n=e;n;){if(Object.prototype.hasOwnProperty.call(n,t))return!0;n=i.getPrototype(n)}return!1},i.matches=function(e,t){var n=Element.prototype;return(n.matches||n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=0;t[n]&&t[n]!==this;)n++;return!!t[n]}).call(e,t)},void 0!==(e=window.CSSStyleDeclaration.prototype).setAttribute&&(e.setProperty=function(e,t){return this.setAttribute(l(e),String(t))},e.getPropertyValue=function(e){return this.getAttribute(l(e))||null},e.removeProperty=function(e){var t=this.getPropertyValue(e);return this.removeAttribute(l(e)),t})},{"class-list":36,"computed-style":37,punycode:44}],2:[function(e,t,n){"use strict";var l=e("../common");t.exports=function(e,t,n,o){n=n||"opaque";var r="obj"+(""+Math.random()).slice(2,15),i='<object class="fp-engine" id="'+r+'" name="'+r+'" ',a=-1<navigator.userAgent.indexOf("MSIE");i+=a?'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">':' data="'+e+'" type="application/x-shockwave-flash">';var s={width:"100%",height:"100%",allowscriptaccess:"always",wmode:n,quality:"high",flashvars:"",movie:e+(a?"?"+r:""),name:r};"transparent"!==n&&(s.bgcolor=o||"#333333"),Object.keys(t).forEach(function(e){s.flashvars+=e+"="+t[e]+"&"}),Object.keys(s).forEach(function(e){i+='<param name="'+e+'" value="'+s[e]+'"/>'}),i+="</object>";o=l.createElement("div",{},i);return l.find("object",o)},window.attachEvent&&window.attachEvent("onbeforeunload",function(){window.__flash_savedUnloadHandler=window.__flash_unloadHandler=function(){}})},{"../common":1}],3:[function(e,t,n){"use strict";var o,f=e("../flowplayer"),d=e("../common"),i=(e("./embed"),e("extend-object")),p=e("bean");function h(e){return/^https?:/.test(e)}(o=function(r,a){var e,s,l=r.conf,c=[],u={engineName:o.engineName,pick:function(o){var e=i({},function(){if(f.support.flashVideo){for(var e,t,n=0;n<o.length;n++)if(t=o[n],/mp4|flv|flash/i.test(t.type)&&(e=t),r.conf.swfHls&&/mpegurl/i.test(t.type)&&(e=t),e&&!/mp4/i.test(e.type))return e;return e}}());if(e)return!e.src||h(e.src)||r.conf.rtmp||e.rtmp||(e.src=d.createAbsoluteUrl(e.src)),e},suspendEngine:function(){0},resumeEngine:function(){0},load:function(t){c.forEach(function(e){clearTimeout(e)});var n=d.findDirect("video",a)[0]||d.find(".fp-player > video",a)[0],e=t.src,o=h(e),r=function(){d.removeNode(n)};f.support.video&&d.prop(n,"autoplay")&&t.sources.some(function(e){return!!n.canPlayType(e.type)})?p.one(n,"timeupdate",r):r();var i=t.rtmp||l.rtmp;o||i||(e=d.createAbsoluteUrl(e)),s&&/application\/x-mpegurl/i.test(t.type)&&s.data!==d.createAbsoluteUrl(l.swfHls)&&u.unload(),s&&(["live","preload","loop"].forEach(function(e){t.hasOwnProperty(e)&&s.__set(e,t[e])}),Object.keys(t.flashls||{}).forEach(function(e){s.__set("hls_"+e,t.flashls[e])}),r=!1,!o&&i?s.__set("rtmp",i.url||i):(r=!!s.__get("rtmp"),s.__set("rtmp",null)),s.__play(e,r||t.rtmp&&t.rtmp!==l.rtmp))},speed:d.noop,unload:function(){s&&s.__unload&&s.__unload();try{e}catch(e){}d.find("object",a).forEach(d.removeNode),s=0,r.off(".flashengine"),r.off(".flashhack"),clearInterval(s.pollInterval),c.forEach(function(e){clearTimeout(e)})}};return["pause","resume","seek","volume"].forEach(function(t){u[t]=function(e){try{r.ready&&(void 0===e?s["__"+t]():s["__"+t](e))}catch(e){if(void 0===s["__"+t])return r.trigger("flashdisabled",[r]);throw e}}}),u}).engineName="flash",o.canPlay=function(e,t){return f.support.flashVideo&&/video\/(mp4|flash|flv)/i.test(e)||f.support.flashVideo&&t.swfHls&&/mpegurl/i.test(e)},f.engines.push(o)},{"../common":1,"../flowplayer":31,"./embed":2,bean:34,"extend-object":39}],4:[function(e,t,n){"use strict";var s,p=e("../flowplayer"),o=p.support,h=p.common,g=p.bean,r=e("./html5-factory");function l(e){return void 0!==window.Hls&&(/mpegurl/.test(e)&&window.Hls.isSupported())}(s=function(f,i){var d,a=window.Hls;return r("hlsjs-lite",f,i,l,function(l,c,e){var o=p.extend({recoverMediaError:!0},f.conf.hlsjs,l.hlsjs);f.engine.hls&&f.engine.hls.destroy();var t,n,u=f.engine.hls=new a(o);function r(e){if(f.debug("hlsjs - recovery"),h.removeClass(i,"is-paused"),h.addClass(i,"is-seeking"),g.one(c,"seeked",function(){c.paused&&(h.removeClass(i,"is-poster"),f.poster=!1,c.play()),h.removeClass(i,"is-seeking")}),e)return u.startLoad();e=performance.now(),!t||3e3<e-t?(t=performance.now(),u.recoverMediaError()):(!n||3e3<e-n)&&(n=performance.now(),u.swapAudioCodec(),u.recoverMediaError())}return s.extensions.forEach(function(e){e({hls:u,player:f,root:i,videoTag:c})}),u.loadSource(l.src),e.resume=function(){f.live&&!f.dvr&&(c.currentTime=u.liveSyncPosition||0),c.play()},!(e.seek=function(t){try{f.live||f.dvr?c.currentTime=Math.min(t,u.liveSyncPosition||c.duration-o.livePositionOffset):c.currentTime=t}catch(e){f.debug("Failed to seek to ",t,e)}})===o.bufferWhilePaused&&f.on("pause",function(){u.stopLoad(),f.one("resume",function(){u.startLoad()})}),f.on("quality",function(e,t,n){u.nextLevel=d=n}),u.on(a.Events.MANIFEST_PARSED,function(e,t){var r,i=l.hlsQualities||f.conf.hlsQualities,a={},n=t.levels;if(!1===i)return u.attachMedia(c);if("drive"===i)switch(n.length){case 4:r=[1,2,3];break;case 5:r=[1,2,3,4];break;case 6:r=[1,3,4,5];break;case 7:r=[1,3,5,6];break;case 8:r=[1,3,6,7];break;default:r=n.length<3||n[0].height&&n[2].height&&n[0].height===n[2].height?[]:[1,2]}l.qualities=[{value:-1,label:"Auto"}],Array.isArray(i)&&((o=i.find(function(e){return-1===e||e.level&&-1===e.level}))?l.qualities[0].label=("number"!=typeof o?o:l.qualities[0]).label:l.qualities=[],r=i.map(function(e){return void 0!==e.level&&(a[e.level]=e.label),void 0!==e.level?e.level:e}));var s=-2;l.qualities=l.qualities.concat(n.map(function(e,t){if(r&&-1===r.indexOf(t))return!1;var n,o=e.width/e.height<=1.55?e.height:e.width/16*9;return i.some(function(e){if(o==parseInt(e.label))return!0})?o+="p":o=((n=o)<=420?360:420<n&&n<=600?480:600<n&&n<=900?720:1080)+"p",a[t]||"drive"===i||(o+=" ("+Math.round(e.bitrate/1e3)+"k)"),t===d&&(s=t),{value:t,label:o}})).filter(h.identity).reverse();var o=l.quality=-2===s?l.qualities[l.qualities.length-1].value||-1:s;o!==u.currentLevel&&(u.currentLevel=o),u.attachMedia(c),l.src}),u.on(a.Events.ERROR,function(e,t){var n;t.fatal&&(o.recoverNetworkError&&t.type===a.ErrorTypes.NETWORK_ERROR?r(!0):o.recoverMediaError&&t.type===a.ErrorTypes.MEDIA_ERROR?r(!1):(n=5,t.type===a.ErrorTypes.NETWORK_ERROR&&(n=2),t.type===a.ErrorTypes.MEDIA_ERROR&&(n=3),u.destroy(),f.trigger("error",[f,{code:n}])))}),f.one("unload",function(){u.destroy()}),{handlers:{error:function(e,t){t=t.error&&t.error.code;return o.recoverMediaError&&3===t||!t?(e.preventDefault(),r(!1),!0):o.recoverNetworkError&&2===t?(e.preventDefault(),r(!0),!0):void 0}}}})}).canPlay=function(e,t){return!(!1===t.hlsjs||t.clip&&!1===t.clip.hlsjs)&&(!(o.browser.safari&&!(t.clip&&t.clip.hlsjs||t.hlsjs||{}).safari)&&(p.support.video&&l(e)))},s.engineName="hlsjs-lite",s.plugin=function(e){s.extensions.push(e)},s.extensions=[],p.engines.push(s)},{"../flowplayer":31,"./html5-factory":5}],5:[function(e,t,n){var o=e("../flowplayer"),h=o.common,g=o.support,m=o.bean,v=o.extend,e=g.browser.safari&&!g.iOS,y={ended:"finish",pause:"pause",play:"resume",timeupdate:"progress",volumechange:"volume",ratechange:"speed",seeked:"seek",loadedmetadata:e?0:"ready",canplaythrough:e?"ready":0,durationchange:"ready",error:"error",dataunavailable:"error",webkitendfullscreen:!o.support.inlineVideo&&"unload",progress:"buffer"};function b(e,t){return t=t||100,Math.round(e*t)/t}t.exports=function(e,d,p,i,a){var t,s,l,c=h.findDirect("video",p)[0]||h.find(".fp-player > video",p)[0],u=d.conf;return l={engineName:e,pick:function(e){e=g.video&&e.filter(function(e){return i(e.type)})[0];if(e)return"string"==typeof e.src&&(e.src=h.createAbsoluteUrl(e.src)),e},load:function(e){var t,n=h.find(".fp-player",p)[0];c||(c=document.createElement("video"),h.prepend(n,c),c.autoplay=!1),h.addClass(c,"fp-engine"),h.find("track",c).forEach(h.removeNode),c.preload="none",u.nativesubtitles||h.attr(c,"crossorigin",!1),u.disableInline||(c.setAttribute("webkit-playsinline","true"),c.setAttribute("playsinline","true")),g.inlineVideo||h.css(c,{position:"absolute",top:"-9999em"}),g.subtitles&&u.nativesubtitles&&e.subtitles&&e.subtitles.length&&(h.addClass(c,"native-subtitles"),r=e.subtitles,t=function(e){var t=c.textTracks;t.length&&(t[0].mode=e)},r.some(function(e){return!h.isSameDomain(e.src)})&&h.attr(c,"crossorigin","anonymous"),"function"==typeof c.textTracks.addEventListener&&c.textTracks.addEventListener("addtrack",function(){t("disabled"),t("showing")}),r.forEach(function(e){c.appendChild(h.createElement("track",{kind:"subtitles",srclang:e.srclang||"en",label:e.label||"en",src:e.src,default:e.default}))})),m.off(c,"timeupdate",h.noop),m.on(c,"timeupdate",h.noop),h.prop(c,"loop",!1),d.off(".loophack"),(e.loop||u.loop)&&d.on("finish.loophack",function(){d.resume()}),void 0!==s&&(c.volume=s);var o,r=a(e,c,l);(u.autoplay||u.splash||e.autoplay)&&(d.debug("Autoplay / Splash setup, try to start video"),c.load()),l._listeners=function(l,e,c,u){var f=p.getAttribute("data-flowplayer-instance-id");if(l.listeners&&l.listeners.hasOwnProperty(f))return void(l.listeners[f]=c);(l.listeners||(l.listeners={}))[f]=c,m.on(e,"error",function(e){try{i(e.target.getAttribute("type"))&&d.trigger("error",[d,{code:4,video:v(c,{src:l.src,url:l.src})}])}catch(e){}}),d.on("shutdown",function(){m.off(e),m.off(l,".dvrhack"),d.off(".loophack")});function t(e){"metadata"===e.kind&&(e.mode="hidden",e.addEventListener("cuechange",function(){e.activeCues.length&&d.trigger("metadata",[d,e.activeCues[0].value])},!1))}var n={};l&&l.textTracks&&l.textTracks.length&&Array.prototype.forEach.call(l.textTracks,t);l&&l.textTracks&&"function"==typeof l.textTracks.addEventListener&&l.textTracks.addEventListener("addtrack",function(e){t(e.track)},!1);(d.conf.dvr||d.dvr||c.dvr)&&m.on(l,"progress.dvrhack",function(){l.seekable.length&&(d.video.duration=l.seekable.end(null),d.video.seekOffset=l.seekable.start(null),d.trigger("dvrwindow",[d,{start:l.seekable.start(null),end:l.seekable.end(null)}]),l.currentTime>=l.seekable.start(null)||(l.currentTime=l.seekable.start(null)))});return Object.keys(y).forEach(function(a){var e,s=y[a];"webkitendfullscreen"===a&&d.conf.disableInline&&(s="unload"),s&&(e=function(e){if(c=l.listeners[f],e.target&&h.hasClass(e.target,"fp-engine")){/progress/.test(s)||d.debug(a,"->",s,e);function t(e){d.trigger(e||s,[d,n])}var n;if((d.ready||/ready|error/.test(s))&&s&&h.find("video",p).length)if("unload"!==s){switch(s){case"ready":if(d.ready)return d.debug("Player already ready, not sending duplicate ready event");if(!(l.duration&&l.duration!==1/0||d.live))return d.debug("No duration and VOD setup, not sending ready event");if((n=v(c,{duration:l.duration<Number.MAX_VALUE?l.duration:0,width:l.videoWidth,height:l.videoHeight,url:l.currentSrc})).seekable=n.duration,d.debug("Ready: ",n),d.live||n.duration||g.hlsDuration||"loadeddata"!==a)break;var o=function(){n.duration=l.duration;try{n.seekable=l.seekable&&l.seekable.end(null)}catch(e){}t(),l.removeEventListener("durationchange",o),h.toggleClass(p,"is-live",!1)};l.addEventListener("durationchange",o);var r=function(){d.ready||l.duration||(n.duration=0,h.addClass(p,"is-live"),t()),l.removeEventListener("timeupdate",r)};return void l.addEventListener("timeupdate",r);case"progress":case"seek":if(0<l.currentTime||d.live)n=Math.max(l.currentTime,0);else if("seek"===s&&0===l.currentTime)n=0;else if("progress"==s)return;break;case"buffer":n=[];for(var i=0;i<l.buffered.length;i++)n.push({start:l.buffered.start(i),end:l.buffered.end(i)});l.buffered.length&&l.buffered.end(null)===l.duration&&t("buffered");break;case"speed":n=b(l.playbackRate);break;case"volume":n=b(l.muted?0:l.volume);break;case"error":try{if(u&&u.handlers&&u.handlers.error)if(u.handlers.error(e,l))return;(n=(e.srcElement||e.originalTarget).error).video=v(c,{src:l.src,url:l.src})}catch(e){return}}t()}else d.unload();else"resume"===s&&d.one("ready",function(){setTimeout(function(){t()})})}},p.addEventListener(a,e,!0),n[a]||(n[a]=[]),n[a].push(e))}),n}(c,h.find("source",c).concat(c),e,r)||l._listeners,u.autoplay||u.splash||e.autoplay||(o=function(){!function(e){e=e.getBoundingClientRect();return 0<=e.top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)+e.height&&e.right<=(window.innerWidth||document.documentElement.clientWidth)+e.width}(p)||(d.debug("player is in viewport, preload"),g.preloadMetadata?c.preload="metadata":c.load(),m.off(document,"scroll.preloadviewport"))},m.off(document,"scroll.preloadviewport"),m.on(document,"scroll.preloadviewport",function(){window.requestAnimationFrame(o)}),o())},mute:function(e){c.muted=!!e,d.trigger("mute",[d,e]),d.trigger("volume",[d,e?0:c.volume])},pause:function(){c.pause()},resume:function(){c.play()},speed:function(e){c.playbackRate=e},seek:function(e){var t=c.paused||d.finished;try{c.currentTime=e,t&&m.one(c,"seeked",function(){c.pause()})}catch(e){}},volume:function(e){s=e,c&&(c.volume=e,Number(e)?(l.mute(!1),h.toggleClass(p,"is-muted",!1)):(l.mute(!0),h.toggleClass(p,"is-muted",!0)))},unload:function(){m.off(document,"scroll.preloadviewport"),h.find("video.fp-engine",p).forEach(function(e){"MediaSource"in window?e.src=URL.createObjectURL(new MediaSource):e.src="",h.removeNode(e)}),t=clearInterval(t);var e=p.getAttribute("data-flowplayer-instance-id");delete c.listeners[e],c=0,l._listeners&&Object.keys(l._listeners).forEach(function(t){l._listeners[t].forEach(function(e){p.removeEventListener(t,e,!0)})})}}}},{"../flowplayer":31}],6:[function(e,t,n){"use strict";var o=e("../flowplayer"),r=o.common,i=e("./html5-factory"),a=document.createElement("video");function s(e){var t;return/^(video|application)/i.test(e)||(e=/mpegurl/i.test(t=e)?"application/x-mpegurl":t),!!a.canPlayType(e).replace("no","")}(e=function(e,t){return i("html5",e,t,s,function(e,t){t.currentSrc!==e.src?(r.find("source",t).forEach(r.removeNode),t.src=e.src,t.type=e.type):e.autoplay&&t.load()})}).canPlay=function(e){return o.support.video&&s(e)},e.engineName="html5",o.engines.push(e)},{"../flowplayer":31,"./html5-factory":5}],7:[function(e,t,n){"use strict";var o=e("../flowplayer"),r=e("../common"),i=e("bean");o(function(e,o){e.one("ready",function(){var e,t,n=r.find("video.fp-engine",o)[0];n&&(n.setAttribute("x-webkit-airplay","allow"),e=$(".fp-player > video")[0],t=$(".flowplayer"),e.addEventListener("enterpictureinpicture",function(){t.addClass("is-pip")}),e.addEventListener("leavepictureinpicture",function(){t.removeClass("is-pip")}),void 0===document.pictureInPictureEnabled&&$(".fp-pip").addClass("fp-hidden"),$(".fp-pip").on("click",function(){document.pictureInPictureElement?document.exitPictureInPicture():document.pictureInPictureEnabled&&e.requestPictureInPicture()}),window.WebKitPlaybackTargetAvailabilityEvent&&(n.addEventListener("webkitplaybacktargetavailabilitychanged",function(e){"available"===e.availability&&(e=r.find(".fp-header",o)[0],r.find(".fp-airplay",e).forEach(r.removeNode),r.createElement("a",{class:"fp-airplay fp-icon",title:"Play on AirPlay device"}))}),n.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",function(){var e=r.find(".fp-airplay",o)[0];e&&r.toggleClass(e,"fp-active",n.webkitCurrentPlaybackTargetIsWireless)})))}),i.on(o,"click",".fp-airplay",function(e){e.preventDefault(),r.find("video.fp-engine",o)[0].webkitShowPlaybackTargetPicker()}),$(".fp-config-bg").on("click",function(){var e=$(".fp-config-mobile");$(e).hasClass("fp-active")&&e.removeClass("fp-active")}),$(".fp-config__bg-lock").on("click",function(){var e=$(".fp-config");return $(e).hasClass("fp-active")&&e.removeClass("fp-active"),$(".fp-config__bg-lock").removeClass("bg-lock"),!1})})},{"../common":1,"../flowplayer":31,bean:34}],8:[function(e,t,n){"use strict";var o=e("../flowplayer"),l=e("./resolve").TYPE_RE,c=e("scriptjs"),u=e("bean");o(function(o,r){var i,a,e,t=o.conf.analytics,s=0,n=0;t&&("undefined"==typeof _gat&&c("//google-analytics.com/ga.js"),a=function(){var e=_gat._getTracker(t);return e._setAllowLinker(!0),e},e=function(e,t,n){n=n||o.video,s&&"undefined"!=typeof _gat&&(a()._trackEvent("Video / Seconds played",o.engine.engineName+"/"+n.type,n.title||r.getAttribute("title")||n.src.split("/").slice(-1)[0].replace(l,""),Math.round(s/1e3)),s=0,i&&(clearTimeout(i),i=null))},o.bind("load unload",e).bind("progress",function(){o.seeking||(s+=n?+new Date-n:0,n=+new Date),i=i||setTimeout(function(){i=null,a()._trackEvent("Flowplayer heartbeat","Heartbeat","",0,!0)},6e5)}).bind("pause",function(){n=0}),o.bind("shutdown",function(){u.off(window,"unload",e)}),u.on(window,"unload",e))})},{"../flowplayer":31,"./resolve":21,bean:34,scriptjs:45}],9:[function(e,t,n){"use strict";var o=e("../flowplayer"),d=e("../common"),p=e("bean"),h=e("scriptjs");o(function(t,o){var n,r,i,a;function s(){console.log("sessionListener")}function l(e){var t,n;e!==chrome.cast.ReceiverAvailability.AVAILABLE||(n=d.find(".fp-header",o)[0])&&(d.find(".fp-chromecast",n).forEach(d.removeNode),d.find(".fp-chromecast-engine",o).forEach(d.removeNode),a=d.createElement("a",{class:"fp-chromecast fp-icon",title:"Play on Cast device"}),n.insertBefore(a,d.find(".fp-fullscreen",n)[0]),t=d.createElement("div",{class:"fp-chromecast-engine"}),e=d.createElement("p",{class:"fp-chromecast-engine-status"}),n=d.createElement("p",{class:"fp-chromecast-engine-icon"}),t.appendChild(n),t.appendChild(e),(e=d.find(".fp-engine",o)[0])?e.parentNode.insertBefore(t,e):d.prepend(d.find(".fp-player",o)[0]||o,t))}function c(){}function u(){console.log("onError")}function f(){clearInterval(i),i=null,t.release(),d.toggleClass(o,"is-chromecast",!1),d.toggleClass(a,"fp-active",!1)}!1!==t.conf.chromecast&&(h("https://www.gstatic.com/cv/js/sender/v1/cast_sender.js"),window.__onGCastApiAvailable=function(e){e&&(e=n.applicationId||chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,e=new chrome.cast.SessionRequest(e),e=new chrome.cast.ApiConfig(e,s,l),chrome.cast.initialize(e,c,u))},n=t.conf.chromecast||{},p.on(o,"click",".fp-chromecast",function(e){return e.preventDefault(),r?(t.trigger("pause",[t]),r.stop(),r=null,void f()):(t.playing&&t.pause(),void chrome.cast.requestSession(function(e){e=(r=e).receiver.friendlyName;d.html(d.find(".fp-chromecast-engine-status")[0],"Playing on device "+e);e=new chrome.cast.media.MediaInfo(t.video.src),e=new chrome.cast.media.LoadRequest(e);r.loadMedia(e,function(n){n.addUpdateListener(function(e){r&&(i=i||setInterval(function(){t.trigger("progress",[t,n.getEstimatedTime()])},500),e?(d.toggleClass(o,"is-chromecast",!0),d.toggleClass(a,"fp-active",!0),t.hijack({pause:function(){n.pause()},resume:function(){n.play()},seek:function(e){var t=new chrome.cast.media.SeekRequest;t.currentTime=e,n.seek(t)}})):(f(),t.trigger("finish",[t])),e=n.playerState,t.paused&&e===chrome.cast.media.PlayerState.PLAYING&&t.trigger("resume",[t]),t.playing&&e===chrome.cast.media.PlayerState.PAUSED&&t.trigger("pause",[t]),d.toggleClass(o,"is-loading",e===chrome.cast.media.PlayerState.BUFFERING))})},function(){})},function(e){console.error("requestSession error",e)}))}))})},{"../common":1,"../flowplayer":31,bean:34,scriptjs:45}],10:[function(e,t,n){"use strict";var o=e("../flowplayer"),f=e("../common"),d=e("bean");o(function(r,i){var t=/ ?cue\d+ ?/,a=!1;function o(e){i.className=i.className.replace(t," "),0<=e&&f.addClass(i,"cue"+e)}function s(e){o(e.index),r.trigger("cuepoint",[r,e])}var l={},c=-.125;function u(e){e=e&&!isNaN(e.time)?e.time:e;return e<0&&(e=r.video.duration+e),.125*Math.round(e/.125)}r.on("progress",function(e,t,n){if(!a)for(var o=u(n);c<o;)l[c+=.125]&&l[c].forEach(s)}).on("unload",o).on("beforeseek",function(e){setTimeout(function(){e.defaultPrevented||(a=!0)})}).on("seek",function(e,t,n){o(),c=u(n||0)-.125,a=!1,!n&&l[0]&&l[0].forEach(s)}).on("ready",function(e,t,n){c=-.125;n=n.cuepoints||r.conf.cuepoints||[];r.setCuepoints(n)}).on("finish",function(){for(var e=u(r.video.duration);c<e;)l[c+=.125]&&l[c].forEach(s);c=-.125}),r.conf.generate_cuepoints&&r.bind("load",function(){f.find(".fp-cuepoint",i).forEach(f.removeNode)}),r.setCuepoints=function(e){return r.cuepoints=[],l={},e.forEach(r.addCuepoint),r},r.addCuepoint=function(e){r.cuepoints||(r.cuepoints=[]),"number"==typeof e&&(e={time:e}),e.index=0;var t,n,o=u(e);return l[o]||(l[o]=[]),l[o].push(e),r.cuepoints.length&&(e.index=Math.max.apply(null,r.cuepoints.map(function(e){return e.index}))+1),r.cuepoints.push(e),r.conf.generate_cuepoints&&!1!==e.visible&&(t=r.video.duration,o=f.find(".fp-timeline",i)[0],f.css(o,"overflow","visible"),(n=e.time||e)<0&&(n=t+n),e=f.createElement("a",{className:"fp-cuepoint fp-cuepoint"+e.index}),f.css(e,"left",n/t*100+"%"),o.appendChild(e),d.on(e,"mousedown",function(e){e.preventDefault(),e.stopPropagation(),r.seek(n)})),r},r.removeCuepoint=function(t){"number"==typeof t&&(t=r.cuepoints.filter(function(e){return e.index===t})[0]);var e=r.cuepoints.indexOf(t),n=u(t);if(-1!==e){r.cuepoints=r.cuepoints.slice(0,e).concat(r.cuepoints.slice(e+1));e=f.find(".fp-timeline",i)[0];f.find(".fp-cuepoint"+t.index,e).forEach(f.removeNode);e=l[n].indexOf(t);if(-1!==e)return l[n]=l[n].slice(0,e).concat(l[n].slice(e+1)),r}}})},{"../common":1,"../flowplayer":31,bean:34}],11:[function(e,t,n){"use strict";var o=e("../flowplayer"),r=e("bean"),s=e("../common"),l=e("./util/clipboard");o(function(i,a){var e,t;!1!==i.conf.embed&&!1!==i.conf.share&&(e=s.find(".fp-share-menu",a)[0],t=s.createElement("a",{class:"fp-icon fp-embed",title:"Copy to your site"},"Embed"),s.append(e,t),i.embedCode=function(){var e=i.conf.embed||{},t=i.video,n=e.width||t.width||s.width(a),o=e.height||t.height||s.height(a),r=i.conf.ratio,t='<iframe src="'+i.shareUrl(!0)+'" allowfullscreen style="border:none;';return e.width||e.height?(isNaN(n)||(n+="px"),isNaN(o)||(o+="px"),t+"width:"+n+";height:"+o+';"></iframe>'):(r&&!i.conf.adaptiveRatio||(r=o/n),'<div style="position:relative;width:100%;display:inline-block;">'+t+'position:absolute;top:0;left:0;width:100%;height:100%;"></iframe><div style="padding-top:'+100*r+'%;"></div></div>')},r.on(a,"click",".fp-embed",function(){l(i.embedCode(),function(){i.message("The embed code is now on your clipboard",2e3)},function(){i.textarea(i.embedCode(),"Copy the code below to embed your video")})}))})},{"../common":1,"../flowplayer":31,"./util/clipboard":30,bean:34}],12:[function(e,t,n){"use strict";t.exports=function(r,a){a=a||document.createElement("div");function n(t,n,o){var r=t.split(".")[0],i=function(e){o&&(a.removeEventListener(r,i),s[t].splice(s[t].indexOf(i),1));e=[e].concat(l[e.timeStamp+e.type]||[]);n&&n.apply(void 0,e)};a.addEventListener(r,i),s[t]||(s[t]=[]),s[t].push(i)}var s={},l={};r.on=r.bind=function(e,t){return e.split(" ").forEach(function(e){n(e,t)}),r},r.one=function(e,t){return e.split(" ").forEach(function(e){n(e,t,!0)}),r};r.off=r.unbind=function(e){return e.split(" ").forEach(function(e){var o=e.split(".").slice(1),r=e.split(".")[0];Object.keys(s).filter(function(e){var t,n=e.split(".").slice(1);return(!r||0===e.indexOf(r))&&(t=n,0===o.filter(function(e){return-1===t.indexOf(e)}).length)}).forEach(function(e){var t=s[e],n=e.split(".")[0];s[e]=t.filter(function(e){return a.removeEventListener(n,e),!1})})}),r},r.trigger=function(e,t,n){if(e){t=(t||[]).length?t||[]:[t];var o=document.createEvent("Event"),e=e.type||e;return o.initEvent(e,!1,!0),Object.defineProperty&&(o.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}),l[o.timeStamp+o.type]=t,a.dispatchEvent(o),n?o:r}}},t.exports.EVENTS=["beforeseek","disable","error","finish","fullscreen","fullscreen-exit","load","mute","pause","progress","ready","resume","seek","speed","stop","unload","volume","boot","shutdown"]},{}],13:[function(e,t,n){"use strict";var o=e("../flowplayer"),i=e("../common"),a=e("bean");o(function(e,t){var n,o,r=e.conf;!1!==r.share&&r.facebook&&(e.facebook=function(){var e=screen.height,t=screen.width,n="string"==typeof r.facebook?r.facebook:window.location.toString(),o=Math.round(t/2-275),t=0;420<e&&(t=Math.round(e/2-210)),window.open("https://www.facebook.com/sharer.php?s=100&p[url]="+encodeURIComponent(n),"sharer","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,left="+o+",top="+t)},n=i.find(".fp-share-menu",t)[0],o=i.createElement("a",{class:"fp-icon fp-facebook"},"Facebook"),i.append(n,o),a.on(t,"click",".fp-facebook",function(){e.facebook()}))})},{"../common":1,"../flowplayer":31,bean:34}],14:[function(e,t,n){"use strict";var l,o=e("../flowplayer"),c=e("bean"),u=e("../common"),f="fullscreen",d="fullscreen-exit",p=o.support.fullscreen;c.on(document,"fullscreenchange.ffscr webkitfullscreenchange.ffscr mozfullscreenchange.ffscr MSFullscreenChange.ffscr",function(e){var t=document.webkitCurrentFullScreenElement||document.mozFullScreenElement||document.fullscreenElement||document.msFullscreenElement||e.target;(l||t.parentNode&&t.parentNode.getAttribute("data-flowplayer-instance-id"))&&(e=l||o(t.parentNode),l=t&&!l?e.trigger(f,[e]):(l.trigger(d,[l]),null))}),o(function(t,n){var o,r,i,a,s=u.createElement("div",{className:"fp-player"});Array.prototype.map.call(n.children,u.identity).forEach(function(e){u.matches(e,".fp-ratio,script")||s.appendChild(e)}),n.appendChild(s),t.conf.fullscreen&&(o=window,t.isFullscreen=!1,t.fullscreen=function(e){if(!t.disabled)return void 0===e&&(e=!t.isFullscreen),e&&(r=o.scrollY,i=o.scrollX),p?e?["requestFullScreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"].forEach(function(e){"function"==typeof s[e]&&s[e]({navigationUI:"hide"})}):["exitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"].forEach(function(e){"function"==typeof document[e]&&document[e]()}):t.trigger(e?f:d,[t]),t;console.log("player.disabled")},t.on(f,function(){u.addClass(n,"is-fullscreen"),u.toggleClass(n,"fp-minimal-fullscreen",u.hasClass(n,"fp-minimal")),u.removeClass(n,"fp-minimal"),p||u.css(n,"position","fixed"),t.isFullscreen=!0}).on(d,function(){var e;u.toggleClass(n,"fp-minimal",u.hasClass(n,"fp-minimal-fullscreen")),u.removeClass(n,"fp-minimal-fullscreen"),p||"html5"!==t.engine||(e=n.css("opacity")||"",u.css(n,"opacity",0)),p||u.css(n,"position",""),u.removeClass(n,"is-fullscreen"),p||"html5"!==t.engine||setTimeout(function(){n.css("opacity",e)}),t.isFullscreen=!1,o.scrollTo(i,r)}).on("unload",function(){t.isFullscreen&&t.fullscreen()}),t.on("shutdown",function(){l=null,u.removeNode(s)}),a=/Firefox/.test(navigator.userAgent),c.on(s,"fullscreenchange.fsvl webkitfullscreenchange.fsvl mozfullscreenchange.fsvl MSFullscreenChange.fsvl",function(e){document.fullscreenElement?c.on(document,"mousewheel.fp",function(e){e.target.closest("#select-container")||t&&(e.preventDefault(),a?e.detail<0?t.volume(t.volumeLevel+.05):0<e.detail&&t.volume(t.volumeLevel-.05):0<e.wheelDeltaY?t.volume(t.volumeLevel+.05):e.wheelDeltaY<0&&t.volume(t.volumeLevel-.05))},!1,{passive:!1}):c.off(document,"mousewheel.fp")}))})},{"../common":1,"../flowplayer":31,bean:34}],15:[function(e,t,n){"use strict";var s,o,r=e("../flowplayer"),i=e("bean"),a=e("../common");i.on(document,"keydown.fp",function(e){var n=s,t=e.ctrlKey||e.metaKey||e.altKey,o=e.which,r=n&&n.conf;if(n&&r.keyboard&&!n.disabled){var i=[];if(!t&&n.ready){if(e.shiftKey)return 39==o?n.speed(!0):37==o&&n.speed(!1),e.preventDefault();(function(){switch(o){case 38:case 75:return n.volume(n.volumeLevel+.05),a(),!0;case 40:case 74:return n.volume(n.volumeLevel-.05),a(),!0;case 39:case 76:return n.seeking=!0,n.seek(!0),(t=$(".fp-stepmove-forward")).removeClass("active"),setTimeout(function(){clearTimeout(i),t.addClass("active"),i=setTimeout(function(){t.removeClass("active")},500)},0),!0;case 37:case 72:return n.seeking=!0,n.seek(!1),(e=$(".fp-stepmove-back")).removeClass("active"),setTimeout(function(){clearTimeout(i),e.addClass("active"),i=setTimeout(function(){e.removeClass("active")},500)},0),!0;case 190:return n.seekTo(),!0;case 32:return n.toggle(),!0;case 70:return r.fullscreen&&n.fullscreen(),!0;case 77:return n.mute(),!0;case 81:return n.unload(),!0}var e,t})()&&e.preventDefault()}}function a(){$(".flowplayer").hasClass("is-touch")||($(".fp-volume").addClass("fp-volume_active"),setTimeout(function(){$(".fp-volume").removeClass("fp-volume_active")},1500))}});/Firefox/.test(navigator.userAgent);r(function(t,n){t.conf.keyboard&&(i.on(document,"click",function(e){if(a.hasParent(e.target,n))s=t.disabled?0:t;else{if(s!==t)return;s=0}s&&(o=n)}),t.bind("shutdown",function(){o==n&&(o=null)}))})},{"../common":1,"../flowplayer":31,bean:34}],16:[function(e,t,n){var o=e("../flowplayer"),s=e("../common"),l=e("bean");o(function(i,a){i.showMenu=function(t,e){var n=s.find(".fp-ui",a)[0];s.addClass(t,"fp-active"),setTimeout(function(){l.one(document,"click",function(e){i.hideMenu(t)})});var o=e;if(e&&e.tagName&&(o={left:s.offset(e).left,rightFallbackOffset:s.width(e),top:s.offset(e).top+s.height(e)}),!o)return s.css(t,"top","auto");o.rightFallbackOffset=o.rightFallbackOffset||0;var r=o.top-s.offset(n).top,e=o.left-s.offset(n).left;s.width(t)+e>s.width(n)&&(e=e-s.width(t)+o.rightFallbackOffset),s.height(t)+r>s.height(n)&&(r-=s.height(t)),s.css(t,{top:r+"px",left:e+"px",right:"auto"})},i.hideMenu=function(e){s.toggleClass(e,"fp-active",!1)}})},{"../common":1,"../flowplayer":31,bean:34}],17:[function(e,t,n){var o=e("../flowplayer"),a=e("../common"),s=e("bean");o(function(e,t){var r=a.find(".fp-header",t)[0],i=a.find(".fp-ui",t)[0];e.message=function(e,t){var n,o=(e=e,n=a.createElement("div",{className:"fp-message"},e),i.insertBefore(n,r),setTimeout(function(){a.toggleClass(n,"fp-shown")}),n),e=function(){a.toggleClass(o,"fp-shown"),setTimeout(function(){var e;e=o,a.removeNode(e)},500)};return t&&setTimeout(e,t),e},e.textarea=function(e){var t=document.createElement("textarea");t.value=e,t.className="fp-textarea",i.appendChild(t),s.on(document,"click.fptextarea",function(e){return e.target===t?t.select():(e.stopPropagation(),e.preventDefault(),a.removeNode(t),void s.off(document,"click.fptextarea"))})}})},{"../common":1,"../flowplayer":31,bean:34}],18:[function(e,t,n){"use strict";var o=e("../flowplayer"),p=/IEMobile/.test(window.navigator.userAgent),h=e("../common"),g=e("bean"),m=e("./ui").format,v=o.support,y=window.navigator.userAgent;o(function(n,o){var e,t,r,i,a,s,l,c,u,f,d;(v.touch||p)&&(t=(e=v.android)&&!e.firefox,r=/Silk/.test(y),i=e.version||0,t&&!p&&((!/Chrome/.test(y)&&i<4||e.samsung&&i<5)&&(a=n.load,n.load=function(){var e=a.apply(n,arguments);return h.find("video.fp-engine",o)[0].load(),n.trigger("ready",[n,n.video]),e}),l=0,c=function(e){s=setInterval(function(){e.video.time=++l,e.trigger("progress",[e,l])},1e3)},n.on("ready pause unload",function(){s&&(clearInterval(s),s=null)}),n.on("ready",function(){l=0}),n.on("resume",function(e,t){if(t.live)return l?c(t):void n.one("progress",function(e,t,n){0===n&&c(t)})})),v.volume||(h.removeClass(o,"fp-mute"),h.addClass(o,"no-volume")),v.iOS&&h.addClass(o,"fp-mute"),h.addClass(o,"is-touch"),n.sliders&&n.sliders.timeline&&n.sliders.timeline.disableAnimation(),u=!1,g.on(o,"touchmove",function(){u=!0}),f=!0,g.on(o,"touchend",function(e){var t;u?u=!1:(t=h.find("fp-engine.fp-engine",o)[0],f&&n.conf.clickToUnMute&&t&&t.muted&&n.conf.autoplay&&(t.muted=!1),f=!1,!e.target.closest(".block-options")||e.target.closest(".fp-qsel")&&e.target.closest(".fp-cc")||n.showPanel(),e.target.closest(".fp-menu")&&n.showPanel(),(e.target.closest(".fp-qsel")||e.target.closest(".fp-cc"))&&(document.querySelector(".fp-active")?showPanel():clearTimeout(void 0)))}),g.on(o,"touchstart",".fp-timeline",function(e){clearTimeout(void 0)},!!supportsPassive&&{passive:!0}),g.on(o,"touchend",".fp-timeline, .fp-playbtn, .fp-playbtn-small",function(e){n.showPanel()}),!v.fullscreen&&n.conf.native_fullscreen&&"function"==typeof h.createElement("video").webkitEnterFullScreen&&(d=n.fullscreen,n.fullscreen=function(){var e=h.find("video.fp-engine",o)[0];if(!e)return d.apply(n);n.trigger("fullscreen",[n]),g.on(document,"webkitfullscreenchange.nativefullscreen",function(){document.webkitFullscreenElement===e&&(g.off(document,".nativefullscreen"),g.on(document,"webkitfullscreenchange.nativefullscreen",function(){document.webkitFullscreenElement||(g.off(document,".nativefullscreen"),n.trigger("fullscreen-exit",[n]))}))}),e.webkitEnterFullScreen(),g.one(e,"webkitendfullscreen",function(){g.off(document,"fullscreenchange.nativefullscreen"),n.trigger("fullscreen-exit",[n]),h.prop(e,"controls",!0),h.prop(e,"controls",!1)})}),(t||r)&&n.bind("ready",function(){var t=h.find("video.fp-engine",o)[0];n.conf.splash&&t.paused&&"hlsjs-lite"!==n.engine.engineName&&(g.one(t,"canplay",function(){t.play()}),t.load()),n.bind("progress.dur",function(){var e;n.live||n.conf.live||1!==(e=t.duration)&&(n.video.duration=e,h.find(".fp-duration",o)[0].innerHTML=m(e),n.unbind("progress.dur"))})}))})},{"../common":1,"../flowplayer":31,"./ui":27,bean:34}],19:[function(e,t,n){"use strict";var o=e("../flowplayer"),r=e("extend-object"),i=e("bean"),h=e("../common"),a=e("./resolve"),s=new a,g=window.jQuery,m=/^#/;o(function(l,c){var u=r({active:"is-active",advance:!0,query:".fp-playlist a"},l.conf),f=u.active,t=h.find(".fp-ui",c)[0],e=h.hasClass(c,"fp-custom-playlist")||!!u.customPlaylist;function n(){return h.find(u.query,d())}function d(){if(!m.test(u.query))return c}function p(){return h.find(u.query+"."+f,d())}function o(){var e,n=h.find(".fp-playlist",c)[0];n||(n=h.createElement("div",{className:"fp-playlist"}),(e=h.find(".fp-next,.fp-prev",c)).length?e[0].parentElement.insertBefore(n,e[0]):h.insertAfter(c,h.find("video",c)[0],n)),n.innerHTML="",l.conf.playlist[0].length&&(l.conf.playlist=l.conf.playlist.map(function(e){if("string"!=typeof e)return{sources:e.map(function(t){var n={};return Object.keys(t).forEach(function(e){n.type=/mpegurl/i.test(e)?"application/x-mpegurl":"video/"+e,n.src=t[e]}),n})};var t=e.split(a.TYPE_RE)[1];return{sources:[{type:"m3u8"===t.toLowerCase()?"application/x-mpegurl":"video/"+t,src:e}]}})),l.conf.playlist.forEach(function(e,t){e=e.sources[0].src;n.appendChild(h.createElement("a",{href:e,className:l.video.index===t?f:void 0,"data-index":t}))})}h.toggleClass(c,"fp-custom-playlist",e),h.toggleClass(c,"fp-default-playlist",!e),l.playDisplayNone=function(e){return l.resume2()},l.play=function(e,t){if(void 0===e)return l.resume();if("number"==typeof e&&!l.conf.playlist[e])return l;if("number"!=typeof e)return l.load.apply(null,arguments);var n=r({index:e},l.conf.playlist[e]);return l.off("beforeresume.fromfirst"),"number"==typeof e&&e===l.video.index?l.seek(0,function(){l.resume()}):(l.load(n,function(){l.video.index=t?e+1:e}),l)},l.next=function(e){e&&e.preventDefault();var t=l.video.index;if(-1!=t){if(0==t&&(t=1),"number"!=typeof++t)return l.load.apply(null,arguments);e=r({index:t},l.conf.playlist[t]);console.log(e),l.off("beforeresume.fromfirst"),l.load(e,function(){l.video.index=t})}return l},l.prev=function(e,t){e&&e.preventDefault();var n=l.video.index;if(-1!=n&&(n=0===n?0:n-1),"number"!=typeof n)return l.load.apply(null,arguments);e=r({index:n},l.conf.playlist[n]);return l.off("beforeresume.fromfirst"),l.load(e,function(){l.video.index=n}),l},l.setPlaylist=function(e,t,n){return l.conf.playlist=e,t||delete l.video.index,"prev"==n&&l.video.index++,o(),l},l.addPlaylistItem=function(e){return delete l.video.is_last,l.setPlaylist(l.conf.playlist.concat([e]),!0)},l.addPlaylistItemFirst=function(e){return l.setPlaylist([e].concat(l.conf.playlist),!0,"prev")},l.removePlaylistItem=function(e){var t=l.conf.playlist;return l.setPlaylist(t.slice(0,e).concat(t.slice(e+1)))},i.on(c,"click",".fp-next",l.next),i.on(c,"click",".fp-prev",l.prev),l.off("finish.pl").on("finish.pl",function(e,t){if(void 0===t.conf.advance||t.conf.advance){if(t.video.loop)return t.seek(0,function(){t.resume()});var n=0<=t.video.index?t.video.index+1:void 0;n<t.conf.playlist.length||u.loop?(n=n===t.conf.playlist.length?0:n,h.removeClass(c,"is-finished")):1<t.conf.playlist.length&&(t.one("beforeresume.fromfirst",function(e){e.preventDefault()}),t.one("seek",function(){t.off("beforeresume.fromfirst")}))}});e=!1;l.conf.playlist.length&&(e=!0,o(),l.conf.clip&&l.conf.clip.sources.length||(l.conf.clip=l.conf.playlist[l.conf.startIndex||0])),n().length&&!e&&(l.conf.playlist=[],delete l.conf.startIndex,n().forEach(function(e){var t=e.href;e.setAttribute("data-index",l.conf.playlist.length);t=s.resolve(t,l.conf.clip.sources);g&&r(t,g(e).data()),l.conf.playlist.push(t)})),h.find(".fp-prev,.fp-next,.fp-playlist",c).forEach(function(e){t.appendChild(e)}),i.on(m.test(u.query)?document:c,"click",u.query,function(e){e.preventDefault();e=e.currentTarget,e=Number(e.getAttribute("data-index"));-1!=e&&l.play(e)}),l.on("load",function(e,t,n){var o,r,i,a,s;l.conf.playlist.length&&(r=(o=p()[0])&&o.getAttribute("data-index"),i=n.index=void 0!==(s=n).index?s.index:void 0!==l.video.index?l.video.index:l.conf.startIndex||0,a=h.find(u.query+'[data-index="'+i+'"]',d())[0],s=i==l.conf.playlist.length-1,o&&h.removeClass(o,f),a&&h.addClass(a,f),h.removeClass(c,"video"+r),h.addClass(c,"video"+i),h.toggleClass(c,"last-video",s),n.index=t.video.index=i,n.is_last=t.video.is_last=s)}).on("unload.pl",function(){l.conf.playlist.length&&(p().forEach(function(e){h.toggleClass(e,f)}),l.conf.playlist.forEach(function(e,t){h.removeClass(c,"video"+t)}),delete l.video.index)}),l.conf.playlist.length&&(l.conf.loop=!1)})},{"../common":1,"../flowplayer":31,"./resolve":21,bean:34,"extend-object":39}],20:[function(e,t,n){"use strict";var y=e("../flowplayer"),b=e("../common"),w=e("bean"),e=e("./subtitles/parser");y.defaults.subtitleParser=e,y(function(s,r){var i,a,n,o,l,c,u,f,d,p,h=document.querySelector(".fp-config .fp-config-list"),g=document.querySelector(".fp-config-mobile .fp-config-list");y.support.inlineVideo&&(y.support.fullscreen||!s.conf.native_fullscreen)||(s.conf.nativesubtitles=!0),s.ui||(s.ui={}),s.ui.createSubtitleControl=function(e,t){return p=t,f=b.createElement("li",{className:"fp-config-item"}),d=b.createElement("li"),n=b.createElement("div",{className:"fp-config-but fp-cc"}),o=b.createElement("div",{className:"fp-config-label"},"Субтитры"),l=b.createElement("div",{className:"fp-config-value"}),n.appendChild(o),n.appendChild(l),f.appendChild(n),d.appendChild(o.cloneNode(!0)),u=u||b.createElement("div",{className:"fp-menu fp-subtitle-menu"},"<strong>Субтитры</strong>"),c=c||b.createElement("select",{className:"fp-cc-select-menu"}),b.find("a",u).forEach(b.removeNode),b.find("option",c).forEach(b.removeNode),u.appendChild(b.createElement("a",{"data-subtitle-index":-1},"Отключены")),c.appendChild(b.createElement("option",{value:-1},"Отключены")),(e||[]).forEach(function(e,t){var n=e.srclang||"en",e=e.label||"Default ("+n+")",n=b.createElement("a",{"data-subtitle-index":t},e),e=b.createElement("option",{value:t},e);u.appendChild(n),c.appendChild(e)}),f.appendChild(u),d.appendChild(c),h.appendChild(f),g.appendChild(d),b.toggleClass(f,"fp-hidden",!e||!e.length),b.toggleClass(d,"fp-hidden",!e||!e.length),n},s.ui.createSpeedControl=function(){var o,r,e=b.createElement("li",{className:"fp-config-item"}),t=b.createElement("li"),n=b.createElement("div",{className:"fp-config-but fp-speed"}),i=b.createElement("div",{className:"fp-config-label"},"Скорость"),a=b.createElement("div",{className:"fp-config-value"},"Обычная");return n.appendChild(i),n.appendChild(a),e.appendChild(n),t.appendChild(i.cloneNode(!0)),o=b.createElement("div",{className:"fp-menu fp-speed-menu"},'<strong class="fp-config-toBack">Скорость</strong>'),r=b.createElement("select",{className:"fp-speed-select-menu"}),b.find("a",o).forEach(b.removeNode),b.find("option",r).forEach(b.removeNode),(s.conf.speeds||[]).forEach(function(e,t){var n,e=e||1,e=1==e?(n=b.createElement("a",{className:"fp-selected","data-speed-index":e},"Обычная"),b.createElement("option",{selected:"selected",value:e},"Обычная")):(n=b.createElement("a",{"data-speed-index":e},e+"x"),b.createElement("option",{value:e},e+"x"));o.appendChild(n),r.appendChild(e)}),e.appendChild(o),t.appendChild(r),h.appendChild(e),g.appendChild(t),b.toggleClass(e,"fp-hidden",!s.conf.speeds||!s.conf.speeds.length),b.toggleClass(t,"fp-hidden",!s.conf.speeds||!s.conf.speeds.length),n},s.ui.setActiveSubtitleItem=function(e){v(e)},w.on(r,"click",".fp-cc",function(){b.hasClass(u,"fp-active")?s.hideMenu():s.showMenu(u)}),w.on(r,"click",".fp-subtitle-menu [data-subtitle-index]",function(e){e=e.target.getAttribute("data-subtitle-index");return $(".fp-cc-select-menu").find("[value='"+e+"']").prop("selected","selected"),p?p(e):"-1"===e?s.disableSubtitles():void s.loadSubtitles(e)}),w.on(r,"change",".fp-cc-select-menu",function(e){e.preventDefault();e=e.target.value;return p?p(e):"-1"===e?s.disableSubtitles():void s.loadSubtitles(e)}),w.on(r,"click",".fp-speed-menu a",function(e){e.stopPropagation(),$(".fp-speed-menu a").removeClass("fp-selected"),$(this).addClass("fp-selected");var t=e.target.getAttribute("data-speed-index");$(".fp-speed .fp-config-value").text($(e.target).text()),$(".fp-speed-select-menu option[value='"+t+"']").prop("selected","selected"),s.speed(t)}),w.on(r,"change",".fp-speed-select-menu",function(e){var t=$(e.target).val();e.stopPropagation();var n=$(".fp-config-mobile");$(".fp-speed-menu a").removeClass("fp-selected"),$('.fp-speed-menu a[data-speed-index="'+t+'"]').addClass("fp-selected"),$(".fp-speed .fp-config-value").text($(e.target).val()+"x"),s.speed(t),$(n).hasClass("fp-active")&&n.removeClass("fp-active")});s.on("ready",function(e,t,n){var o;t.subtitles=[],a=(a=b.find(".fp-captions",r)[0])||b.appendTo(b.createElement("div",{class:"fp-captions"}),b.find(".fp-player",r)[0]),$(".fp-cc").parent().remove(),$(".fp-cc-select-menu").parent().remove(),$(".fp-speed").parent().remove(),$(".fp-speed-select-menu").parent().remove(),s.ui.createSubtitleControl(s.video.subtitles),s.ui.createSpeedControl(),s.ui.setSize(),b.removeClass(r,"has-menu"),s.disableSubtitles(),n.subtitles&&n.subtitles.length&&((o=n.subtitles.filter(function(e){return e.default})[0])&&t.loadSubtitles(n.subtitles.indexOf(o)))}),s.showSubtitle=function(e){b.html(a,e),b.addClass(a,"fp-shown")},s.hideSubtitle=function(){b.removeClass(a,"fp-shown")},s.bind("cuepoint",function(e,t,n){n.subtitle?(i=n.index,s.showSubtitle(n.subtitle.text)):n.subtitleEnd&&(s.hideSubtitle(),i=n.index)}),s.bind("seek",function(e,t,o){i&&s.cuepoints[i]&&s.cuepoints[i].time>o&&(b.removeClass(a,"fp-shown"),i=null),(s.cuepoints||[]).forEach(function(e,t){var n=e.subtitle;n&&i!=t?o>=e.time&&(!n.endTime||o<=n.endTime)&&s.trigger("cuepoint",[s,e]):e.subtitleEnd&&o>=e.time&&t==i+1&&s.trigger("cuepoint",[s,e])})}),s.on("unload",function(){b.find(".fp-captions",r).forEach(b.removeNode)});function m(e,t){var n=b.find("video.fp-engine",r)[0].textTracks;n.length&&(null===e?[].forEach.call(n,function(e){e.mode=t}):n[e].mode=t)}var v=function(e){b.toggleClass(b.find("a.fp-selected",u)[0],"fp-selected"),b.toggleClass(b.find('a[data-subtitle-index="'+e+'"]',u)[0],"fp-selected"),l.innerHTML=b.find('a[data-subtitle-index="'+e+'"]',u)[0].innerHTML,$(".fp-cc-select-menu option[value='"+e+"']").prop("selected","selected")};s.disableSubtitles=function(){return s.subtitles=[],(s.cuepoints||[]).forEach(function(e){(e.subtitle||e.subtitleEnd)&&s.removeCuepoint(e)}),a&&Array.prototype.forEach.call(a.children,b.removeNode),v(-1),y.support.subtitles&&s.conf.nativesubtitles&&"html5"==s.engine.engineName&&m(null,"disabled"),s},s.loadSubtitles=function(e){s.disableSubtitles();var t=s.video.subtitles[e].src;if(t){if(v(e),!y.support.subtitles||!s.conf.nativesubtitles||"html5"!=s.engine.engineName)return b.xhrGet(t,function(e){s.conf.subtitleParser(e).forEach(function(e,t){e.title||(e.title="subtitle"+t);var n={time:e.startTime,subtitle:e,visible:!1};s.subtitles.push(e),s.addCuepoint(n),s.addCuepoint({time:e.endTime,subtitleEnd:e.title,visible:!1}),0!==e.startTime||s.video.time||s.splash||s.trigger("cuepoint",[s,y.extend({},n,{index:0})]),s.splash&&s.one("ready",function(){s.trigger("cuepoint",[s,n])})})},function(){return s.trigger("error",{code:8,url:t}),!1}),s;m(e,"showing")}}})},{"../common":1,"../flowplayer":31,"./subtitles/parser":24,bean:34}],21:[function(e,t,n){"use strict";var r=/\.(\w{3,4})(\?.*)?$/i,i=e("extend-object");function o(e){var t=e.attr("src"),n=e.attr("type")||"",o=t.split(r)[1],n=n.toLowerCase();return i(e.data(),{src:t,suffix:o||n,type:n||o})}t.exports=function(){this.sourcesFromVideoTag=function(e,t){var n=[];return t("source",e).each(function(){n.push(o(t(this)))}),!n.length&&e.length&&n.push(o(e)),n},this.resolve=function(n,e){return n?("string"==typeof n&&((n={src:n,sources:[]}).sources=(e||[]).map(function(e){var t=e.src.split(r)[1];return{type:e.type,src:n.src.replace(r,"."+t+"$2")}})),n instanceof Array&&(n={sources:n.map(function(n){return n.type&&n.src?n:Object.keys(n).reduce(function(e,t){return i(e,{type:/mpegurl/i.test(e=t)?"application/x-mpegurl":"video/"+e,src:n[t]})},{})})}),n):{sources:e}}},t.exports.TYPE_RE=r},{"extend-object":39}],22:[function(e,t,n){"use strict";var o=e("../flowplayer"),i=e("../common"),a=e("extend-object"),s=e("bean");o(function(t,e){var n,o,r=t.conf;!1!==r.share?(t.shareUrl=function(e){return e&&r.embed&&r.embed.iframe?r.embed.iframe:"string"==typeof t.conf.share?t.conf.share:(e?"https://flowplayer.com/e/":"https://flowplayer.com/s/")+"?t="+encodeURIComponent(t.video.title||(i.find("title")[0]||{}).innerHTML||"Flowplayer Commercial video")+"&c="+encodeURIComponent(btoa(JSON.stringify(a({},t.conf,t.extensions)).replace(/[\u007F-\uFFFF]/g,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)})))+"&r="+encodeURIComponent(window.location.toString())},n=i.createElement("div",{className:"fp-menu fp-share-menu"},"<strong>Share</strong>"),i.find(".fp-ui",e)[0].appendChild(n),o=i.find(".fp-share",e)[0],s.on(e,"click",".fp-share",function(e){e.preventDefault(),i.hasClass(n,"fp-active")?t.hideMenu():t.showMenu(n,o)})):i.find(".fp-share",e).forEach(i.removeNode)})},{"../common":1,"../flowplayer":31,bean:34,"extend-object":39}],23:[function(e,t,n){var o=e("../flowplayer"),u=e("../common"),l=e("bean");o(function(n,o){var e=u.find(".fp-ui",o)[0],t=(u.find(".fp-controls",e)[0],$(".fp-config")),r=$(".fp-config__bg-lock"),i=$(".fp-config-mobile"),a=$(".fp-config-btn");function s(t){u.find(".fp-qsel-menu a",o).forEach(function(e){u.toggleClass(e,"fp-selected",e.getAttribute("data-quality")==t),u.toggleClass(e,"fp-color",e.getAttribute("data-quality")==t)}),u.find(".fp-qsel-select option",o).forEach(function(e){u.toggleClass(e,"fp-selected",e.getAttribute("value")==t),u.toggleClass(e,"fp-color",e.getAttribute("value")==t)})}$(".fp-config-mobile").on("click",function(e){e.stopPropagation()}),l.on(o,"click",a,function(e){$(window).width()<821&&$(".flowplayer").hasClass("is-touch")?(t.removeClass("fp-active"),i.toggleClass("fp-active")):(i.removeClass("fp-active"),t.toggleClass("fp-active"),r.toggleClass("bg-lock")),i.hasClass("fp-active")||t.hasClass("fp-active")?$(this).addClass("active"):$(this).removeClass("active"),e.stopPropagation()}),$(i).on("click",".fp-config-close",function(){i.removeClass("fp-active")}),$(window).on("click",function(e){$(e.target).closest(".fp-config").length||(t.removeClass("fp-active"),a.removeClass("active"))}),l.on(o,"click",".fp-qsel-menu a",function(e){e=e.target.getAttribute("data-quality");$(".fp-qsel-select-menu").val(e).find("option[value='q']").attr("selected","selected"),n.quality(e)}),l.on(o,"change",".fp-qsel-select-menu",function(e){var t=e.target.value,e=$(".fp-config-mobile");$(".fp-qsel-menu a").removeClass("fp-selected fp-color"),$(".fp-qsel-menu a[data-quality='"+t+"']").addClass("fp-selected fp-color"),n.quality(t),$(e).hasClass("fp-active")&&e.removeClass("fp-active")}),n.quality=function(e){e=isNaN(Number(e))?e:Number(e),n.trigger("quality",[n,e])},n.on("quality",function(e,t,n){s(n,t.video.qualities)}),n.on("ready",function(e,t,n){$(".fp-qsel-menu").parent().remove(),$(".fp-qsel-select-menu").parent().remove(),!n.qualities||n.qualities.filter(function(e){return void 0===e.value||-1<e.value}).length<2?u.addClass(o,"is-noquality"):(function(e){var t=document.querySelector(".fp-config .fp-config-list"),n=document.querySelector(".fp-config-mobile .fp-config-list"),o=u.createElement("li",{className:"fp-config-item"}),r=u.createElement("li"),i=u.createElement("div",{className:"fp-config-but fp-qsel"}),a=u.createElement("div",{className:"fp-config-label"},"Качество"),s=u.createElement("div",{className:"fp-config-value"},"Авто");i.appendChild(a),i.appendChild(s),o.appendChild(i),r.appendChild(a.cloneNode(!0));var l=u.createElement("div",{className:"fp-menu fp-qsel-menu"},'<strong class="fp-config-toBack">Качество</strong>'),c=u.createElement("select",{className:"fp-qsel-select-menu"});e.forEach(function(e){var t=document.createElement("a"),n=document.createElement("option"),o=void 0!==e.value?e.value:e;t.setAttribute("data-quality",o),n.setAttribute("value",o),t.innerHTML=e.label||e,n.innerHTML=e.label||e,l.appendChild(t),c.appendChild(n)}),o.appendChild(l),r.appendChild(c),t.appendChild(o),n.appendChild(r)}(n.qualities,n.quality),s(n.quality,n.qualities))})})},{"../common":1,"../flowplayer":31,bean:34}],24:[function(e,t,n){t.exports=function(e){var t=/^(([0-9]+:){1,2}[0-9]{2}[,.][0-9]{3}) --\> (([0-9]+:){1,2}[0-9]{2}[,.][0-9]{3})(.*)/;function n(e){e=e.split(":");return 2==e.length&&e.unshift(0),60*e[0]*60+60*e[1]+parseFloat(e[2].replace(",","."))}for(var o,r,i,a,s=[],l=0,c=e.split("\n"),u=c.length;l<u;l++)if(i=t.exec(c[l])){for(r=c[l-1],a="<p>"+c[++l]+"</p><br/>";"string"==typeof c[++l]&&c[l].trim()&&l<c.length;)a+="<p>"+c[l]+"</p><br/>";o={title:r,startTime:n(i[1]),endTime:n(i[3]),text:a},s.push(o)}return s}},{}],25:[function(e,t,n){"use strict";var E=e("../flowplayer"),C=e("extend-object");!function(){var e={},t=document.documentElement.style,n=navigator.userAgent.toLowerCase();(v=/(chrome)[ \/]([\w.]+)/.exec(n)||/(safari)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[])[1]&&(e[v[1]]=!0,e.version=v[2]||"0"),e.safari&&(e.version=(/version\/([\w.]+)/.exec(n)||[])[1]);var o=((m=document.createElement("video")).loop=!0,m.autoplay=!0,m.preload=!0,m),r=navigator.userAgent,i=e.msie||/Trident\/7/.test(r),a=/iPad|MeeGo/.test(r)&&!/CriOS/.test(r),s=/iPad/.test(r)&&/CriOS/.test(r),l=/iP(hone|od)/i.test(r)&&!/iPad/.test(r)&&!/IEMobile/i.test(r),c=/Android/.test(r),u=c&&/Firefox/.test(r),f=c&&/SAMSUNG/.test(r),d=/Silk/.test(r),p=/IEMobile/.test(r),h=p?parseFloat(/Windows\ Phone\ (\d+\.\d+)/.exec(r)[1],10):0,g=p?parseFloat(/IEMobile\/(\d+\.\d+)/.exec(r)[1],10):0,m=a||l?function(e){e=/iP(ad|hone)(; CPU)? OS (\d+_\d)/.exec(e);return e&&1<e.length?parseFloat(e[e.length-1].replace("_","."),10):0}(r):0,v=c?parseFloat(/Android\ (\d+(\.\d+)?)/.exec(r)[1],10):0,n=(l||a||s)&&{iPhone:l,iPad:a||s,version:m,chrome:s},y=C(E.support,{browser:e,iOS:n,android:!!c&&{firefox:u,opera:/Opera/.test(r),samsung:f,version:v},subtitles:!!o.addTextTrack,fullscreen:"boolean"==typeof document.webkitFullscreenEnabled?document.webkitFullscreenEnabled:"function"==typeof document.webkitCancelFullScreen&&!/Mac OS X 10_5.+Version\/5\.0\.\d Safari/.test(r)||document.mozFullScreenEnabled||"function"==typeof document.exitFullscreen||"function"==typeof document.msExitFullscreen,inlineBlock:!(i&&e.version<8),touch:"ontouchstart"in window,dataload:!a&&!l&&!p,flex:"flexWrap"in t||"WebkitFlexWrap"in t||"msFlexWrap"in t,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,zeropreload:!i&&!c,volume:!(a||l||d||s),cachedVideoTag:!(a||l||s||p),firstframe:!(d||p||u||f||m&&m<10||c&&v<4.4),inlineVideo:(!l||10<=m)&&(!p||8.1<=h&&11<=g)&&(!c||3<=v),hlsDuration:!c&&(!e.safari||a||l||s),seekable:!a&&!s,preloadMetadata:!n&&!e.safari});y.autoplay=y.firstframe,p&&(y.browser.safari=!1);try{var b=navigator.plugins["Shockwave Flash"],w=i?new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version"):b.description;i||b[0].enabledPlugin?((w=w.split(/\D+/)).length&&!w[0]&&(w=w.slice(1)),y.flashVideo=9<w[0]||9==w[0]&&115<=w[3]):y.flashVideo=!1}catch(e){}try{y.video=!!o.canPlayType,y.video&&o.canPlayType("video/mp4")}catch(e){y.video=!1}y.animation=function(){for(var e=["","Webkit","Moz","O","ms","Khtml"],t=document.createElement("p"),n=0;n<e.length;n++)if(void 0!==t.style[e[n]+"AnimationName"])return!0}()}()},{"../flowplayer":31,"extend-object":39}],26:[function(e,t,n){"use strict";var o=e("../flowplayer"),a=e("../common"),s=e("bean");o(function(r,e){var t,n,i=r.conf;!1!==i.share&&!1!==i.twitter&&(r.tweet=function(){var e=screen.height,t=screen.width,n="string"==typeof i.twitter?i.twitter:r.shareUrl(),o=Math.round(t/2-275),t=0;420<e&&(t=Math.round(e/2-210)),window.open("https://twitter.com/intent/tweet?url="+encodeURIComponent(n),"intent","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,left="+o+",top="+t)},t=a.find(".fp-share-menu",e)[0],n=a.createElement("a",{class:"fp-icon fp-twitter"},"Twitter"),a.append(t,n),s.on(e,"click",".fp-twitter",function(){r.tweet()}))})},{"../common":1,"../flowplayer":31,bean:34}],27:[function(e,t,n){(function(j){"use strict";var R=e("../flowplayer"),O=e("../common"),L=e("bean"),_=e("./ui/slider"),U=e("./ui/bar-slider");function o(e){return 10<=(e=parseInt(e,10))?e:"0"+e}function F(e,t){e=Math.max(e||0,0),e=t?Math.ceil(e):Math.floor(e);var n=Math.floor(e/3600),t=Math.floor(e/60);return e-=60*t,1<=n?n+":"+o(t-=60*n)+":"+o(e):o(t)+":"+o(e)}var Y=j("PHN2ZyBjbGFzcz0iZnAtbG9hZGluZy1zaGFycC1maWxsIiB3aWR0aD0iMTEycHgiIGhlaWdodD0iMTEycHgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDc2IDc2IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+ICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSI3NiIgaGVpZ2h0PSI3NiIgZmlsbD0icmdiYSgwLDAsMCwwKSIgY2xhc3M9ImJrIj48L3JlY3Q+ICAgIDxyZWN0IHg9Ii0xMCIgeT0iLTEwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1IDI1KSIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwxKSIgY2xhc3M9InNxIj4gICAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJmaWxsIiBmcm9tPSJyZ2JhKDAsMCwwLDApIiB0bz0icmdiYSgyNTUsMjU1LDI1NSwxKSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS42cyIgYmVnaW49IjAuMHMiIHZhbHVlcz0icmdiYSgyNTUsMjU1LDI1NSwxKTtyZ2JhKDAsMCwwLDApO3JnYmEoMCwwLDAsMCk7cmdiYSgyNTUsMjU1LDI1NSwxKTtyZ2JhKDI1NSwyNTUsMjU1LDEpIiBrZXlUaW1lcz0iMDswLjE7MC4yOzAuNDsxIj48L2FuaW1hdGU+ICAgICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJzY2FsZSIgYWRkaXRpdmU9InN1bSIgZnJvbT0iMC44IiB0bz0iMSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGJlZ2luPSIwLjBzIiBkdXI9IjEuNnMiIHZhbHVlcz0iMTswLjg7MC44OzE7MSIga2V5VGltZXM9IjA7MC4xOzAuMjswLjQ7MSI+PC9hbmltYXRlVHJhbnNmb3JtPiAgICA8L3JlY3Q+ICAgIDxyZWN0IHg9Ii0xMCIgeT0iLTEwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwIDI1KSIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwxKSIgY2xhc3M9InNxIj4gICAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJmaWxsIiBmcm9tPSJyZ2JhKDAsMCwwLDApIiB0bz0icmdiYSgyNTUsMjU1LDI1NSwxKSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS42cyIgYmVnaW49IjAuNHMiIHZhbHVlcz0icmdiYSgyNTUsMjU1LDI1NSwxKTtyZ2JhKDAsMCwwLDApO3JnYmEoMCwwLDAsMCk7cmdiYSgyNTUsMjU1LDI1NSwxKTtyZ2JhKDI1NSwyNTUsMjU1LDEpIiBrZXlUaW1lcz0iMDswLjE7MC4yOzAuNDsxIj48L2FuaW1hdGU+ICAgICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJzY2FsZSIgYWRkaXRpdmU9InN1bSIgZnJvbT0iMC44IiB0bz0iMSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGJlZ2luPSIwLjRzIiBkdXI9IjEuNnMiIHZhbHVlcz0iMTswLjg7MC44OzE7MSIga2V5VGltZXM9IjA7MC4xOzAuMjswLjQ7MSI+PC9hbmltYXRlVHJhbnNmb3JtPiAgICA8L3JlY3Q+ICAgIDxyZWN0IHg9Ii0xMCIgeT0iLTEwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwIDUwKSIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwxKSIgY2xhc3M9InNxIj4gICAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJmaWxsIiBmcm9tPSJyZ2JhKDAsMCwwLDApIiB0bz0icmdiYSgyNTUsMjU1LDI1NSwxKSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS42cyIgYmVnaW49IjAuOHMiIHZhbHVlcz0icmdiYSgyNTUsMjU1LDI1NSwxKTtyZ2JhKDAsMCwwLDApO3JnYmEoMCwwLDAsMCk7cmdiYSgyNTUsMjU1LDI1NSwxKTtyZ2JhKDI1NSwyNTUsMjU1LDEpIiBrZXlUaW1lcz0iMDswLjE7MC4yOzAuNDsxIj48L2FuaW1hdGU+ICAgICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJzY2FsZSIgYWRkaXRpdmU9InN1bSIgZnJvbT0iMC44IiB0bz0iMSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGJlZ2luPSIwLjhzIiBkdXI9IjEuNnMiIHZhbHVlcz0iMTswLjg7MC44OzE7MSIga2V5VGltZXM9IjA7MC4xOzAuMjswLjQ7MSI+PC9hbmltYXRlVHJhbnNmb3JtPiAgICA8L3JlY3Q+ICAgIDxyZWN0IHg9Ii0xMCIgeT0iLTEwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1IDUwKSIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwxKSIgY2xhc3M9InNxIj4gICAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJmaWxsIiBmcm9tPSJyZ2JhKDAsMCwwLDApIiB0bz0icmdiYSgyNTUsMjU1LDI1NSwxKSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS42cyIgYmVnaW49IjEuMnMiIHZhbHVlcz0icmdiYSgyNTUsMjU1LDI1NSwxKTtyZ2JhKDAsMCwwLDApO3JnYmEoMCwwLDAsMCk7cmdiYSgyNTUsMjU1LDI1NSwxKTtyZ2JhKDI1NSwyNTUsMjU1LDEpIiBrZXlUaW1lcz0iMDswLjE7MC4yOzAuNDsxIj48L2FuaW1hdGU+ICAgICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJzY2FsZSIgYWRkaXRpdmU9InN1bSIgZnJvbT0iMC44IiB0bz0iMSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGJlZ2luPSIxLjJzIiBkdXI9IjEuNnMiIHZhbHVlcz0iMTswLjg7MC44OzE7MSIga2V5VGltZXM9IjA7MC4xOzAuMjswLjQ7MSI+PC9hbmltYXRlVHJhbnNmb3JtPiAgICA8L3JlY3Q+ICA8L3N2Zz4=","base64");R(function(f,i){O.find(".fp-filters").forEach(O.removeNode);try{var e;document.body.appendChild(e=O.createElement("div",{},j("PHN2ZyBjbGFzcz0iZnAtZmlsdGVycyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMCAwIj4KICA8ZGVmcz4KICAgIDxmaWx0ZXIgaWQ9ImYxIiB4PSItMjAlIiB5PSItMjAlIiB3aWR0aD0iMjAwJSIgaGVpZ2h0PSIyMDAlIj4KICAgICAgPGZlT2Zmc2V0IHJlc3VsdD0ib2ZmT3V0IiBpbj0iU291cmNlQWxwaGEiIGR4PSIwIiBkeT0iMCIgLz4KICAgICAgPGZlQ29sb3JNYXRyaXggcmVzdWx0PSJtYXRyaXhPdXQiIGluPSJvZmZPdXQiIHR5cGU9Im1hdHJpeCIKICAgICAgdmFsdWVzPSIwLjMgMCAwIDAgMCAwIDAuMyAwIDAgMCAwIDAgMC4zIDAgMCAwIDAgMCAwLjQgMCIgLz4KICAgICAgPGZlR2F1c3NpYW5CbHVyIHJlc3VsdD0iYmx1ck91dCIgaW49Im1hdHJpeE91dCIgc3RkRGV2aWF0aW9uPSI0IiAvPgogICAgICA8ZmVCbGVuZCBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJibHVyT3V0IiBtb2RlPSJub3JtYWwiIC8+CiAgICA8L2ZpbHRlcj4KICA8L2RlZnM+Cjwvc3ZnPgo=","base64"))),O.css(e,{width:0,height:0,overflow:"hidden",position:"absolute",margin:0,padding:0})}catch(e){}var a=f.conf,s=R.support;O.find(".fp-ratio,.fp-ui",i).forEach(O.removeNode),O.addClass(i,"flowplayer"),i.appendChild(O.createElement("div",{id:"ratio-block",className:"m-10 p-r c-white fp-ratio"}));var r=O.createElement("div",{id:"container__user-interface",className:"d-f mt-10 fp-ui"},'         <div id="container-preload__elements" class="first-preload__element"><span></span></div>         <div class="p-f t-50 l-50 tr-tr fp-waiting">           {{ LOADING_CUSTOM1 }}         </div>         <div id="center-play-element" class="fp-play fp-visible">           <a class="fp-icon fp-playbtn"><svg class="svg-icon"><use xlink:href="#play-large"></use>             </svg><svg class="svg-icon fp-playbtn-hover"><use xlink:href="#play-large-hover"></use></svg>           </a>         </div>         <div id="center-pause-element" class="fp-pause">           <a class="fp-icon fp-playbtn"><svg class="svg-icon"><use xlink:href="#pause-large"></use></svg></a>           <a class="fp-icon fp-playbtn fp-playbtn-hover"><svg class="svg-icon"><use xlink:href="#pause-large"></use></svg></a>         </div>         <div id="center-controls-element" class="fp-controls">            <a class="fp-playbtn-small">              <svg class="svg-icon svg-icon-play"><use xlink:href="#play-small"></use></svg>              <svg class="svg-icon svg-icon-pause"><use xlink:href="#pause-small"></use></svg>            </a>            <div class="fp-stepmove-nav">              <div class="fp-stepmove fp-stepmove-back">                -10              </div>              <div class="fp-stepmove fp-stepmove-forward">                +10              </div>            </div>            <div id="time-element" class="fp-time">              <span class="fp-elapsed">00:00</span>              <span class="fp-duration"></span>              <div class="fp-timeline fp-bar">                 <span class="fp-timestamp"></span>                 <div class="fp-progress fp-color"></div>              </div>              <span class="fp-remaining"></span>            </div>            <div class="fp-container-options">              <a class="fp-config-btn">                <svg class="svg-icon"><use xlink:href="#config"></use></svg>              </a>              <div class="fp-volume">                <a class="fp-icon fp-volumebtn">                  <svg class="svg-icon svg-icon-volume"><use xlink:href="#volume"></use></svg>                  <svg class="svg-icon svg-icon-volume-mute"><use xlink:href="#volume-mute"></use></svg>                </a>                <div class="fp-volumebar fp-bar-slider">                    <span class="fp-volume-ball"></span>                     <em></em><em></em><em></em><em></em><em></em><em></em><em></em><em></em><em></em><em></em>                   </div>              </div>              <a class="fp-pip">                <svg class="svg-icon svg-icon-pipin"><use xlink:href="#pip-in"></use></svg>                <svg class="svg-icon svg-icon-pipout"><use xlink:href="#pip-out"></use></svg>              </a>              <a class="fp-fullscreen">                <svg class="svg-icon svg-icon-fsin"><use xlink:href="#fs-in"></use></svg>                <svg class="svg-icon svg-icon-fsout"><use xlink:href="#fs-out"></use></svg>              </a>            </div>         </div>'.replace("{{ LOADING_CUSTOM1 }}",Y).replace(/url\(#/g,"url("+window.location.href.replace(window.location.hash,"").replace(/\#$/g,"")+"#")),t=O.createElement("div",{id:"container__outer-interface",className:"mt-10 p-r d-f fsz-15 fp-outerui"},'        <section id="outer-control-items" class="mt-10 mb-15 d-f fsz-16"><span></span></section>        <div class="outer-menu-elements" data-menuitem="8" data-menucolor="fff"></div>        <div id="but_tapSeekPrev"></div>        <div id="but_tapSeekNext"></div>        <div class="fp-config__bg-lock"></div>         <div class="fp-config">          <ul class="fp-config-list"></ul>         </div>        <div class="fp-config-mobile">          <div class="fp-config-mobile-body">            <div class="fp-config-close"></div>            <div class="fp-config-title">Настройки</div>            <ul class="fp-config-list">            </ul>          </div>          <div class="fp-config-bg"></div>        </div>');function n(){$(".fp-playbtn-small");var e=$(".fp-outerui"),t=$(".fp-stepmove-nav");$(window).width(),e.append(t)}function o(e){return O.find(".fp-"+e,i)[0]}f.ui||(f.ui={}),f.ui.setSize=function(){function e(){var e=r.offset().left+r.outerWidth()/2;n.css("left",e)}var n,t,o,r,i,a,s,l,c,u;f.ui.setSize.setted||(t=(n=$(".fp-config")).find(".fp-config-label"),o=n.find(".fp-menu"),r=$(".fp-config-btn"),n.off("click.updateSizeEv"),i=[],a=[],l=s=0,o.each(function(e){return!!$(this).parent().hasClass("fp-hidden")||(i[e]=$(this).outerWidth(),a[e]=$(this).outerHeight(),i[e]>s&&(s=i[e]),void $(this).hide())}),t.each(function(){$(this).width()>l&&(l=$(this).outerWidth())}),c=n.height(),u=s+l,n.width(u).height(c),n.on("click.updateSizeEv",".fp-config-but",function(e){var t=$(this);return t.parent().addClass("active"),n.addClass("active").width(i[t.parent().index()]).height(a[t.parent().index()]),!1}),n.on("click.updateSizeEv",".fp-menu a, .fp-menu strong",function(e){e.preventDefault(),$(e.target).closest(".fp-menu strong").length&&e.stopPropagation(),$(e.target).parents(".fp-config-item").removeClass("active"),n.removeClass("active").width(u).height(c)}),e(),$(window).on("resize",e),f.ui.setSize.setted=!0)},f.ui.setSize.setted=!1,i.appendChild(r),i.appendChild(t),n(),$(window).on("resize",n);var t=o("waiting"),l=o("elapsed"),c=o("ratio"),u=o("speed-flash"),d=o("duration"),p=o("remaining"),h=o("timestamp"),g=O.css(c,"padding-top"),m=o("play"),v=o("pause"),y=o("timeline"),b=_(y,f.rtl),w=o("fullscreen"),E=o("volumebar"),C=O.hasClass(i,"no-toggle"),x="Y"==$(".js-flowplayer").data("volaxis")?U(E,{rtl:f.rtl,axis:"Y"}):U(E,{rtl:f.rtl});b.disableAnimation(O.hasClass(i,"is-touch")),f.sliders=f.sliders||{},f.sliders.timeline=b,f.sliders.volume=x;var k,I=[];function S(e){O.css(c,"padding-top",100*e+"%"),s.inlineBlock||O.height(O.find("object",i)[0],O.height(i))}function T(e){var t;e?(O.addClass(i,"is-mouseover"),O.removeClass(i,"is-mouseout")):O.hasClass(i,"is-seeking")||(O.addClass(i,"is-mouseout"),O.removeClass(i,"is-mouseover"),(t=O.find(".fp-qsel-menu",i)[0])&&O.hasClass(t,"fp-active")&&(O.removeClass(t,"fp-active"),L.one(document,"click",function(){f.showMenu(t)})))}s.svg||O.html(t,"<p>loading &hellip;</p>"),a.ratio&&S(a.ratio);try{a.fullscreen||O.removeNode(w)}catch(e){O.removeNode(w)}function A(e){var t,n=(e.pageX||e.clientX)-O.offset(y).left,o=n/O.width(y),r=f.video,i=r.duration-(void 0===r.seekOffset?0:r.seekOffset),a=(f.rtl?1-o:o)*i;o<0||(i<a&&(a=i),O.html(h,F(a)),t=O.width(h),e=O.width(y),r=n-t/2,t=O.width(h),e=O.width(y),o=n-t/2,i=n+t/2,a=O.offset(y).left,n=window.innerWidth-O.offset(y).right,"number"==typeof(r=o<(r=0)?o<2-a&&a<t/2?2-a:o<-t/2?-t/2:o:e<i?n<i-e&&n<t/2?e-t+n-2:t/2<=i-e+2?e-t+t/2:o:o)&&(r+="px"),O.css(h,{left:r}),$(h).is(":hidden")&&$(h).fadeIn(200))}f.on("dvrwindow",function(){b.disable(!1)}),f.on("ready",function(e,t,n){var o=t.video.duration;b.disable(t.disabled||!o),a.adaptiveRatio&&!isNaN(n.height/n.width)&&S(n.height/n.width),O.html([d,p],t.live?"Live":F(o)),O.toggleClass(i,"is-long",3600<=o),x.slide(t.volumeLevel),"flash"===t.engine.engineName?b.disableAnimation(!0,!0):b.disableAnimation(!1),O.find(".fp-title",r).forEach(O.removeNode),n.title&&O.prepend(r,O.createElement("div",{className:"fp-message fp-title"},n.title)),O.toggleClass(i,"has-title",!!n.title)}).on("unload",function(){g||a.splash||O.css(c,"paddingTop",""),b.slide(0),O.addClass(m,"fp-visible")}).on("buffer",function(e,t,n){var o=t.video,r=o.buffer/o.duration;!o.seekable&&s.seekable&&b.max(t.conf.live?1/0:r),n&&"number"!=typeof n||(n=[{start:0,end:o.buffer}]);var i=O.find(".fp-buffer",y);i.length!==n.length&&(i.forEach(O.removeNode),i=[]),n.forEach(function(e,t){t=i[t]||O.createElement("div",{className:"fp-buffer"});O.css(t,{left:100*e.start/o.duration+"%",width:100*(e.end-e.start)/o.duration+"%"}),O.prepend(y,t)})}).on("speed",function(e,t,n){t.video.time&&(O.addClass(u,"fp-shown"),(I=I.filter(function(e){return clearTimeout(e),!1})).push(setTimeout(function(){O.addClass(u,"fp-hilite"),I.push(setTimeout(function(){O.removeClass(u,"fp-hilite"),I.push(setTimeout(function(){O.removeClass(u,"fp-shown")},300))},1e3))})))}).on("buffered",function(){b.max(1)}).on("progress seek",function(e,t,n){var o=f.video.duration,r=f.video.seekOffset||0,r=((n=n||f.video.time)-r)/(o-r);b.dragging||b.slide(r,f.seeking?0:250),O.toggleClass(i,"is-live-position",o-n<a.livePositionOffset),O.html(l,F(n)),O.html(p,F(o-n,!0))}).on("finish resume seek",function(e){O.toggleClass(i,"is-finished","finish"==e.type)}).on("resume",function(){O.addClass(m,"fp-visible"),setTimeout(function(){O.removeClass(m,"fp-visible")},300)}).on("pause",function(){O.addClass(v,"fp-visible"),setTimeout(function(){O.removeClass(v,"fp-visible")},300)}).on("stop",function(){O.html(l,F(0)),b.slide(0,100)}).on("finish",function(){O.html(l,F(f.video.duration)),b.slide(1,100),O.removeClass(i,"is-seeking")}).on("beforeseek",function(){}).on("volume",function(){x.slide(f.volumeLevel)}).on("disable",function(){var e=f.disabled;b.disable(e),x.disable(e),O.toggleClass(i,"is-disabled",f.disabled)}).on("mute",function(e,t,n){n?O.toggleClass(i,"is-muted",n):(O.toggleClass(i,"is-muted",n),t.volumeLevel)}).on("error",function(e,t,n){var o,r;O.removeClass(i,"is-loading"),O.removeClass(i,"is-seeking"),O.addClass(i,"is-error"),n&&(t.error=!0,o=n.code,(n.message||"").match(/DECODER_ERROR_NOT_SUPPORTED/)&&(o=3),r=t.message((t.engine&&t.engine.engineName||"html5")+": "+a.errors[o]),O.removeClass(i,"is-mouseover"),t.one("load progress",function(){r()}))}).one("resume ready",function(){var e,t=O.find("video.fp-engine",i)[0];t&&(O.width(t)&&O.height(t)||(e=i.style.overflow,i.style.overflow="visible",setTimeout(function(){e?i.style.overflow=e:i.style.removeProperty("overflow")})))}),L.on(i,"mouseenter mouseleave",function(e){C||e.type}),f.showPanel=function(e){e=e||a.mouseoutTimeout;clearTimeout(k),T(!0),f.panelIsShowed=!0,k=setTimeout(function(){f.hidePanel()},e)},f.hidePanel=function(){f.panelIsShowed=!1,clearTimeout(k),T(!1)},f.panelIsShowed=!1,setTimeout(function(){$(".flowplayer").hasClass("is-touch")||L.on(i,"mousemove",function(e){f.showPanel(5e3)})},100),L.on(i,"mouseleave",function(){(b.dragging||x.dragging)&&(O.addClass(i,"is-mouseover"),O.removeClass(i,"is-mouseout"))}),L.on(i,"click.player",function(e){if(!f.disabled)return O.hasClass(e.target,"fp-ui")||O.hasClass(e.target,"fp-engine")||e.flash||O.hasParent(e.target,".fp-play,.fp-pause")?(e.preventDefault&&e.preventDefault(),f.toggle()):void 0}),L.on(i,"mousemove",".fp-timeline",function(e){A(e)}),L.on(i,"touchmove",".fp-timeline",function(e){A(e=e.originalEvent.touches[0])},!!supportsPassive&&{passive:!0}),L.on(i,"mouseleave touchend",".fp-timeline",function(e){$(h).fadeOut(200)}),f.on("flashdisabled",function(e,t,n){var o;O.addClass(i,"is-flash-disabled"),!1!==n&&(o=f.message("Seems something is blocking Adobe Flash from running")),f.one("ready progress",function(){O.removeClass(i,"is-flash-disabled"),o&&o()})}),a.poster&&O.css(i,"background-image","url("+a.poster+")");var N,M,P,D,t=O.css(i,"background-color"),t="none"!=O.css(i,"background-image")||t&&"rgba(0, 0, 0, 0)"!=t&&"transparent"!=t;t&&!a.splash&&(a.poster||(a.poster=!0),N=function(){O.addClass(i,"is-poster"),O.addClass(m,"fp-visible"),f.poster=!0,f.on("resume.poster progress.poster beforeseek.poster",function(e){"beforeseek"!==e.type&&!f.playing||(O.removeClass(i,"is-poster"),O.removeClass(m,"fp-visible"),f.poster=!1,f.off(".poster"))})},f.on("stop",function(){N()}),f.on("ready",function(e,t,n){n.index||n.autoplay||N()})),"string"==typeof a.splash&&O.css(i,"background-image","url('"+a.splash+"')"),!t&&f.forcedSplash&&O.css(i,"background-color","#555"),$(".fp-toggle, .fp-playbtn, .fp-playbtn-small").on("click",function(e){f.disabled||f.toggle()}),L.on(i,"click",".fp-volumebtn",function(){f.mute()}),L.on(i,"click",".fp-fullscreen",function(){f.fullscreen(),$(".flowplayer").hasClass("is-touch")&&screen.orientation.lock("landscape")}),L.on(i,"click",".fp-unload",function(){f.unload()}),L.on(y,"slide",function(e){f.seeking=!0,f.seekTo(10*e)}),L.on(E,"slide",function(e){f.volume(e)}),L.on(i,"click",".fp-duration,.fp-remaining",function(){return f.dvr?f.seekTo(10):void O.toggleClass(i,"is-inverted")}),f.on("shutdown",function(){L.off(y),L.off(E),D&&window.cancelAnimationFrame(D),O.removeNode(r),O.find(".fp-ratio",i).forEach(O.removeNode)}),"function"==typeof window.requestAnimationFrame&&(M=O.find(".fp-player",i)[0]||i,P=function(){O.toggleClass(i,"is-tiny",M.clientWidth<400),O.toggleClass(i,"is-small",M.clientWidth<600&&400<=M.clientWidth),D=window.requestAnimationFrame(P)},D=window.requestAnimationFrame(P))}),t.exports.format=F}).call(this,e("buffer").Buffer)},{"../common":1,"../flowplayer":31,"./ui/bar-slider":28,"./ui/slider":29,bean:34,buffer:35}],28:[function(e,t,n){var f=e("bean"),d=e("../../common");t.exports=function(i,e){var o=(e=e||{}).activeClass||"fp-color",r=e.inactiveClass||"fp-grey",t=e.childSelector||"em",a=!!e.rtl,s=e.axis,n=!1,l=d.find(t,i).length,c={unload:function(){f.off(i,".barslider")},slide:function(n,e){d.find(t,i).forEach(function(e,t){t=t/l<n;d.toggleClass(e,o,t),d.toggleClass(e,r,!t),$(".fp-volume-ball").width(100*n+"%")}),e&&f.fire(i,"slide",[n])},disable:function(e){n=e}};return f.on(i,"mousedown.sld touchstart.sld",function(e){e.preventDefault(),n||(c.slide(u(e),!0),f.on(i,"mousemove.sld touchmove.sld",function(e){e.preventDefault(),c.slide(u(e),!0)}),f.one(document,"mouseup.sld touchup.sld",function(){f.off(i,"mousemove.sld touchmove.sld")}))},!1,!!supportsPassive&&{passive:!0}),c;function u(e){var t=e.pageX||e.clientX,n=e.pageY||e.clientY,o=d.offset(i),o="Y"==s?(a=!0,r=d.height(i),!n&&e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length&&(n=e.originalEvent.touches[0].pageY),n-o.top):(r=d.width(i),!t&&e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length&&(t=e.originalEvent.touches[0].pageX),t-o.left),r=(o=Math.max(0,Math.min(r,o)))/r;return a&&(r=1-r),r}}},{"../../common":1,bean:34}],29:[function(e,t,n){"use strict";var m=e("bean"),v=e("../../common");t.exports=function(i,n){function a(){o=v.offset(i),t=v.width(i),v.height(i),r=t,f=e(u)}function s(e){c||e==g.value||u&&!(e<u)||(m.fire(i,"slide",[e]),g.value=e)}function l(e){var t=e.pageX||e.clientX;return!t&&e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length&&(t=e.originalEvent.touches[0].pageX),t-=o.left,t=(t=Math.max(0,Math.min(f||r,t)))/r,n&&(t=1-t),h(t,0,!0)}var c,o,t,r,u,f,d=v.lastChild(i),p=!1,h=function(e,t){void 0===t&&(t=0),1<e&&(e=1);var n=Math.round(1e3*e)/10+"%";return(!u||e<=u)&&(p?v.removeClass(d,"animated"):(v.addClass(d,"animated"),v.css(d,"transition-duration",(t||0)+"ms")),v.css(d,"width",n)),e},e=function(e){return Math.max(0,Math.min(r,e*t))},g={max:function(e){u=e},disable:function(e){c=e},slide:function(e,t,n){a(),n&&s(e),h(e,t)},disableAnimation:function(e,t){p=!1!==e,v.toggleClass(i,"no-animation",!!t)}};return a(),m.on(i,"mousedown.sld touchstart",function(e){var t,n,o,r;e.preventDefault(),c||(n=s,o=100,t=function(){r||(n.apply(this,arguments),r=1,setTimeout(function(){r=0},o))},a(),g.dragging=!0,v.addClass(i,"is-dragging"),s(l(e)),m.on(document,"mousemove.sld touchmove.sld",function(e){e.preventDefault(),t(l(e))}),m.one(document,"mouseup touchend",function(){g.dragging=!1,v.removeClass(i,"is-dragging"),m.off(document,"mousemove.sld touchmove.sld")}))},!1,!!supportsPassive&&{passive:!0}),g}},{"../../common":1,bean:34}],30:[function(e,t,n){t.exports=function(e,t,n){try{!function(e){var t=document.createElement("textarea");if(t.value=e,t.style.opacity=0,t.style.position="absolute",document.body.appendChild(t),t.select(),e=document.execCommand("copy"),document.body.removeChild(t),!e)throw new Error("Unsuccessfull")}(e),t()}catch(e){n(e)}}},{}],31:[function(e,t,n){"use strict";var h=e("extend-object"),g=e("is-function"),m=e("bean"),o=e("./ext/ui/slider"),r=e("./ext/ui/bar-slider"),v=e("./common"),y=e("./ext/events"),b=[],w=[],i=window.onbeforeunload;window.onbeforeunload=function(e){if(b.forEach(function(e){e.conf.splash?e.unload():e.bind("error",function(){v.find(".flowplayer.is-error .fp-message").forEach(v.removeNode)})}),i)return i(e)};var a=/Safari/.exec(navigator.userAgent)&&!/Chrome/.exec(navigator.userAgent),s=/(\d+\.\d+) Safari/.exec(navigator.userAgent),s=s?Number(s[1]):100,E=t.exports=function(e,t,n){if(g(e))return w.push(e);if("number"==typeof e||void 0===e)return b[e||0];if(e.nodeType)return null!==e.getAttribute("data-flowplayer-instance-id")?b[e.getAttribute("data-flowplayer-instance-id")]:t?c(e,t,n):void 0;if(e.jquery)return E(e[0],t,n);if("string"==typeof e){e=v.find(e)[0];return e&&E(e,t,n)}};h(E,{version:"7.2.7",engines:[],engine:function(t){return E.engines.filter(function(e){return e.engineName===t})[0]},extensions:[],conf:{},set:function(e,t){"string"==typeof e?E.conf[e]=t:h(E.conf,e)},registerExtension:function(e,t){E.extensions.push([e,t])},support:{},defaults:{debug:!1,disabled:!1,fullscreen:window==window.top,keyboard:!0,ratio:9/16,adaptiveRatio:!1,rtmp:0,proxy:"best",hlsQualities:!0,seekStep:!1,splash:!1,live:!1,livePositionOffset:120,swf:"//releases.flowplayer.org/7.2.7/commercial/flowplayer.swf",swfHls:"//releases.flowplayer.org/7.2.7/commercial/flowplayerhls.swf",speeds:[1,1.1,1.25,1.5,1.75,2],tooltip:!0,mouseoutTimeout:5e3,mutedAutoplay:!0,clickToUnMute:!0,volume:1,errors:["","Video loading aborted","Network error","Video not properly encoded","Video file not found","Unsupported video","Skin not found","SWF file not found","Subtitles not found","Invalid RTMP URL","Unsupported video format. Try installing Adobe Flash."],errorUrls:["","","","","","","","","","","http://get.adobe.com/flashplayer/"],playlist:[],hlsFix:a&&s<8,disableInline:!1},bean:m,common:v,slider:o,barSlider:r,extend:h});var l,C=0,x=e("./ext/resolve");function c(e,t,n){t&&t.embed&&(t.embed=h({},E.defaults.embed,t.embed));var o=!1;try{void 0===E.conf.storage&&"object"==typeof window.localStorage&&(window.localStorage.flowplayerTestStorage="test",o=!0)}catch(e){}var r,i,a=e,s=h({},E.defaults,E.conf,t),l={},c=a.className,u=new x;v.addClass(a,"is-loading"),v.toggleClass(a,"no-flex",!E.support.flex),v.toggleClass(a,"no-svg",!E.support.svg);try{l=E.conf.storage||(o?window.localStorage:l)}catch(e){}s.volume="true"===l.muted?0:(s.volume!==E.defaults.volume||isNaN(l.volume)?s:l).volume,s.debug=!!l.flowplayerDebug||s.debug,s.aspectRatio&&"string"==typeof s.aspectRatio&&(f=s.aspectRatio.split(/[:\/]/),s.ratio=f[1]/f[0]);var f=a.currentStyle&&"rtl"===a.currentStyle.direction||window.getComputedStyle&&null!==window.getComputedStyle(a,null)&&"rtl"===window.getComputedStyle(a,null).getPropertyValue("direction");f&&v.addClass(a,"is-rtl");var d={conf:s,currentSpeed:1,volumeLevel:s.muted?0:void 0===s.volume?+l.volume:s.volume,video:{},disabled:!1,finished:!1,loading:!1,muted:"true"==l.muted||s.muted,paused:!1,playing:!1,ready:!1,splash:!1,rtl:f,hijack:function(e){try{d.engine.suspendEngine()}catch(e){}d.hijacked=e},release:function(){try{d.engine.resumeEngine()}catch(e){}d.hijacked=!1},debug:function(){s.debug&&console.log.apply(console,["DEBUG"].concat([].slice.call(arguments)))},load:function(e,t){if(!d.error&&!d.loading){d.video={},d.finished=!1,e=e||s.clip,e=h({},u.resolve(e,s.clip.sources)),(d.playing||d.engine)&&(e.autoplay=!0);var n=p(e);if(!n)return setTimeout(function(){d.trigger("error",[d,{code:E.support.flashVideo?5:10}])})&&d;if(!n.engineName)throw new Error("engineName property of factory should be exposed");return d.engine&&n.engineName===d.engine.engineName||(d.ready=!1,d.engine&&(d.engine.unload(),d.conf.autoplay=!0),i=d.engine=n(d,a),d.one("ready",function(){setTimeout(function(){d.showPanel(),d.muted?d.mute(!0,!0):i.volume(d.volumeLevel)})})),h(e,i.pick(e.sources.filter(function(e){return!e.engine||e.engine===i.engineName}))),e.src&&(d.trigger("load",[d,e,i],!0).defaultPrevented?d.loading=!1:(d.ready=!1,i.load(e),g(e)&&(t=e),t&&d.one("ready",t))),d}},pause:function(e){return d.hijacked?d.hijacked.pause(e)|d:(!d.ready||d.seeking||d.loading||(i.pause(),d.one("pause",e)),d)},resume2:function(){if(document.getElementsByClassName("fp-play")[0].style.visibility="none!important",document.getElementsByClassName("fp-play")[0].style.opacity="0!important",document.getElementsByClassName("fp-play-sharp-fill")[0].style.visibility="none!important",document.getElementsByClassName("fp-play-sharp-fill")[0].style.opacity="0!important",!d.trigger("beforeresume",[d],!0).defaultPrevented)return d.hijacked?d.hijacked.resume()|d:(d.ready&&d.paused&&(i.resume(),d.finished&&(d.trigger("resume",[d]),d.finished=!1)),document.getElementsByClassName("fp-play")[0].style.visibility="",document.getElementsByClassName("fp-play")[0].style.opacity="",document.getElementsByClassName("fp-play-sharp-fill")[0].style.visibility="",document.getElementsByClassName("fp-play-sharp-fill")[0].style.opacity="",d)},resume:function(){if(!d.trigger("beforeresume",[d],!0).defaultPrevented)return d.hijacked?d.hijacked.resume()|d:(d.ready&&d.paused&&(i.resume(),d.finished&&(d.trigger("resume",[d]),d.finished=!1)),d)},toggle:function(){return d.ready?d.paused?d.resume():d.pause():d.load()},seek:function(e,t){var n;return"boolean"==typeof e&&(n=d.conf.seekStep||.1*d.video.duration,e=d.video.time+(e?n:-n),e=Math.min(Math.max(e,0),d.video.duration-.1)),void 0===e?d:d.hijacked?d.hijacked.seek(e,t)|d:(d.ready&&(r=e,d.trigger("beforeseek",[d,e],!0).defaultPrevented?(d.seeking=!1,v.toggleClass(a,"is-seeking",d.seeking)):(i.seek(e),g(t)&&d.one("seek",t))),d)},seekTo:function(e,t){return void 0===e?d.seek(r,t):void 0!==d.video.seekOffset?d.seek(d.video.seekOffset+.1*(d.video.duration-d.video.seekOffset)*e,t):d.seek(.1*d.video.duration*e,t)},mute:function(e,t){if(void 0===e&&(e=!d.muted),d.muted=e,t||(l.muted=e,l.volume=(isNaN(l.volume)?s:l).volume),void 0!==i.mute){if(0==l.volume)return;i.mute(e)}else d.volume(e?0:l.volume,!0),d.trigger("mute",[d,e]);return d},volume:function(e,t){return d.ready&&(e=Math.min(Math.max(e,0),1),t||(l.volume=e),i.volume(e),d.showPanel()),d},speed:function(e,t){return d.ready&&("boolean"==typeof e&&(e=s.speeds[s.speeds.indexOf(d.currentSpeed)+(e?1:-1)]||d.currentSpeed),i.speed(e),t&&a.one("speed",t)),d},stop:function(){return d.ready&&(d.pause(),!d.live||d.dvr?d.seek(0,function(){d.trigger("stop",[d])}):d.trigger("stop",[d])),d},unload:function(){return s.splash?(d.trigger("unload",[d]),i&&(i.unload(),d.engine=i=0)):d.stop(),d},shutdown:function(){d.unload(),d.trigger("shutdown",[d]),m.off(a),delete b[a.getAttribute("data-flowplayer-instance-id")],a.removeAttribute("data-flowplayer-instance-id")},disable:function(e){return void 0===e&&(e=!d.disabled),e!=d.disabled&&(d.disabled=e,d.trigger("disable",e)),d},registerExtension:function(e,t){"string"==typeof(e=e||[])&&(e=[e]),"string"==typeof(t=t||[])&&(t=[t]),e.forEach(function(e){d.extensions.js.push(e)}),t.forEach(function(e){d.extensions.css.push(e)})}};d.conf=h(d.conf,s),d.extensions={js:[],css:[]},E.extensions.forEach(function(e){d.registerExtension(e[0],e[1])}),y(d);var p=function(e){var n,o=E.engines;if(s.engine){var t=o.filter(function(e){return e.engineName===s.engine})[0];if(t&&e.sources.some(function(e){return(!e.engine||e.engine===t.engineName)&&t.canPlay(e.type,d.conf)}))return t}return s.enginePreference&&(o=E.engines.filter(function(e){return-1<s.enginePreference.indexOf(e.engineName)}).sort(function(e,t){return s.enginePreference.indexOf(e.engineName)-s.enginePreference.indexOf(t.engineName)})),e.sources.some(function(t){var e=o.filter(function(e){return(!t.engine||t.engine===e.engineName)&&e.canPlay(t.type,d.conf)}).shift();return e&&(n=e),!!e}),n};return a.getAttribute("data-flowplayer-instance-id")||(a.setAttribute("data-flowplayer-instance-id",C++),d.on("boot",function(){var e=E.support;!s.splash&&!v.hasClass(a,"is-splash")&&e.firstframe||(d.forcedSplash=!s.splash&&!v.hasClass(a,"is-splash"),d.splash=!0,s.splash||(s.splash=!0),v.addClass(a,"is-splash")),s.splash&&v.find("video",a).forEach(v.removeNode),(s.dvr||s.live||v.hasClass(a,"is-live"))&&(d.live=s.live=!0,d.dvr=s.dvr=!!s.dvr||v.hasClass(a,"is-dvr"),v.addClass(a,"is-live"),v.toggleClass(a,"is-dvr",d.dvr)),w.forEach(function(e){e(d,a)}),b.push(d),s.splash?d.unload():d.load(),s.disabled&&d.disable(),d.one("ready",n),d.one("shutdown",function(){a.className=c})}).on("load",function(e,t,n){s.splash&&v.find(".flowplayer.is-ready,.flowplayer.is-loading").forEach(function(e){e=e.getAttribute("data-flowplayer-instance-id");e===a.getAttribute("data-flowplayer-instance-id")||(e=b[Number(e)])&&e.conf.splash&&e.unload()}),v.addClass(a,"is-loading"),t.loading=!0,void 0===n.live&&void 0===n.dvr||(v.toggleClass(a,"is-live",n.dvr||n.live),v.toggleClass(a,"is-dvr",!!n.dvr),t.live=n.dvr||n.live,t.dvr=!!n.dvr)}).on("ready",function(e,t,n){n.time=0,t.video=n,v.removeClass(a,"is-loading"),t.loading=!1,t.muted?t.mute(!0,!0):t.volume(t.volumeLevel);n=t.conf.hlsFix&&/mpegurl/i.exec(n.type);v.toggleClass(a,"hls-fix",!!n)}).on("unload",function(){v.removeClass(a,"is-loading"),d.loading=!1}).on("ready unload",function(e){e="ready"==e.type;v.toggleClass(a,"is-splash",!e),v.toggleClass(a,"is-ready",e),d.ready=e,d.splash=!e}).on("progress",function(e,t,n){t.video.time=n}).on("buffer",function(e,t,n){t.video.buffer="number"==typeof n?n:n.length?n[n.length-1].end:0}).on("speed",function(e,t,n){t.currentSpeed=n}).on("volume",function(e,t,n){t.volumeLevel=Math.round(100*n)/100,t.muted&&n&&t.mute(!1)}).on("beforeseek seek",function(e){d.seeking="beforeseek"==e.type,v.toggleClass(a,"is-seeking",d.seeking)}).on("ready pause resume unload finish stop",function(e){d.paused=/pause|finish|unload|stop/.test(e.type),d.paused=d.paused||"ready"===e.type&&!s.autoplay&&!d.playing,d.playing=!d.paused,v.toggleClass(a,"is-paused",d.paused),v.toggleClass(a,"is-playing",d.playing),d.load.ed||d.pause()}).on("finish",function(){d.finished=!0}).on("error",function(){})),d.trigger("boot",[d,a]),d}void 0!==window.jQuery&&((l=window.jQuery)(function(){"function"==typeof l.fn.flowplayer&&l('.flowplayer:has(video:not(.fp-engine),script[type="application/json"])').flowplayer()}),l.fn.flowplayer=function(o,r){return this.each(function(){"string"==typeof o&&(o={swf:o}),g(o)&&(r=o,o={});var t=l(this),e=t.find('script[type="application/json"]'),e=e.length?JSON.parse(e.text()):function(o){if(!o.length)return{};var r=o.data()||{},i={};return l.each(["autoplay","loop","preload","poster"],function(e,t){var n=o.attr(t);void 0!==n&&-1!==["autoplay","poster"].indexOf(t)?i[t]=n||!0:void 0!==n&&(r[t]=n||!0)}),o[0].autoplay=o[0].preload=!1,r.subtitles=o.find("track").map(function(){var e=l(this);return{src:e.attr("src"),kind:e.attr("kind"),label:e.attr("label"),srclang:e.attr("srclang"),default:e.prop("default")}}).get(),r.sources=(new x).sourcesFromVideoTag(o,l),h(i,{clip:r})}(t.find("video")),n=c(this,l.extend({},o||{},e,t.data()),r);y.EVENTS.forEach(function(e){n.on(e+".jquery",function(e){t.trigger.call(t,e.type,e.detail&&e.detail.args)})}),t.data("flowplayer",n)})})},{"./common":1,"./ext/events":12,"./ext/resolve":21,"./ext/ui/bar-slider":28,"./ext/ui/slider":29,bean:34,"extend-object":39,"is-function":42}],32:[function(e,t,n){e("es5-shim");var v=t.exports=e("./flowplayer");e("./ext/support"),e("./engine/embed"),e("./engine/hlsjs"),e("./engine/html5"),e("./engine/flash"),e("./ext/ui"),e("./ext/message"),e("./ext/keyboard"),e("./ext/playlist"),e("./ext/cuepoint"),e("./ext/subtitle"),e("./ext/analytics"),e("./ext/share"),e("./ext/facebook"),e("./ext/twitter"),e("./ext/embed"),e("./ext/airplay"),e("./ext/chromecast"),e("./ext/qsel"),e("./ext/menu"),e("./ext/fullscreen"),e("./ext/mobile"),v(function(e,t){function n(e,t){var n,o,r,i;n=t,o="ab.ca,ac.ac,ac.ae,ac.at,ac.be,ac.cn,ac.il,ac.in,ac.jp,ac.kr,ac.sg,ac.th,ac.uk,ad.jp,adm.br,adv.br,ah.cn,am.br,arq.br,art.br,arts.ro,asn.au,asso.fr,asso.mc,bc.ca,bel.tr,bio.br,biz.pl,biz.tr,bj.cn,br.com,cn.com,cng.br,cnt.br,co.ac,co.at,co.de,co.gl,co.hk,co.id,co.il,co.in,co.jp,co.kr,co.mg,co.ms,co.nz,co.th,co.uk,co.ve,co.vi,co.za,com.ag,com.ai,com.ar,com.au,com.br,com.cn,com.co,com.cy,com.de,com.do,com.ec,com.es,com.fj,com.fr,com.gl,com.gt,com.hk,com.hr,com.hu,com.kg,com.ki,com.lc,com.mg,com.mm,com.ms,com.mt,com.mu,com.mx,com.my,com.na,com.nf,com.ng,com.ni,com.pa,com.ph,com.pl,com.pt,com.qa,com.ro,com.ru,com.sb,com.sc,com.sg,com.sv,com.tr,com.tw,com.ua,com.uy,com.ve,com.vn,cp.tz,cq.cn,de.com,de.org,ecn.br,ed.jp,edu.au,edu.cn,edu.hk,edu.mm,edu.my,edu.pl,edu.pt,edu.qa,edu.sg,edu.tr,edu.tw,eng.br,ernet.in,esp.br,etc.br,eti.br,eu.com,eu.int,eu.lv,firm.in,firm.ro,fm.br,fot.br,fst.br,g12.br,gb.com,gb.net,gd.cn,gen.in,go.jp,go.kr,go.th,gov.au,gov.az,gov.br,gov.cn,gov.il,gov.in,gov.mm,gov.my,gov.qa,gov.sg,gov.tr,gov.tw,gov.uk,govt.nz,gr.jp,gs.cn,gv.ac,gv.at,gx.cn,gz.cn,he.cn,hi.cn,hk.cn,hl.cn,hu.com,id.au,idv.tw,in.th,in.ua,ind.br,ind.in,inf.br,info.pl,info.ro,info.tr,info.ve,iwi.nz,jl.cn,jor.br,js.cn,jus.br,k12.il,k12.tr,kr.com,lel.br,lg.jp,ln.cn,ltd.uk,maori.nz,mb.ca,me.uk,med.br,mi.th,mil.br,mil.uk,mo.cn,mod.uk,muni.il,nb.ca,ne.jp,ne.kr,net.ag,net.ai,net.au,net.br,net.cn,net.do,net.gl,net.hk,net.il,net.in,net.kg,net.ki,net.lc,net.mg,net.mm,net.mu,net.ni,net.nz,net.pl,net.ru,net.sb,net.sc,net.sg,net.th,net.tr,net.tw,net.uk,net.ve,nf.ca,nhs.uk,nm.cn,nm.kr,no.com,nom.br,nom.ni,nom.ro,ns.ca,nt.ca,nt.ro,ntr.br,nx.cn,odo.br,off.ai,on.ca,or.ac,or.at,or.jp,or.kr,or.th,org.ag,org.ai,org.au,org.br,org.cn,org.do,org.es,org.gl,org.hk,org.in,org.kg,org.ki,org.lc,org.mg,org.mm,org.ms,org.nf,org.ng,org.ni,org.nz,org.pl,org.ro,org.ru,org.sb,org.sc,org.sg,org.tr,org.tw,org.uk,org.ve,pe.ca,plc.uk,police.uk,ppg.br,presse.fr,pro.br,psc.br,psi.br,qc.ca,qc.com,qh.cn,rec.br,rec.ro,res.in,sa.com,sc.cn,sch.uk,se.com,se.net,sh.cn,sk.ca,slg.br,sn.cn,store.ro,tj.cn,tm.fr,tm.mc,tm.ro,tmp.br,tur.br,tv.br,tv.tr,tw.cn,uk.com,uk.net,us.com,uy.com,vet.br,waw.pl,web.ve,www.ro,xj.cn,xz.cn,yk.ca,yn.cn,zj.cn,zlg.br".split(","),r=(n=n.toLowerCase()).split(".");for(var a=0,s=(t=(i=r.length)<2||/^\d+$/.test(r[i-1])?n:(n=r.slice(-2).join("."),3<=i&&0<=o.indexOf(n)?r.slice(-3).join("."):n)).length-1;0<=s;s--)a+=5285928321*t.charCodeAt(s);for(a=(""+a).substring(0,7),s=0;s<e.length;s++)if(a===e[s].substring(1,8))return 1}v(function(e,s){function t(e,t){var n,o,r,i;n=t,o="ab.ca,ac.ac,ac.ae,ac.at,ac.be,ac.cn,ac.il,ac.in,ac.jp,ac.kr,ac.sg,ac.th,ac.uk,ad.jp,adm.br,adv.br,ah.cn,am.br,arq.br,art.br,arts.ro,asn.au,asso.fr,asso.mc,bc.ca,bel.tr,bio.br,biz.pl,biz.tr,bj.cn,br.com,cn.com,cng.br,cnt.br,co.ac,co.at,co.de,co.gl,co.hk,co.id,co.il,co.in,co.jp,co.kr,co.mg,co.ms,co.nz,co.th,co.uk,co.ve,co.vi,co.za,com.ag,com.ai,com.ar,com.au,com.br,com.cn,com.co,com.cy,com.de,com.do,com.ec,com.es,com.fj,com.fr,com.gl,com.gt,com.hk,com.hr,com.hu,com.kg,com.ki,com.lc,com.mg,com.mm,com.ms,com.mt,com.mu,com.mx,com.my,com.na,com.nf,com.ng,com.ni,com.pa,com.ph,com.pl,com.pt,com.qa,com.ro,com.ru,com.sb,com.sc,com.sg,com.sv,com.tr,com.tw,com.ua,com.uy,com.ve,com.vn,cp.tz,cq.cn,de.com,de.org,ecn.br,ed.jp,edu.au,edu.cn,edu.hk,edu.mm,edu.my,edu.pl,edu.pt,edu.qa,edu.sg,edu.tr,edu.tw,eng.br,ernet.in,esp.br,etc.br,eti.br,eu.com,eu.int,eu.lv,firm.in,firm.ro,fm.br,fot.br,fst.br,g12.br,gb.com,gb.net,gd.cn,gen.in,go.jp,go.kr,go.th,gov.au,gov.az,gov.br,gov.cn,gov.il,gov.in,gov.mm,gov.my,gov.qa,gov.sg,gov.tr,gov.tw,gov.uk,govt.nz,gr.jp,gs.cn,gv.ac,gv.at,gx.cn,gz.cn,he.cn,hi.cn,hk.cn,hl.cn,hu.com,id.au,idv.tw,in.th,in.ua,ind.br,ind.in,inf.br,info.pl,info.ro,info.tr,info.ve,iwi.nz,jl.cn,jor.br,js.cn,jus.br,k12.il,k12.tr,kr.com,lel.br,lg.jp,ln.cn,ltd.uk,maori.nz,mb.ca,me.uk,med.br,mi.th,mil.br,mil.uk,mo.cn,mod.uk,muni.il,nb.ca,ne.jp,ne.kr,net.ag,net.ai,net.au,net.br,net.cn,net.do,net.gl,net.hk,net.il,net.in,net.kg,net.ki,net.lc,net.mg,net.mm,net.mu,net.ni,net.nz,net.pl,net.ru,net.sb,net.sc,net.sg,net.th,net.tr,net.tw,net.uk,net.ve,nf.ca,nhs.uk,nm.cn,nm.kr,no.com,nom.br,nom.ni,nom.ro,ns.ca,nt.ca,nt.ro,ntr.br,nx.cn,odo.br,off.ai,on.ca,or.ac,or.at,or.jp,or.kr,or.th,org.ag,org.ai,org.au,org.br,org.cn,org.do,org.es,org.gl,org.hk,org.in,org.kg,org.ki,org.lc,org.mg,org.mm,org.ms,org.nf,org.ng,org.ni,org.nz,org.pl,org.ro,org.ru,org.sb,org.sc,org.sg,org.tr,org.tw,org.uk,org.ve,pe.ca,plc.uk,police.uk,ppg.br,presse.fr,pro.br,psc.br,psi.br,qc.ca,qc.com,qh.cn,rec.br,rec.ro,res.in,sa.com,sc.cn,sch.uk,se.com,se.net,sh.cn,sk.ca,slg.br,sn.cn,store.ro,tj.cn,tm.fr,tm.mc,tm.ro,tmp.br,tur.br,tv.br,tv.tr,tw.cn,uk.com,uk.net,us.com,uy.com,vet.br,waw.pl,web.ve,www.ro,xj.cn,xz.cn,yk.ca,yn.cn,zj.cn,zlg.br".split(","),r=(n=n.toLowerCase()).split(".");for(var a=0,s=(t=(i=r.length)<2||/^\d+$/.test(r[i-1])?n:(n=r.slice(-2).join("."),3<=i&&0<=o.indexOf(n)?r.slice(-3).join("."):n)).length-1;0<=s;s--)a+=5285928321*t.charCodeAt(s);for(a=(""+a).substring(0,7),s=0;s<e.length;s++)if(a===e[s].substring(1,8))return 1}var n,o,l,c,u,f,r,i,a=e.conf,d=v.common,p=d.createElement,h=a.swf.indexOf("flowplayer.org")&&a.e&&s.getAttribute("data-origin"),g=h?(n=h,(o=document.createElement("a")).href=n,d.hostname(o.hostname)):d.hostname(),m=(document,a.key);"file:"==location.protocol&&(g="localhost"),e.load.ed=1,a.hostname=g,a.origin=h||location.href,h&&(i="is-embedded",-1===(r=s).className.split(" ").indexOf(i)&&(r.className+=" "+i)),"string"==typeof m&&(m=m.split(/,\s*/)),m&&t(m,g)?a.logo&&(c=d.find(".fp-player",s)[0],m=a.logo.href||"",g=a.logo.src||a.logo,l=p("a",{className:"fp-logo",href:m}),h&&(l.href=l.href||h),a.embed&&a.embed.popup&&(l.target="_blank"),g=p("img",{src:g}),l.appendChild(g),(c||s).appendChild(l)):(l=p("a",{href:"https://flowplayer.com/hello/?from=player"}),((c=d.find(".fp-player",s)[0])||s).appendChild(l),u=p("div",{className:"fp-context-menu fp-menu"},'<strong>&copy; 2018 Flowplayer AB</strong><a href="https://flowplayer.com/hello/?from=player">About Flowplayer</a><a href="https://flowplayer.com/license">GPL based license</a>'),7!==(f=window.location.href.indexOf("localhost"))&&(c||s).appendChild(u),e.on("pause resume finish unload ready",function(e,t){var n=-1;if(t.video.src)for(var o=[["org","flowplayer","drive"],["org","flowplayer","my"],["org","flowplayer","cdn"],["com","flowplayer","cdn"]],r=0;r<o.length&&-1===(n=t.video.src.indexOf("://"+o[r].reverse().join(".")));r++);if(/pause|resume/.test(e.type)&&"flash"!=t.engine.engineName&&4!=n&&5!=n){var i,a={display:"block",position:"absolute",left:"16px",bottom:"70px",zIndex:99999,width:"100px",height:"20px",backgroundImage:"url("+[".png","logo","/",".net",".cloudfront","d32wqyuo10o653","//","https:"].reverse().join("")+")"};for(i in a)a.hasOwnProperty(i)&&(l.style[i]=a[i]);t.load.ed=(e=l,"none"!==window.getComputedStyle(e).display&&(7===f||u.parentNode==s||u.parentNode==c)),t.load.ed||t.pause()}else l.style.display="none"}))});var o,r,i,a,s,l,c=e.conf,u=v.common,f=u.createElement,d=c.swf.indexOf("flowplayer.org")&&c.e&&t.getAttribute("data-origin"),p=d?(o=d,(r=document.createElement("a")).href=o,u.hostname(r.hostname)):u.hostname(),h=(document,c.key);"file:"==location.protocol&&(p="localhost"),e.load.ed=1,c.hostname=p,c.origin=d||location.href,d&&(l="is-embedded",-1===(s=t).className.split(" ").indexOf(l)&&(s.className+=" "+l)),"string"==typeof h&&(h=h.split(/,\s*/)),h&&n(h,p)?c.logo&&(a=u.find(".fp-player",t)[0],h=c.logo.href||"",p=c.logo.src||c.logo,i=f("a",{className:"fp-logo",href:h}),d&&(i.href=i.href||d),c.embed&&c.embed.popup&&(i.target="_blank"),p=f("img",{src:p}),i.appendChild(p),(a||t).appendChild(i)):(i=f("a",{class:"fp-logo userLogo"}),((a=u.find(".fp-player",t)[0])||t).appendChild(i),f=f("div",{className:"fp-context-menu fp-menu"},'<strong style="text-align: center;">Player</strong>'),7!==window.location.href.indexOf("localhost")&&(a||t).appendChild(f),e.on("pause resume finish unload ready",function(e,t){i.style.display="none"}))})},{"./engine/embed":2,"./engine/flash":3,"./engine/hlsjs":4,"./engine/html5":6,"./ext/airplay":7,"./ext/analytics":8,"./ext/chromecast":9,"./ext/cuepoint":10,"./ext/embed":11,"./ext/facebook":13,"./ext/fullscreen":14,"./ext/keyboard":15,"./ext/menu":16,"./ext/message":17,"./ext/mobile":18,"./ext/playlist":19,"./ext/qsel":20,"./ext/share":22,"./ext/subtitle":23,"./ext/support":25,"./ext/twitter":26,"./ext/ui":27,"./flowplayer":31,"es5-shim":38}],33:[function(e,t,n){"use strict";n.byteLength=function(e){var t=u(e),e=t[0],t=t[1];return 3*(e+t)/4-t},n.toByteArray=function(e){for(var t,n=u(e),o=n[0],n=n[1],r=new c(function(e,t){return 3*(e+t)/4-t}(o,n)),i=0,a=0<n?o-4:o,s=0;s<a;s+=4)t=l[e.charCodeAt(s)]<<18|l[e.charCodeAt(s+1)]<<12|l[e.charCodeAt(s+2)]<<6|l[e.charCodeAt(s+3)],r[i++]=t>>16&255,r[i++]=t>>8&255,r[i++]=255&t;2===n&&(t=l[e.charCodeAt(s)]<<2|l[e.charCodeAt(s+1)]>>4,r[i++]=255&t);1===n&&(t=l[e.charCodeAt(s)]<<10|l[e.charCodeAt(s+1)]<<4|l[e.charCodeAt(s+2)]>>2,r[i++]=t>>8&255,r[i++]=255&t);return r},n.fromByteArray=function(e){for(var t,n=e.length,o=n%3,r=[],i=0,a=n-o;i<a;i+=16383)r.push(function(e,t,n){for(var o,r=[],i=t;i<n;i+=3)o=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),r.push(function(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}(o));return r.join("")}(e,i,a<i+16383?a:i+16383));1==o?(t=e[n-1],r.push(s[t>>2]+s[t<<4&63]+"==")):2==o&&(t=(e[n-2]<<8)+e[n-1],r.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return r.join("")};for(var s=[],l=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,i=o.length;r<i;++r)s[r]=o[r],l[o.charCodeAt(r)]=r;function u(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},{}],34:[function(e,t,n){var o,r;o=this,r=function(e,t){e=e||"bean",t=t||this;function d(e,t){return e.split(t||" ")}function s(e){return"string"==typeof e}function p(e){return"function"==typeof e}function l(e,t){return D||t||e!==M&&e!==I?e:P}function n(e){a=arguments.length?e:M.querySelectorAll?function(e,t){return t.querySelectorAll(e)}:function(){throw new Error("Bean: No selector engine installed")}}function i(e,t){if(D||!t||!e||e.propertyName=="_on"+t){var n=Y.get(this,t||e.type,null,!1),o=n.length,r=0;for(e=new U(e,this,!0),t&&(e.type=t);r<o&&!e.isImmediatePropagationStopped();r++)n[r].removed||n[r].handler.call(this,e)}}function h(r,n){function o(e,t){for(var n,o=s(r)?a(r,t):r;e&&e!==t;e=e.parentNode)for(n=o.length;n--;)if(o[n]===e)return e}function e(e){var t=o(e.target,this);t&&n.apply(t,arguments)}return e.__beanDel={ft:o,selector:r},e}var a,g,m,o,r,c,u,f,v,y,b,w,E,C,x,k,I=window,S=t[e],T=/[^\.]*(?=\..*)\.|.*/,A=/\..*/,N="addEventListener",M=document||{},P=M.documentElement||{},D=P[N],j=D?N:"attachEvent",R={},O=Array.prototype.slice,L=function(e,t,n){for(n=0;n<t.length;n++)t[n]&&(e[t[n]]=1);return e}({},d("click dblclick mouseup mousedown contextmenu mousewheel mousemultiwheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange focus blur change reset select submit load unload beforeunload resize move DOMContentLoaded readystatechange message error abort scroll "+(D?"show input invalid touchstart touchmove touchend touchcancel gesturestart gesturechange gestureend textinput readystatechange pageshow pagehide popstate hashchange offline online afterprint beforeprint dragstart dragenter dragover dragleave drag drop dragend loadstart progress suspend emptied stalled loadmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange volumechange cuechange checking noupdate downloading cached updateready obsolete ":""))),_=(x="compareDocumentPosition"in P?function(e,t){return t.compareDocumentPosition&&16==(16&t.compareDocumentPosition(e))}:"contains"in P?function(e,t){return(t=9===t.nodeType||t===window?P:t)!==e&&t.contains(e)}:function(e,t){for(;e=e.parentNode;)if(e===t)return 1;return 0},{mouseenter:{base:"mouseover",condition:X},mouseleave:{base:"mouseout",condition:X},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}}),U=(o=d("altKey attrChange attrName bubbles cancelable ctrlKey currentTarget detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey srcElement target timeStamp type view which propertyName"),r=o.concat(d("button buttons clientX clientY dataTransfer fromElement offsetX offsetY pageX pageY screenX screenY toElement")),c=r.concat(d("wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ axis")),u=o.concat(d("char charCode key keyCode keyIdentifier keyLocation location")),f=o.concat(d("data")),v=o.concat(d("touches targetTouches changedTouches scale rotation")),y=o.concat(d("data origin source")),b=o.concat(d("state")),w=/over|out/,E=[{reg:/key/i,fix:function(e,t){return t.keyCode=e.keyCode||e.which,u}},{reg:/click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i,fix:function(e,t,n){return t.rightClick=3===e.which||2===e.button,t.pos={x:0,y:0},e.pageX||e.pageY?(t.clientX=e.pageX,t.clientY=e.pageY):(e.clientX||e.clientY)&&(t.clientX=e.clientX+M.body.scrollLeft+P.scrollLeft,t.clientY=e.clientY+M.body.scrollTop+P.scrollTop),w.test(n)&&(t.relatedTarget=e.relatedTarget||e[("mouseover"==n?"from":"to")+"Element"]),r}},{reg:/mouse.*(wheel|scroll)/i,fix:function(){return c}},{reg:/^text/i,fix:function(){return f}},{reg:/^touch|^gesture/i,fix:function(){return v}},{reg:/^message$/i,fix:function(){return y}},{reg:/^popstate$/i,fix:function(){return b}},{reg:/.*/,fix:function(){return o}}],C={},G.prototype.preventDefault=function(){this.originalEvent.preventDefault?this.originalEvent.preventDefault():this.originalEvent.returnValue=!1},G.prototype.stopPropagation=function(){this.originalEvent.stopPropagation?this.originalEvent.stopPropagation():this.originalEvent.cancelBubble=!0},G.prototype.stop=function(){this.preventDefault(),this.stopPropagation(),this.stopped=!0},G.prototype.stopImmediatePropagation=function(){this.originalEvent.stopImmediatePropagation&&this.originalEvent.stopImmediatePropagation(),this.isImmediatePropagationStopped=function(){return!0}},G.prototype.isImmediatePropagationStopped=function(){return this.originalEvent.isImmediatePropagationStopped&&this.originalEvent.isImmediatePropagationStopped()},G.prototype.clone=function(e){var t=new G(this,this.element,this.isNative);return t.currentTarget=e,t},G),F=(H.prototype.inNamespaces=function(e){var t,n,o=0;if(!e)return!0;if(!this.namespaces)return!1;for(t=e.length;t--;)for(n=this.namespaces.length;n--;)e[t]==this.namespaces[n]&&o++;return e.length===o},H.prototype.matches=function(e,t,n){return!(this.element!==e||t&&this.original!==t||n&&this.handler!==n)},H),Y=(g={},m=function(e,t,n,o,r,i){var a=r?"r":"$";if(t&&"*"!=t){var s,l=0,c=g[a+t],u="*"==e;if(c)for(s=c.length;l<s;l++)if((u||c[l].matches(e,n,o))&&!i(c[l],c,l,t))return}else for(var f in g)f.charAt(0)==a&&m(e,f.substr(1),n,o,r,i)},{has:function(e,t,n,o){var r,i=g[(o?"r":"$")+t];if(i)for(r=i.length;r--;)if(!i[r].root&&i[r].matches(e,n,null))return!0;return!1},get:function(e,t,n,o){var r=[];return m(e,t,n,null,o,function(e){return r.push(e)}),r},put:function(e){var t=!e.root&&!this.has(e.element,e.type,null,!1),n=(e.root?"r":"$")+e.type;return(g[n]||(g[n]=[])).push(e),t},del:function(e){m(e.element,e.type,null,e.handler,e.root,function(e,t,n){return t.splice(n,1),e.removed=!0,0===t.length&&delete g[(e.root?"r":"$")+e.type],!1})},entries:function(){var e,t=[];for(e in g)"$"==e.charAt(0)&&(t=t.concat(g[e]));return t}}),B=D?function(e,t,n){e[n?N:"removeEventListener"](t,i,arguments[4]||!1)}:function(t,e,n,o){var r;n?(Y.put(r=new F(t,o||e,function(e){i.call(t,e,o)},i,null,null,!0)),o&&null==t["_on"+o]&&(t["_on"+o]=0),r.target.attachEvent("on"+r.eventType,r.handler)):(r=Y.get(t,o||e,i,!0)[0])&&(r.target.detachEvent("on"+r.eventType,r.handler),Y.del(r))},z=function(e,t,n,o,r){return function(){o.apply(this,arguments),e(t,n,r)}},Z=function(e,t,n,o){for(var t=t&&t.replace(A,""),r=Y.get(e,t,null,!1),i={},a=0,s=r.length;a<s;a++)n&&r[a].original!==n||!r[a].inNamespaces(o)||(Y.del(r[a]),!i[r[a].eventType]&&r[a][j]&&(i[r[a].eventType]={t:r[a].eventType,c:r[a].type}));for(a in i)Y.has(e,i[a].t,null,!1)||B(e,i[a].t,!1,i[a].c)},W=D?function(e,t,n){var o=M.createEvent(e?"HTMLEvents":"UIEvents");o[e?"initEvent":"initUIEvent"](t,!0,!0,I,1),n.dispatchEvent(o)}:function(e,t,n){n=l(n,e),e?n.fireEvent("on"+t,M.createEventObject()):n["_on"+t]++},$=function(e,t,n){var o,r,i,a=s(t);if(a&&0<t.indexOf(" ")){for(i=(t=d(t)).length;i--;)$(e,t[i],n);return e}if((r=a&&t.replace(A,""))&&_[r]&&(r=_[r].base),!t||a)(a=a&&t.replace(T,""))&&(a=d(a,".")),Z(e,r,n,a);else if(p(t))Z(e,null,t);else for(o in t)t.hasOwnProperty(o)&&$(e,o,t[o]);return e},q=function(e,t,n,o,r){var i,a,s,l,c,u,f;if(void 0!==n||"object"!=typeof t){for(o=p(n)?(c=O.call(arguments,3),i=n):(i=o,c=O.call(arguments,4),h(n,i)),s=d(t),this===R&&(o=z($,e,t,o,i)),l=s.length;l--;)f=Y.put(u=new F(e,s[l].replace(A,""),o,i,d(s[l].replace(T,""),"."),c,!1)),u[j]&&f&&B(e,u.eventType,!0,u.customType,r);return e}for(a in t)t.hasOwnProperty(a)&&q.call(this,e,a,t[a])},V={on:q,add:function(e,t,n,o){return q.apply(null,s(n)?[e,n,t,o].concat(3<arguments.length?O.call(arguments,5):[]):O.call(arguments))},one:function(){return q.apply(R,arguments)},off:$,remove:$,clone:function(e,t,n){for(var o,r,i=Y.get(t,n,null,!1),a=i.length,s=0;s<a;s++)i[s].original&&(o=[e,i[s].type],(r=i[s].handler.__beanDel)&&o.push(r.selector),o.push(i[s].original),q.apply(null,o));return e},fire:function(e,t,n){for(var o,r,i,a,s=d(t),l=s.length;l--;)if(t=s[l].replace(A,""),(i=s[l].replace(T,""))&&(i=d(i,".")),i||n||!e[j])for(a=Y.get(e,t,null,!1),n=[!1].concat(n),o=0,r=a.length;o<r;o++)a[o].inNamespaces(i)&&a[o].handler.apply(e,n);else W(L[t],t,e);return e},Event:U,setSelectorEngine:n,noConflict:function(){return t[e]=S,this}};function J(n,o,r,i){function a(e,t){return o.apply(n,i?O.call(t,e?0:1).concat(i):t)}function s(e,t){return o.__beanDel?o.__beanDel.ft(e.target,n):t}var e=r?function(e){var t=s(e,this);if(r.apply(t,arguments))return e&&(e.currentTarget=t),a(e,arguments)}:function(e){return o.__beanDel&&(e=e.clone(s(e))),a(e,arguments)};return e.__beanDel=o.__beanDel,e}function H(e,t,n,o,r,i,a){var s=_[t];"unload"==t&&(n=z(Z,e,t,n,o)),s&&(s.condition&&(n=J(e,n,s.condition,i)),t=s.base||t),this.isNative=s=L[t]&&!!e[j],this.customType=!D&&!s&&t,this.element=e,this.type=t,this.original=o,this.namespaces=r,this.eventType=D||s?t:"propertychange",this.target=l(e,s),this[j]=!!this.target[j],this.root=a,this.handler=J(e,n,null,i)}function G(e,t,n){if(arguments.length&&(e=e||((t.ownerDocument||t.document||t).parentWindow||I).event,this.originalEvent=e,this.isNative=n,this.isBean=!0,e)){var o,r,i,a,s,l=e.type,c=e.target||e.srcElement;if(this.target=c&&3===c.nodeType?c.parentNode:c,n){if(!(s=C[l]))for(o=0,r=E.length;o<r;o++)if(E[o].reg.test(l)){C[l]=s=E[o].fix;break}for(o=(a=s(e,this,l)).length;o--;)!((i=a[o])in this)&&i in e&&(this[i]=e[i])}}}function X(e){return(e=e.relatedTarget)?e!==this&&"xul"!==e.prefix&&!/document/.test(this.toString())&&!x(e,this):null==e}return I.attachEvent&&(k=function(){var e,t=Y.entries();for(e in t)t[e].type&&"unload"!==t[e].type&&$(t[e].element,t[e].type);I.detachEvent("onunload",k),I.CollectGarbage&&I.CollectGarbage()},I.attachEvent("onunload",k)),n(),V},void 0!==t&&t.exports?t.exports=r():o.bean=r()},{}],35:[function(D,e,j){(function(e){"use strict";var s=D("base64-js"),i=D("ieee754"),a=D("isarray");function n(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function r(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=f.prototype:(null===e&&(e=new f(t)),e.length=t),e}function f(e,t,n){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(e,t,n);if("number"!=typeof e)return o(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}function o(e,t,n,o){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,o){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===o?new Uint8Array(t):void 0===o?new Uint8Array(t,n):new Uint8Array(t,n,o);f.TYPED_ARRAY_SUPPORT?(e=t).__proto__=f.prototype:e=u(e,t);return e}(e,t,n,o):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!f.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|p(t,n),n=(e=r(e,o)).write(t,n);n!==o&&(e=e.slice(0,n));return e}(e,t,n):function(e,t){if(f.isBuffer(t)){var n=0|d(t.length);return 0===(e=r(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?r(e,0):u(e,t);if("Buffer"===t.type&&a(t.data))return u(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(l(t),e=r(e,t<0?0:0|d(t)),!f.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t){var n=t.length<0?0:0|d(t.length);e=r(e,n);for(var o=0;o<n;o+=1)e[o]=255&t[o];return e}function d(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function p(e,t){if(f.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return M(e).length;default:if(o)return N(e).length;t=(""+t).toLowerCase(),o=!0}}function t(e,t,n){var o,r,i,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,n){var o=e.length;(!t||t<0)&&(t=0);(!n||n<0||o<n)&&(n=o);for(var r="",i=t;i<n;++i)r+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[i]);return r}(this,t,n);case"utf8":case"utf-8":return b(this,t,n);case"ascii":return function(e,t,n){var o="";n=Math.min(e.length,n);for(var r=t;r<n;++r)o+=String.fromCharCode(127&e[r]);return o}(this,t,n);case"latin1":case"binary":return function(e,t,n){var o="";n=Math.min(e.length,n);for(var r=t;r<n;++r)o+=String.fromCharCode(e[r]);return o}(this,t,n);case"base64":return o=this,i=n,0===(r=t)&&i===o.length?s.fromByteArray(o):s.fromByteArray(o.slice(r,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var o=e.slice(t,n),r="",i=0;i<o.length;i+=2)r+=String.fromCharCode(o[i]+256*o[i+1]);return r}(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function h(e,t,n){var o=e[t];e[t]=e[n],e[n]=o}function g(e,t,n,o,r){if(0===e.length)return-1;if("string"==typeof n?(o=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=f.from(t,o)),f.isBuffer(t))return 0===t.length?-1:m(e,t,n,o,r);if("number"==typeof t)return t&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(r?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):m(e,[t],n,o,r);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,o,r){var i=1,a=e.length,s=t.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(e.length<2||t.length<2)return-1;a/=i=2,s/=2,n/=2}function l(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(r)for(var c=-1,u=n;u<a;u++)if(l(e,u)===l(t,-1===c?0:u-c)){if(-1===c&&(c=u),u-c+1===s)return c*i}else-1!==c&&(u-=u-c),c=-1;else for(a<n+s&&(n=a-s),u=n;0<=u;u--){for(var f=!0,d=0;d<s;d++)if(l(e,u+d)!==l(t,d)){f=!1;break}if(f)return u}return-1}function v(e,t,n,o){return P(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,o)}function y(e,t,n,o){return P(function(e,t){for(var n,o,r=[],i=0;i<e.length&&!((t-=2)<0);++i)o=e.charCodeAt(i),n=o>>8,o=o%256,r.push(o),r.push(n);return r}(t,e.length-n),e,n,o)}function b(e,t,n){n=Math.min(e.length,n);for(var o=[],r=t;r<n;){var i,a,s,l,c=e[r],u=null,f=239<c?4:223<c?3:191<c?2:1;if(r+f<=n)switch(f){case 1:c<128&&(u=c);break;case 2:128==(192&(i=e[r+1]))&&127<(l=(31&c)<<6|63&i)&&(u=l);break;case 3:i=e[r+1],a=e[r+2],128==(192&i)&&128==(192&a)&&2047<(l=(15&c)<<12|(63&i)<<6|63&a)&&(l<55296||57343<l)&&(u=l);break;case 4:i=e[r+1],a=e[r+2],s=e[r+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&65535<(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)&&l<1114112&&(u=l)}null===u?(u=65533,f=1):65535<u&&(u-=65536,o.push(u>>>10&1023|55296),u=56320|1023&u),o.push(u),r+=f}return function(e){var t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);var n="",o=0;for(;o<t;)n+=String.fromCharCode.apply(String,e.slice(o,o+=w));return n}(o)}j.Buffer=f,j.SlowBuffer=function(e){+e!=e&&(e=0);return f.alloc(+e)},j.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),j.kMaxLength=n(),f.poolSize=8192,f._augment=function(e){return e.__proto__=f.prototype,e},f.from=function(e,t,n){return o(null,e,t,n)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(e,t,n){return o=null,t=t,n=n,l(e=e),!(e<=0)&&void 0!==t?"string"==typeof n?r(o,e).fill(t,n):r(o,e).fill(t):r(o,e);var o},f.allocUnsafe=function(e){return c(null,e)},f.allocUnsafeSlow=function(e){return c(null,e)},f.isBuffer=function(e){return!(null==e||!e._isBuffer)},f.compare=function(e,t){if(!f.isBuffer(e)||!f.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,o=t.length,r=0,i=Math.min(n,o);r<i;++r)if(e[r]!==t[r]){n=e[r],o=t[r];break}return n<o?-1:o<n?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);if(void 0===t)for(r=t=0;r<e.length;++r)t+=e[r].length;for(var n=f.allocUnsafe(t),o=0,r=0;r<e.length;++r){var i=e[r];if(!f.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},f.byteLength=p,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},f.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},f.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},f.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?b(this,0,e):t.apply(this,arguments)},f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===f.compare(this,e)},f.prototype.inspect=function(){var e="",t=j.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},f.prototype.compare=function(e,t,n,o,r){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===o&&(o=0),void 0===r&&(r=this.length),t<0||n>e.length||o<0||r>this.length)throw new RangeError("out of range index");if(r<=o&&n<=t)return 0;if(r<=o)return-1;if(n<=t)return 1;if(this===e)return 0;for(var i=(r>>>=0)-(o>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),l=this.slice(o,r),c=e.slice(t,n),u=0;u<s;++u)if(l[u]!==c[u]){i=l[u],a=c[u];break}return i<a?-1:a<i?1:0},f.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},f.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},f.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},f.prototype.write=function(e,t,n,o){if(void 0===t)o="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)o=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var r=this.length-t;if((void 0===n||r<n)&&(n=r),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o=o||"utf8";for(var i,a,s,l=!1;;)switch(o){case"hex":return function(e,t,n,o){n=Number(n)||0;var r=e.length-n;if((!o||r<(o=Number(o)))&&(o=r),(r=t.length)%2!=0)throw new TypeError("Invalid hex string");r/2<o&&(o=r/2);for(var i=0;i<o;++i){var a=parseInt(t.substr(2*i,2),16);if(isNaN(a))return i;e[n+i]=a}return i}(this,e,t,n);case"utf8":case"utf-8":return a=t,s=n,P(N(e,(i=this).length-a),i,a,s);case"ascii":return v(this,e,t,n);case"latin1":case"binary":return v(this,e,t,n);case"base64":return i=this,a=t,s=n,P(M(e),i,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,e,t,n);default:if(l)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),l=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function E(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function C(e,t,n,o,r,i){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r<t||t<i)throw new RangeError('"value" argument is out of bounds');if(n+o>e.length)throw new RangeError("Index out of range")}function x(e,t,n,o){t<0&&(t=65535+t+1);for(var r=0,i=Math.min(e.length-n,2);r<i;++r)e[n+r]=(t&255<<8*(o?r:1-r))>>>8*(o?r:1-r)}function k(e,t,n,o){t<0&&(t=4294967295+t+1);for(var r=0,i=Math.min(e.length-n,4);r<i;++r)e[n+r]=t>>>8*(o?r:3-r)&255}function I(e,t,n,o){if(n+o>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function S(e,t,n,o,r){return r||I(e,0,n,4),i.write(e,t,n,o,23,4),n+4}function T(e,t,n,o,r){return r||I(e,0,n,8),i.write(e,t,n,o,52,8),n+8}f.prototype.slice=function(e,t){var n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),f.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=f.prototype;else for(var o=t-e,r=new f(o,void 0),i=0;i<o;++i)r[i]=this[i+e];return r},f.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var o=this[e],r=1,i=0;++i<t&&(r*=256);)o+=this[e+i]*r;return o},f.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var o=this[e+--t],r=1;0<t&&(r*=256);)o+=this[e+--t]*r;return o},f.prototype.readUInt8=function(e,t){return t||E(e,1,this.length),this[e]},f.prototype.readUInt16LE=function(e,t){return t||E(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUInt16BE=function(e,t){return t||E(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUInt32LE=function(e,t){return t||E(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUInt32BE=function(e,t){return t||E(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var o=this[e],r=1,i=0;++i<t&&(r*=256);)o+=this[e+i]*r;return(r*=128)<=o&&(o-=Math.pow(2,8*t)),o},f.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var o=t,r=1,i=this[e+--o];0<o&&(r*=256);)i+=this[e+--o]*r;return(r*=128)<=i&&(i-=Math.pow(2,8*t)),i},f.prototype.readInt8=function(e,t){return t||E(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){t||E(e,2,this.length);e=this[e]|this[e+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(e,t){t||E(e,2,this.length);e=this[e+1]|this[e]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(e,t){return t||E(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readFloatLE=function(e,t){return t||E(e,4,this.length),i.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return t||E(e,4,this.length),i.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return t||E(e,8,this.length),i.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return t||E(e,8,this.length),i.read(this,e,!1,52,8)},f.prototype.writeUIntLE=function(e,t,n,o){e=+e,t|=0,n|=0,o||C(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,i=0;for(this[t]=255&e;++i<n&&(r*=256);)this[t+i]=e/r&255;return t+n},f.prototype.writeUIntBE=function(e,t,n,o){e=+e,t|=0,n|=0,o||C(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,i=1;for(this[t+r]=255&e;0<=--r&&(i*=256);)this[t+r]=e/i&255;return t+n},f.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,1,255,0),f.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},f.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},f.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},f.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):k(this,e,t,!0),t+4},f.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},f.prototype.writeIntLE=function(e,t,n,o){e=+e,t|=0,o||C(this,e,t,n,(o=Math.pow(2,8*n-1))-1,-o);var r=0,i=1,a=0;for(this[t]=255&e;++r<n&&(i*=256);)e<0&&0===a&&0!==this[t+r-1]&&(a=1),this[t+r]=(e/i>>0)-a&255;return t+n},f.prototype.writeIntBE=function(e,t,n,o){e=+e,t|=0,o||C(this,e,t,n,(o=Math.pow(2,8*n-1))-1,-o);var r=n-1,i=1,a=0;for(this[t+r]=255&e;0<=--r&&(i*=256);)e<0&&0===a&&0!==this[t+r+1]&&(a=1),this[t+r]=(e/i>>0)-a&255;return t+n},f.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,1,127,-128),f.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},f.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},f.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},f.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):k(this,e,t,!0),t+4},f.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},f.prototype.writeFloatLE=function(e,t,n){return S(this,e,t,!0,n)},f.prototype.writeFloatBE=function(e,t,n){return S(this,e,t,!1,n)},f.prototype.writeDoubleLE=function(e,t,n){return T(this,e,t,!0,n)},f.prototype.writeDoubleBE=function(e,t,n){return T(this,e,t,!1,n)},f.prototype.copy=function(e,t,n,o){if(n=n||0,o||0===o||(o=this.length),t>=e.length&&(t=e.length),t=t||0,0<o&&o<n&&(o=n),o===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-n&&(o=e.length-t+n);var r,i=o-n;if(this===e&&n<t&&t<o)for(r=i-1;0<=r;--r)e[r+t]=this[r+n];else if(i<1e3||!f.TYPED_ARRAY_SUPPORT)for(r=0;r<i;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},f.prototype.fill=function(e,t,n,o){if("string"==typeof e){var r;if("string"==typeof t?(o=t,t=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1!==e.length||(r=e.charCodeAt(0))<256&&(e=r),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!f.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(s=t;s<n;++s)this[s]=e;else for(var i=f.isBuffer(e)?e:N(new f(e,o).toString()),a=i.length,s=0;s<n-t;++s)this[s+t]=i[s%a];return this};var A=/[^+\/0-9A-Za-z-_]/g;function N(e,t){var n;t=t||1/0;for(var o=e.length,r=null,i=[],a=0;a<o;++a){if(55295<(n=e.charCodeAt(a))&&n<57344){if(!r){if(56319<n){-1<(t-=3)&&i.push(239,191,189);continue}if(a+1===o){-1<(t-=3)&&i.push(239,191,189);continue}r=n;continue}if(n<56320){-1<(t-=3)&&i.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&-1<(t-=3)&&i.push(239,191,189);if(r=null,n<128){if(--t<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function M(e){return s.toByteArray(function(e){var t;if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(A,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function P(e,t,n,o){for(var r=0;r<o&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":33,ieee754:40,isarray:43}],36:[function(e,t,n){var l=e("indexof");function c(e){return!!e}t.exports=function(o){var e=o.classList;if(e)return e;var r={add:t,remove:n,contains:i,toggle:function(e){return i(e)?(n(e),!1):(t(e),!0)},toString:function(){return o.className},length:0,item:function(e){return a()[e]||null}};return r;function t(e){var t=a();-1<l(t,e)||(t.push(e),s(t))}function n(e){var t=a(),e=l(t,e);-1!==e&&(t.splice(e,1),s(t))}function i(e){return-1<l(a(),e)}function a(){return function(e,t){for(var n=[],o=0;o<e.length;o++)t(e[o])&&n.push(e[o]);return n}(o.className.split(" "),c)}function s(e){var t=e.length;o.className=e.join(" "),r.length=t;for(var n=0;n<e.length;n++)r[n]=e[n];delete e[t]}}},{indexof:41}],37:[function(e,t,n){t.exports=function(e,t,n,o){if(o=(n=window.getComputedStyle)?n(e):e.currentStyle)return o[t.replace(/-(\w)/gi,function(e,t){return t.toUpperCase()})]}},{}],38:[function(e,n,o){!function(e,t){"use strict";"object"==typeof o?n.exports=t():e.returnExports=t()}(this,function(){function t(e){try{var t=A.call(e).replace(/\/\/.*\n/g,"").replace(/\/\*[.\s\S]*\*\//g,"").replace(/\n/gm," ").replace(/ {2}/g," ");return N.test(t)}catch(e){return}}function d(e){return!!e&&(("function"==typeof e||"object"==typeof e)&&(T?function(e){try{return t(e)?!1:(A.call(e),!0)}catch(e){return!1}}(e):!t(e)&&("[object Function]"===(e=S.call(e))||"[object GeneratorFunction]"===e)))}function m(e){var t=typeof e;return null===e||"object"!=t&&"function"!=t}function s(){}var r,i,l=Array,e=l.prototype,c=Object,n=c.prototype,u=Function,o=u.prototype,v=String,a=v.prototype,y=Number,f=y.prototype,p=e.slice,h=e.splice,g=e.push,b=e.unshift,w=e.concat,E=e.join,C=o.call,x=o.apply,k=Math.max,I=Math.min,S=n.toString,T="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,A=Function.prototype.toString,N=/^\s*class /,M=RegExp.prototype.exec,P=function(e){return"object"==typeof e&&(T?function(e){try{return M.call(e),!0}catch(e){return!1}}(e):"[object RegExp]"===S.call(e))},D=String.prototype.valueOf,j=function(e){return"string"==typeof e||"object"==typeof e&&(T?function(e){try{return D.call(e),!0}catch(e){return!1}}(e):"[object String]"===S.call(e))},R=c.defineProperty&&function(){try{var e,t={};for(e in c.defineProperty(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(e){return!1}}(),O=(r=n.hasOwnProperty,i=R?function(e,t,n,o){!o&&t in e||c.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(e,t,n,o){!o&&t in e||(e[t]=n)},function(e,t,n){for(var o in t)r.call(t,o)&&i(e,o,t[o],n)}),L=y.isNaN||function(e){return e!=e},_=function(e){e=+e;return L(e)?e=0:0!==e&&e!==1/0&&e!==-1/0&&(e=(0<e||-1)*Math.floor(Math.abs(e))),e},U=function(e){var t,n;if(m(e))return e;if(n=e.valueOf,d(n)&&(t=n.call(e),m(t)))return t;if(n=e.toString,d(n)&&(t=n.call(e),m(t)))return t;throw new TypeError},F=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return c(e)},Y=function(e){return e>>>0};O(o,{bind:function(t){var n=this;if(!d(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var o,r=p.call(arguments,1),e=k(0,n.length-r.length),i=[],a=0;a<e;a++)g.call(i,"$"+a);return o=u("binder","return function ("+E.call(i,",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof o){var e=x.call(n,this,w.call(r,p.call(arguments)));return c(e)===e?e:this}return x.call(n,t,w.call(r,p.call(arguments)))}),n.prototype&&(s.prototype=n.prototype,o.prototype=new s,s.prototype=null),o}});var B=C.bind(n.hasOwnProperty),z=C.bind(n.toString),Z=C.bind(p),W=x.bind(p);if("object"==typeof document&&document&&document.documentElement)try{Z(document.documentElement.childNodes)}catch(e){var $=Z,q=W,Z=function(e){for(var t=[],n=e.length;0<n--;)t[n]=e[n];return q(t,$(arguments,1))},W=function(e,t){return q(Z(e),t)}}var V=C.bind(a.slice),J=C.bind(a.split),H=C.bind(a.indexOf),G=C.bind(g),X=C.bind(n.propertyIsEnumerable),K=C.bind(e.sort),Q=l.isArray||function(e){return"[object Array]"===z(e)},ee=1!==[].unshift(0);O(e,{unshift:function(){return b.apply(this,arguments),this.length}},ee),O(l,{isArray:Q});var o=c("a"),te="a"!==o[0]||!(0 in o),n=function(e){var o=!0,t=!0,n=!1;if(e)try{e.call("foo",function(e,t,n){"object"!=typeof n&&(o=!1)}),e.call([1],function(){"use strict";t="string"==typeof this},"x")}catch(e){n=!0}return!!e&&!n&&o&&t};O(e,{forEach:function(e){var t,n=F(this),o=te&&j(this)?J(this,""):n,r=-1,i=Y(o.length);if(1<arguments.length&&(t=arguments[1]),!d(e))throw new TypeError("Array.prototype.forEach callback must be a function");for(;++r<i;)r in o&&(void 0===t?e(o[r],r,n):e.call(t,o[r],r,n))}},!n(e.forEach)),O(e,{map:function(e){var t,n=F(this),o=te&&j(this)?J(this,""):n,r=Y(o.length),i=l(r);if(1<arguments.length&&(t=arguments[1]),!d(e))throw new TypeError("Array.prototype.map callback must be a function");for(var a=0;a<r;a++)a in o&&(i[a]=void 0===t?e(o[a],a,n):e.call(t,o[a],a,n));return i}},!n(e.map)),O(e,{filter:function(e){var t,n,o=F(this),r=te&&j(this)?J(this,""):o,i=Y(r.length),a=[];if(1<arguments.length&&(n=arguments[1]),!d(e))throw new TypeError("Array.prototype.filter callback must be a function");for(var s=0;s<i;s++)s in r&&(t=r[s],(void 0===n?e(t,s,o):e.call(n,t,s,o))&&G(a,t));return a}},!n(e.filter)),O(e,{every:function(e){var t,n=F(this),o=te&&j(this)?J(this,""):n,r=Y(o.length);if(1<arguments.length&&(t=arguments[1]),!d(e))throw new TypeError("Array.prototype.every callback must be a function");for(var i=0;i<r;i++)if(i in o&&!(void 0===t?e(o[i],i,n):e.call(t,o[i],i,n)))return!1;return!0}},!n(e.every)),O(e,{some:function(e){var t,n=F(this),o=te&&j(this)?J(this,""):n,r=Y(o.length);if(1<arguments.length&&(t=arguments[1]),!d(e))throw new TypeError("Array.prototype.some callback must be a function");for(var i=0;i<r;i++)if(i in o&&(void 0===t?e(o[i],i,n):e.call(t,o[i],i,n)))return!0;return!1}},!n(e.some));ee=!1;e.reduce&&(ee="object"==typeof e.reduce.call("es5",function(e,t,n,o){return o})),O(e,{reduce:function(e){var t=F(this),n=te&&j(this)?J(this,""):t,o=Y(n.length);if(!d(e))throw new TypeError("Array.prototype.reduce callback must be a function");if(0===o&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var r,i=0;if(2<=arguments.length)r=arguments[1];else for(;;){if(i in n){r=n[i++];break}if(++i>=o)throw new TypeError("reduce of empty array with no initial value")}for(;i<o;i++)i in n&&(r=e(r,n[i],i,t));return r}},!ee);o=!1;e.reduceRight&&(o="object"==typeof e.reduceRight.call("es5",function(e,t,n,o){return o})),O(e,{reduceRight:function(e){var t,n=F(this),o=te&&j(this)?J(this,""):n,r=Y(o.length);if(!d(e))throw new TypeError("Array.prototype.reduceRight callback must be a function");if(0===r&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var i=r-1;if(2<=arguments.length)t=arguments[1];else for(;;){if(i in o){t=o[i--];break}if(--i<0)throw new TypeError("reduceRight of empty array with no initial value")}if(i<0)return t;for(;i in o&&(t=e(t,o[i],i,n)),i--;);return t}},!o);n=e.indexOf&&-1!==[0,1].indexOf(1,2);O(e,{indexOf:function(e){var t=te&&j(this)?J(this,""):F(this),n=Y(t.length);if(0===n)return-1;var o=0;for(1<arguments.length&&(o=_(arguments[1])),o=0<=o?o:k(0,n+o);o<n;o++)if(o in t&&t[o]===e)return o;return-1}},n);ee=e.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);O(e,{lastIndexOf:function(e){var t=te&&j(this)?J(this,""):F(this),n=Y(t.length);if(0===n)return-1;var o=n-1;for(1<arguments.length&&(o=I(o,_(arguments[1]))),o=0<=o?o:n-Math.abs(o);0<=o;o--)if(o in t&&e===t[o])return o;return-1}},ee);n=(o=[1,2]).splice(),ee=2===o.length&&Q(n)&&0===n.length;O(e,{splice:function(e,t){return 0===arguments.length?[]:h.apply(this,arguments)}},!ee);o={},e.splice.call(o,0,0,1),n=1===o.length;O(e,{splice:function(e,t){if(0===arguments.length)return[];var n=arguments;return this.length=k(_(this.length),0),0<arguments.length&&"number"!=typeof t&&((n=Z(arguments)).length<2?G(n,this.length-e):n[1]=_(t)),h.apply(this,n)}},!n);(ee=new l(1e5))[8]="x",ee.splice(1,1),o=7===ee.indexOf("x"),(n=[])[256]="a",n.splice(257,0,"b"),ee="a"===n[256];O(e,{splice:function(e,t){for(var n,o=F(this),r=[],i=Y(o.length),a=_(e),s=a<0?k(i+a,0):I(a,i),l=I(k(_(t),0),i-s),c=0;c<l;)n=v(s+c),B(o,n)&&(r[c]=o[n]),c+=1;var u,f=Z(arguments,2),d=f.length;if(d<l){c=s;for(var p=i-l;c<p;)n=v(c+l),u=v(c+d),B(o,n)?o[u]=o[n]:delete o[u],c+=1;for(var h=(c=i)-l+d;h<c;)delete o[c-1],--c}else if(l<d)for(c=i-l;s<c;)n=v(c+l-1),u=v(c+d-1),B(o,n)?o[u]=o[n]:delete o[u],--c;c=s;for(var g=0;g<f.length;++g)o[c]=f[g],c+=1;return o.length=i-l+d,r}},!o||!ee);var ne,oe=e.join;try{ne="1,2,3"!==Array.prototype.join.call("123",",")}catch(e){ne=!0}ne&&O(e,{join:function(e){e=void 0===e?",":e;return oe.call(j(this)?J(this,""):this,e)}},ne);n="1,2"!==[1,2].join(void 0);n&&O(e,{join:function(e){e=void 0===e?",":e;return oe.call(this,e)}},n);function re(e){for(var t=F(this),n=Y(t.length),o=0;o<arguments.length;)t[n+o]=arguments[o],o+=1;return t.length=n+o,n+o}o={},ee=1!==Array.prototype.push.call(o,void 0)||1!==o.length||void 0!==o[0]||!B(o,0);O(e,{push:function(e){return(Q(this)?g:re).apply(this,arguments)}},ee);o=1!==(n=[]).push(void 0)||1!==n.length||void 0!==n[0]||!B(n,0);O(e,{push:re},o),O(e,{slice:function(e,t){var n=j(this)?J(this,""):this;return W(n,arguments)}},te);ee=function(){try{[1,2].sort(null)}catch(e){try{[1,2].sort({})}catch(e){return!1}}return!0}(),n=function(){try{return[1,2].sort(/a/),!1}catch(e){}return!0}(),o=function(){try{return[1,2].sort(void 0),!0}catch(e){}return!1}();O(e,{sort:function(e){if(void 0===e)return K(this);if(!d(e))throw new TypeError("Array.prototype.sort callback must be a function");return K(this,e)}},ee||!o||!n);function ie(e){var t=e.constructor;return t&&t.prototype===e}var ae=!X({toString:null},"toString"),se=X(function(){},"prototype"),le=!B("x","0"),ce={$window:!0,$console:!0,$parent:!0,$self:!0,$frame:!0,$frames:!0,$frameElement:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$external:!0,$width:!0,$height:!0,$top:!0,$localStorage:!0},ue=function(){if("undefined"==typeof window)return!1;for(var e in window)try{!ce["$"+e]&&B(window,e)&&null!==window[e]&&"object"==typeof window[e]&&ie(window[e])}catch(e){return!0}return!1}(),fe=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],de=fe.length,e=function(e){return"[object Arguments]"===z(e)},pe=e(arguments)?e:function(e){return null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&!Q(e)&&d(e.callee)};O(c,{keys:function(e){var t=d(e),n=pe(e),o=null!==e&&"object"==typeof e,r=o&&j(e);if(!o&&!t&&!n)throw new TypeError("Object.keys called on a non-object");var i=[],a=se&&t;if(r&&le||n)for(var s=0;s<e.length;++s)G(i,v(s));if(!n)for(var l in e)a&&"prototype"===l||!B(e,l)||G(i,v(l));if(ae)for(var c=function(e){if("undefined"==typeof window||!ue)return ie(e);try{return ie(e)}catch(e){return!1}}(e),u=0;u<de;u++){var f=fe[u];c&&"constructor"===f||!B(e,f)||G(i,f)}return i}});var ee=c.keys&&function(){return 2===c.keys(arguments).length}(1,2),o=c.keys&&function(){var e=c.keys(arguments);return 1!==arguments.length||1!==e.length||1!==e[0]}(1),he=c.keys;O(c,{keys:function(e){return pe(e)?he(Z(e)):he(e)}},!ee||o);function ge(e,t){return be(new Date(t,e,0))}var me,n=0!==new Date(-0xc782b5b342b24).getUTCMonth(),e=new Date(-0x55d318d56a724),ee=new Date(14496624e5),o="Mon, 01 Jan -45875 11:59:59 GMT"!==e.toUTCString(),ee=e.getTimezoneOffset()<-720?(me="Tue Jan 02 -45875"!==e.toDateString(),!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(ee))):(me="Mon Jan 01 -45875"!==e.toDateString(),!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(ee))),ve=C.bind(Date.prototype.getFullYear),ye=C.bind(Date.prototype.getMonth),be=C.bind(Date.prototype.getDate),we=C.bind(Date.prototype.getUTCFullYear),Ee=C.bind(Date.prototype.getUTCMonth),Ce=C.bind(Date.prototype.getUTCDate),xe=C.bind(Date.prototype.getUTCDay),ke=C.bind(Date.prototype.getUTCHours),Ie=C.bind(Date.prototype.getUTCMinutes),Se=C.bind(Date.prototype.getUTCSeconds),Te=C.bind(Date.prototype.getUTCMilliseconds),Ae=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Ne=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];O(Date.prototype,{getFullYear:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=ve(this);return e<0&&11<ye(this)?e+1:e},getMonth:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=ve(this),t=ye(this);return e<0&&11<t?0:t},getDate:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=ve(this),t=ye(this),n=be(this);return!(e<0&&11<t)||12===t?n:ge(0,e+1)-n+1},getUTCFullYear:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=we(this);return e<0&&11<Ee(this)?e+1:e},getUTCMonth:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=we(this),t=Ee(this);return e<0&&11<t?0:t},getUTCDate:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=we(this),t=Ee(this),n=Ce(this);return!(e<0&&11<t)||12===t?n:ge(0,e+1)-n+1}},n),O(Date.prototype,{toUTCString:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=xe(this),t=Ce(this),n=Ee(this),o=we(this),r=ke(this),i=Ie(this),a=Se(this);return Ae[e]+", "+(t<10?"0"+t:t)+" "+Ne[n]+" "+o+" "+(r<10?"0"+r:r)+":"+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+" GMT"}},n||o),O(Date.prototype,{toDateString:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=this.getDay(),t=this.getDate(),n=this.getMonth(),o=this.getFullYear();return Ae[e]+" "+Ne[n]+" "+(t<10?"0"+t:t)+" "+o}},n||me),(n||ee)&&(Date.prototype.toString=function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var e=this.getDay(),t=this.getDate(),n=this.getMonth(),o=this.getFullYear(),r=this.getHours(),i=this.getMinutes(),a=this.getSeconds(),s=this.getTimezoneOffset(),l=Math.floor(Math.abs(s)/60),c=Math.floor(Math.abs(s)%60);return Ae[e]+" "+Ne[n]+" "+(t<10?"0"+t:t)+" "+o+" "+(r<10?"0"+r:r)+":"+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+" GMT"+(0<s?"-":"+")+(l<10?"0"+l:l)+(c<10?"0"+c:c)},R&&c.defineProperty(Date.prototype,"toString",{configurable:!0,enumerable:!1,writable:!0}));var Me=-621987552e5,Pe="-000001",n=Date.prototype.toISOString&&-1===new Date(Me).toISOString().indexOf(Pe),ee=Date.prototype.toISOString&&"1969-12-31T23:59:59.999Z"!==new Date(-1).toISOString(),De=C.bind(Date.prototype.getTime);O(Date.prototype,{toISOString:function(){if(!isFinite(this)||!isFinite(De(this)))throw new RangeError("Date.prototype.toISOString called on non-finite value.");var e=we(this),t=Ee(this);e+=Math.floor(t/12);for(var n=[1+(t%12+12)%12,Ce(this),ke(this),Ie(this),Se(this)],e=(e<0?"-":9999<e?"+":"")+V("00000"+Math.abs(e),0<=e&&e<=9999?-4:-6),o=0;o<n.length;++o)n[o]=V("00"+n[o],-2);return e+"-"+Z(n,0,2).join("-")+"T"+Z(n,2).join(":")+"."+V("000"+Te(this),-3)+"Z"}},n||ee),function(){try{return Date.prototype.toJSON&&null===new Date(NaN).toJSON()&&-1!==new Date(Me).toJSON().indexOf(Pe)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(e){return!1}}()||(Date.prototype.toJSON=function(e){var t=c(this),n=U(t);if("number"==typeof n&&!isFinite(n))return null;n=t.toISOString;if(!d(n))throw new TypeError("toISOString property is not callable");return n.call(t)});var je,Re,n=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),ee=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));!isNaN(Date.parse("2000-01-01T00:00:00.000Z"))&&!ee&&n||(je=Math.pow(2,31)-1,Re=L(new Date(1970,0,1,0,0,0,1+je).getTime()),Date=function(p){function h(e,t){var n=1<t?1:0;return o[t]+Math.floor((e-1969+n)/4)-Math.floor((e-1901+n)/100)+Math.floor((e-1601+n)/400)+365*(e-1970)}var e,f=function(e,t,n,o,r,i,a){var s,l,c,u=arguments.length,u=this instanceof p?(s=i,l=a,Re&&7<=u&&je<a&&(c=Math.floor(a/je)*je,s+=c=Math.floor(c/1e3),l-=1e3*c),1===u&&v(e)===e?new p(f.parse(e)):7<=u?new p(e,t,n,o,r,s,l):6<=u?new p(e,t,n,o,r,s):5<=u?new p(e,t,n,o,r):4<=u?new p(e,t,n,o):3<=u?new p(e,t,n):2<=u?new p(e,t):1<=u?new p(e instanceof p?+e:e):new p):p.apply(this,arguments);return m(u)||O(u,{constructor:f},!0),u},g=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),o=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(e in p)B(p,e)&&(f[e]=p[e]);O(f,{now:p.now,UTC:p.UTC},!0),f.prototype=p.prototype,O(f.prototype,{constructor:f},!0);return O(f,{parse:function(e){var t=g.exec(e);if(t){var n,o=y(t[1]),r=y(t[2]||1)-1,i=y(t[3]||1)-1,a=y(t[4]||0),s=y(t[5]||0),l=y(t[6]||0),c=Math.floor(1e3*y(t[7]||0)),u=Boolean(t[4]&&!t[8]),f="-"===t[9]?1:-1,d=y(t[10]||0),t=y(t[11]||0);return a<(0<s||0<l||0<c?24:25)&&s<60&&l<60&&c<1e3&&-1<r&&r<12&&d<24&&t<60&&-1<i&&i<h(o,1+r)-h(o,r)&&(n=1e3*(60*((n=60*(24*(h(o,r)+i)+a+d*f))+s+t*f)+l)+c,u&&(l=0,u=c=n,Re&&je<u&&(c=Math.floor(u/je)*je,l+=c=Math.floor(c/1e3),u-=1e3*c),n=y(new p(1970,0,1,0,0,l,u))),-864e13<=n&&n<=864e13)?n:NaN}return p.parse.apply(this,arguments)}}),f}(Date)),Date.now||(Date.now=function(){return(new Date).getTime()});var n=f.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0)),Oe={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(e,t){for(var n=-1,o=t;++n<Oe.size;)o+=e*Oe.data[n],Oe.data[n]=o%Oe.base,o=Math.floor(o/Oe.base)},divide:function(e){for(var t=Oe.size,n=0;0<=--t;)n+=Oe.data[t],Oe.data[t]=Math.floor(n/e),n=n%e*Oe.base},numToString:function(){for(var e,t=Oe.size,n="";0<=--t;)""===n&&0!==t&&0===Oe.data[t]||(e=v(Oe.data[t]),""===n?n=e:n+=V("0000000",0,7-e.length)+e);return n},pow:function e(t,n,o){return 0===n?o:n%2==1?e(t,n-1,o*t):e(t*t,n/2,o)},log:function(e){for(var t=0,n=e;4096<=n;)t+=12,n/=4096;for(;2<=n;)t+=1,n/=2;return t}};O(f,{toFixed:function(e){var t,n,o,r,i=y(e);if((i=L(i)?0:Math.floor(i))<0||20<i)throw new RangeError("Number.toFixed called with invalid number of decimals");if(n=y(this),L(n))return"NaN";if(n<=-1e21||1e21<=n)return v(n);if(t="",n<0&&(t="-",n=-n),e="0",1e-21<n)if(n=(r=Oe.log(n*Oe.pow(2,69,1))-69)<0?n*Oe.pow(2,-r,1):n/Oe.pow(2,r,1),n*=4503599627370496,0<(r=52-r)){for(Oe.multiply(0,n),o=i;7<=o;)Oe.multiply(1e7,0),o-=7;for(Oe.multiply(Oe.pow(10,o,1),0),o=r-1;23<=o;)Oe.divide(1<<23),o-=23;Oe.divide(1<<o),Oe.multiply(1,1),Oe.divide(2),e=Oe.numToString()}else Oe.multiply(0,n),Oe.multiply(1<<-r,0),e=Oe.numToString()+V("0.00000000000000000000",2,2+i);return e=0<i?(r=e.length)<=i?t+V("0.0000000000000000000",0,i-r+2)+e:t+V(e,0,r-i)+"."+V(e,r-i):t+e}},n);var Le,_e,n=function(){try{return"1"===1..toPrecision(void 0)}catch(e){return!0}}(),Ue=f.toPrecision;O(f,{toPrecision:function(e){return void 0===e?Ue.call(this):Ue.call(this,e)}},n),2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||1<".".split(/()()/).length?(Le=void 0===/()??/.exec("")[1],_e=Math.pow(2,32)-1,a.split=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!P(e))return J(this,e,t);var o,r,i,a=[],s=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,c=new RegExp(e.source,s+"g");Le||(o=new RegExp("^"+c.source+"$(?!\\s)",s));for(var u=void 0===t?_e:Y(t),f=c.exec(n);f&&!(l<(r=f.index+f[0].length)&&(G(a,V(n,l,f.index)),!Le&&1<f.length&&f[0].replace(o,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(f[e]=void 0)}),1<f.length&&f.index<n.length&&g.apply(a,Z(f,1)),i=f[0].length,l=r,u<=a.length));)c.lastIndex===f.index&&c.lastIndex++,f=c.exec(n);return l===n.length?!i&&c.test("")||G(a,""):G(a,V(n,l)),u<a.length?Z(a,0,u):a}):"0".split(void 0,0).length&&(a.split=function(e,t){return void 0===e&&0===t?[]:J(this,e,t)});var Fe,Ye=a.replace;(Fe=[],"x".replace(/x(.)?/g,function(e,t){G(Fe,t)}),1===Fe.length&&void 0===Fe[0])||(a.replace=function(r,i){var e=d(i),t=P(r)&&/\)[*?]/.test(r.source);if(e&&t)return Ye.call(this,r,function(e){var t=arguments.length,n=r.lastIndex;r.lastIndex=0;var o=r.exec(e)||[];return r.lastIndex=n,G(o,arguments[t-2],arguments[t-1]),i.apply(this,o)});return Ye.call(this,r,i)});var Be=a.substr,f="".substr&&"b"!=="0b".substr(-1);O(a,{substr:function(e,t){var n=e;return e<0&&(n=k(this.length+e,0)),Be.call(this,n,t)}},f);var n="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",f="["+n+"]",ze=new RegExp("^"+f+f+"*"),Ze=new RegExp(f+f+"*$"),f=a.trim&&(n.trim()||!"​".trim());O(a,{trim:function(){if(null==this)throw new TypeError("can't convert "+this+" to object");return v(this).replace(ze,"").replace(Ze,"")}},f);var We=C.bind(String.prototype.trim),C=a.lastIndexOf&&-1!=="abcあい".lastIndexOf("あい",2);O(a,{lastIndexOf:function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");for(var t=v(this),n=v(e),o=1<arguments.length?y(arguments[1]):NaN,o=L(o)?1/0:_(o),r=I(k(o,0),t.length),i=n.length,a=r+i;0<a;){a=k(0,a-i);var s=H(V(t,a,r+i),n);if(-1!==s)return a+s}return-1}},C);var $e,qe,Ve,Je=a.lastIndexOf;O(a,{lastIndexOf:function(e){return Je.apply(this,arguments)}},1!==a.lastIndexOf.length),8===parseInt(n+"08")&&22===parseInt(n+"0x16")||(parseInt=($e=parseInt,qe=/^[-+]?0[xX]/,function(e,t){e=We(String(e)),t=y(t)||(qe.test(e)?16:10);return $e(e,t)})),1/parseFloat("-0")!=-1/0&&(parseFloat=(Ve=parseFloat,function(e){var t=We(String(e)),e=Ve(t);return 0===e&&"-"===V(t,0,1)?-0:e})),"RangeError: test"!==String(new RangeError("test"))&&(Error.prototype.toString=function(){if(null==this)throw new TypeError("can't convert "+this+" to object");var e=this.name;void 0===e?e="Error":"string"!=typeof e&&(e=v(e));var t=this.message;return void 0===t?t="":"string"!=typeof t&&(t=v(t)),e?t?e+": "+t:e:t}),R&&((R=function(e,t){var n;!X(e,t)||(n=Object.getOwnPropertyDescriptor(e,t)).configurable&&(n.enumerable=!1,Object.defineProperty(e,t,n))})(Error.prototype,"message"),""!==Error.prototype.message&&(Error.prototype.message=""),R(Error.prototype,"name")),"/a/gim"!==String(/a/gim)&&(RegExp.prototype.toString=function(){var e="/"+this.source+"/";return this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),e})})},{}],39:[function(e,t,n){var o=[],r=o.forEach,i=o.slice;t.exports=function(n){return r.call(i.call(arguments,1),function(e){if(e)for(var t in e)n[t]=e[t]}),n}},{}],40:[function(e,t,n){n.read=function(e,t,n,o,r){var i,a,s=8*r-o-1,l=(1<<s)-1,c=l>>1,u=-7,f=n?r-1:0,d=n?-1:1,n=e[t+f];for(f+=d,i=n&(1<<-u)-1,n>>=-u,u+=s;0<u;i=256*i+e[t+f],f+=d,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=o;0<u;a=256*a+e[t+f],f+=d,u-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,o),i-=c}return(n?-1:1)*a*Math.pow(2,i-o)},n.write=function(e,t,n,o,r,i){var a,s,l=8*i-r-1,c=(1<<l)-1,u=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=o?0:i-1,p=o?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(o=Math.pow(2,-a))<1&&(a--,o*=2),2<=(t+=1<=a+u?f/o:f*Math.pow(2,1-u))*o&&(a++,o/=2),c<=a+u?(s=0,a=c):1<=a+u?(s=(t*o-1)*Math.pow(2,r),a+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,r),a=0));8<=r;e[n+d]=255&s,d+=p,s/=256,r-=8);for(a=a<<r|s,l+=r;0<l;e[n+d]=255&a,d+=p,a/=256,l-=8);e[n+d-p]|=128*i}},{}],41:[function(e,t,n){var o=[].indexOf;t.exports=function(e,t){if(o)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],42:[function(e,t,n){t.exports=function(e){var t=o.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var o=Object.prototype.toString},{}],43:[function(e,t,n){var o={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==o.call(e)}},{}],44:[function(e,D,j){(function(P){!function(e){var t="object"==typeof j&&j&&!j.nodeType&&j,n="object"==typeof D&&D&&!D.nodeType&&D,o="object"==typeof P&&P;o.global!==o&&o.window!==o&&o.self!==o||(e=o);var r,i,v=2147483647,y=36,b=1,w=26,a=38,s=700,E=72,C=128,x="-",l=/^xn--/,c=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=y-b,k=Math.floor,I=String.fromCharCode;function S(e){throw new RangeError(f[e])}function p(e,t){for(var n=e.length,o=[];n--;)o[n]=t(e[n]);return o}function h(e,t){var n=e.split("@"),o="";return 1<n.length&&(o=n[0]+"@",e=n[1]),o+p((e=e.replace(u,".")).split("."),t).join(".")}function T(e){for(var t,n,o=[],r=0,i=e.length;r<i;)55296<=(t=e.charCodeAt(r++))&&t<=56319&&r<i?56320==(64512&(n=e.charCodeAt(r++)))?o.push(((1023&t)<<10)+(1023&n)+65536):(o.push(t),r--):o.push(t);return o}function g(e){return p(e,function(e){var t="";return 65535<e&&(t+=I((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=I(e)}).join("")}function A(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function N(e,t,n){var o=0;for(e=n?k(e/s):e>>1,e+=k(e/t);d*w>>1<e;o+=y)e=k(e/d);return k(o+(d+1)*e/(e+a))}function m(e){var t,n,o,r,i,a,s,l=[],c=e.length,u=0,f=C,d=E,p=e.lastIndexOf(x);for(p<0&&(p=0),n=0;n<p;++n)128<=e.charCodeAt(n)&&S("not-basic"),l.push(e.charCodeAt(n));for(o=0<p?p+1:0;o<c;){for(r=u,i=1,a=y;c<=o&&S("invalid-input"),s=e.charCodeAt(o++),(y<=(s=s-48<10?s-22:s-65<26?s-65:s-97<26?s-97:y)||s>k((v-u)/i))&&S("overflow"),u+=s*i,!(s<(s=a<=d?b:d+w<=a?w:a-d));a+=y)i>k(v/(s=y-s))&&S("overflow"),i*=s;d=N(u-r,t=l.length+1,0==r),k(u/t)>v-f&&S("overflow"),f+=k(u/t),u%=t,l.splice(u++,0,f)}return g(l)}function M(e){for(var t,n,o,r,i,a,s,l,c,u,f,d=[],p=(e=T(e)).length,h=C,g=E,m=t=0;m<p;++m)(l=e[m])<128&&d.push(I(l));for(n=o=d.length,o&&d.push(x);n<p;){for(r=v,m=0;m<p;++m)h<=(l=e[m])&&l<r&&(r=l);for(r-h>k((v-t)/(c=n+1))&&S("overflow"),t+=(r-h)*c,h=r,m=0;m<p;++m)if((l=e[m])<h&&++t>v&&S("overflow"),l==h){for(i=t,a=y;!(i<(s=a<=g?b:g+w<=a?w:a-g));a+=y)f=i-s,u=y-s,d.push(I(A(s+f%u,0))),i=k(f/u);d.push(I(A(i,0))),g=N(t,c,n==o),t=0,++n}++t,++h}return d.join("")}if(r={version:"1.4.1",ucs2:{decode:T,encode:g},decode:m,encode:M,toASCII:function(e){return h(e,function(e){return c.test(e)?"xn--"+M(e):e})},toUnicode:function(e){return h(e,function(e){return l.test(e)?m(e.slice(4).toLowerCase()):e})}},0,t&&n)if(D.exports==t)n.exports=r;else for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);else e.punycode=r}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(e,t,n){!function(e){void 0!==t&&t.exports?t.exports=e():this.$script=e()}(function(){var c,r,i=document,a=i.getElementsByTagName("head")[0],s=!1,u="push",l="readyState",f="onreadystatechange",d={},p={},h={},g={};function m(e,t){for(var n=0,o=e.length;n<o;++n)if(!t(e[n]))return s;return 1}function v(e,t){m(e,function(e){return!t(e)})}function y(e,t,n){e=e[u]?e:[e];var o=t&&t.call,r=o?t:n,i=o?e.join(""):t,a=e.length;function s(e){return e.call?e():d[e]}function l(){if(!--a)for(var e in d[i]=1,r&&r(),h)m(e.split("|"),s)&&!v(h[e],s)&&(h[e]=[])}return setTimeout(function(){v(e,function e(t,n){return null===t?(l(),0):(n||/^https?:\/\//.test(t)||!c||(t=-1===t.indexOf(".js")?c+t+".js":c+t),g[t]?(i&&(p[i]=1),2==g[t]?l():setTimeout(function(){e(t,!0)},0)):(g[t]=1,i&&(p[i]=1),void b(t,l)))})},0),y}function b(e,t){var n,o=i.createElement("script");o.onload=o.onerror=o[f]=function(){o[l]&&!/^c|loade/.test(o[l])||n||(o.onload=o[f]=null,n=1,g[e]=2,t())},o.async=1,o.src=r?e+(-1===e.indexOf("?")?"?":"&")+r:e,a.insertBefore(o,a.lastChild)}return y.get=b,y.order=function(n,o,r){!function e(t){t=n.shift(),n.length?y(t,e):y(t,o,r)}()},y.path=function(e){c=e},y.urlArgs=function(e){r=e},y.ready=function(e,t,n){e=e[u]?e:[e];var o=[];return v(e,function(e){d[e]||o[u](e)}),m(e,function(e){return d[e]})?t():(e=e.join("|"),h[e]=h[e]||[],h[e][u](t),n&&n(o)),y},y.done=function(e){y([null],e)},y})},{}]},{},[32])(32)});


// close.fullscreen.js

function createCloseFullscreen(){$(".fp-ui").append('<div class="fp-close_fullscreen"></div>')}function closeFullscreen(e){e.stopPropagation(),"fp-close_fullscreen"===e.target.className&&flowplayer().fullscreen()}

// skip-screen-video.js

function skipScreen(i){var t=flowplayer(),c=$(".fp-ui");i.forEach(function(i){var e,n=i.start,o=i.end,i=i.text,s=$("<div />",{class:"fp-skip-screen",text:i});c.append(s),s.on("click",function(i){i.stopPropagation(),s.hide(),t.seek(o)}),t.on("progress",function(){(e=t.video.time)>=n&&e<o?s.is(":hidden")&&s.show():s.is(":visible")&&s.hide()})})}

// save-scale.js

var stateVideoStyle="";function saveScale(e){$(".flowplayer").hasClass("is-touch")&&$(".flowplayer").hasClass("is-fullscreen")&&(console.log("here"),$(".fp-close_fullscreen").on("click",getScale),$(".fp-fullscreen").on("click",getScale))}function getScale(e){document.querySelector("video").style.transform="none",setScale()}function setScale(e){$(".fp-fullscreen").on("click",function(){document.querySelector("video").style.transform=stateVideoStyle})}

//hls.js

"undefined"!=typeof window&&function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}(this,function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=31)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(6);function a(){}var n={trace:a,debug:a,log:a,warn:a,info:a,error:a},o=n;var s=i.getSelfScope();function l(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t.forEach(function(t){o[t]=e[t]?e[t].bind(e):function(e){var t=s.console[e];return t?function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r[0]&&(r[0]=function(e,t){return t="["+e+"] > "+t}(e,r[0])),t.apply(s.console,r)}:a}(t)})}t.enableLogs=function(e){if(!0===e||"object"==typeof e){l(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=n}}else o=n},t.logger=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(6).getSelfScope().Number;t.Number=i,i.isFinite=i.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},t.ErrorDetails={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(3),n=r(1),o={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},s=function(){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.hls=e,this.onEvent=this.onEvent.bind(this),this.handledEvents=t,this.useGenericHandler=!0,this.registerListeners()}return e.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.prototype.onHandlerDestroying=function(){},e.prototype.onHandlerDestroyed=function(){},e.prototype.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},e.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(o[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},e.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},e.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},e.prototype.onEventGeneric=function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){i.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(n.default.ERROR,{type:a.ErrorTypes.OTHER_ERROR,details:a.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var i=e.buffered,a=[],n=void 0;for(n=0;n<i.length;n++)a.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(a,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){var i,a,n,o,s,l=[];for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),s=0;s<e.length;s++){var u=l.length;if(u){var d=l[u-1].end;e[s].start-d<r?e[s].end>d&&(l[u-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(s=0,i=0,a=n=t;s<l.length;s++){var f=l[s].start,c=l[s].end;if(t+r>=f&&t<c)a=f,i=(n=c)-t;else if(t+r<f){o=f;break}}return{len:i,start:a,end:n,nextStart:o}},e}();t.BufferHelper=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelfScope=function(){return"undefined"==typeof window?self:window}},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(4),n=r(1);t.FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var o=function(r){function o(e){var t=r.call(this,e,n.default.BUFFER_APPENDED,n.default.FRAG_BUFFERED,n.default.FRAG_LOADED)||this;return t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=e.config,t}return i(o,r),o.prototype.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,a.default.prototype.destroy.call(this),r.prototype.destroy.call(this)},o.prototype.getBufferedFrag=function(e,t){var r=this.fragments,i=Object.keys(r).filter(function(i){var a=r[i];if(a.body.type!==t)return!1;if(!a.buffered)return!1;var n=a.body;return n.startPTS<=e&&e<=n.endPTS});if(0===i.length)return null;var a=i.pop();return r[a].body},o.prototype.detectEvictedFragments=function(e,t){var r,i,a=this;Object.keys(this.fragments).forEach(function(n){var o=a.fragments[n];if(!0===o.buffered){var s=o.range[e];if(s){r=s.time;for(var l=0;l<r.length;l++)if(i=r[l],!1===a.isTimeBuffered(i.startPTS,i.endPTS,t)){a.removeFragment(o.body);break}}}})},o.prototype.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),i=this.fragments[r];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){if(e.hasElementaryStream(r)){var a=t.timeRanges[r];i.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,a)}}))},o.prototype.getBufferedTimes=function(e,t,r){for(var i,a,n=[],o=!1,s=0;s<r.length;s++){if(i=r.start(s)-this.bufferPadding,a=r.end(s)+this.bufferPadding,e>=i&&t<=a){n.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))});break}if(e<a&&t>i)n.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))}),o=!0;else if(t<=i)break}return{time:n,partial:o}},o.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},o.prototype.getPartialFragment=function(e){var t,r,i,a=this,n=null,o=0;return Object.keys(this.fragments).forEach(function(s){var l=a.fragments[s];a.isPartial(l)&&(r=l.body.startPTS-a.bufferPadding,i=l.body.endPTS+a.bufferPadding,e>=r&&e<=i&&(t=Math.min(e-r,i-e),o<=t&&(n=l.body,o=t)))}),n},o.prototype.getState=function(e){var r=this.getFragmentKey(e),i=this.fragments[r],a=t.FragmentState.NOT_LOADED;return void 0!==i&&(a=i.buffered?!0===this.isPartial(i)?t.FragmentState.PARTIAL:t.FragmentState.OK:t.FragmentState.APPENDING),a},o.prototype.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},o.prototype.isTimeBuffered=function(e,t,r){for(var i,a,n=0;n<r.length;n++){if(i=r.start(n)-this.bufferPadding,a=r.end(n)+this.bufferPadding,e>=i&&t<=a)return!0;if(t<=i)return!1}return!1},o.prototype.onFragLoaded=function(t){var r=t.frag;e.isFinite(r.sn)&&!r.bitrateTest&&(this.fragments[this.getFragmentKey(r)]={body:r,range:Object.create(null),buffered:!1})},o.prototype.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)})},o.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},o.prototype.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},o.prototype.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},o.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},o}(a.default);t.FragmentTracker=o}).call(this,r(2).Number)},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r(0);function a(t,r,a){var n=t[r],o=t[a],s=o.startPTS;e.isFinite(s)?a>r?(n.duration=s-n.start,n.duration<0&&i.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(o.duration=n.start-s,o.duration<0&&i.logger.warn("negative duration computed for frag "+o.sn+",level "+o.level+", there should be some duration drift between playlist and fragment!")):o.start=a>r?n.start+n.duration:Math.max(n.start-o.duration,0)}function n(t,r,i,n,o,s){var l=i;if(e.isFinite(r.startPTS)){var u=Math.abs(r.startPTS-i);e.isFinite(r.deltaPTS)?r.deltaPTS=Math.max(u,r.deltaPTS):r.deltaPTS=u,l=Math.max(i,r.startPTS),i=Math.min(i,r.startPTS),n=Math.max(n,r.endPTS),o=Math.min(o,r.startDTS),s=Math.max(s,r.endDTS)}var d=i-r.start;r.start=r.startPTS=i,r.maxStartPTS=l,r.endPTS=n,r.startDTS=o,r.endDTS=s,r.duration=n-i;var f,c,h,p=r.sn;if(!t||p<t.startSN||p>t.endSN)return 0;for(f=p-t.startSN,(c=t.fragments)[f]=r,h=f;h>0;h--)a(c,h,h-1);for(h=f;h<c.length-1;h++)a(c,h,h+1);return t.PTSKnown=!0,d}function o(e,t,r){if(e&&t)for(var i=Math.max(e.startSN,t.startSN)-t.startSN,a=Math.min(e.endSN,t.endSN)-t.startSN,n=t.startSN-e.startSN,o=i;o<=a;o++){var s=e.fragments[n+o],l=t.fragments[o];if(!s||!l)break;r(s,l,o)}}function s(e,t){var r=t.startSN-e.startSN,i=e.fragments,a=t.fragments;if(!(r<0||r>i.length))for(var n=0;n<a.length;n++)a[n].start+=i[r].start}t.addGroupId=function(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}},t.updatePTS=a,t.updateFragPTSDTS=n,t.mergeDetails=function(t,r){r.initSegment&&t.initSegment&&(r.initSegment=t.initSegment);var a,l=0;if(o(t,r,function(t,i){l=t.cc-i.cc,e.isFinite(t.startPTS)&&(i.start=i.startPTS=t.startPTS,i.endPTS=t.endPTS,i.duration=t.duration,i.backtracked=t.backtracked,i.dropped=t.dropped,a=i),r.PTSKnown=!0}),r.PTSKnown){if(l){i.logger.log("discontinuity sliding from playlist, take drift into account");for(var u=r.fragments,d=0;d<u.length;d++)u[d].cc+=l}a?n(r,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):s(t,r),r.PTSKnown=t.PTSKnown}},t.mergeSubtitlePlaylists=function(e,t,r){void 0===r&&(r=0);var i=-1;o(e,t,function(e,t,r){t.start=e.start,i=r});var a=t.fragments;if(i<0)a.forEach(function(e){e.start+=r});else for(var n=i+1;n<a.length;n++)a[n].start=a[n-1].start+a[n-1].duration},t.mapFragmentIntersection=o,t.adjustSliding=s,t.computeReloadInterval=function(e,t,r){var i=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),a=i/2;return e&&t.endSN===e.endSN&&(i=a),r&&(i=Math.max(a,i-(window.performance.now()-r))),Math.round(i)}}).call(this,r(2).Number)},function(e,t,r){!function(t){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,n=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var a=o.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");return a.path=o.normalizePath(a.path),o.buildURLFromParts(a)}var n=o.parseURL(t);if(!n)throw new Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=o.normalizePath(n.path),o.buildURLFromParts(n)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(u.netLoc=s.netLoc,"/"!==n.path[0]))if(n.path){var d=s.path,f=d.substring(0,d.lastIndexOf("/")+1)+n.path;u.path=o.normalizePath(f)}else u.path=s.path,n.params||(u.params=s.params,n.query||(u.query=s.query));return null===u.path&&(u.path=r.alwaysNormalize?o.normalizePath(n.path):n.path),o.buildURLFromParts(u)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(n,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=o}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={search:function(e,t){for(var r=0,i=e.length-1,a=null,n=null;r<=i;){var o=t(n=e[a=(r+i)/2|0]);if(o>0)r=a+1;else{if(!(o<0))return n;i=a-1}}return null}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var i=r,a=0;e.isHeader(t,r);){a+=10,a+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(a+=10),r+=a}if(a>0)return t.subarray(i,i+a)},e._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),i=0;i<r.length;i++){var a=r[i];if(e.isTimeStampFrame(a))return e._readTimeStamp(a)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),i=e._readSize(t,4);return{type:r,size:i,data:t.subarray(10,10+i)}},e.getID3Frames=function(t){for(var r=0,i=[];e.isHeader(t,r);){for(var a=e._readSize(t,r+6),n=(r+=10)+a;r+8<n;){var o=e._getFrameData(t.subarray(r)),s=e._decodeFrame(o);s&&i.push(s),r+=o.size+10}e.isFooter(t,r)&&(r+=10)}return i},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data,!0),i=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:i.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,i=e._utf8ArrayToStr(t.data.subarray(r));r+=i.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:a}}var n=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:n}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,i=e._utf8ArrayToStr(t.data.subarray(r));r+=i.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:a}}var n=e._utf8ArrayToStr(t.data);return{key:t.type,data:n}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);for(var r,i,a,n=e.length,o="",s=0;s<n;){if(0===(r=e[s++])&&t)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:i=e[s++],o+=String.fromCharCode((31&r)<<6|63&i);break;case 14:i=e[s++],a=e[s++],o+=String.fromCharCode((15&r)<<12|(63&i)<<6|(63&a)<<0)}}return o},e}(),a=i._utf8ArrayToStr;t.utf8ArrayToStr=a,t.default=i},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r(9),a=r(18),n=function(){function t(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this.programDateTime=null,this.rawProgramDateTime=null,this._elementaryStreams=((e={})[t.ElementaryStreamTypes.AUDIO]=!1,e[t.ElementaryStreamTypes.VIDEO]=!1,e)}return Object.defineProperty(t,"ElementaryStreamTypes",{get:function(){return{AUDIO:"audio",VIDEO:"video"}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return!this._url&&this.relurl&&(this._url=i.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRange",{get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var r=this.lastByteRangeEndOffset;e[0]=r||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0],this._byteRange=e}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeStartOffset",{get:function(){return this.byteRange[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeEndOffset",{get:function(){return this.byteRange[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"decryptdata",{get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endProgramDateTime",{get:function(){if(!e.isFinite(this.programDateTime))return null;var t=e.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encrypted",{get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)},enumerable:!0,configurable:!0}),t.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},t.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},t.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},t.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new a.default).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r},t}();t.default=n}).call(this,r(2).Number)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(39),a=r(40),n=r(41),o=r(3),s=r(0),l=r(1),u=r(6).getSelfScope(),d=function(){function e(e,t,r){var i=(void 0===r?{}:r).removePKCS7Padding,a=void 0===i||i;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=a,a)try{var n=u.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}return e.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.prototype.decrypt=function(e,t,r,o){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(s.logger.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new n.default),u.expandKey(t),o(u.decrypt(e,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(s.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var d=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new a.default(d,t)),this.fastAesKey.expandKey().then(function(a){new i.default(d,r).decrypt(e,a).catch(function(i){l.onWebCryptoError(i,e,t,r,o)}).then(function(e){o(e)})}).catch(function(i){l.onWebCryptoError(i,e,t,r,o)})}},e.prototype.onWebCryptoError=function(e,t,r,i,a){this.config.enableSoftwareAES?(s.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,i,a)):(s.logger.error("decrypting error : "+e.message),this.observer.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},e.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaSource=function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(28),n=r(7),o=r(5),s=r(0);t.State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var l=function(r){function a(){return null!==r&&r.apply(this,arguments)||this}return i(a,r),a.prototype.doTick=function(){},a.prototype.startLoad=function(){},a.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=t.State.STOPPED},a.prototype._streamEnded=function(e,t){var r=this.fragCurrent,i=this.fragmentTracker;if(!t.live&&r&&!r.backtracked&&r.sn===t.endSN&&!e.nextStart){var a=i.getState(r);return a===n.FragmentState.PARTIAL||a===n.FragmentState.OK}return!1},a.prototype.onMediaSeeking=function(){var r=this.config,i=this.media,a=this.mediaBuffer,n=this.state,l=i?i.currentTime:null,u=o.BufferHelper.bufferInfo(a||i,l,this.config.maxBufferHole);if(e.isFinite(l)&&s.logger.log("media seeking to "+l.toFixed(3)),n===t.State.FRAG_LOADING){var d=this.fragCurrent;if(0===u.len&&d){var f=r.maxFragLookUpTolerance,c=d.start-f,h=d.start+d.duration+f;l<c||l>h?(d.loader&&(s.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),d.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=t.State.IDLE):s.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else n===t.State.ENDED&&(0===u.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=t.State.IDLE);i&&(this.lastCurrentTime=l),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=l),this.tick()},a.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},a.prototype.onHandlerDestroying=function(){this.stopLoad(),r.prototype.onHandlerDestroying.call(this)},a.prototype.onHandlerDestroyed=function(){this.state=t.State.STOPPED,this.fragmentTracker=null},a}(a.default);t.default=l}).call(this,r(2).Number)},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(3),s=r(0),l=r(17),u=r(32),d=window.performance,f={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},c={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},h=function(t){function r(e){var r=t.call(this,e,a.default.MANIFEST_LOADING,a.default.LEVEL_LOADING,a.default.AUDIO_TRACK_LOADING,a.default.SUBTITLE_TRACK_LOADING)||this;return r.loaders={},r}return i(r,t),Object.defineProperty(r,"ContextType",{get:function(){return f},enumerable:!0,configurable:!0}),Object.defineProperty(r,"LevelType",{get:function(){return c},enumerable:!0,configurable:!0}),r.canHaveQualityLevels=function(e){return e!==f.AUDIO_TRACK&&e!==f.SUBTITLE_TRACK},r.mapContextToLevelType=function(e){switch(e.type){case f.AUDIO_TRACK:return c.AUDIO;case f.SUBTITLE_TRACK:return c.SUBTITLE;default:return c.MAIN}},r.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r},r.prototype.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,i=t.loader,a=new(r||i)(t);return e.loader=a,this.loaders[e.type]=a,a},r.prototype.getInternalLoader=function(e){return this.loaders[e.type]},r.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},r.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},r.prototype.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},r.prototype.onManifestLoading=function(e){this.load(e.url,{type:f.MANIFEST,level:0,id:null})},r.prototype.onLevelLoading=function(e){this.load(e.url,{type:f.LEVEL,level:e.level,id:e.id})},r.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:f.AUDIO_TRACK,level:null,id:e.id})},r.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:f.SUBTITLE_TRACK,level:null,id:e.id})},r.prototype.load=function(e,t){var r=this.hls.config;s.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var i,a,n,o,l=this.getInternalLoader(t);if(l){var u=l.context;if(u&&u.url===e)return s.logger.trace("playlist request ongoing"),!1;s.logger.warn("aborting previous loader for type: "+t.type),l.abort()}switch(t.type){case f.MANIFEST:i=r.manifestLoadingMaxRetry,a=r.manifestLoadingTimeOut,n=r.manifestLoadingRetryDelay,o=r.manifestLoadingMaxRetryTimeout;break;case f.LEVEL:i=0,a=r.levelLoadingTimeOut;break;default:i=r.levelLoadingMaxRetry,a=r.levelLoadingTimeOut,n=r.levelLoadingRetryDelay,o=r.levelLoadingMaxRetryTimeout}l=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"";var d={timeout:a,maxRetry:i,retryDelay:n,maxRetryDelay:o},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return s.logger.debug("Calling internal loader delegate for URL: "+e),l.load(t,d,c),!0},r.prototype.loadsuccess=function(e,t,r,i){if(void 0===i&&(i=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,i);this.resetInternalLoader(r.type);var a=e.data;t.tload=d.now(),0===a.indexOf("#EXTM3U")?a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,r,i):this._handleMasterPlaylist(e,t,r,i):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",i)},r.prototype.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},r.prototype.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},r.prototype._handleMasterPlaylist=function(e,t,i,n){var o=this.hls,l=e.data,d=r.getResponseUrl(e,i),f=u.default.parseMasterPlaylist(l,d);if(f.length){var c=f.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),h=u.default.parseMasterPlaylistMedia(l,d,"AUDIO",c),p=u.default.parseMasterPlaylistMedia(l,d,"SUBTITLES");if(h.length){var g=!1;h.forEach(function(e){e.url||(g=!0)}),!1===g&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(s.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main"}))}o.trigger(a.default.MANIFEST_LOADED,{levels:f,audioTracks:h,subtitles:p,url:d,stats:t,networkDetails:n})}else this._handleManifestParsingError(e,i,"no level found in manifest",n)},r.prototype._handleTrackOrLevelPlaylist=function(t,i,n,o){var s=this.hls,l=n.id,c=n.level,h=n.type,p=r.getResponseUrl(t,n),g=e.isFinite(l)?l:0,v=e.isFinite(c)?c:g,y=r.mapContextToLevelType(n),m=u.default.parseLevelPlaylist(t.data,p,v,y,g);if(m.tload=i.tload,h===f.MANIFEST){var E={url:p,details:m};s.trigger(a.default.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:p,stats:i,networkDetails:o})}if(i.tparsed=d.now(),m.needSidxRanges){var _=m.initSegment.url;this.load(_,{isSidxRequest:!0,type:h,level:c,levelDetails:m,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else n.levelDetails=m,this._handlePlaylistLoaded(t,i,n,o)},r.prototype._handleSidxRequest=function(e,t){var r=l.default.parseSegmentIndex(new Uint8Array(e.data));if(r){var i=r.references,a=t.levelDetails;i.forEach(function(e,t){var r=e.info,i=a.fragments[t];0===i.byteRange.length&&(i.rawByteRange=String(1+r.end-r.start)+"@"+String(r.start))}),a.initSegment.rawByteRange=String(r.moovEndOffset)+"@0"}},r.prototype._handleManifestParsingError=function(e,t,r,i){this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:i})},r.prototype._handleNetworkError=function(e,t,r,i){var n,l;void 0===r&&(r=!1),void 0===i&&(i=null),s.logger.info("A network error occured while loading a "+e.type+"-type playlist");var u=this.getInternalLoader(e);switch(e.type){case f.MANIFEST:n=r?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,l=!0;break;case f.LEVEL:n=r?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,l=!1;break;case f.AUDIO_TRACK:n=r?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,l=!1;break;default:l=!1}u&&(u.abort(),this.resetInternalLoader(e.type));var d={type:o.ErrorTypes.NETWORK_ERROR,details:n,fatal:l,url:u.url,loader:u,context:e,networkDetails:t};i&&(d.response=i),this.hls.trigger(a.default.ERROR,d)},r.prototype._handlePlaylistLoaded=function(e,t,i,n){var o=i.type,s=i.level,l=i.id,u=i.levelDetails;if(u.targetduration)if(r.canHaveQualityLevels(i.type))this.hls.trigger(a.default.LEVEL_LOADED,{details:u,level:s||0,id:l||0,stats:t,networkDetails:n});else switch(o){case f.AUDIO_TRACK:this.hls.trigger(a.default.AUDIO_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:n});break;case f.SUBTITLE_TRACK:this.hls.trigger(a.default.SUBTITLE_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:n})}else this._handleManifestParsingError(e,i,"invalid target duration",n)},r}(n.default);t.default=h}).call(this,r(2).Number)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(1),n=Math.pow(2,32)-1,o=function(){function e(e,t){this.observer=e,this.remuxer=t}return e.prototype.resetTimeStamp=function(e){this.initPTS=e},e.prototype.resetInitSegment=function(t,r,i,n){if(t&&t.byteLength){var o=this.initData=e.parseInitSegment(t);null==r&&(r="mp4a.40.5"),null==i&&(i="avc1.42e01e");var s={};o.audio&&o.video?s.audiovideo={container:"video/mp4",codec:r+","+i,initSegment:n?t:null}:(o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:n?t:null}),o.video&&(s.video={container:"video/mp4",codec:i,initSegment:n?t:null})),this.observer.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),i&&(this.videoCodec=i)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var i,a,n,o,s,l,u,d=[];if(t.data?(l=t.start,o=t.end,t=t.data):(l=0,o=t.byteLength),!r.length)return null;for(i=l;i<o;)a=e.readUint32(t,i),n=e.bin2str(t.subarray(i+4,i+8)),u=a>1?i+a:o,n===r[0]&&(1===r.length?d.push({data:t,start:i+8,end:u}):(s=e.findBox({data:t,start:i+8,end:u},r.slice(1))).length&&(d=d.concat(s))),i=u;return d},e.parseSegmentIndex=function(t){var r,i=e.findBox(t,["moov"])[0],a=i?i.end:null,n=0,o=e.findBox(t,["sidx"]);if(!o||!o[0])return null;r=[];var s=(o=o[0]).data[0];n=0===s?8:16;var l=e.readUint32(o,n);n+=4;n+=0===s?8:16,n+=2;var u=o.end+0,d=e.readUint16(o,n);n+=2;for(var f=0;f<d;f++){var c=n,h=e.readUint32(o,c);c+=4;var p=2147483647&h;if(1===(2147483648&h)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=e.readUint32(o,c);c+=4,r.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/l,start:u,end:u+p-1}}),u+=p,n=c+=4}return{earliestPresentationTime:0,timescale:l,version:s,referencesCount:d,references:r,moovEndOffset:a}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach(function(t){var a=e.findBox(t,["tkhd"])[0];if(a){var n=a.data[a.start],o=0===n?12:20,s=e.readUint32(a,o),l=e.findBox(t,["mdia","mdhd"])[0];if(l){o=0===(n=l.data[l.start])?12:20;var u=e.readUint32(l,o),d=e.findBox(t,["mdia","hdlr"])[0];if(d){var f={soun:"audio",vide:"video"}[e.bin2str(d.data.subarray(d.start+8,d.start+12))];if(f){var c=e.findBox(t,["mdia","minf","stbl","stsd"]);if(c.length){c=c[0];var h=e.bin2str(c.data.subarray(c.start+12,c.start+16));i.logger.log("MP4Demuxer:"+f+":"+h+" found")}r[s]={timescale:u,type:f},r[f]={timescale:u,id:s}}}}}}),r},e.getStartDTS=function(t,r){var i,a,n;return i=e.findBox(r,["moof","traf"]),a=[].concat.apply([],i.map(function(r){return e.findBox(r,["tfhd"]).map(function(i){var a,n;return a=e.readUint32(i,4),n=t[a].timescale||9e4,e.findBox(r,["tfdt"]).map(function(t){var r,i;return r=t.data[t.start],i=e.readUint32(t,4),1===r&&(i*=Math.pow(2,32),i+=e.readUint32(t,8)),i})[0]/n})})),n=Math.min.apply(null,a),isFinite(n)?n:0},e.offsetStartDTS=function(t,r,i){e.findBox(r,["moof","traf"]).map(function(r){return e.findBox(r,["tfhd"]).map(function(a){var o=e.readUint32(a,4),s=t[o].timescale||9e4;e.findBox(r,["tfdt"]).map(function(t){var r=t.data[t.start],a=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,a-i*s);else{a*=Math.pow(2,32),a+=e.readUint32(t,8),a-=i*s,a=Math.max(a,0);var o=Math.floor(a/(n+1)),l=Math.floor(a%(n+1));e.writeUint32(t,4,o),e.writeUint32(t,8,l)}})})})},e.prototype.append=function(t,r,i,n){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),o=this.initData);var s,l=this.initPTS;if(void 0===l){var u=e.getStartDTS(o,t);this.initPTS=l=u-r,this.observer.trigger(a.default.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(o,t,l),s=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,s,i,n,t)},e.prototype.destroy=function(){},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(9),a=function(){function e(){this.method=null,this.key=null,this.iv=null,this._uri=null}return Object.defineProperty(e.prototype,"uri",{get:function(){return!this._uri&&this.reluri&&(this._uri=i.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri},enumerable:!0,configurable:!0}),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};t.isCodecType=function(e,t){var r=i[t];return!!r&&!0===r[e.slice(0,4)]},t.isCodecSupportedInMp4=function(e,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r(38),a=r(1),n=r(21),o=r(0),s=r(3),l=r(14),u=r(6),d=r(24),f=u.getSelfScope(),c=l.getMediaSource(),h=function(){function t(e,t){var r=this;this.hls=e,this.id=t;var l=this.observer=new d.Observer,u=e.config,h=function(t,i){(i=i||{}).frag=r.frag,i.id=r.id,e.trigger(t,i)};l.on(a.default.FRAG_DECRYPTED,h),l.on(a.default.FRAG_PARSING_INIT_SEGMENT,h),l.on(a.default.FRAG_PARSING_DATA,h),l.on(a.default.FRAG_PARSED,h),l.on(a.default.ERROR,h),l.on(a.default.FRAG_PARSING_METADATA,h),l.on(a.default.FRAG_PARSING_USERDATA,h),l.on(a.default.INIT_PTS_FOUND,h);var p={mp4:c.isTypeSupported("video/mp4"),mpeg:c.isTypeSupported("audio/mpeg"),mp3:c.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(u.enableWorker&&"undefined"!=typeof Worker){o.logger.log("demuxing in webworker");var v=void 0;try{v=this.w=i(52),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(t){e.trigger(a.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},v.postMessage({cmd:"init",typeSupported:p,vendor:g,id:t,config:JSON.stringify(u)})}catch(e){o.logger.warn("Error in worker:",e),o.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),v&&f.URL.revokeObjectURL(v.objectURL),this.demuxer=new n.default(l,p,u,g),this.w=void 0}}else this.demuxer=new n.default(l,p,u,g)}return t.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.prototype.push=function(t,r,i,a,n,s,l,u){var d=this.w,f=e.isFinite(n.startPTS)?n.startPTS:n.start,c=n.decryptdata,h=this.frag,p=!(h&&n.cc===h.cc),g=!(h&&n.level===h.level),v=h&&n.sn===h.sn+1,y=!g&&v;if(p&&o.logger.log(this.id+":discontinuity detected"),g&&o.logger.log(this.id+":switch detected"),this.frag=n,d)d.postMessage({cmd:"demux",data:t,decryptdata:c,initSegment:r,audioCodec:i,videoCodec:a,timeOffset:f,discontinuity:p,trackSwitch:g,contiguous:y,duration:s,accurateTimeOffset:l,defaultInitPTS:u},t instanceof ArrayBuffer?[t]:[]);else{var m=this.demuxer;m&&m.push(t,c,r,i,a,f,p,g,y,s,l,u)}},t.prototype.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":f.URL.revokeObjectURL(this.w.objectURL);break;case a.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},t}();t.default=h}).call(this,r(2).Number)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=r(1),n=r(3),o=r(13),s=r(42),l=r(17),u=r(43),d=r(46),f=r(47),c=r(50),h=r(6),p=r(0),g=h.getSelfScope();try{i=g.performance.now.bind(g.performance)}catch(e){p.logger.debug("Unable to use Performance API on this environment"),i=g.Date.now}var v=function(){function e(e,t,r,i){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=i}return e.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},e.prototype.push=function(e,t,r,n,s,l,u,d,f,c,h,p){var g=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var v=this.decrypter;null==v&&(v=this.decrypter=new o.default(this.observer,this.config));var y=i();v.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var o=i();g.observer.trigger(a.default.FRAG_DECRYPTED,{stats:{tstart:y,tdecrypt:o}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,s,l,u,d,f,c,h,p)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,s,l,u,d,f,c,h,p)},e.prototype.pushDecrypted=function(e,t,r,i,o,h,p,g,v,y,m,E){var _=this.demuxer;if(!_||(p||g)&&!this.probe(e)){for(var T=this.observer,S=this.typeSupported,b=this.config,A=[{demux:u.default,remux:f.default},{demux:l.default,remux:c.default},{demux:s.default,remux:f.default},{demux:d.default,remux:f.default}],R=0,D=A.length;R<D;R++){var L=A[R],w=L.demux.probe;if(w(e)){var O=this.remuxer=new L.remux(T,b,S,this.vendor);_=new L.demux(T,O,b,S),this.probe=w;break}}if(!_)return void T.trigger(a.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=_}var I=this.remuxer;(p||g)&&(_.resetInitSegment(r,i,o,y),I.resetInitSegment()),p&&(_.resetTimeStamp(E),I.resetTimeStamp(E)),"function"==typeof _.setDecryptData&&_.setDecryptData(t),_.append(e,h,v,m)},e}();t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(3),n=r(1);function o(e,t,r,o){var s,l,u,d,f,c=navigator.userAgent.toLowerCase(),h=o,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[r+2])>>>6),!((l=(60&t[r+2])>>>2)>p.length-1))return d=(1&t[r+2])<<2,d|=(192&t[r+3])>>>6,i.logger.log("manifest codec:"+o+",ADTS data:type:"+s+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+d),/firefox/i.test(c)?l>=6?(s=5,f=new Array(4),u=l-3):(s=2,f=new Array(2),u=l):-1!==c.indexOf("android")?(s=2,f=new Array(2),u=l):(s=5,f=new Array(4),o&&(-1!==o.indexOf("mp4a.40.29")||-1!==o.indexOf("mp4a.40.5"))||!o&&l>=6?u=l-3:((o&&-1!==o.indexOf("mp4a.40.2")&&(l>=6&&1===d||/vivaldi/i.test(c))||!o&&1===d)&&(s=2,f=new Array(2)),u=l)),f[0]=s<<3,f[0]|=(14&l)>>1,f[1]|=(1&l)<<7,f[1]|=d<<3,5===s&&(f[1]|=(14&u)>>1,f[2]=(1&u)<<7,f[2]|=8,f[3]=0),{config:f,samplerate:p[l],channelCount:d,codec:"mp4a.40."+s,manifestCodec:h};e.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}function s(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function u(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function d(e){return 9216e4/e}function f(e,t,r,i,a){var n,o,s=e.length;if(n=l(e,t),o=u(e,t),(o-=n)>0&&t+n+o<=s)return{headerLength:n,frameLength:o,stamp:r+i*a}}t.getAudioConfig=o,t.isHeaderPattern=s,t.getHeaderLength=l,t.getFullFrameLength=u,t.isHeader=function(e,t){return!!(t+1<e.length&&s(e,t))},t.probe=function(e,t){if(t+1<e.length&&s(e,t)){var r=l(e,t);t+5<e.length&&(r=u(e,t));var i=t+r;if(i===e.length||i+1<e.length&&s(e,i))return!0}return!1},t.initTrackConfig=function(e,t,r,a,n){if(!e.samplerate){var s=o(t,r,a,n);e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,i.logger.log("parsed codec:"+e.codec+",rate:"+s.samplerate+",nb channel:"+s.channelCount)}},t.getFrameDuration=d,t.parseFrameHeader=f,t.appendFrame=function(e,t,r,i,a){var n=f(t,r,i,a,d(e.samplerate));if(n){var o=n.stamp,s=n.headerLength,l=n.frameLength,u={unit:t.subarray(r+s,r+s+l),pts:o,dts:o};return e.samples.push(u),e.len+=l,{sample:u,length:l+s}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,i,a){if(!(r+24>t.length)){var n=this.parseHeader(t,r);if(n&&r+n.frameLength<=t.length){var o=i+a*(9e4*n.samplesPerFrame/n.sampleRate),s={unit:t.subarray(r,r+n.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=n.channelCount,e.samplerate=n.sampleRate,e.samples.push(s),e.len+=n.frameLength,{sample:s,length:n.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,a=e[t+1]>>1&3,n=e[t+2]>>4&15,o=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!==r&&0!==n&&15!==n&&3!==o){var l=3===r?3-a:3===a?3:4,u=1e3*i.BitratesMap[14*l+n-1],d=3===r?0:2===r?1:2,f=i.SamplingRateMap[3*d+o],c=e[t+3]>>6==3?1:2,h=i.SamplesCoefficients[r][a],p=i.BytesInSlot[a],g=8*h*p;return{sampleRate:f,channelCount:c,frameLength:parseInt(h*u/f+s,10)*p,samplesPerFrame:g}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),i=4;r&&r.frameLength&&(i=r.frameLength);var a=t+i;if(a===e.length||a+1<e.length&&this.isHeaderPattern(e,a))return!0}return!1}};t.default=i},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.emit.apply(this,[e,e].concat(t))},t}(r(51).EventEmitter);t.Observer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={toString:function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i).toFixed(3)+","+e.end(i).toFixed(3)+"]";return t}}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r(10),a=r(0);function n(e,t){for(var r=null,i=0;i<e.length;i+=1){var a=e[i];if(a&&a.cc===t){r=a;break}}return r}function o(e,t,r){var i=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(i=!0),i}function s(e,t){var r=e.fragments,i=t.fragments;if(i.length&&r.length){var o=n(r,i[0].cc);if(o&&(!o||o.startPTS))return o;a.logger.log("No frag in previous level to align on")}else a.logger.log("No fragments to align")}function l(e,t){t.fragments.forEach(function(t){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}}),t.PTSKnown=!0}function u(e,t,r){if(o(e,r,t)){var i=s(r.details,t);i&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level"),l(i.start,t))}}function d(t,r){if(r&&r.fragments.length){if(!t.hasProgramDateTime||!r.hasProgramDateTime)return;var i=r.fragments[0].programDateTime,n=(t.fragments[0].programDateTime-i)/1e3+r.fragments[0].start;e.isFinite(n)&&(a.logger.log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3)),l(n,t))}}t.findFirstFragWithCC=n,t.findFragWithCC=function(e,t){return i.default.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})},t.shouldAlignOnDiscontinuities=o,t.findDiscontinuousReferenceFrag=s,t.adjustPts=l,t.alignStream=function(e,t,r){u(e,r,t),!r.PTSKnown&&t&&d(r,t.details)},t.alignDiscontinuities=u,t.alignPDT=d}).call(this,r(2).Number)},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r(10);function a(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=e?1:r.start-i>e&&r.start?-1:0}function n(e,t,r){var i=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.endProgramDateTime-i>e}t.findFragmentByPDT=function(t,r,i){if(!Array.isArray(t)||!t.length||!e.isFinite(r))return null;if(r<t[0].programDateTime)return null;if(r>=t[t.length-1].endProgramDateTime)return null;i=i||0;for(var a=0;a<t.length;++a){var o=t[a];if(n(r,i,o))return o}return null},t.findFragmentByPTS=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var o=e?t[e.sn-t[0].sn+1]:null;return o&&!a(r,n,o)?o:i.default.search(t,a.bind(null,r,n))},t.fragmentWithinToleranceTest=a,t.pdtWithinToleranceTest=n}).call(this,r(2).Number)},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=e.apply(this,[t].concat(r))||this;return a._tickInterval=null,a._tickTimer=null,a._tickCallCount=0,a._boundTick=a.tick.bind(a),a}return i(t,e),t.prototype.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.prototype.hasInterval=function(){return!!this._tickInterval},t.prototype.hasNextTick=function(){return!!this._tickTimer},t.prototype.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,e),!0)},t.prototype.clearInterval=function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.prototype.clearNextTick=function(){return!!this._tickTimer&&(clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.prototype.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},t.prototype.doTick=function(){},t}(r(4).default);t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendAddTrackEvent=function(e,t){var r=null;try{r=new window.Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)},t.clearCurrentCues=function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(69),a=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function n(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new a,this.regionList=[]}function o(){this.values=Object.create(null)}function s(e,t,r,i){var a=i?e.split(i):[e];for(var n in a)if("string"==typeof a[n]){var o=a[n].split(r);if(2===o.length)t(o[0],o[1])}}o.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var l=new i.default(0,0,0),u="middle"===l.align?"middle":"center";function d(e,t,r){var i=e;function a(){var t=function(e){function t(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function n(){e=e.replace(/^\s+/,"")}if(n(),t.startTime=a(),n(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.substr(3),n(),t.endTime=a(),n(),function(e,t){var i=new o;s(e,function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){i.set(e,r[a].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var n=t.split(","),o=n[0];i.integer(e,o),i.percent(e,o)&&i.set("snapToLines",!1),i.alt(e,o,["auto"]),2===n.length&&i.alt("lineAlign",n[1],["start",u,"end"]);break;case"position":n=t.split(","),i.percent(e,n[0]),2===n.length&&i.alt("positionAlign",n[1],["start",u,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",u,"end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");var a=i.get("line","auto");"auto"===a&&-1===l.line&&(a=-1),t.line=a,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",u);var n=i.get("position","auto");"auto"===n&&50===l.position&&(n="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=n}(e,t)}function f(e){return e.replace(/<br(?: \/)?>/gi,"\n")}t.fixLineBreaks=f,n.prototype={parse:function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=f(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var i=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),i}function a(e){s(e,function(e,t){e},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n=void 0;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var o=(n=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var l=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(l?l=!1:n=r(),t.state){case"HEADER":/:/.test(n)?a(n):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new i.default(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":try{d(n,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var u=-1!==n.indexOf("--\x3e");if(!n||u&&(l=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}},t.default=n},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(9),n=r(3),o=r(16),s=r(35),l=r(36),u=r(7),d=r(37),f=r(55),c=r(56),h=r(57),p=r(0),g=r(58),v=r(1),y=function(e){function t(r){void 0===r&&(r={});var i=e.call(this)||this,a=t.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in a)n in r||(r[n]=a[n]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');p.enableLogs(r.debug),i.config=r,i._autoLevelCapping=-1;var h=i.abrController=new r.abrController(i),g=new r.bufferController(i),v=new r.capLevelController(i),y=new r.fpsController(i),m=new o.default(i),E=new s.default(i),_=new l.default(i),T=new c.default(i),S=i.levelController=new f.default(i),b=new u.FragmentTracker(i),A=[S,i.streamController=new d.default(i,b)],R=r.audioStreamController;R&&A.push(new R(i,b)),i.networkControllers=A;var D=[m,E,_,h,g,v,y,T,b];if(R=r.audioTrackController){var L=new R(i);i.audioTrackController=L,D.push(L)}if(R=r.subtitleTrackController){var w=new R(i);i.subtitleTrackController=w,A.push(w)}if(R=r.emeController){var O=new R(i);i.emeController=O,D.push(O)}return(R=r.subtitleStreamController)&&A.push(new R(i,b)),(R=r.timelineController)&&D.push(new R(i)),i.coreComponents=D,i}return i(t,e),Object.defineProperty(t,"version",{get:function(){return"0.12.4"},enumerable:!0,configurable:!0}),t.isSupported=function(){return h.isSupported()},Object.defineProperty(t,"Events",{get:function(){return v.default},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorTypes",{get:function(){return n.ErrorTypes},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorDetails",{get:function(){return n.ErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DefaultConfig",{get:function(){return t.defaultConfig?t.defaultConfig:g.hlsDefaultConfig},set:function(e){t.defaultConfig=e},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){p.logger.log("destroy"),this.trigger(v.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},t.prototype.attachMedia=function(e){p.logger.log("attachMedia"),this.media=e,this.trigger(v.default.MEDIA_ATTACHING,{media:e})},t.prototype.detachMedia=function(){p.logger.log("detachMedia"),this.trigger(v.default.MEDIA_DETACHING),this.media=null},t.prototype.loadSource=function(e){e=a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),p.logger.log("loadSource:"+e),this.url=e,this.trigger(v.default.MANIFEST_LOADING,{url:e})},t.prototype.startLoad=function(e){void 0===e&&(e=-1),p.logger.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})},t.prototype.stopLoad=function(){p.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},t.prototype.swapAudioCodec=function(){p.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.prototype.recoverMediaError=function(){p.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},Object.defineProperty(t.prototype,"levels",{get:function(){return this.levelController.levels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLevel",{get:function(){return this.streamController.currentLevel},set:function(e){p.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextLevel",{get:function(){return this.streamController.nextLevel},set:function(e){p.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loadLevel",{get:function(){return this.levelController.level},set:function(e){p.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextLoadLevel",{get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLevel",{get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){p.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLevel",{get:function(){return this.levelController.startLevel},set:function(e){p.logger.log("set startLevel:"+e);-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLevelCapping",{get:function(){return this._autoLevelCapping},set:function(e){p.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLevelEnabled",{get:function(){return-1===this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"manualLevel",{get:function(){return this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minAutoLevel",{get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,i=0;i<r;i++){if((e[i].realBitrate?Math.max(e[i].realBitrate,e[i].bitrate):e[i].bitrate)>t)return i}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxAutoLevel",{get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextAutoLevel",{get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTracks",{get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTrack",{get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"liveSyncPosition",{get:function(){return this.streamController.liveSyncPosition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleTracks",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleTrack",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleDisplay",{get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)},enumerable:!0,configurable:!0}),t}(r(24).Observer);t.default=y},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r(9),a=r(12),n=r(33),o=r(18),s=r(34),l=r(0),u=r(19),d=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,f=/#EXT-X-MEDIA:(.*)/g,c=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),h=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,p=/\.(mp4|m4s|m4v|m4a)$/i,g=function(){function t(){}return t.findGroup=function(e,t){if(!e)return null;for(var r=null,i=0;i<e.length;i++){var a=e[i];a.id===t&&(r=a)}return r},t.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},t.resolve=function(e,t){return i.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,r){var i,a=[];function n(e,t){["video","audio"].forEach(function(r){var i=e.filter(function(e){return u.isCodecType(e,r)});if(i.length){var a=i.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});t[r+"Codec"]=a.length>0?a[0]:i[0],e=e.filter(function(e){return-1===i.indexOf(e)})}}),t.unknownCodecs=e}for(d.lastIndex=0;null!=(i=d.exec(e));){var o={},l=o.attrs=new s.default(i[1]);o.url=t.resolve(i[2],r);var f=l.decimalResolution("RESOLUTION");f&&(o.width=f.width,o.height=f.height),o.bitrate=l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),o.name=l.NAME,n([].concat((l.CODECS||"").split(/[ ,]+/)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=t.convertAVC1ToAVCOTI(o.videoCodec)),a.push(o)}return a},t.parseMasterPlaylistMedia=function(e,r,i,a){var n;void 0===a&&(a=[]);var o=[],l=0;for(f.lastIndex=0;null!==(n=f.exec(e));){var u={},d=new s.default(n[1]);if(d.TYPE===i){if(u.groupId=d["GROUP-ID"],u.name=d.NAME,u.type=i,u.default="YES"===d.DEFAULT,u.autoselect="YES"===d.AUTOSELECT,u.forced="YES"===d.FORCED,d.URI&&(u.url=t.resolve(d.URI,r)),u.lang=d.LANGUAGE,u.name||(u.name=u.lang),a.length){var c=t.findGroup(a,u.groupId);u.audioCodec=c?c.codec:a[0].codec}u.id=l++,o.push(u)}}return o},t.parseLevelPlaylist=function(t,r,i,u,d){var f,g,y=0,m=0,E=new n.default(r),_=new o.default,T=0,S=null,b=new a.default,A=null;for(c.lastIndex=0;null!==(f=c.exec(t));){var R=f[1];if(R){b.duration=parseFloat(R);var D=(" "+f[2]).slice(1);b.title=D||null,b.tagList.push(D?["INF",R,D]:["INF",R])}else if(f[3]){if(e.isFinite(b.duration)){var L=y++;b.type=u,b.start=m,b.levelkey=_,b.sn=L,b.level=i,b.cc=T,b.urlId=d,b.baseurl=r,b.relurl=(" "+f[3]).slice(1),v(b,S),E.fragments.push(b),S=b,m+=b.duration,b=new a.default}}else if(f[4]){if(b.rawByteRange=(" "+f[4]).slice(1),S){var w=S.byteRangeEndOffset;w&&(b.lastByteRangeEndOffset=w)}}else if(f[5])b.rawProgramDateTime=(" "+f[5]).slice(1),b.tagList.push(["PROGRAM-DATE-TIME",b.rawProgramDateTime]),null===A&&(A=E.fragments.length);else{for(f=f[0].match(h),g=1;g<f.length&&void 0===f[g];g++);var O=(" "+f[g+1]).slice(1),I=(" "+f[g+2]).slice(1);switch(f[g]){case"#":b.tagList.push(I?[O,I]:[O]);break;case"PLAYLIST-TYPE":E.type=O.toUpperCase();break;case"MEDIA-SEQUENCE":y=E.startSN=parseInt(O);break;case"TARGETDURATION":E.targetduration=parseFloat(O);break;case"VERSION":E.version=parseInt(O);break;case"EXTM3U":break;case"ENDLIST":E.live=!1;break;case"DIS":T++,b.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":T=parseInt(O);break;case"KEY":var P=O,k=new s.default(P),C=k.enumeratedString("METHOD"),F=k.URI,x=k.hexadecimalInteger("IV");C&&(_=new o.default,F&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(C)>=0&&(_.method=C,_.baseuri=r,_.reluri=F,_.key=null,_.iv=x));break;case"START":var M=O,N=new s.default(M).decimalFloatingPoint("TIME-OFFSET");e.isFinite(N)&&(E.startTimeOffset=N);break;case"MAP":var U=new s.default(O);b.relurl=U.URI,b.rawByteRange=U.BYTERANGE,b.baseurl=r,b.level=i,b.type=u,b.sn="initSegment",E.initSegment=b,(b=new a.default).rawProgramDateTime=E.initSegment.rawProgramDateTime;break;default:l.logger.warn("line parsed but not handled: "+f)}}}return(b=S)&&!b.relurl&&(E.fragments.pop(),m-=b.duration),E.totalduration=m,E.averagetargetduration=m/E.fragments.length,E.endSN=y-1,E.startCC=E.fragments[0]?E.fragments[0].cc:0,E.endCC=T,!E.initSegment&&E.fragments.length&&E.fragments.every(function(e){return p.test(e.relurl)})&&(l.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(b=new a.default).relurl=E.fragments[0].relurl,b.baseurl=r,b.level=i,b.type=u,b.sn="initSegment",E.initSegment=b,E.needSidxRanges=!0),A&&function(e,t){for(var r=e[t],i=t-1;i>=0;i--){var a=e[i];a.programDateTime=r.programDateTime-1e3*a.duration,r=a}}(E.fragments,A),E},t}();function v(t,r){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):r&&r.programDateTime&&(t.programDateTime=r.endProgramDateTime),e.isFinite(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}t.default=g}).call(this,r(2).Number)},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}return Object.defineProperty(t.prototype,"hasProgramDateTime",{get:function(){return!(!this.fragments[0]||!e.isFinite(this.fragments[0].programDateTime))},enumerable:!0,configurable:!0}),t}();t.default=r}).call(this,r(2).Number)},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,a=function(){function t(e){for(var r in"string"==typeof e&&(e=t.parseAttrList(e)),e)e.hasOwnProperty(r)&&(this[r]=e[r])}return t.prototype.decimalInteger=function(t){var r=parseInt(this[t],10);return r>e.MAX_SAFE_INTEGER?1/0:r},t.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},t.prototype.hexadecimalIntegerAsNumber=function(t){var r=parseInt(this[t],16);return r>e.MAX_SAFE_INTEGER?1/0:r},t.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.prototype.enumeratedString=function(e){return this[e]},t.prototype.decimalResolution=function(e){var t=r.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},t.parseAttrList=function(e){var t,r={};for(i.lastIndex=0;null!==(t=i.exec(e));){var a=t[2];0===a.indexOf('"')&&a.lastIndexOf('"')===a.length-1&&(a=a.slice(1,-1)),r[t[1]]=a}return r},t}();t.default=a}).call(this,r(2).Number)},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(3),s=r(0),l=function(t){function r(e){var r=t.call(this,e,a.default.FRAG_LOADING)||this;return r.loaders={},r}return i(r,t),r.prototype.destroy=function(){var e=this.loaders;for(var r in e){var i=e[r];i&&i.destroy()}this.loaders={},t.prototype.destroy.call(this)},r.prototype.onFragLoading=function(t){var r=t.frag,i=r.type,a=this.loaders,n=this.hls.config,o=n.fLoader,l=n.loader;r.loaded=0;var u,d,f,c=a[i];c&&(s.logger.warn("abort previous fragment loader for type: "+i),c.abort()),c=a[i]=r.loader=n.fLoader?new o(n):new l(n),u={url:r.url,frag:r,responseType:"arraybuffer",progressData:!1};var h=r.byteRangeStartOffset,p=r.byteRangeEndOffset;e.isFinite(h)&&e.isFinite(p)&&(u.rangeStart=h,u.rangeEnd=p),d={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},c.load(u,d,f)},r.prototype.loadsuccess=function(e,t,r,i){void 0===i&&(i=null);var n=e.data,o=r.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(a.default.FRAG_LOADED,{payload:n,frag:o,stats:t,networkDetails:i})},r.prototype.loaderror=function(e,t,r){void 0===r&&(r=null);var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},r.prototype.loadtimeout=function(e,t,r){void 0===r&&(r=null);var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},r.prototype.loadprogress=function(e,t,r,i){void 0===i&&(i=null);var n=t.frag;n.loaded=e.loaded,this.hls.trigger(a.default.FRAG_LOAD_PROGRESS,{frag:n,stats:e,networkDetails:i})},r}(n.default);t.default=l}).call(this,r(2).Number)},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(3),s=r(0),l=function(e){function t(t){var r=e.call(this,t,a.default.KEY_LOADING)||this;return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return i(t,e),t.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},n.default.prototype.destroy.call(this)},t.prototype.onKeyLoading=function(e){var t=e.frag,r=t.type,i=this.loaders[r],n=t.decryptdata,o=n.uri;if(o!==this.decrypturl||null===this.decryptkey){var l=this.hls.config;i&&(s.logger.warn("abort previous key loader for type:"+r),i.abort()),t.loader=this.loaders[r]=new l.loader(l),this.decrypturl=o,this.decryptkey=null;var u,d,f;u={url:o,frag:t,responseType:"arraybuffer"},d={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:l.fragLoadingRetryDelay,maxRetryDelay:l.fragLoadingMaxRetryTimeout},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(u,d,f)}else this.decryptkey&&(n.key=this.decryptkey,this.hls.trigger(a.default.KEY_LOADED,{frag:t}))},t.prototype.loadsuccess=function(e,t,r){var i=r.frag;this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(a.default.KEY_LOADED,{frag:i})},t.prototype.loaderror=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},t.prototype.loadtimeout=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},t}(n.default);t.default=l},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(10),n=r(5),o=r(20),s=r(1),l=r(7),u=r(12),d=r(16),f=r(8),c=r(25),h=r(3),p=r(0),g=r(26),v=r(27),y=r(54),m=r(15),E=function(t){function r(e,r){var i=t.call(this,e,s.default.MEDIA_ATTACHED,s.default.MEDIA_DETACHING,s.default.MANIFEST_LOADING,s.default.MANIFEST_PARSED,s.default.LEVEL_LOADED,s.default.KEY_LOADED,s.default.FRAG_LOADED,s.default.FRAG_LOAD_EMERGENCY_ABORTED,s.default.FRAG_PARSING_INIT_SEGMENT,s.default.FRAG_PARSING_DATA,s.default.FRAG_PARSED,s.default.ERROR,s.default.AUDIO_TRACK_SWITCHING,s.default.AUDIO_TRACK_SWITCHED,s.default.BUFFER_CREATED,s.default.BUFFER_APPENDED,s.default.BUFFER_FLUSHED)||this;return i.fragmentTracker=r,i.config=e.config,i.audioCodecSwap=!1,i._state=m.State.STOPPED,i.stallReported=!1,i.gapController=null,i}return i(r,t),r.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=r.startLevel;-1===i&&(i=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}t>0&&-1===e&&(p.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=m.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=m.State.STOPPED},r.prototype.stopLoad=function(){this.forceStartLoad=!1,t.prototype.stopLoad.call(this)},r.prototype.doTick=function(){switch(this.state){case m.State.BUFFER_FLUSHING:this.fragLoadError=0;break;case m.State.IDLE:this._doTickIdle();break;case m.State.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=m.State.IDLE);break;case m.State.FRAG_LOADING_WAITING_RETRY:var t=window.performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(p.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=m.State.IDLE);break;case m.State.ERROR:case m.State.STOPPED:case m.State.FRAG_LOADING:case m.State.PARSING:case m.State.PARSED:case m.State.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},r.prototype._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch)){var i;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var a=e.nextLoadLevel,o=this.levels[a];if(o){var l,u=o.bitrate;l=u?Math.max(8*t.maxBufferSize/u,t.maxBufferLength):t.maxBufferLength,l=Math.min(l,t.maxMaxBufferLength);var d=n.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,t.maxBufferHole),f=d.len;if(!(f>=l)){p.logger.trace("buffer length of "+f.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=a;var c=o.details;if(!c||c.live&&this.levelLastLoaded!==a)this.state=m.State.WAITING_LEVEL;else{if(this._streamEnded(d,c)){var h={};return this.altAudio&&(h.type="video"),this.hls.trigger(s.default.BUFFER_EOS,h),void(this.state=m.State.ENDED)}this._fetchPayloadOrEos(i,d,c)}}}}},r.prototype._fetchPayloadOrEos=function(e,t,r){var i=this.fragPrevious,a=this.level,n=r.fragments,o=n.length;if(0!==o){var s,l=n[0].start,u=n[o-1].start+n[o-1].duration,d=t.end;if(r.initSegment&&!r.initSegment.data)s=r.initSegment;else if(r.live){var f=this.config.initialLiveManifestSize;if(o<f)return void p.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+f);if(null===(s=this._ensureFragmentAtLivePoint(r,d,l,u,i,n,o)))return}else d<l&&(s=n[0]);s||(s=this._findFragment(l,i,o,n,d,u,r)),s&&(s.encrypted?(p.logger.log("Loading key for "+s.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+a),this._loadKey(s)):(p.logger.log("Loading "+s.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+a+", currentTime:"+e.toFixed(3)+",bufferEnd:"+d.toFixed(3)),this._loadFragment(s)))}},r.prototype._ensureFragmentAtLivePoint=function(e,t,r,i,n,o,s){var l,u=this.hls.config,d=this.media,f=void 0!==u.liveMaxLatencyDuration?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-u.maxFragLookUpTolerance,i-f)){var c=this.liveSyncPosition=this.computeLivePosition(r,e);p.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),t=c,d&&d.readyState&&d.duration>c&&(d.currentTime=c),this.nextLoadPosition=c}if(e.PTSKnown&&t>i&&d&&d.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(n)if(e.hasProgramDateTime)p.logger.log("live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),l=v.findFragmentByPDT(o,n.endProgramDateTime,u.maxFragLookUpTolerance);else{var h=n.sn+1;if(h>=e.startSN&&h<=e.endSN){var g=o[h-e.startSN];n.cc===g.cc&&(l=g,p.logger.log("live playlist, switching playlist, load frag with next SN: "+l.sn))}l||(l=a.default.search(o,function(e){return n.cc-e.cc}))&&p.logger.log("live playlist, switching playlist, load frag with same CC: "+l.sn)}l||(l=o[Math.min(s-1,Math.round(s/2))],p.logger.log("live playlist, switching playlist, unknown, load middle frag : "+l.sn))}return l},r.prototype._findFragment=function(e,t,r,i,a,n,o){var s,l=this.hls.config;if(a<n){var u=a>n-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance;s=v.findFragmentByPTS(t,i,a,u)}else s=i[r-1];if(s){var d=s.sn-o.startSN,f=t&&s.level===t.level,c=i[d-1],h=i[d+1];if(t&&s.sn===t.sn)if(f&&!s.backtracked)if(s.sn<o.endSN){var g=t.deltaPTS;g&&g>l.maxBufferHole&&t.dropped&&d?(s=c,p.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(s=h,p.logger.log("SN just loaded, load next one: "+s.sn,s))}else s=null;else s.backtracked&&(h&&h.backtracked?(p.logger.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+h.sn),s=h):(p.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),s.dropped=0,c?(s=c).backtracked=!0:d&&(s=null)))}return s},r.prototype._loadKey=function(e){this.state=m.State.KEY_LOADING,this.hls.trigger(s.default.KEY_LOADING,{frag:e})},r.prototype._loadFragment=function(t){var r=this.fragmentTracker.getState(t);this.fragCurrent=t,this.startFragRequested=!0,e.isFinite(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),t.backtracked||r===l.FragmentState.NOT_LOADED||r===l.FragmentState.PARTIAL?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.hls.trigger(s.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new o.default(this.hls,"main")),this.state=m.State.FRAG_LOADING):r===l.FragmentState.APPENDING&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(e){if(this.state!==e){var t=this.state;this._state=e,p.logger.log("main stream:"+t+"->"+e),this.hls.trigger(s.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},enumerable:!0,configurable:!0}),r.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,d.default.LevelType.MAIN)},Object.defineProperty(r.prototype,"currentLevel",{get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"nextBufferedFrag",{get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null},enumerable:!0,configurable:!0}),r.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},Object.defineProperty(r.prototype,"nextLevel",{get:function(){var e=this.nextBufferedFrag;return e?e.level:-1},enumerable:!0,configurable:!0}),r.prototype._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),n.BufferHelper.isBuffered(r,t)?e=this.getBufferedFrag(t):n.BufferHelper.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var i=e;if(i!==this.fragPlaying){this.hls.trigger(s.default.FRAG_CHANGED,{frag:i});var a=i.level;this.fragPlaying&&this.fragPlaying.level===a||this.hls.trigger(s.default.LEVEL_SWITCHED,{level:a}),this.fragPlaying=i}}},r.prototype.immediateLevelSwitch=function(){if(p.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,r=void 0;t?(r=t.paused,t.pause()):r=!0,this.previouslyPaused=r}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,e.POSITIVE_INFINITY)},r.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,n.BufferHelper.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},r.prototype.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var r,i=void 0,a=void 0;if((r=this.getBufferedFrag(t.currentTime))&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),t.paused)i=0;else{var n=this.hls.nextLoadLevel,o=this.levels[n],s=this.fragLastKbps;i=s&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*s)+1:0}if((a=this.getBufferedFrag(t.currentTime+i))&&(a=this.followingBufferedFrag(a))){var l=this.fragCurrent;l&&l.loader&&l.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(a.maxStartPTS,e.POSITIVE_INFINITY)}}},r.prototype.flushMainBuffer=function(e,t){this.state=m.State.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(s.default.BUFFER_FLUSHING,r)},r.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new y.default(r,t,this.fragmentTracker,this.hls)},r.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(p.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},r.prototype.onMediaSeeked=function(){var t=this.media,r=t?t.currentTime:void 0;e.isFinite(r)&&p.logger.log("media seeked to "+r.toFixed(3)),this.tick()},r.prototype.onManifestLoading=function(){p.logger.log("trigger BUFFER_RESET"),this.hls.trigger(s.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},r.prototype.onManifestParsed=function(e){var t,r=!1,i=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=r&&i,this.audioCodecSwitch&&p.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var a=this.config;(a.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(a.startPosition)},r.prototype.onLevelLoaded=function(t){var r=t.details,i=t.level,a=this.levels[this.levelLastLoaded],n=this.levels[i],o=r.totalduration,l=0;if(p.logger.log("level "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+o),r.live){var u=n.details;u&&r.fragments.length>0?(f.mergeDetails(u,r),l=r.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(l,u),r.PTSKnown&&e.isFinite(l)?p.logger.log("live playlist sliding:"+l.toFixed(3)):(p.logger.log("live playlist - outdated PTS, unknown sliding"),g.alignStream(this.fragPrevious,a,r))):(p.logger.log("live playlist - first load, unknown sliding"),r.PTSKnown=!1,g.alignStream(this.fragPrevious,a,r))}else r.PTSKnown=!1;if(n.details=r,this.levelLastLoaded=i,this.hls.trigger(s.default.LEVEL_UPDATED,{details:r,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var d=r.startTimeOffset;e.isFinite(d)?(d<0&&(p.logger.log("negative start time offset "+d+", count from end of last fragment"),d=l+o+d),p.logger.log("start time offset found in playlist, adjust startPosition to "+d),this.startPosition=d):r.live?(this.startPosition=this.computeLivePosition(l,r),p.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===m.State.WAITING_LEVEL&&(this.state=m.State.IDLE),this.tick()},r.prototype.onKeyLoaded=function(){this.state===m.State.KEY_LOADING&&(this.state=m.State.IDLE,this.tick())},r.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,i=this.levels,a=this.media,n=e.frag;if(this.state===m.State.FRAG_LOADING&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var l=e.stats,u=i[t.level],d=u.details;if(this.bitrateTest=!1,this.stats=l,p.logger.log("Loaded "+t.sn+" of ["+d.startSN+" ,"+d.endSN+"],level "+t.level),n.bitrateTest&&r.nextLoadLevel)this.state=m.State.IDLE,this.startFragRequested=!1,l.tparsed=l.tbuffered=window.performance.now(),r.trigger(s.default.FRAG_BUFFERED,{stats:l,frag:t,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=m.State.IDLE,l.tparsed=l.tbuffered=window.performance.now(),d.initSegment.data=e.payload,r.trigger(s.default.FRAG_BUFFERED,{stats:l,frag:t,id:"main"}),this.tick();else{p.logger.log("Parsing "+t.sn+" of ["+d.startSN+" ,"+d.endSN+"],level "+t.level+", cc "+t.cc),this.state=m.State.PARSING,this.pendingBuffering=!0,this.appended=!1,n.bitrateTest&&(n.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:n}));var f=!(a&&a.seeking)&&(d.PTSKnown||!d.live),c=d.initSegment?d.initSegment.data:[],h=this._getAudioCodec(u);(this.demuxer=this.demuxer||new o.default(this.hls,"main")).push(e.payload,c,h,u.videoCodec,t,d.totalduration,f)}}this.fragLoadError=0},r.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===m.State.PARSING){var i=e.tracks,a=void 0,n=void 0;if(i.audio&&this.altAudio&&delete i.audio,n=i.audio){var o=this.levels[this.level].audioCodec,l=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(p.logger.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&-1===l.indexOf("firefox")&&(o="mp4a.40.5"),-1!==l.indexOf("android")&&"audio/mpeg"!==n.container&&(o="mp4a.40.2",p.logger.log("Android: force audio codec to "+o)),n.levelCodec=o,n.id=e.id}for(a in(n=i.video)&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=e.id),this.hls.trigger(s.default.BUFFER_CODECS,i),i){n=i[a],p.logger.log("main track:"+a+",container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var u=n.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(s.default.BUFFER_APPENDING,{type:a,data:u,parent:"main",content:"initSegment"}))}this.tick()}},r.prototype.onFragParsingData=function(t){var r=this,i=this.fragCurrent,a=t.frag;if(i&&"main"===t.id&&a.sn===i.sn&&a.level===i.level&&("audio"!==t.type||!this.altAudio)&&this.state===m.State.PARSING){var n=this.levels[this.level],o=i;if(e.isFinite(t.endPTS)||(t.endPTS=t.startPTS+i.duration,t.endDTS=t.startDTS+i.duration),!0===t.hasAudio&&o.addElementaryStream(u.default.ElementaryStreamTypes.AUDIO),!0===t.hasVideo&&o.addElementaryStream(u.default.ElementaryStreamTypes.VIDEO),p.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(o.dropped=t.dropped,o.dropped)if(o.backtracked)p.logger.warn("Already backtracked on this fragment, appending with the gap",o.sn);else{var l=n.details;if(!l||o.sn!==l.startSN)return p.logger.warn("missing video frame(s), backtracking fragment",o.sn),this.fragmentTracker.removeFragment(o),o.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=m.State.IDLE,this.fragPrevious=o,void this.tick();p.logger.warn("missing video frame(s) on first frag, appending with gap",o.sn)}else o.backtracked=!1;var d=f.updateFragPTSDTS(n.details,o,t.startPTS,t.endPTS,t.startDTS,t.endDTS),c=this.hls;c.trigger(s.default.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:d,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(e){e&&e.length&&r.state===m.State.PARSING&&(r.appended=!0,r.pendingBuffering=!0,c.trigger(s.default.BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"}))}),this.tick()}},r.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===m.State.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=m.State.PARSED,this._checkAppendedParsed())},r.prototype.onAudioTrackSwitching=function(t){var r=!!t.url,i=t.id;if(!r){if(this.mediaBuffer!==this.media){p.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;a.loader&&(p.logger.log("switching to main audio track, cancel main fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=m.State.IDLE}var n=this.hls;n.trigger(s.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"}),n.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},r.prototype.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(p.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},r.prototype.onBufferCreated=function(e){var t,r,i=e.tracks,a=!1;for(var n in i){var o=i[n];"main"===o.id?(r=n,t=o,"video"===n&&(this.videoBuffer=i[n].buffer)):a=!0}a&&t?(p.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},r.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==m.State.PARSING&&t!==m.State.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},r.prototype._checkAppendedParsed=function(){if(!(this.state!==m.State.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;p.logger.log("main buffered : "+c.default.toString(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(s.default.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=m.State.IDLE}this.tick()}},r.prototype.onError=function(t){var r=t.frag||this.fragCurrent;if(!r||"main"===r.type){var i=!!this.media&&n.BufferHelper.isBuffered(this.media,this.media.currentTime)&&n.BufferHelper.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var a=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);p.logger.warn("mediaController: frag loading failed, retry in "+a+" ms"),this.retryDate=window.performance.now()+a,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=m.State.FRAG_LOADING_WAITING_RETRY}else p.logger.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=m.State.ERROR;break;case h.ErrorDetails.LEVEL_LOAD_ERROR:case h.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==m.State.ERROR&&(t.fatal?(this.state=m.State.ERROR,p.logger.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==m.State.WAITING_LEVEL||(this.state=m.State.IDLE));break;case h.ErrorDetails.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==m.State.PARSING&&this.state!==m.State.PARSED||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=m.State.IDLE):(p.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,e.POSITIVE_INFINITY)))}}},r.prototype._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,p.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},r.prototype._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},r.prototype.onFragLoadEmergencyAborted=function(){this.state=m.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},r.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(u.default.ElementaryStreamTypes.VIDEO,e.buffered),this.state=m.State.IDLE,this.fragPrevious=null},r.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},r.prototype.computeLivePosition=function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},r.prototype._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=e.seeking?t:this.startPosition;t!==r&&(p.logger.log("target start position not buffered, seek to buffered.start(0) "+r+" from current time "+t+" "),e.currentTime=r)},r.prototype._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(p.logger.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},Object.defineProperty(r.prototype,"liveSyncPosition",{get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e},enumerable:!0,configurable:!0}),r}(m.default);t.default=E}).call(this,r(2).Number)},function(e,t,r){function i(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var i=r(r.s=ENTRY_MODULE);return i.default||i}var a="[\\.|\\-|\\+|\\w|/|@]+",n="\\((/\\*.*?\\*/)?s?.*?("+a+").*?\\)";function o(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e){return!isNaN(1*e)}function l(e,t,i){var l={};l[i]=[];var u=t.toString(),d=u.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!d)return l;for(var f,c=d[1],h=new RegExp("(\\\\n|\\W)"+o(c)+n,"g");f=h.exec(u);)"dll-reference"!==f[3]&&l[i].push(f[3]);for(h=new RegExp("\\("+o(c)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+n,"g");f=h.exec(u);)e[f[2]]||(l[i].push(f[1]),e[f[2]]=r(f[1]).m),l[f[2]]=l[f[2]]||[],l[f[2]].push(f[4]);for(var p=Object.keys(l),g=0;g<p.length;g++)for(var v=0;v<l[p[g]].length;v++)s(l[p[g]][v])&&(l[p[g]][v]=1*l[p[g]][v]);return l}function u(e){return Object.keys(e).reduce(function(t,r){return t||e[r].length>0},!1)}e.exports=function(e,t){t=t||{};var a={main:r.m},n=t.all?{main:Object.keys(a.main)}:function(e,t){for(var r={main:[t]},i={main:[]},a={main:{}};u(r);)for(var n=Object.keys(r),o=0;o<n.length;o++){var s=n[o],d=r[s].pop();if(a[s]=a[s]||{},!a[s][d]&&e[s][d]){a[s][d]=!0,i[s]=i[s]||[],i[s].push(d);for(var f=l(e,e[s][d],s),c=Object.keys(f),h=0;h<c.length;h++)r[c[h]]=r[c[h]]||[],r[c[h]]=r[c[h]].concat(f[c[h]])}}return i}(a,e),o="";Object.keys(n).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;n[e][t];)t++;n[e].push(t),a[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",o=o+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+n[e].map(function(t){return JSON.stringify(t)+": "+a[e][t].toString()}).join(",")+"});\n"}),o=o+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+n.main.map(function(e){return JSON.stringify(e)+": "+a.main[e].toString()}).join(",")+"}))(self);";var s=new window.Blob([o],{type:"text/javascript"});if(t.bare)return s;var d=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(s),f=new window.Worker(d);return f.objectURL=d,f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();t.default=i},function(e,t,r){"use strict";function i(e){var t=e.byteLength,r=t&&new DataView(e).getUint8(t-1);return r?e.slice(0,t-r):e}Object.defineProperty(t,"__esModule",{value:!0}),t.removePadding=i;var a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),i=0;i<4;i++)r[i]=t.getUint32(4*i);return r},e.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],a=r[1],n=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],d=s[2],f=s[3],c=new Uint32Array(256),h=0,p=0,g=0;for(g=0;g<256;g++)c[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var v=p^p<<1^p<<2^p<<3^p<<4;v=v>>>8^255&v^99,e[h]=v,t[v]=h;var y=c[h],m=c[y],E=c[m],_=257*c[v]^16843008*v;i[h]=_<<24|_>>>8,a[h]=_<<16|_>>>16,n[h]=_<<8|_>>>24,o[h]=_,_=16843009*E^65537*m^257*y^16843008*h,l[v]=_<<24|_>>>8,u[v]=_<<16|_>>>16,d[v]=_<<8|_>>>24,f[v]=_,h?(h=y^c[c[c[E^y]]],p^=c[c[p]]):h=p=1}},e.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,i=0;i<t.length&&r;)r=t[i]===this.key[i],i++;if(!r){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var n,o,s,l,u=this.ksRows=4*(a+6+1),d=this.keySchedule=new Uint32Array(u),f=this.invKeySchedule=new Uint32Array(u),c=this.sBox,h=this.rcon,p=this.invSubMix,g=p[0],v=p[1],y=p[2],m=p[3];for(n=0;n<u;n++)n<a?s=d[n]=t[n]:(l=s,n%a==0?(l=c[(l=l<<8|l>>>24)>>>24]<<24|c[l>>>16&255]<<16|c[l>>>8&255]<<8|c[255&l],l^=h[n/a|0]<<24):a>6&&n%a==4&&(l=c[l>>>24]<<24|c[l>>>16&255]<<16|c[l>>>8&255]<<8|c[255&l]),d[n]=s=(d[n-a]^l)>>>0);for(o=0;o<u;o++)n=u-o,l=3&o?d[n]:d[n-4],f[o]=o<4||n<=4?l:g[c[l>>>24]]^v[c[l>>>16&255]]^y[c[l>>>8&255]]^m[c[255&l]],f[o]=f[o]>>>0}},e.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},e.prototype.decrypt=function(e,t,r,a){for(var n,o,s,l,u,d,f,c,h,p,g,v,y,m,E=this.keySize+6,_=this.invKeySchedule,T=this.invSBox,S=this.invSubMix,b=S[0],A=S[1],R=S[2],D=S[3],L=this.uint8ArrayToUint32Array_(r),w=L[0],O=L[1],I=L[2],P=L[3],k=new Int32Array(e),C=new Int32Array(k.length),F=this.networkToHostOrderSwap;t<k.length;){for(h=F(k[t]),p=F(k[t+1]),g=F(k[t+2]),v=F(k[t+3]),u=h^_[0],d=v^_[1],f=g^_[2],c=p^_[3],y=4,m=1;m<E;m++)n=b[u>>>24]^A[d>>16&255]^R[f>>8&255]^D[255&c]^_[y],o=b[d>>>24]^A[f>>16&255]^R[c>>8&255]^D[255&u]^_[y+1],s=b[f>>>24]^A[c>>16&255]^R[u>>8&255]^D[255&d]^_[y+2],l=b[c>>>24]^A[u>>16&255]^R[d>>8&255]^D[255&f]^_[y+3],u=n,d=o,f=s,c=l,y+=4;n=T[u>>>24]<<24^T[d>>16&255]<<16^T[f>>8&255]<<8^T[255&c]^_[y],o=T[d>>>24]<<24^T[f>>16&255]<<16^T[c>>8&255]<<8^T[255&u]^_[y+1],s=T[f>>>24]<<24^T[c>>16&255]<<16^T[u>>8&255]<<8^T[255&d]^_[y+2],l=T[c>>>24]<<24^T[u>>16&255]<<16^T[d>>8&255]<<8^T[255&f]^_[y+3],y+=3,C[t]=F(n^w),C[t+1]=F(l^O),C[t+2]=F(s^I),C[t+3]=F(o^P),w=h,O=p,I=g,P=v,t+=4}return a?i(C.buffer):C.buffer},e.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}();t.default=a},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r(22),a=r(0),n=r(11),o=function(){function t(e,t,r){this.observer=e,this.config=r,this.remuxer=t}return t.prototype.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(e){if(!e)return!1;for(var t=(n.default.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(i.probe(e,t))return a.logger.log("ADTS sync word found !"),!0;return!1},t.prototype.append=function(t,r,o,s){for(var l=this._audioTrack,u=n.default.getID3Data(t,0)||[],d=n.default.getTimeStamp(u),f=e.isFinite(d)?90*d:9e4*r,c=0,h=f,p=t.length,g=u.length,v=[{pts:h,dts:h,data:u}];g<p-1;)if(i.isHeader(t,g)&&g+5<p){i.initTrackConfig(l,this.observer,t,g,l.manifestCodec);var y=i.appendFrame(l,t,g,f,c);if(!y){a.logger.log("Unable to parse AAC frame");break}g+=y.length,h=y.sample.pts,c++}else n.default.isHeader(t,g)?(u=n.default.getID3Data(t,g),v.push({pts:h,dts:h,data:u}),g+=u.length):g++;this.remuxer.remux(l,{samples:[]},{samples:v,inputTimeScale:9e4},{samples:[]},r,o,s)},t.prototype.destroy=function(){},t}();t.default=o}).call(this,r(2).Number)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(22),a=r(23),n=r(1),o=r(44),s=r(45),l=r(0),u=r(3),d={video:1,audio:2,id3:3,text:4},f=function(){function e(e,t,r,i){this.observer=e,this.config=r,this.typeSupported=i,this.remuxer=t,this.sampleAes=null}return e.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new s.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0)&&(r&&l.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),!0)},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:d[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},e.prototype.resetInitSegment=function(t,r,i,a){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",a),this._audioTrack=e.createTrack("audio",a),this._id3Track=e.createTrack("id3",a),this._txtTrack=e.createTrack("text",a),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=i,this._duration=a},e.prototype.resetTimeStamp=function(){},e.prototype.append=function(t,r,i,a){var o,s,d,f,c,h=t.length,p=!1;this.contiguous=i;var g=this.pmtParsed,v=this._avcTrack,y=this._audioTrack,m=this._id3Track,E=v.pid,_=y.pid,T=m.pid,S=this._pmtId,b=v.pesData,A=y.pesData,R=m.pesData,D=this._parsePAT,L=this._parsePMT,w=this._parsePES,O=this._parseAVCPES.bind(this),I=this._parseAACPES.bind(this),P=this._parseMPEGPES.bind(this),k=this._parseID3PES.bind(this),C=e._syncOffset(t);for(h-=(h+C)%188,o=C;o<h;o+=188)if(71===t[o]){if(s=!!(64&t[o+1]),d=((31&t[o+1])<<8)+t[o+2],(48&t[o+3])>>4>1){if((f=o+5+t[o+4])===o+188)continue}else f=o+4;switch(d){case E:s&&(b&&(c=w(b))&&void 0!==c.pts&&O(c,!1),b={data:[],size:0}),b&&(b.data.push(t.subarray(f,o+188)),b.size+=o+188-f);break;case _:s&&(A&&(c=w(A))&&void 0!==c.pts&&(y.isAAC?I(c):P(c)),A={data:[],size:0}),A&&(A.data.push(t.subarray(f,o+188)),A.size+=o+188-f);break;case T:s&&(R&&(c=w(R))&&void 0!==c.pts&&k(c),R={data:[],size:0}),R&&(R.data.push(t.subarray(f,o+188)),R.size+=o+188-f);break;case 0:s&&(f+=t[f]+1),S=this._pmtId=D(t,f);break;case S:s&&(f+=t[f]+1);var F=L(t,f,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(E=F.avc)>0&&(v.pid=E),(_=F.audio)>0&&(y.pid=_,y.isAAC=F.isAAC),(T=F.id3)>0&&(m.pid=T),p&&!g&&(l.logger.log("reparse from beginning"),p=!1,o=C-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(n.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});b&&(c=w(b))&&void 0!==c.pts?(O(c,!0),v.pesData=null):v.pesData=b,A&&(c=w(A))&&void 0!==c.pts?(y.isAAC?I(c):P(c),y.pesData=null):(A&&A.size&&l.logger.log("last AAC PES packet truncated,might overlap between fragments"),y.pesData=A),R&&(c=w(R))&&void 0!==c.pts?(k(c),m.pesData=null):m.pesData=R,null==this.sampleAes?this.remuxer.remux(y,v,m,this._txtTrack,r,i,a):this.decryptAndRemux(y,v,m,this._txtTrack,r,i,a)},e.prototype.decryptAndRemux=function(e,t,r,i,a,n,o){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){s.decryptAndRemuxAvc(e,t,r,i,a,n,o)})}else this.decryptAndRemuxAvc(e,t,r,i,a,n,o)},e.prototype.decryptAndRemuxAvc=function(e,t,r,i,a,n,o){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){s.remuxer.remux(e,t,r,i,a,n,o)})}else this.remuxer.remux(e,t,r,i,a,n,o)},e.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},e.prototype._parsePMT=function(e,t,r,i){var a,n,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(a=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){switch(n=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!i){l.logger.log("unkown stream type:"+e[t]);break}case 15:-1===o.audio&&(o.audio=n);break;case 21:-1===o.id3&&(o.id3=n);break;case 219:if(!i){l.logger.log("unkown stream type:"+e[t]);break}case 27:-1===o.avc&&(o.avc=n);break;case 3:case 4:r?-1===o.audio&&(o.audio=n,o.isAAC=!1):l.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:l.logger.warn("HEVC stream type found, not supported for now");break;default:l.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return o},e.prototype._parsePES=function(e){var t,r,i,a,n,o,s,u,d=0,f=e.data;if(!e||0===e.size)return null;for(;f[0].length<19&&f.length>1;){var c=new Uint8Array(f[0].length+f[1].length);c.set(f[0]),c.set(f[1],f[0].length),f[0]=c,f.splice(1,1)}if(1===((t=f[0])[0]<<16)+(t[1]<<8)+t[2]){if((i=(t[4]<<8)+t[5])&&i>e.size-6)return null;192&(r=t[7])&&((o=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(o-=8589934592),64&r?((s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(s-=8589934592),o-s>54e5&&(l.logger.warn(Math.round((o-s)/9e4)+"s delta between PTS and DTS, align them"),o=s)):s=o),u=(a=t[8])+9,e.size-=u,n=new Uint8Array(e.size);for(var h=0,p=f.length;h<p;h++){var g=(t=f[h]).byteLength;if(u){if(u>g){u-=g;continue}t=t.subarray(u),g-=u,u=0}n.set(t,d),d+=g}return i&&(i-=a+3),{data:n,pts:o,dts:s,len:i}}return null},e.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,i=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(i||this.contiguous)?(e.id=i,r.push(e)):t.dropped++}e.debug.length&&l.logger.log(e.pts+"/"+e.dts+":"+e.debug)},e.prototype._parseAVCPES=function(e,t){var r,i,a,n=this,s=this._avcTrack,l=this._parseAVCNALu(e.data),u=this.avcSample,d=!1,f=this.pushAccesUnit.bind(this),c=function(e,t,r,i){return{key:e,pts:t,dts:r,units:[],debug:i}};e.data=null,u&&l.length&&!s.audFound&&(f(u,s),u=this.avcSample=c(!1,e.pts,e.dts,"")),l.forEach(function(t){switch(t.type){case 1:i=!0,u||(u=n.avcSample=c(!0,e.pts,e.dts,"")),u.frame=!0;var l=t.data;if(d&&l.length>4){var h=new o.default(l).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(u.key=!0)}break;case 5:i=!0,u||(u=n.avcSample=c(!0,e.pts,e.dts,"")),u.key=!0,u.frame=!0;break;case 6:i=!0,(r=new o.default(n.discardEPB(t.data))).readUByte();for(var p=0,g=0,v=!1,y=0;!v&&r.bytesAvailable>1;){p=0;do{p+=y=r.readUByte()}while(255===y);g=0;do{g+=y=r.readUByte()}while(255===y);if(4===p&&0!==r.bytesAvailable){if(v=!0,181===r.readUByte())if(49===r.readUShort())if(1195456820===r.readUInt())if(3===r.readUByte()){var m=r.readUByte(),E=31&m,_=[m,r.readUByte()];for(a=0;a<E;a++)_.push(r.readUByte()),_.push(r.readUByte()),_.push(r.readUByte());n._insertSampleInOrder(n._txtTrack.samples,{type:3,pts:e.pts,bytes:_})}}else if(g<r.bytesAvailable)for(a=0;a<g;a++)r.readUByte()}break;case 7:if(i=!0,d=!0,!s.sps){var T=(r=new o.default(t.data)).readSPS();s.width=T.width,s.height=T.height,s.pixelRatio=T.pixelRatio,s.sps=[t.data],s.duration=n._duration;var S=t.data.subarray(1,4),b="avc1.";for(a=0;a<3;a++){var A=S[a].toString(16);A.length<2&&(A="0"+A),b+=A}s.codec=b}break;case 8:i=!0,s.pps||(s.pps=[t.data]);break;case 9:i=!1,s.audFound=!0,u&&f(u,s),u=n.avcSample=c(!1,e.pts,e.dts,"");break;case 12:i=!1;break;default:i=!1,u&&(u.debug+="unknown NAL "+t.type+" ")}u&&i&&u.units.push(t)}),t&&u&&(f(u,s),this.avcSample=null)},e.prototype._insertSampleInOrder=function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var i=r-1;i>=0;i--)if(t.pts<e[i].pts){e.splice(i,0,t);break}}else e.push(t)},e.prototype._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var i=t.units;e=i[i.length-1]}return e},e.prototype._parseAVCNALu=function(e){var t,r,i,a,n=0,o=e.byteLength,s=this._avcTrack,l=s.naluState||0,u=l,d=[],f=-1;for(-1===l&&(f=0,a=31&e[0],l=0,n=1);n<o;)if(t=e[n++],l)if(1!==l)if(t)if(1===t){var c,h;if(f>=0)i={data:e.subarray(f,n-l-1),type:a},d.push(i);else if(c=this._getLastNalUnit())if(u&&n<=4-u&&c.state&&(c.data=c.data.subarray(0,c.data.byteLength-u)),(r=n-l-1)>0)(h=new Uint8Array(c.data.byteLength+r)).set(c.data,0),h.set(e.subarray(0,r),c.data.byteLength),c.data=h;n<o?(f=n,a=31&e[n],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;(f>=0&&l>=0&&(i={data:e.subarray(f,o),type:a,state:l},d.push(i)),0===d.length)&&((c=this._getLastNalUnit())&&((h=new Uint8Array(c.data.byteLength+e.byteLength)).set(c.data,0),h.set(e,c.data.byteLength),c.data=h));return s.naluState=l,d},e.prototype.discardEPB=function(e){for(var t,r,i=e.byteLength,a=[],n=1;n<i-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(a.push(n+2),n+=2):n++;if(0===a.length)return e;t=i-a.length,r=new Uint8Array(t);var o=0;for(n=0;n<t;o++,n++)o===a[0]&&(o++,a.shift()),r[n]=e[o];return r},e.prototype._parseAACPES=function(e){var t,r,a,o,s,d=this._audioTrack,f=e.data,c=e.pts,h=this.aacOverFlow,p=this.aacLastPTS;if(h){var g=new Uint8Array(h.byteLength+f.byteLength);g.set(h,0),g.set(f,h.byteLength),f=g}for(a=0,s=f.length;a<s-1&&!i.isHeader(f,a);a++);if(a){var v=void 0,y=void 0;if(a<s-1?(v="AAC PES did not start with ADTS header,offset:"+a,y=!1):(v="no ADTS header found in AAC PES",y=!0),l.logger.warn("parsing error:"+v),this.observer.trigger(n.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:y,reason:v}),y)return}if(i.initTrackConfig(d,this.observer,f,a,this.audioCodec),r=0,t=i.getFrameDuration(d.samplerate),h&&p){var m=p+t;Math.abs(m-c)>1&&(l.logger.log("AAC: align PTS for overlapping frames by "+Math.round((m-c)/90)),c=m)}for(;a<s;)if(i.isHeader(f,a)&&a+5<s){var E=i.appendFrame(d,f,a,c,r);if(!E)break;a+=E.length,o=E.sample.pts,r++}else a++;h=a<s?f.subarray(a,s):null,this.aacOverFlow=h,this.aacLastPTS=o},e.prototype._parseMPEGPES=function(e){for(var t=e.data,r=t.length,i=0,n=0,o=e.pts;n<r;)if(a.default.isHeader(t,n)){var s=a.default.appendFrame(this._audioTrack,t,n,o,i);if(!s)break;n+=s.length,i++}else n++},e.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");i.set(e.subarray(r,r+a)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a},e.prototype.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},e.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&i.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},e.prototype.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},e.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e.prototype.skipScalingList=function(e){var t,r=8,i=8;for(t=0;t<e;t++)0!==i&&(i=(r+this.readEG()+256)%256),r=0===i?r:i},e.prototype.readSPS=function(){var e,t,r,i,a,n,o,s=0,l=0,u=0,d=0,f=this.readUByte.bind(this),c=this.readBits.bind(this),h=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),v=this.skipEG.bind(this),y=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);if(f(),e=f(),c(5),g(3),f(),y(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var E=h();if(3===E&&g(1),y(),y(),g(1),p())for(n=3!==E?8:12,o=0;o<n;o++)p()&&m(o<6?16:64)}y();var _=h();if(0===_)h();else if(1===_)for(g(1),v(),v(),t=h(),o=0;o<t;o++)v();y(),g(1),r=h(),i=h(),0===(a=c(1))&&g(1),g(1),p()&&(s=h(),l=h(),u=h(),d=h());var T=[1,1];if(p()&&p())switch(f()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[f()<<8|f(),f()<<8|f()]}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-a)*(i+1)*16-(a?2:4)*(u+d),pixelRatio:T}},e.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(13),a=function(){function e(e,t,r,a){this.decryptdata=r,this.discardEPB=a,this.decrypter=new i.default(e,t,{removePKCS7Padding:!1})}return e.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},e.prototype.decryptAacSample=function(e,t,r,i){var a=e[t].unit,n=a.subarray(16,a.length-a.length%16),o=n.buffer.slice(n.byteOffset,n.byteOffset+n.length),s=this;this.decryptBuffer(o,function(n){n=new Uint8Array(n),a.set(n,16),i||s.decryptAacSamples(e,t+1,r)})},e.prototype.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,i),!i)return}}},e.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),i=0,a=32;a<=e.length-16;a+=160,i+=16)r.set(e.subarray(a,a+16),i);return r},e.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,i=32;i<=e.length-16;i+=160,r+=16)e.set(t.subarray(r,r+16),i);return e},e.prototype.decryptAvcSample=function(e,t,r,i,a,n){var o=this.discardEPB(a.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,function(s){a.data=l.getAvcDecryptedUnit(o,s),n||l.decryptAvcSamples(e,t,r+1,i)})},e.prototype.decryptAvcSamples=function(e,t,r,i){for(;;t++,r=0){if(t>=e.length)return void i();for(var a=e[t].units;!(r>=a.length);r++){var n=a[r];if(!(n.length<=48||1!==n.type&&5!==n.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,i,n,o),!o)return}}}},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(11),a=r(0),n=r(23),o=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}return e.prototype.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){var t,r,o=i.default.getID3Data(e,0);if(o&&void 0!==i.default.getTimeStamp(o))for(t=o.length,r=Math.min(e.length-1,t+100);t<r;t++)if(n.default.probe(e,t))return a.logger.log("MPEG Audio sync word found !"),!0;return!1},e.prototype.append=function(e,t,r,a){for(var o=i.default.getID3Data(e,0),s=i.default.getTimeStamp(o),l=s?90*s:9e4*t,u=o.length,d=e.length,f=0,c=0,h=this._audioTrack,p=[{pts:l,dts:l,data:o}];u<d;)if(n.default.isHeader(e,u)){var g=n.default.appendFrame(h,e,u,l,f);if(!g)break;u+=g.length,c=g.sample.pts,f++}else i.default.isHeader(e,u)?(o=i.default.getID3Data(e,u),p.push({pts:c,dts:c,data:o}),u+=o.length):u++;this.remuxer.remux(h,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},t,r,a)},e.prototype.destroy=function(){},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(48),a=r(49),n=r(1),o=r(3),s=r(0),l=function(){function e(e,t,r,i){this.observer=e,this.config=t,this.typeSupported=r;var a=navigator.userAgent;this.isSafari=i&&i.indexOf("Apple")>-1&&a&&!a.match("CriOS"),this.ISGenerated=!1}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},e.prototype.resetInitSegment=function(){this.ISGenerated=!1},e.prototype.remux=function(e,t,r,i,a,o,l){if(this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated){var u=e.samples.length,d=t.samples.length,f=a,c=a;if(u&&d){var h=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;f+=Math.max(0,h),c+=Math.max(0,-h)}if(u){e.timescale||(s.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var p=this.remuxAudio(e,f,o,l);if(d){var g=void 0;p&&(g=p.endPTS-p.startPTS),t.timescale||(s.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,c,o,g,l)}}else if(d){var v=this.remuxVideo(t,c,o,0,l);v&&e.codec&&this.remuxEmptyAudio(e,f,o,v)}}r.samples.length&&this.remuxID3(r,a),i.samples.length&&this.remuxText(i,a),this.observer.trigger(n.default.FRAG_PARSED)},e.prototype.generateIS=function(e,t,r){var i,l,u=this.observer,d=e.samples,f=t.samples,c=this.typeSupported,h="audio/mp4",p={},g={tracks:p},v=void 0===this._initPTS;if(v&&(i=l=1/0),e.config&&d.length&&(e.timescale=e.samplerate,s.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(c.mpeg?(h="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),p.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&c.mpeg?new Uint8Array:a.default.initSegment([e]),metadata:{channelCount:e.channelCount}},v&&(i=l=d[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&f.length){var y=t.inputTimeScale;t.timescale=y,p.video={container:"video/mp4",codec:t.codec,initSegment:a.default.initSegment([t]),metadata:{width:t.width,height:t.height}},v&&(i=Math.min(i,f[0].pts-y*r),l=Math.min(l,f[0].dts-y*r),this.observer.trigger(n.default.INIT_PTS_FOUND,{initPTS:i}))}Object.keys(p).length?(u.trigger(n.default.FRAG_PARSING_INIT_SEGMENT,g),this.ISGenerated=!0,v&&(this._initPTS=i,this._initDTS=l)):u.trigger(n.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.prototype.remuxVideo=function(e,t,r,i,l){var u,d,f,c,h,p,g,v=8,y=e.timescale,m=e.samples,E=[],_=m.length,T=this._PTSNormalize,S=this._initPTS,b=this.nextAvcDts,A=this.isSafari;if(0!==_){A&&(r|=m.length&&b&&(l&&Math.abs(t-b/y)<.1||Math.abs(m[0].pts-b-S)<y/5)),r||(b=t*y),m.forEach(function(e){e.pts=T(e.pts-S,b),e.dts=T(e.dts-S,b)}),m.sort(function(e,t){var r=e.dts-t.dts,i=e.pts-t.pts;return r||i||e.id-t.id});var R=m.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(R<0){s.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(R/90)+" ms to overcome this issue");for(var D=0;D<m.length;D++)m[D].dts+=R}var L=m[0];h=Math.max(L.dts,0),c=Math.max(L.pts,0);var w=Math.round((h-b)/90);r&&w&&(w>1?s.logger.log("AVC:"+w+" ms hole between fragments detected,filling it"):w<-1&&s.logger.log("AVC:"+-w+" ms overlapping between fragments detected"),h=b,m[0].dts=h,c=Math.max(c-w,b),m[0].pts=c,s.logger.log("Video/PTS/DTS adjusted: "+Math.round(c/90)+"/"+Math.round(h/90)+",delta:"+w+" ms")),L=m[m.length-1],g=Math.max(L.dts,0),p=Math.max(L.pts,0,g),A&&(u=Math.round((g-h)/(m.length-1)));var O=0,I=0;for(D=0;D<_;D++){for(var P=m[D],k=P.units,C=k.length,F=0,x=0;x<C;x++)F+=k[x].data.length;I+=F,O+=C,P.length=F,P.dts=A?h+D*u:Math.max(P.dts,h),P.pts=Math.max(P.pts,P.dts)}var M=I+4*O+8;try{d=new Uint8Array(M)}catch(e){return void this.observer.trigger(n.default.ERROR,{type:o.ErrorTypes.MUX_ERROR,details:o.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating video mdat "+M})}var N=new DataView(d.buffer);N.setUint32(0,M),d.set(a.default.types.mdat,4);for(D=0;D<_;D++){var U=m[D],B=U.units,G=0,j=void 0;for(x=0,C=B.length;x<C;x++){var K=B[x],H=K.data,V=K.data.byteLength;N.setUint32(v,V),v+=4,d.set(H,v),v+=V,G+=4+V}if(A)j=Math.max(0,u*Math.round((U.pts-U.dts)/u));else{if(D<_-1)u=m[D+1].dts-U.dts;else{var W=this.config,Y=U.dts-m[D>0?D-1:D].dts;if(W.stretchShortVideoTrack){var q=W.maxBufferHole,X=Math.floor(q*y),z=(i?c+i*y:this.nextAudioPts)-U.pts;z>X?((u=z-Y)<0&&(u=Y),s.logger.log("It is approximately "+z/90+" ms to the next segment; using duration "+u/90+" ms for the last video frame.")):u=Y}else u=Y}j=Math.round(U.pts-U.dts)}E.push({size:G,duration:u,cts:j,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:U.key?2:1,isNonSync:U.key?0:1}})}this.nextAvcDts=g+u;var Q=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,E.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var $=E[0].flags;$.dependsOn=2,$.isNonSync=0}e.samples=E,f=a.default.moof(e.sequenceNumber++,h,e),e.samples=[];var J={data1:f,data2:d,startPTS:c/y,endPTS:(p+u)/y,startDTS:h/y,endDTS:this.nextAvcDts/y,type:"video",hasAudio:!1,hasVideo:!0,nb:E.length,dropped:Q};return this.observer.trigger(n.default.FRAG_PARSING_DATA,J),J}},e.prototype.remuxAudio=function(e,t,r,l){var u,d,f,c,h,p,g,v=e.inputTimeScale,y=e.timescale,m=v/y,E=(e.isAAC?1024:1152)*m,_=this._PTSNormalize,T=this._initPTS,S=!e.isAAC&&this.typeSupported.mpeg,b=e.samples,A=[],R=this.nextAudioPts;if(r|=b.length&&R&&(l&&Math.abs(t-R/v)<.1||Math.abs(b[0].pts-R-T)<20*E),b.forEach(function(e){e.pts=e.dts=_(e.pts-T,t*v)}),0!==(b=b.filter(function(e){return e.pts>=0})).length){if(r||(R=l?t*v:b[0].pts),e.isAAC)for(var D=this.config.maxAudioFramesDrift,L=0,w=R;L<b.length;){var O,I=b[L];O=(U=I.pts)-w;var P=Math.abs(1e3*O/v);if(O<=-D*E)s.logger.warn("Dropping 1 audio frame @ "+(w/v).toFixed(3)+"s due to "+Math.round(P)+" ms overlap."),b.splice(L,1),e.len-=I.unit.length;else if(O>=D*E&&P<1e4&&w){var k=Math.round(O/E);s.logger.warn("Injecting "+k+" audio frame @ "+(w/v).toFixed(3)+"s due to "+Math.round(1e3*O/v)+" ms gap.");for(var C=0;C<k;C++){var F=Math.max(w,0);(f=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(s.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),f=I.unit.subarray()),b.splice(L,0,{unit:f,pts:F,dts:F}),e.len+=f.length,w+=E,L++}I.pts=I.dts=w,w+=E,L++}else Math.abs(O),I.pts=I.dts=w,w+=E,L++}C=0;for(var x=b.length;C<x;C++){var M=b[C],N=M.unit,U=M.pts;if(void 0!==g)d.duration=Math.round((U-g)/m);else{var B=Math.round(1e3*(U-R)/v),G=0;if(r&&e.isAAC&&B){if(B>0&&B<1e4)G=Math.round((U-R)/E),s.logger.log(B+" ms hole between AAC samples detected,filling it"),G>0&&((f=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(f=N.subarray()),e.len+=G*f.length);else if(B<-12){s.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(R/v).toFixed(3)+"s/"+(U/v).toFixed(3)+"s/"+-B+"ms"),e.len-=N.byteLength;continue}U=R}if(p=U,!(e.len>0))return;var j=S?e.len:e.len+8;u=S?0:8;try{c=new Uint8Array(j)}catch(e){return void this.observer.trigger(n.default.ERROR,{type:o.ErrorTypes.MUX_ERROR,details:o.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:j,reason:"fail allocating audio mdat "+j})}S||(new DataView(c.buffer).setUint32(0,j),c.set(a.default.types.mdat,4));for(L=0;L<G;L++)(f=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(s.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),f=N.subarray()),c.set(f,u),u+=f.byteLength,d={size:f.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},A.push(d)}c.set(N,u);var K=N.byteLength;u+=K,d={size:K,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},A.push(d),g=U}var H=0,V=A.length;if(V>=2&&(H=A[V-2].duration,d.duration=H),V){this.nextAudioPts=R=g+m*H,e.len=0,e.samples=A,h=S?new Uint8Array:a.default.moof(e.sequenceNumber++,p/m,e),e.samples=[];var W=p/v,Y=R/v,q={data1:h,data2:c,startPTS:W,endPTS:Y,startDTS:W,endDTS:Y,type:"audio",hasAudio:!0,hasVideo:!1,nb:V};return this.observer.trigger(n.default.FRAG_PARSING_DATA,q),q}return null}},e.prototype.remuxEmptyAudio=function(e,t,r,a){var n=e.inputTimeScale,o=n/(e.samplerate?e.samplerate:n),l=this.nextAudioPts,u=(void 0!==l?l:a.startDTS*n)+this._initDTS,d=a.endDTS*n+this._initDTS,f=1024*o,c=Math.ceil((d-u)/f),h=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(s.logger.warn("remux empty Audio"),h){for(var p=[],g=0;g<c;g++){var v=u+g*f;p.push({unit:h,pts:v,dts:v}),e.len+=h.length}e.samples=p,this.remuxAudio(e,t,r)}else s.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.prototype.remuxID3=function(e){var t,r=e.samples.length,i=e.inputTimeScale,a=this._initPTS,o=this._initDTS;if(r){for(var s=0;s<r;s++)(t=e.samples[s]).pts=(t.pts-a)/i,t.dts=(t.dts-o)/i;this.observer.trigger(n.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},e.prototype.remuxText=function(e){e.samples.sort(function(e,t){return e.pts-t.pts});var t,r=e.samples.length,i=e.inputTimeScale,a=this._initPTS;if(r){for(var o=0;o<r;o++)(t=e.samples[o]).pts=(t.pts-a)/i;this.observer.trigger(n.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e.prototype._PTSNormalize=function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e},e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Math.pow(2,32)-1,a=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:i};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=n,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))},e.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),i=8,a=r.length,n=a;a--;)i+=r[a].byteLength;for((t=new Uint8Array(i))[0]=i>>24&255,t[1]=i>>16&255,t[2]=i>>8&255,t[3]=255&i,t.set(e,4),a=0,i=8;a<n;a++)t.set(r[a],i),i+=r[a].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var a=Math.floor(r/(i+1)),n=Math.floor(r%(i+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,r))},e.moov=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(i))},e.mvhd=function(t,r){r*=t;var a=Math.floor(r/(i+1)),n=Math.floor(r%(i+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)},e.sdtp=function(t){var r,i,a=t.samples||[],n=new Uint8Array(4+a.length);for(i=0;i<a.length;i++)r=a[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,n)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,i,a,n=[],o=[];for(r=0;r<t.sps.length;r++)a=(i=t.sps[r]).byteLength,n.push(a>>>8&255),n.push(255&a),n=n.concat(Array.prototype.slice.call(i));for(r=0;r<t.pps.length;r++)a=(i=t.pps[r]).byteLength,o.push(a>>>8&255),o.push(255&a),o=o.concat(Array.prototype.slice.call(i));var s=e.box(e.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,d=t.pixelRatio[0],f=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,f>>24,f>>16&255,f>>8&255,255&f])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,a=t.duration*t.timescale,n=t.width,o=t.height,s=Math.floor(a/(i+1)),l=Math.floor(a%(i+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,o>>8&255,255&o,0,0]))},e.traf=function(t,r){var a=e.sdtp(t),n=t.id,o=Math.floor(r/(i+1)),s=Math.floor(r%(i+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,a.length+16+20+8+16+8+8),a)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var i,a,n,o,s,l,u=t.samples||[],d=u.length,f=12+16*d,c=new Uint8Array(f);for(r+=8+f,c.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,255&d,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),i=0;i<d;i++)n=(a=u[i]).duration,o=a.size,s=a.flags,l=a.cts,c.set([n>>>24&255,n>>>16&255,n>>>8&255,255&n,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*i);return e.box(e.types.trun,c)},e.initSegment=function(t){e.types||e.init();var r,i=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+i.byteLength)).set(e.FTYP),r.set(i,e.FTYP.byteLength),r},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1),a=function(){function e(e){this.observer=e}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(){},e.prototype.resetInitSegment=function(){},e.prototype.remux=function(e,t,r,a,n,o,s,l){var u=this.observer,d="";e&&(d+="audio"),t&&(d+="video"),u.trigger(i.default.FRAG_PARSING_DATA,{data1:l,startPTS:n,startDTS:n,type:d,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),u.trigger(i.default.FRAG_PARSED)},e}();t.default=a},function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,a="~";function n(){}function o(e,t,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new function(e,t,r){this.fn=e,this.context=t,this.once=r||!1}(r,i||e,n),s=a?a+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],o]:e._events[s].push(o):(e._events[s]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function l(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(a=!1)),l.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)i.call(e,t)&&r.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},l.prototype.listeners=function(e){var t=a?a+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,o=new Array(n);i<n;i++)o[i]=r[i].fn;return o},l.prototype.listenerCount=function(e){var t=a?a+e:e,r=this._events[t];return r?r.fn?1:r.length:0},l.prototype.emit=function(e,t,r,i,n,o){var s=a?a+e:e;if(!this._events[s])return!1;var l,u,d=this._events[s],f=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),f){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,i),!0;case 5:return d.fn.call(d.context,t,r,i,n),!0;case 6:return d.fn.call(d.context,t,r,i,n,o),!0}for(u=1,l=new Array(f-1);u<f;u++)l[u-1]=arguments[u];d.fn.apply(d.context,l)}else{var c,h=d.length;for(u=0;u<h;u++)switch(d[u].once&&this.removeListener(e,d[u].fn,void 0,!0),f){case 1:d[u].fn.call(d[u].context);break;case 2:d[u].fn.call(d[u].context,t);break;case 3:d[u].fn.call(d[u].context,t,r);break;case 4:d[u].fn.call(d[u].context,t,r,i);break;default:if(!l)for(c=1,l=new Array(f-1);c<f;c++)l[c-1]=arguments[c];d[u].fn.apply(d[u].context,l)}}return!0},l.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},l.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},l.prototype.removeListener=function(e,t,r,i){var n=a?a+e:e;if(!this._events[n])return this;if(!t)return s(this,n),this;var o=this._events[n];if(o.fn)o.fn!==t||i&&!o.once||r&&o.context!==r||s(this,n);else{for(var l=0,u=[],d=o.length;l<d;l++)(o[l].fn!==t||i&&!o[l].once||r&&o[l].context!==r)&&u.push(o[l]);u.length?this._events[n]=1===u.length?u[0]:u:s(this,n)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=a,l.EventEmitter=l,e.exports=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(21),a=r(1),n=r(0),o=r(53);t.default=function(e){var t=new o.EventEmitter;t.trigger=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(r))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(a){var o=a.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);e.demuxer=new i.default(t,o.typeSupported,s,o.vendor),n.enableLogs(s.debug),r("init",null);break;case"demux":e.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}}),t.on(a.default.FRAG_DECRYPTED,r),t.on(a.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(a.default.FRAG_PARSED,r),t.on(a.default.ERROR,r),t.on(a.default.FRAG_PARSING_METADATA,r),t.on(a.default.FRAG_PARSING_USERDATA,r),t.on(a.default.INIT_PTS_FOUND,r),t.on(a.default.FRAG_PARSING_DATA,function(t,r){var i=[],a={event:t,data:r};r.data1&&(a.data1=r.data1.buffer,i.push(r.data1.buffer),delete r.data1),r.data2&&(a.data2=r.data2.buffer,i.push(r.data2.buffer),delete r.data2),e.postMessage(a,i)})}},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function n(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,o,s,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(n(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(a(r))for(s=Array.prototype.slice.call(arguments,1),o=(u=r.slice()).length,l=0;l<o;l++)u[l].apply(this,s);return!0},r.prototype.addListener=function(e,t){var o;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(o=n(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=!1;function a(){this.removeListener(e,a),r||(r=!0,t.apply(this,arguments))}return a.listener=t,this.on(e,a),this},r.prototype.removeListener=function(e,t){var r,n,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(r=this._events[e]).length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(5),a=r(3),n=r(1),o=r(0),s=function(){function e(e,t,r,i){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=i,this.stallReported=!1}return e.prototype.poll=function(e,t){var r=this.config,a=this.media,n=a.currentTime,s=window.performance.now();if(n!==e)return this.stallReported&&(o.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(s-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);if(!(a.ended||!a.buffered.length||a.readyState>2||a.seeking&&i.BufferHelper.isBuffered(a,n))){var l=s-this.stalled,u=i.BufferHelper.bufferInfo(a,n,r.maxBufferHole);this.stalled?(l>=1e3&&this._reportStall(u.len),this._tryFixBufferStall(u,l)):this.stalled=s}},e.prototype._tryFixBufferStall=function(e,t){var r=this.config,i=this.fragmentTracker,a=this.media.currentTime,n=i.getPartialFragment(a);n&&this._trySkipBufferHole(n),e.len>.5&&t>1e3*r.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},e.prototype._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,o.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer"),t.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},e.prototype._trySkipBufferHole=function(e){for(var t=this.hls,r=this.media,i=r.currentTime,s=0,l=0;l<r.buffered.length;l++){var u=r.buffered.start(l);if(i>=s&&i<u)return r.currentTime=Math.max(u,r.currentTime+.1),o.logger.warn("skipping hole, adjusting currentTime from "+i+" to "+r.currentTime),this.stalled=null,void t.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+r.currentTime,frag:e});s=r.buffered.end(l)}},e.prototype._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,i=r.currentTime,s=(this.nudgeRetry||0)+1;if(this.nudgeRetry=s,s<e.nudgeMaxRetry){var l=i+s*e.nudgeOffset;o.logger.log("adjust currentTime from "+i+" to "+l),r.currentTime=l,t.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else o.logger.error("still stuck in high buffer @"+i+" after "+e.nudgeMaxRetry+", raise fatal error"),t.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}();t.default=s},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a,n=r(1),o=r(4),s=r(0),l=r(3),u=r(19),d=r(8),f=(window.performance,function(e){function t(t){var r=e.call(this,t,n.default.MANIFEST_LOADED,n.default.LEVEL_LOADED,n.default.AUDIO_TRACK_SWITCHED,n.default.FRAG_LOADED,n.default.ERROR)||this;return r.canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,a=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}return i(t,e),t.prototype.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},t.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},t.prototype.stopLoad=function(){this.canload=!1},t.prototype.onManifestLoaded=function(e){var t,r=[],i=[],o={},f=null,c=!1,h=!1;if(e.levels.forEach(function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,c=c||!!e.videoCodec,h=h||!!e.audioCodec,a&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(f=o[e.bitrate])?f.url.push(e.url):(e.url=[e.url],e.urlId=0,o[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&(h=!0,d.addGroupId(f||e,"audio",t.AUDIO)),t.SUBTITLES&&d.addGroupId(f||e,"text",t.SUBTITLES))}),c&&h&&(r=r.filter(function(e){return!!e.videoCodec})),r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||u.isCodecSupportedInMp4(t,"audio"))&&(!r||u.isCodecSupportedInMp4(r,"video"))}),e.audioTracks&&(i=e.audioTracks.filter(function(e){return!e.audioCodec||u.isCodecSupportedInMp4(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),r.length>0){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var p=0;p<r.length;p++)if(r[p].bitrate===t){this._firstLevel=p,s.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(n.default.MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:e.stats,audio:h,video:c,altAudio:i.some(function(e){return!!e.url})})}else this.hls.trigger(n.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},Object.defineProperty(t.prototype,"levels",{get:function(){return this._levels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))},enumerable:!0,configurable:!0}),t.prototype.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){s.logger.log("switching to level "+e),this.currentLevelIndex=e;var i=t[e];i.level=e,r.trigger(n.default.LEVEL_SWITCHING,i)}var a=t[e],o=a.details;if(!o||o.live){var u=a.urlId;r.trigger(n.default.LEVEL_LOADING,{url:a.url[u],level:e,id:u})}}else r.trigger(n.default.ERROR,{type:l.ErrorTypes.OTHER_ERROR,details:l.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},Object.defineProperty(t.prototype,"manualLevel",{get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLevel",{get:function(){return this._firstLevel},set:function(e){this._firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLevel",{get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e},enumerable:!0,configurable:!0}),t.prototype.onError=function(e){if(e.fatal)e.type===l.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,i=!1;switch(e.details){case l.ErrorDetails.FRAG_LOAD_ERROR:case l.ErrorDetails.FRAG_LOAD_TIMEOUT:case l.ErrorDetails.KEY_LOAD_ERROR:case l.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,i=!0;break;case l.ErrorDetails.LEVEL_LOAD_ERROR:case l.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case l.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,i)}},t.prototype.recoverLevel=function(e,t,r,i){var a,n,o,l=this,u=this.hls.config,d=e.details,f=this._levels[t];if(f.loadError++,f.fragmentError=i,r){if(!(this.levelRetryCount+1<=u.levelLoadingMaxRetry))return s.logger.error("level controller, cannot recover from "+d+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);n=Math.min(Math.pow(2,this.levelRetryCount)*u.levelLoadingRetryDelay,u.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return l.loadLevel()},n),e.levelRetry=!0,this.levelRetryCount++,s.logger.warn("level controller, "+d+", retry in "+n+" ms, current retry count is "+this.levelRetryCount)}(r||i)&&((a=f.url.length)>1&&f.loadError<a?(f.urlId=(f.urlId+1)%a,f.details=void 0,s.logger.warn("level controller, "+d+" for level "+t+": switching to redundant URL-id "+f.urlId)):-1===this.manualLevelIndex?(o=0===t?this._levels.length-1:t-1,s.logger.warn("level controller, "+d+": switch to "+o),this.hls.nextAutoLevel=this.currentLevelIndex=o):i&&(s.logger.warn("level controller, "+d+": reload a fragment"),this.currentLevelIndex=null))},t.prototype.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var r=this._levels[t.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},t.prototype.onLevelLoaded=function(e){var t=this,r=e.level,i=e.details;if(r===this.currentLevelIndex){var a=this._levels[r];if(a.fragmentError||(a.loadError=0,this.levelRetryCount=0),i.live){var n=d.computeReloadInterval(a.details,i,e.stats.trequest);s.logger.log("live playlist, reload in "+Math.round(n)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},n)}else this.clearTimer()}},t.prototype.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var i=-1,a=0;a<r.audioGroupIds.length;a++)if(r.audioGroupIds[a]===t){i=a;break}i!==r.urlId&&(r.urlId=i,this.startLoad())}},t.prototype.loadLevel=function(){if(s.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,r=e.urlId,i=e.url[r];s.logger.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(n.default.LEVEL_LOADING,{url:i,level:t,id:r})}}},Object.defineProperty(t.prototype,"nextLoadLevel",{get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)},enumerable:!0,configurable:!0}),t}(o.default));t.default=f},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(11),s=r(29),l=function(e){function t(t){var r=e.call(this,t,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_METADATA)||this;return r.id3Track=void 0,r.media=void 0,r}return i(t,e),t.prototype.destroy=function(){n.default.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(e){this.media=e.media,this.media},t.prototype.onMediaDetaching=function(){s.clearCurrentCues(this.id3Track),this.id3Track=void 0,this.media=void 0},t.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return s.sendAddTrackEvent(r,this.media),r}return this.media.addTextTrack("metadata","id3")},t.prototype.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,a=0;a<r.length;a++){var n=o.default.getID3Frames(r[a].data);if(n){var s=r[a].pts,l=a<r.length-1?r[a+1].pts:t.endPTS;s===l&&(l+=1e-4);for(var u=0;u<n.length;u++){var d=n[u];if(!o.default.isTimeStampFrame(d)){var f=new i(s,l,"");f.value=d,this.id3Track.addCue(f)}}}}},t}(n.default);t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(14);t.isSupported=function(){var e=i.getMediaSource(),t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(59),a=r(62),n=r(63),o=r(64),s=r(65),l=r(66),u=r(67),d=r(68),f=r(70),c=r(74),h=r(75),p=r(76),g=r(77);t.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:s.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:i.default,bufferController:a.default,capLevelController:n.default,fpsController:o.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:g.requestMediaKeySystemAccess},t.hlsDefaultConfig.subtitleStreamController=h.SubtitleStreamController,t.hlsDefaultConfig.subtitleTrackController=c.default,t.hlsDefaultConfig.timelineController=f.default,t.hlsDefaultConfig.cueHandler=d,t.hlsDefaultConfig.enableCEA708Captions=!0,t.hlsDefaultConfig.enableWebVTT=!0,t.hlsDefaultConfig.captionsTextTrack1Label="English",t.hlsDefaultConfig.captionsTextTrack1LanguageCode="en",t.hlsDefaultConfig.captionsTextTrack2Label="Spanish",t.hlsDefaultConfig.captionsTextTrack2LanguageCode="es",t.hlsDefaultConfig.audioStreamController=u.default,t.hlsDefaultConfig.audioTrackController=l.default,t.hlsDefaultConfig.emeController=p.default},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(5),s=r(3),l=r(0),u=r(60),d=window.performance,f=function(t){function r(e){var r=t.call(this,e,a.default.FRAG_LOADING,a.default.FRAG_LOADED,a.default.FRAG_BUFFERED,a.default.ERROR)||this;return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(r),r}return i(r,t),r.prototype.destroy=function(){this.clearTimer(),n.default.prototype.destroy.call(this)},r.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r=this.hls,i=r.config,a=t.level,n=void 0,o=void 0;r.levels[a].details.live?(n=i.abrEwmaFastLive,o=i.abrEwmaSlowLive):(n=i.abrEwmaFastVoD,o=i.abrEwmaSlowVoD),this._bwEstimator=new u.default(r,o,n,i.abrEwmaDefaultEstimate)}},r.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var i=r.loader,n=e.minAutoLevel;if(!i||i.stats&&i.stats.aborted)return l.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var s=i.stats;if(t&&s&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var u=d.now()-s.trequest,f=Math.abs(t.playbackRate);if(u>500*r.duration/f){var c=e.levels,h=Math.max(1,s.bw?s.bw/8:1e3*s.loaded/u),p=c[r.level],g=p.realBitrate?Math.max(p.realBitrate,p.bitrate):p.bitrate,v=s.total?s.total:Math.max(s.loaded,Math.round(r.duration*g/8)),y=t.currentTime,m=(v-s.loaded)/h,E=(o.BufferHelper.bufferInfo(t,y,e.config.maxBufferHole).end-y)/f;if(E<2*r.duration/f&&m>E){var _=void 0,T=void 0;for(T=r.level-1;T>n;T--){var S=c[T].realBitrate?Math.max(c[T].realBitrate,c[T].bitrate):c[T].bitrate;if((_=r.duration*S/(6.4*h))<E)break}_<m&&(l.logger.warn("loading too slow, abort fragment loading and switch to level "+T+":fragLoadedDelay["+T+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+_.toFixed(1)+"<"+m.toFixed(1)+":"+E.toFixed(1)),e.nextLoadLevel=T,this._bwEstimator.sample(u,s.loaded),i.abort(),this.clearTimer(),e.trigger(a.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:s}))}}}}},r.prototype.onFragLoaded=function(t){var r=t.frag;if("main"===r.type&&e.isFinite(r.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[r.level],a=(i.loaded?i.loaded.bytes:0)+t.stats.loaded,n=(i.loaded?i.loaded.duration:0)+t.frag.duration;i.loaded={bytes:a,duration:n},i.realBitrate=Math.round(8*a/n)}if(t.frag.bitrateTest){var o=t.stats;o.tparsed=o.tbuffered=o.tload,this.onFragBuffered(t)}}},r.prototype.onFragBuffered=function(t){var r=t.stats,i=t.frag;if(!0!==r.aborted&&"main"===i.type&&e.isFinite(i.sn)&&(!i.bitrateTest||r.tload===r.tbuffered)){var a=r.tparsed-r.trequest;l.logger.log("latency/loading/parsing/append/kbps:"+Math.round(r.tfirst-r.trequest)+"/"+Math.round(r.tload-r.tfirst)+"/"+Math.round(r.tparsed-r.tload)+"/"+Math.round(r.tbuffered-r.tparsed)+"/"+Math.round(8*r.loaded/(r.tbuffered-r.trequest))),this._bwEstimator.sample(a,r.loaded),r.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}},r.prototype.onError=function(e){switch(e.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},r.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},Object.defineProperty(r.prototype,"nextAutoLevel",{get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_nextABRAutoLevel",{get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,i=e.config,a=e.minAutoLevel,n=e.media,s=this.lastLoadedFragLevel,u=this.fragCurrent?this.fragCurrent.duration:0,d=n?n.currentTime:0,f=n&&0!==n.playbackRate?Math.abs(n.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,h=(o.BufferHelper.bufferInfo(n,d,i.maxBufferHole).end-d)/f,p=this._findBestLevel(s,u,c,a,t,h,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(p>=0)return p;l.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var g=u?Math.min(u,i.maxStarvationDelay):i.maxStarvationDelay,v=i.abrBandWidthFactor,y=i.abrBandWidthUpFactor;if(0===h){var m=this.bitrateTestDelay;if(m)g=(u?Math.min(u,i.maxLoadingDelay):i.maxLoadingDelay)-m,l.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms"),v=y=1}return p=this._findBestLevel(s,u,c,a,t,h+g,v,y,r),Math.max(p,0)},enumerable:!0,configurable:!0}),r.prototype._findBestLevel=function(e,t,r,i,a,n,o,s,u){for(var d=a;d>=i;d--){var f=u[d];if(f){var c=f.details,h=c?c.totalduration/c.fragments.length:t,p=!!c&&c.live,g=void 0;g=d<=e?o*r:s*r;var v=u[d].realBitrate?Math.max(u[d].realBitrate,u[d].bitrate):u[d].bitrate,y=v*h/g;if(l.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+d+"/"+Math.round(g)+"/"+v+"/"+h+"/"+n+"/"+y),g>v&&(!y||p&&!this.bitrateTestDelay||y<n))return d}}return-1},r}(n.default);t.default=f}).call(this,r(2).Number)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(61),a=function(){function e(e,t,r,a){this.hls=e,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new i.default(t),this.fast_=new i.default(r)}return e.prototype.sample=function(e,t){var r=8e3*t/(e=Math.max(e,this.minDelayMs_)),i=e/1e3;this.fast_.sample(i,r),this.slow_.sample(i,r)},e.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},e.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.prototype.destroy=function(){},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}return e.prototype.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},e.prototype.getTotalWeight=function(){return this.totalWeight_},e.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}();t.default=i},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(0),s=r(3),l=r(14).getMediaSource(),u=function(t){function r(e){var r=t.call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.MANIFEST_PARSED,a.default.BUFFER_RESET,a.default.BUFFER_APPENDING,a.default.BUFFER_CODECS,a.default.BUFFER_EOS,a.default.BUFFER_FLUSHING,a.default.LEVEL_PTS_UPDATED,a.default.LEVEL_UPDATED)||this;return r._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r.bufferCodecEventsExpected=0,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return i(r,t),r.prototype.destroy=function(){n.default.prototype.destroy.call(this)},r.prototype.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var i=this.sourceBuffer.audio;if(Math.abs(i.timestampOffset-e.start)>.1){var a=i.updating;try{i.abort()}catch(e){o.logger.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(o.logger.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+e.start),i.timestampOffset=e.start)}}},r.prototype.onManifestParsed=function(e){this.bufferCodecEventsExpected=e.altAudio?2:1,o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},r.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new l;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},r.prototype.onMediaDetaching=function(){o.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){o.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):o.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(a.default.MEDIA_DETACHED)},r.prototype.onMediaSourceOpen=function(){o.logger.log("media source opened"),this.hls.trigger(a.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},r.prototype.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},r.prototype.onMediaSourceClose=function(){o.logger.log("media source closed")},r.prototype.onMediaSourceEnded=function(){o.logger.log("media source ended")},r.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;o.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce(function(e,r){return r.parent===t?e+1:e},0),i={},n=this.sourceBuffer;for(var s in n)i[s]=n[s].buffered;this.hls.trigger(a.default.BUFFER_APPENDED,{parent:t,pending:r,timeRanges:i}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration(),0===r&&this.flushLiveBackBuffer()},r.prototype.onSBUpdateError=function(e){o.logger.error("sourceBuffer error:",e),this.hls.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},r.prototype.onBufferCodecs=function(e){var t=this;if(!Object.keys(this.sourceBuffer).length){Object.keys(e).forEach(function(r){t.pendingTracks[r]=e[r]});var r=this.mediaSource;this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),r&&"open"===r.readyState&&this.checkPendingTracks()}},r.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var i in e)if(!t[i]){var n=e[i],l=n.levelCodec||n.codec,u=n.container+";codecs="+l;o.logger.log("creating sourceBuffer("+u+")");try{var d=t[i]=r.addSourceBuffer(u);d.addEventListener("updateend",this.onsbue),d.addEventListener("error",this.onsbe),this.tracks[i]={codec:l,container:n.container},n.buffer=d}catch(e){o.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:u})}}this.hls.trigger(a.default.BUFFER_CREATED,{tracks:e})},r.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},r.prototype.onBufferAppendFail=function(e){o.logger.error("sourceBuffer error:",e.event),this.hls.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.prototype.onBufferEos=function(e){var t=this.sourceBuffer,r=e.type;for(var i in t)r&&i!==r||t[i].ended||(t[i].ended=!0,o.logger.log(i+" sourceBuffer now EOS"));this.checkEos()},r.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var i=e[r];if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}o.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){o.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},r.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},r.prototype.flushLiveBackBuffer=function(){if(this._live){var e=this.hls.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))for(var t=this.media.currentTime,r=this.sourceBuffer,i=Object.keys(r),a=t-Math.max(e,this._levelTargetDuration),n=i.length-1;n>=0;n--){var o=i[n],s=r[o].buffered;s.length>0&&a>s.start(0)&&this.removeBufferRange(o,r[o],0,a)}}},r.prototype.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},r.prototype.updateMediaElementDuration=function(){var t,r=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;t=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===r.liveDurationInfinity?(o.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||!e.isFinite(t))&&(o.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},r.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var i in r)t+=r[i].buffered.length}catch(e){o.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(a.default.BUFFER_FLUSHED)}},r.prototype.doAppending=function(){var e=this.hls,t=this.segments,r=this.sourceBuffer;if(Object.keys(r).length){if(this.media.error)return this.segments=[],void o.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(t&&t.length){var i=t.shift();try{var n=r[i.type];n?n.updating?t.unshift(i):(n.ended=!1,this.parent=i.parent,n.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(r){o.logger.error("error while trying to append buffer:"+r.message),t.unshift(i);var l={type:s.ErrorTypes.MEDIA_ERROR,parent:i.parent};22!==r.code?(this.appendError?this.appendError++:this.appendError=1,l.details=s.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry?(o.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],l.fatal=!0,e.trigger(a.default.ERROR,l)):(l.fatal=!1,e.trigger(a.default.ERROR,l))):(this.segments=[],l.details=s.ErrorDetails.BUFFER_FULL_ERROR,l.fatal=!1,e.trigger(a.default.ERROR,l))}}}},r.prototype.flushBuffer=function(e,t,r){var i,a=this.sourceBuffer;if(Object.keys(a).length){if(o.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var n in a)if(!r||n===r){if((i=a[n]).ended=!1,i.updating)return o.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(n,i,e,t))return this.flushBufferCounter++,!1}}else o.logger.warn("abort flushing too many retries");o.logger.log("buffer flushed")}return!0},r.prototype.removeBufferRange=function(e,t,r,i){try{for(var a=0;a<t.buffered.length;a++){var n=t.buffered.start(a),s=t.buffered.end(a),l=Math.max(n,r),u=Math.min(s,i);if(Math.min(u,s)-l>.5)return o.logger.log("sb remove "+e+" ["+l+","+u+"], of ["+n+","+s+"], pos:"+this.media.currentTime),t.remove(l,u),!0}}catch(e){o.logger.warn("removeBufferRange failed",e)}return!1},r}(n.default);t.default=u}).call(this,r(2).Number)},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=function(t){function r(r){var i=t.call(this,r,a.default.FPS_DROP_LEVEL_CAPPING,a.default.MEDIA_ATTACHING,a.default.MANIFEST_PARSED,a.default.BUFFER_CODECS,a.default.MEDIA_DETACHING)||this;return i.autoLevelCapping=e.POSITIVE_INFINITY,i.firstLevel=null,i.levels=[],i.media=null,i.restrictedLevels=[],i.timer=null,i}return i(r,t),r.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},r.prototype.onFpsDropLevelCapping=function(e){r.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},r.prototype.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},r.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this._startCapping()},r.prototype.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this._startCapping()},r.prototype.onLevelsUpdated=function(e){this.levels=e.levels},r.prototype.onMediaDetaching=function(){this._stopCapping()},r.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},r.prototype.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var i=this.levels.filter(function(i,a){return r.isLevelAllowed(a,t.restrictedLevels)&&a<=e});return r.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},r.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=e.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},r.prototype._stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=e.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},Object.defineProperty(r.prototype,"mediaWidth",{get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=r.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mediaHeight",{get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=r.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(r,"contentScaleFactor",{get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e},enumerable:!0,configurable:!0}),r.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},r.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var i=function(e,t){return!t||(e.width!==t.width||e.height!==t.height)},a=e.length-1,n=0;n<e.length;n+=1){var o=e[n];if((o.width>=t||o.height>=r)&&i(o,e[n+1])){a=n;break}}return a},r}(r(4).default);t.default=n}).call(this,r(2).Number)},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(0),s=window.performance,l=function(e){function t(t){return e.call(this,t,a.default.MEDIA_ATTACHING)||this}return i(t,e),t.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},t.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},t.prototype.checkFPS=function(e,t,r){var i=s.now();if(t){if(this.lastTime){var n=i-this.lastTime,l=r-this.lastDroppedFrames,u=t-this.lastDecodedFrames,d=1e3*l/n,f=this.hls;if(f.trigger(a.default.FPS_DROP,{currentDropped:l,currentDecoded:u,totalDroppedFrames:r}),d>0&&l>f.config.fpsDroppedMonitoringThreshold*u){var c=f.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(-1===f.autoLevelCapping||f.autoLevelCapping>=c)&&(c-=1,f.trigger(a.default.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:f.currentLevel}),f.autoLevelCapping=c,f.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},t.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},t}(n.default);t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=window.performance,n=window.XMLHttpRequest,o=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return e.prototype.destroy=function(){this.abort(),this.loader=null},e.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:a.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},e.prototype.loadInternal=function(){var e,t=this.context;e=this.loader=new n;var r=this.stats;r.tfirst=0,r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(e,t.url)}catch(r){e.open("GET",t.url,!0),i(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},e.prototype.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,n=this.stats,o=this.context,s=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(a.now(),n.trequest)),4===r){var l=t.status;if(l>=200&&l<300){n.tload=Math.max(n.tfirst,a.now());var u=void 0,d=void 0;d="arraybuffer"===o.responseType?(u=t.response).byteLength:(u=t.responseText).length,n.loaded=n.total=d;var f={url:t.responseURL,data:u};this.callbacks.onSuccess(f,n,o,t)}else n.retry>=s.maxRetry||l>=400&&l<499?(i.logger.error(l+" while loading "+o.url),this.callbacks.onError({code:l,text:t.statusText},o,t)):(i.logger.warn(l+" while loading "+o.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)},e.prototype.loadtimeout=function(){i.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.prototype.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,t)},e}();t.default=o},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(28),o=r(0),s=r(3),l=function(e){function t(t){var r=e.call(this,t,a.default.MANIFEST_LOADING,a.default.MANIFEST_PARSED,a.default.AUDIO_TRACK_LOADED,a.default.AUDIO_TRACK_SWITCHED,a.default.LEVEL_LOADED,a.default.ERROR)||this;return r._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}return i(t,e),t.prototype.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},t.prototype.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(a.default.AUDIO_TRACKS_UPDATED,{audioTracks:t})},t.prototype.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)o.logger.warn("Invalid audio track id:",e.id);else{if(o.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},t.prototype.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},t.prototype.onLevelLoaded=function(e){var t=this.hls.levels[e.level];if(t.audioGroupIds){var r=t.audioGroupIds[t.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},t.prototype.onError=function(e){e.type===s.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(o.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},Object.defineProperty(t.prototype,"audioTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTrack",{get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1},enumerable:!0,configurable:!0}),t.prototype._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)o.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)o.logger.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];o.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var r=t.url,i=t.type,n=t.id;this.hls.trigger(a.default.AUDIO_TRACK_SWITCHING,{id:n,type:i,url:r}),this._loadTrackDetailsIfNeeded(t)}},t.prototype.doTick=function(){this._updateTrack(this._trackId)},t.prototype._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var r=this.tracks[this._trackId],i=null;if(r&&(i=r.name),this._selectDefaultTrack){var n=t.filter(function(e){return e.default});n.length?t=n:o.logger.warn("No default audio tracks defined")}var l=!1,u=function(){t.forEach(function(t){l||e.audioGroupId&&t.groupId!==e.audioGroupId||i&&i!==t.name||(e._setAudioTrack(t.id),l=!0)})};u(),l||(i=null,u()),l||(o.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(a.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},t.prototype._needsTrackLoading=function(e){var t=e.details,r=e.url;return!(t&&!t.live)&&!!r},t.prototype._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,r=e.id;o.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(a.default.AUDIO_TRACK_LOADING,{url:t,id:r})}},t.prototype._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,o.logger.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},t.prototype._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,i=t.language,a=t.groupId;o.logger.warn("Loading failed on audio track id: "+e+", group-id: "+a+', name/language: "'+r+'" / "'+i+'"');for(var n=e,s=0;s<this.tracks.length;s++){if(!this.trackIdBlacklist[s])if(this.tracks[s].name===r){n=s;break}}n!==e?(o.logger.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId),this._setAudioTrack(n)):o.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+i+'"')},t}(n.default);t.default=l},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(10),n=r(5),o=r(20),s=r(1),l=r(8),u=r(25),d=r(3),f=r(0),c=r(26),h=r(7),p=r(12),g=r(15),v=window.performance,y=function(t){function r(e,r){var i=t.call(this,e,s.default.MEDIA_ATTACHED,s.default.MEDIA_DETACHING,s.default.AUDIO_TRACKS_UPDATED,s.default.AUDIO_TRACK_SWITCHING,s.default.AUDIO_TRACK_LOADED,s.default.KEY_LOADED,s.default.FRAG_LOADED,s.default.FRAG_PARSING_INIT_SEGMENT,s.default.FRAG_PARSING_DATA,s.default.FRAG_PARSED,s.default.ERROR,s.default.BUFFER_RESET,s.default.BUFFER_CREATED,s.default.BUFFER_APPENDED,s.default.BUFFER_FLUSHED,s.default.INIT_PTS_FOUND)||this;return i.fragmentTracker=r,i.config=e.config,i.audioCodecSwap=!1,i._state=g.State.STOPPED,i.initPTS=[],i.waitingFragment=null,i.videoTrackCC=null,i}return i(r,t),r.prototype.onInitPtsFound=function(e){var t=e.id,r=e.frag.cc,i=e.initPTS;"main"===t&&(this.initPTS[r]=i,this.videoTrackCC=r,f.logger.log("InitPTS for cc: "+r+" found from video track: "+i),this.state===g.State.WAITING_INIT_PTS&&this.tick())},r.prototype.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(f.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=g.State.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=g.State.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=g.State.STOPPED},Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(e){if(this.state!==e){var t=this.state;this._state=e,f.logger.log("audio stream:"+t+"->"+e)}},enumerable:!0,configurable:!0}),r.prototype.doTick=function(){var t,r,i,o=this.hls,l=o.config;switch(this.state){case g.State.ERROR:case g.State.PAUSED:case g.State.BUFFER_FLUSHING:break;case g.State.STARTING:this.state=g.State.WAITING_TRACK,this.loadedmetadata=!1;break;case g.State.IDLE:var u=this.tracks;if(!u)break;if(!this.media&&(this.startFragRequested||!l.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var d=this.mediaBuffer?this.mediaBuffer:this.media,p=this.videoBuffer?this.videoBuffer:this.media,y=n.BufferHelper.bufferInfo(d,t,l.maxBufferHole),m=n.BufferHelper.bufferInfo(p,t,l.maxBufferHole),E=y.len,_=y.end,T=this.fragPrevious,S=Math.min(l.maxBufferLength,l.maxMaxBufferLength),b=Math.max(S,m.len),A=this.audioSwitch,R=this.trackId;if((E<b||A)&&R<u.length){if(void 0===(i=u[R].details)){this.state=g.State.WAITING_TRACK;break}if(!A&&this._streamEnded(y,i))return this.hls.trigger(s.default.BUFFER_EOS,{type:"audio"}),void(this.state=g.State.ENDED);var D=i.fragments,L=D.length,w=D[0].start,O=D[L-1].start+D[L-1].duration,I=void 0;if(A)if(i.live&&!i.PTSKnown)f.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),_=0;else if(_=t,i.PTSKnown&&t<w){if(!(y.end>w||y.nextStart))return;f.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=w+.05}if(i.initSegment&&!i.initSegment.data)I=i.initSegment;else if(_<=w){if(I=D[0],null!==this.videoTrackCC&&I.cc!==this.videoTrackCC&&(I=c.findFragWithCC(D,this.videoTrackCC)),i.live&&I.loadIdx&&I.loadIdx===this.fragLoadIdx){var P=y.nextStart?y.nextStart:w;return f.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(P+.05)),void(this.media.currentTime=P+.05)}}else{var k=void 0,C=l.maxFragLookUpTolerance,F=T?D[T.sn-D[0].sn+1]:void 0,x=function(e){var t=Math.min(C,e.duration);return e.start+e.duration-t<=_?1:e.start-t>_&&e.start?-1:0};_<O?(_>O-C&&(C=0),k=F&&!x(F)?F:a.default.search(D,x)):k=D[L-1],k&&(I=k,w=k.start,T&&I.level===T.level&&I.sn===T.sn&&(I.sn<i.endSN?(I=D[I.sn+1-i.startSN],f.logger.log("SN just loaded, load next one: "+I.sn)):I=null))}I&&(I.encrypted?(f.logger.log("Loading key for "+I.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+R),this.state=g.State.KEY_LOADING,o.trigger(s.default.KEY_LOADING,{frag:I})):(f.logger.log("Loading "+I.sn+", cc: "+I.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+R+", currentTime:"+t+",bufferEnd:"+_.toFixed(3)),this.fragCurrent=I,(A||this.fragmentTracker.getState(I)===h.FragmentState.NOT_LOADED)&&(this.startFragRequested=!0,e.isFinite(I.sn)&&(this.nextLoadPosition=I.start+I.duration),o.trigger(s.default.FRAG_LOADING,{frag:I}),this.state=g.State.FRAG_LOADING)))}break;case g.State.WAITING_TRACK:(r=this.tracks[this.trackId])&&r.details&&(this.state=g.State.IDLE);break;case g.State.FRAG_LOADING_WAITING_RETRY:var M=v.now(),N=this.retryDate,U=(d=this.media)&&d.seeking;(!N||M>=N||U)&&(f.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=g.State.IDLE);break;case g.State.WAITING_INIT_PTS:var B=this.videoTrackCC;if(void 0===this.initPTS[B])break;var G=this.waitingFragment;if(G){var j=G.frag.cc;B!==j?(r=this.tracks[this.trackId]).details&&r.details.live&&(f.logger.warn("Waiting fragment CC ("+j+") does not match video track CC ("+B+")"),this.waitingFragment=null,this.state=g.State.IDLE):(this.state=g.State.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=g.State.IDLE;break;case g.State.STOPPED:case g.State.FRAG_LOADING:case g.State.PARSING:case g.State.PARSED:case g.State.ENDED:}},r.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},r.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(f.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},r.prototype.onAudioTracksUpdated=function(e){f.logger.log("audio tracks updated"),this.tracks=e.audioTracks},r.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=g.State.PAUSED,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=g.State.IDLE),this.tick()},r.prototype.onAudioTrackLoaded=function(t){var r=t.details,i=t.id,a=this.tracks[i],n=r.totalduration,o=0;if(f.logger.log("track "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+n),r.live){var s=a.details;s&&r.fragments.length>0?(l.mergeDetails(s,r),o=r.fragments[0].start,r.PTSKnown?f.logger.log("live audio playlist sliding:"+o.toFixed(3)):f.logger.log("live audio playlist - outdated PTS, unknown sliding")):(r.PTSKnown=!1,f.logger.log("live audio playlist - first load, unknown sliding"))}else r.PTSKnown=!1;if(a.details=r,!this.startFragRequested){if(-1===this.startPosition){var u=r.startTimeOffset;e.isFinite(u)?(f.logger.log("start time offset found in playlist, adjust startPosition to "+u),this.startPosition=u):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===g.State.WAITING_TRACK&&(this.state=g.State.IDLE),this.tick()},r.prototype.onKeyLoaded=function(){this.state===g.State.KEY_LOADING&&(this.state=g.State.IDLE,this.tick())},r.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===g.State.FRAG_LOADING&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var i=this.tracks[this.trackId],a=i.details,n=a.totalduration,l=t.level,u=t.sn,d=t.cc,c=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===u)this.state=g.State.IDLE,h.tparsed=h.tbuffered=v.now(),a.initSegment.data=e.payload,this.hls.trigger(s.default.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=g.State.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new o.default(this.hls,"audio"));var p=this.initPTS[d],y=a.initSegment?a.initSegment.data:[];if(a.initSegment||void 0!==p){this.pendingBuffering=!0,f.logger.log("Demuxing "+u+" of ["+a.startSN+" ,"+a.endSN+"],track "+l);this.demuxer.push(e.payload,y,c,null,t,n,!1,p)}else f.logger.log("unknown video PTS for continuity counter "+d+", waiting for video PTS before demuxing audio frag "+u+" of ["+a.startSN+" ,"+a.endSN+"],track "+l),this.waitingFragment=e,this.state=g.State.WAITING_INIT_PTS}}this.fragLoadError=0},r.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===g.State.PARSING){var i=e.tracks,a=void 0;if(i.video&&delete i.video,a=i.audio){a.levelCodec=a.codec,a.id=e.id,this.hls.trigger(s.default.BUFFER_CODECS,i),f.logger.log("audio track:audio,container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var n=a.initSegment;if(n){var o={type:"audio",data:n,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(s.default.BUFFER_APPENDING,o))}this.tick()}}},r.prototype.onFragParsingData=function(t){var r=this,i=this.fragCurrent,a=t.frag;if(i&&"audio"===t.id&&"audio"===t.type&&a.sn===i.sn&&a.level===i.level&&this.state===g.State.PARSING){var n=this.trackId,o=this.tracks[n],u=this.hls;e.isFinite(t.endPTS)||(t.endPTS=t.startPTS+i.duration,t.endDTS=t.startDTS+i.duration),i.addElementaryStream(p.default.ElementaryStreamTypes.AUDIO),f.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),l.updateFragPTSDTS(o.details,i,t.startPTS,t.endPTS);var c=this.audioSwitch,h=this.media,v=!1;if(c&&h)if(h.readyState){var y=h.currentTime;f.logger.log("switching audio track : currentTime:"+y),y>=t.startPTS&&(f.logger.log("switching audio track : flushing all audio"),this.state=g.State.BUFFER_FLUSHING,u.trigger(s.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"}),v=!0,this.audioSwitch=!1,u.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,u.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:n});var m=this.pendingData;if(!m)return f.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void u.trigger(s.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&m.push({type:t.type,data:e,parent:"audio",content:"data"})}),!v&&m.length&&(m.forEach(function(e){r.state===g.State.PARSING&&(r.pendingBuffering=!0,r.hls.trigger(s.default.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},r.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===g.State.PARSING&&(this.stats.tparsed=v.now(),this.state=g.State.PARSED,this._checkAppendedParsed())},r.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},r.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},r.prototype.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==g.State.PARSING&&t!==g.State.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},r.prototype._checkAppendedParsed=function(){if(!(this.state!==g.State.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=v.now(),r.trigger(s.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;f.logger.log("audio buffered : "+u.default.toString(i.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=g.State.IDLE}this.tick()}},r.prototype.onError=function(t){var r=t.frag;if(!r||"audio"===r.type)switch(t.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:var i=t.frag;if(i&&"audio"!==i.type)break;if(!t.fatal){var a=this.fragLoadError;if(a?a++:a=1,a<=(l=this.config).fragLoadingMaxRetry){this.fragLoadError=a;var o=Math.min(Math.pow(2,a-1)*l.fragLoadingRetryDelay,l.fragLoadingMaxRetryTimeout);f.logger.warn("AudioStreamController: frag loading failed, retry in "+o+" ms"),this.retryDate=v.now()+o,this.state=g.State.FRAG_LOADING_WAITING_RETRY}else f.logger.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=g.State.ERROR}break;case d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case d.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==g.State.ERROR&&(this.state=t.fatal?g.State.ERROR:g.State.IDLE,f.logger.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case d.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===g.State.PARSING||this.state===g.State.PARSED)){var l,u=this.mediaBuffer,c=this.media.currentTime;if(u&&n.BufferHelper.isBuffered(u,c)&&n.BufferHelper.isBuffered(u,c+.5))(l=this.config).maxMaxBufferLength>=l.maxBufferLength&&(l.maxMaxBufferLength/=2,f.logger.warn("AudioStreamController: reduce max buffer length to "+l.maxMaxBufferLength+"s")),this.state=g.State.IDLE;else f.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=g.State.BUFFER_FLUSHING,this.hls.trigger(s.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"})}}},r.prototype.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(f.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach(function(t){e.hls.trigger(s.default.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=g.State.PARSED):(this.state=g.State.IDLE,this.fragPrevious=null,this.tick())},r}(g.default);t.default=y}).call(this,r(2).Number)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(30);t.newCue=function(e,t,r,a){for(var n,o,s,l,u,d=window.VTTCue||window.TextTrackCue,f=0;f<a.rows.length;f++)if(s=!0,l=0,u="",!(n=a.rows[f]).isEmpty()){for(var c=0;c<n.chars.length;c++)n.chars[c].uchar.match(/\s/)&&s?l++:(u+=n.chars[c].uchar,s=!1);n.cueStartTime=t,t===r&&(r+=1e-4),o=new d(t,r,i.fixLineBreaks(u.trim())),l>=16?l--:l++,navigator.userAgent.match(/Firefox\//)?o.line=f+1:o.line=f>7?f-2:f+1,o.align="left",o.position=Math.max(0,Math.min(100,l/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(o)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e="auto",t={"":!0,lr:!0,rl:!0},r={start:!0,middle:!0,end:!0,left:!0,right:!0};function i(e){return"string"==typeof e&&(!!r[e.toLowerCase()]&&e.toLowerCase())}function a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]=r[i]}return e}function n(r,n,o){var s=this,l=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),u={};l?s=document.createElement("custom"):u.enumerable=!0,s.hasBeenReset=!1;var d="",f=!1,c=r,h=n,p=o,g=null,v="",y=!0,m="auto",E="start",_=50,T="middle",S=50,b="middle";if(Object.defineProperty(s,"id",a({},u,{get:function(){return d},set:function(e){d=""+e}})),Object.defineProperty(s,"pauseOnExit",a({},u,{get:function(){return f},set:function(e){f=!!e}})),Object.defineProperty(s,"startTime",a({},u,{get:function(){return c},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",a({},u,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",a({},u,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",a({},u,{get:function(){return g},set:function(e){g=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",a({},u,{get:function(){return v},set:function(e){var r=function(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");v=r,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",a({},u,{get:function(){return y},set:function(e){y=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",a({},u,{get:function(){return m},set:function(t){if("number"!=typeof t&&t!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",a({},u,{get:function(){return E},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",a({},u,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",a({},u,{get:function(){return T},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",a({},u,{get:function(){return S},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");S=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",a({},u,{get:function(){return b},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),s.displayState=void 0,l)return s}return n.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},n}()},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(71),s=r(72),l=r(73),u=r(0),d=r(29);function f(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}function c(e,t,r,i){return Math.min(t,i)-Math.max(e,r)}var h=function(t){function r(e){var r=t.call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_USERDATA,a.default.FRAG_DECRYPTED,a.default.MANIFEST_LOADING,a.default.MANIFEST_LOADED,a.default.FRAG_LOADED,a.default.LEVEL_SWITCHING,a.default.INIT_PTS_FOUND)||this;if(r.hls=e,r.config=e.config,r.enabled=!0,r.Cues=e.config.cueHandler,r.textTracks=[],r.tracks=[],r.unparsedVttFrags=[],r.initPTS=[],r.cueRanges=[],r.captionsTracks={},r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode}},r.config.enableCEA708Captions){var i=new s.default(r,"textTrack1"),n=new s.default(r,"textTrack2");r.cea608Parser=new o.default(0,i,n)}return r}return i(r,t),r.prototype.addCues=function(e,t,r,i){for(var a=this.cueRanges,n=!1,o=a.length;o--;){var s=a[o],l=c(s[0],s[1],t,r);if(l>=0&&(s[0]=Math.min(s[0],t),s[1]=Math.max(s[1],r),n=!0,l/(r-t)>.5))return}n||a.push([t,r]),this.Cues.newCue(this.captionsTracks[e],t,r,i)},r.prototype.onInitPtsFound=function(e){var t=this;if("main"===e.id&&(this.initPTS[e.frag.cc]=e.initPTS),this.unparsedVttFrags.length){var r=this.unparsedVttFrags;this.unparsedVttFrags=[],r.forEach(function(e){t.onFragLoaded(e)})}},r.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var i=t.textTracks[r];if(i[e])return i}return null},r.prototype.createCaptionsTrack=function(e){var t=this.captionsProperties[e],r=t.label,i=t.languageCode,a=this.captionsTracks;if(!a[e]){var n=this.getExistingTrack(e);if(n)a[e]=n,d.clearCurrentCues(a[e]),d.sendAddTrackEvent(a[e],this.media);else{var o=this.createTextTrack("captions",r,i);o&&(o[e]=!0,a[e]=o)}}},r.prototype.createTextTrack=function(e,t,r){var i=this.media;if(i)return i.addTextTrack(e,t,r)},r.prototype.destroy=function(){n.default.prototype.destroy.call(this)},r.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},r.prototype.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(t){d.clearCurrentCues(e[t]),delete e[t]})},r.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},r.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)d.clearCurrentCues(t[r])}},r.prototype.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var r=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,i){var a;if(i<r.length){for(var n=null,o=0;o<r.length;o++)if(f(r[o],e)){n=r[o];break}n&&(a=n)}a||(a=t.createTextTrack("subtitles",e.name,e.lang)),e.default?a.mode=t.hls.subtitleDisplay?"showing":"hidden":a.mode="disabled",t.textTracks.push(a)})}},r.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},r.prototype.onFragLoaded=function(t){var r=t.frag,i=t.payload;if("main"===r.type){var n=r.sn;if(n!==this.lastSn+1){var o=this.cea608Parser;o&&o.reset()}this.lastSn=n}else if("subtitle"===r.type)if(i.byteLength){if(!e.isFinite(this.initPTS[r.cc]))return this.unparsedVttFrags.push(t),void(this.initPTS.length&&this.hls.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r}));var s=r.decryptdata;null!=s&&null!=s.key&&"AES-128"===s.method||this._parseVTTs(r,i)}else this.hls.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r})},r.prototype._parseVTTs=function(e,t){var r=this.vttCCs;r[e.cc]||(r[e.cc]={start:e.start,prevCC:this.prevCC,new:!0},this.prevCC=e.cc);var i=this.textTracks,n=this.hls;l.default.parse(t,this.initPTS[e.cc],r,e.cc,function(t){var r=i[e.level];"disabled"!==r.mode?(t.forEach(function(e){if(!r.cues.getCueById(e.id))try{r.addCue(e)}catch(i){var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,r.addCue(t)}}),n.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})):n.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},function(t){u.logger.log("Failed to parse VTT cue: "+t),n.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})})},r.prototype.onFragDecrypted=function(t){var r=t.payload,i=t.frag;if("subtitle"===i.type){if(!e.isFinite(this.initPTS[i.cc]))return void this.unparsedVttFrags.push(t);this._parseVTTs(i,r)}},r.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var r=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,r)}},r.prototype.extractCea608Data=function(e){for(var t,r,i,a=31&e[0],n=2,o=[],s=0;s<a;s++)t=e[n++],r=127&e[n++],i=127&e[n++],0===r&&0===i||0!=(4&t)&&0===(3&t)&&(o.push(r),o.push(i));return o},r}(n.default);t.default=h}).call(this,r(2).Number)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},a=function(e){var t=e;return i.hasOwnProperty(e)&&(t=i[e]),String.fromCharCode(t)},n=15,o=100,s={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},u={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},d={25:2,26:4,29:6,30:8,31:10,27:13,28:15},f=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){this.verboseFilter[e];this.verboseLevel}},h=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},p=function(){function e(e,t,r,i,a){this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=i||"black",this.flash=a||!1}return e.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i])}},e.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},e.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},e.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),g=function(){function e(e,t,r,i,a,n){this.uchar=e||" ",this.penState=new p(t,r,i,a,n)}return e.prototype.reset=function(){this.uchar=" ",this.penState.reset()},e.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},e.prototype.setPenState=function(e){this.penState.copy(e)},e.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},e.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},e.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),v=function(){function e(){this.chars=[];for(var e=0;e<o;e++)this.chars.push(new g);this.pos=0,this.currPenState=new p}return e.prototype.equals=function(e){for(var t=!0,r=0;r<o;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<o;t++)this.chars[t].copy(e.chars[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<o;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},e.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>o&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=o)},e.prototype.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},e.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.prototype.insertChar=function(e){e>=144&&this.backSpace();var t=a(e);this.pos>=o?c.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},e.prototype.clearFromPos=function(e){var t;for(t=e;t<o;t++)this.chars[t].reset()},e.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.prototype.getTextString=function(){for(var e=[],t=!0,r=0;r<o;r++){var i=this.chars[r].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},e.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),y=function(){function e(){this.rows=[];for(var e=0;e<n;e++)this.rows.push(new v);this.currRow=n-1,this.nrRollUpRows=null,this.reset()}return e.prototype.reset=function(){for(var e=0;e<n;e++)this.rows[e].clear();this.currRow=n-1},e.prototype.equals=function(e){for(var t=!0,r=0;r<n;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<n;t++)this.rows[t].copy(e.rows[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<n;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},e.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},e.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},e.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},e.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},e.prototype.setCursor=function(e){c.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},e.prototype.setPAC=function(e){c.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<n;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var o=a.rows[i].cueStartTime;if(o&&o<c.time)for(r=0;r<this.nrRollUpRows;r++)this.rows[t-this.nrRollUpRows+r+1].copy(a.rows[i+r])}}this.currRow=t;var s=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,u=Math.max(l-1,0);s.setCursor(e.indent),e.color=s.chars[u].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},e.prototype.setBkgData=function(e){c.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},e.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},e.prototype.rollUp=function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),c.log("INFO","Rolling up")}else c.log("DEBUG","roll_up but nrRollUpRows not set yet")},e.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],r="",i=-1,a=0;a<n;a++){var o=this.rows[a].getTextString();o&&(i=a+1,e?t.push("Row "+i+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},e.prototype.getTextAndFormat=function(){return this.rows},e}(),m=function(){function e(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new y,this.nonDisplayedMemory=new y,this.lastOutputScreen=new y,this.currRollUpRow=this.displayedMemory.rows[n-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return e.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[n-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},e.prototype.getHandler=function(){return this.outputFilter},e.prototype.setHandler=function(e){this.outputFilter=e},e.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},e.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},e.prototype.setMode=function(e){e!==this.mode&&(this.mode=e,c.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},e.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";c.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.prototype.ccRCL=function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.prototype.ccBS=function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.prototype.ccAOF=function(){},e.prototype.ccAON=function(){},e.prototype.ccDER=function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.prototype.ccRU=function(e){c.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},e.prototype.ccFON=function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.prototype.ccRDC=function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.prototype.ccTR=function(){c.log("INFO","TR"),this.setMode("MODE_TEXT")},e.prototype.ccRTD=function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT")},e.prototype.ccEDM=function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.prototype.ccCR=function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.prototype.ccENM=function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.prototype.ccEOC=function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.prototype.ccTO=function(e){c.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},e.prototype.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}c.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},e.prototype.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=c.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},e.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),E=function(){function e(e,t,r){this.field=e||1,this.outputs=[t,r],this.channels=[new m(1,t),new m(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return e.prototype.getHandler=function(e){return this.channels[e].getHandler()},e.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},e.prototype.addData=function(e,t){var r,i,a,n=!1;this.lastTime=e,c.setTime(e);for(var o=0;o<t.length;o+=2)if(i=127&t[o],a=127&t[o+1],0!==i||0!==a){if(c.log("DATA","["+h([t[o],t[o+1]])+"] -> ("+h([i,a])+")"),(r=this.parseCmd(i,a))||(r=this.parseMidrow(i,a)),r||(r=this.parsePAC(i,a)),r||(r=this.parseBackgroundAttributes(i,a)),!r)if(n=this.parseChars(i,a))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(n);else c.log("WARNING","No channel found yet. TEXT-MODE?");r?this.dataCounters.cmd+=2:n?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+h([i,a])+" orig: "+h([t[o],t[o+1]])))}else this.dataCounters.padding+=2},e.prototype.parseCmd=function(e,t){var r=null;if(!((20===e||28===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+h([e,t])+") is dropped"),!0;r=20===e||23===e?1:2;var i=this.channels[r-1];return 20===e||28===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},e.prototype.parseMidrow=function(e,t){var r=null;return(17===e||25===e)&&t>=32&&t<=47&&((r=17===e?1:2)!==this.currChNr?(c.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[r-1].ccMIDROW(t),c.log("DEBUG","MIDROW ("+h([e,t])+")"),!0))},e.prototype.parsePAC=function(e,t){var r,i=null;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;r=e<=23?1:2,i=t>=64&&t<=95?1===r?s[e]:u[e]:1===r?l[e]:d[e];var a=this.interpretPAC(i,t);return this.channels[r-1].setPAC(a),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},e.prototype.interpretPAC=function(e,t){var r=t,i={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,i.underline=1==(1&r),r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i},e.prototype.parseChars=function(e,t){var r=null,i=null,n=null;if(e>=25?(r=2,n=e-8):(r=1,n=e),n>=17&&n<=19){var o=t;o=17===n?t+80:18===n?t+112:t+144,c.log("INFO","Special char '"+a(o)+"' in channel "+r),i=[o]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var s=h(i);c.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},e.prototype.parseBackgroundAttributes=function(e,t){var r,i,a;return((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47)&&(r={},16===e||24===e?(i=Math.floor((t-32)/2),r.background=f[i],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),a=e<24?1:2,this.channels[a-1].setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,!0)},e.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},e.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}();t.default=E},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}return e.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},e.prototype.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e}();t.default=i},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r(30),a=r(11),n=function(e,t,r){return e.substr(r||0,t.length)===t},o=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()},s={parse:function(t,r,s,l,u,d){var f,c=a.utf8ArrayToStr(new Uint8Array(t)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),h="00:00.000",p=0,g=0,v=0,y=[],m=!0,E=new i.default;E.oncue=function(e){var t=s[l],r=s.ccOffset;t&&t.new&&(void 0!==g?r=s.ccOffset=t.start:function(e,t,r){var i=e[t],a=e[i.prevCC];if(!a||!a.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;a&&a.new;)e.ccOffset+=i.start-a.start,i.new=!1,a=e[(i=a).prevCC];e.presentationOffset=r}(s,l,v)),v&&(r=v-s.presentationOffset),e.startTime+=r-g,e.endTime+=r-g,e.id=o(e.startTime.toString())+o(e.endTime.toString())+o(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&y.push(e)},E.onparsingerror=function(e){f=e},E.onflush=function(){f&&d?d(f):u(y)},c.forEach(function(t){if(m){if(n(t,"X-TIMESTAMP-MAP=")){m=!1,t.substr(16).split(",").forEach(function(e){n(e,"LOCAL:")?h=e.substr(6):n(e,"MPEGTS:")&&(p=parseInt(e.substr(7)))});try{r+(9e4*s[l].start||0)<0&&(r+=8589934592),p-=r,g=function(t){var r=parseInt(t.substr(-3)),i=parseInt(t.substr(-6,2)),a=parseInt(t.substr(-9,2)),n=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;return e.isFinite(r)&&e.isFinite(i)&&e.isFinite(a)&&e.isFinite(n)?(r+=1e3*i,r+=6e4*a,r+=36e5*n):-1}(h)/1e3,v=p/9e4,-1===g&&(f=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){f=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(m=!1)}E.parse(t+"\n")}),E.flush()}};t.default=s}).call(this,r(2).Number)},function(e,t,r){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(4),o=r(0),s=r(8),l=function(t){function r(e){var r=t.call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.MANIFEST_LOADED,a.default.SUBTITLE_TRACK_LOADED)||this;return r.tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r}return i(r,t),r.prototype.destroy=function(){n.default.prototype.destroy.call(this)},r.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},r.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=null)},r.prototype.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(a.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},r.prototype.onSubtitleTrackLoaded=function(e){var t=this,r=e.id,i=e.details,a=this.trackId,n=this.tracks,l=n[a];if(r>=n.length||r!==a||!l||this.stopped)this._clearReloadTimer();else if(o.logger.log("subtitle track "+r+" loaded"),i.live){var u=s.computeReloadInterval(l.details,i,e.stats.trequest);o.logger.log("Reloading live subtitle playlist in "+u+"ms"),this.timer=setTimeout(function(){t._loadCurrentTrack()},u)}else this._clearReloadTimer()},r.prototype.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},r.prototype.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},Object.defineProperty(r.prototype,"subtitleTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subtitleTrack",{get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))},enumerable:!0,configurable:!0}),r.prototype._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},r.prototype._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,r=this.hls,i=t[e];e<0||!i||i.details&&!i.details.live||(o.logger.log("Loading subtitle track "+e),r.trigger(a.default.SUBTITLE_TRACK_LOADING,{url:i.url,id:e}))},r.prototype._toggleTrackModes=function(e){var t=this.media,r=this.subtitleDisplay,i=this.trackId;if(t){var a=u(t.textTracks);if(-1===e)[].slice.call(a).forEach(function(e){e.mode="disabled"});else{var n=a[i];n&&(n.mode="disabled")}var o=a[e];o&&(o.mode=r?"showing":"hidden")}},r.prototype._setSubtitleTrackInternal=function(t){var r=this.hls,i=this.tracks;!e.isFinite(t)||t<-1||t>=i.length||(this.trackId=t,o.logger.log("Switching to subtitle track "+t),r.trigger(a.default.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},r.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=u(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack=e}},r}(n.default);function u(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];"subtitles"===i.kind&&i.label&&t.push(e[r])}return t}t.default=l}).call(this,r(2).Number)},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=r(0),o=r(13),s=r(5),l=r(27),u=r(7),d=r(15),f=r(8),c=window.performance,h=function(e){function t(t,r){var i=e.call(this,t,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.ERROR,a.default.KEY_LOADED,a.default.FRAG_LOADED,a.default.SUBTITLE_TRACKS_UPDATED,a.default.SUBTITLE_TRACK_SWITCH,a.default.SUBTITLE_TRACK_LOADED,a.default.SUBTITLE_FRAG_PROCESSED,a.default.LEVEL_UPDATED)||this;return i.fragmentTracker=r,i.config=t.config,i.state=d.State.STOPPED,i.tracks=[],i.tracksBuffered=[],i.currentTrackId=-1,i.decrypter=new o.default(t,t.config),i.lastAVStart=0,i._onMediaSeeking=i.onMediaSeeking.bind(i),i}return i(t,e),t.prototype.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=d.State.IDLE,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var a,n=t.start,o=0;o<i.length;o++)if(n>=i[o].start&&n<=i[o].end){a=i[o];break}var s=t.start+t.duration;a?a.end=s:(a={start:n,end:s},i.push(a))}}},t.prototype.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=d.State.IDLE},t.prototype.onMediaDetaching=function(){this.media.removeEventListener("seeking",this._onMediaSeeking),this.media=null,this.state=d.State.STOPPED},t.prototype.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=d.State.IDLE)},t.prototype.onSubtitleTracksUpdated=function(e){var t=this;n.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]})},t.prototype.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},t.prototype.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,i=this.currentTrackId,a=this.tracks,n=a[i];t>=a.length||t!==i||!n||(r.live&&f.mergeSubtitlePlaylists(n.details,r,this.lastAVStart),n.details=r,this.setInterval(500))},t.prototype.onKeyLoaded=function(){this.state===d.State.KEY_LOADING&&(this.state=d.State.IDLE)},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag.decryptdata,i=e.frag,n=this.hls;if(this.state===d.State.FRAG_LOADING&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var o=c.now();this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,function(e){var t=c.now();n.trigger(a.default.FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:o,tdecrypt:t}})})}},t.prototype.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},t.prototype.doTick=function(){if(this.media)switch(this.state){case d.State.IDLE:var e=this,t=e.config,r=e.currentTrackId,i=e.fragmentTracker,o=e.media,f=e.tracks;if(!f||!f[r]||!f[r].details)break;var c=t.maxBufferHole,h=t.maxFragLookUpTolerance,p=Math.min(t.maxBufferLength,t.maxMaxBufferLength),g=s.BufferHelper.bufferedInfo(this._getBuffered(),o.currentTime,c),v=g.end,y=g.len,m=f[r].details,E=m.fragments,_=E.length,T=E[_-1].start+E[_-1].duration;if(y>p)return;var S=void 0,b=this.fragPrevious;v<T?(b&&m.hasProgramDateTime&&(S=l.findFragmentByPDT(E,b.endProgramDateTime,h)),S||(S=l.findFragmentByPTS(b,E,v,h))):S=E[_-1],S&&S.encrypted?(n.logger.log("Loading key for "+S.sn),this.state=d.State.KEY_LOADING,this.hls.trigger(a.default.KEY_LOADING,{frag:S})):S&&i.getState(S)===u.FragmentState.NOT_LOADED&&(this.fragCurrent=S,this.state=d.State.FRAG_LOADING,this.hls.trigger(a.default.FRAG_LOADING,{frag:S}))}else this.state=d.State.IDLE},t.prototype.stopLoad=function(){this.lastAVStart=0,e.prototype.stopLoad.call(this)},t.prototype._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},t.prototype.onMediaSeeking=function(){this.fragPrevious=null},t}(d.default);t.SubtitleStreamController=h},function(e,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(4),n=r(1),o=r(3),s=r(0),l=window.XMLHttpRequest,u="com.widevine.alpha",d="com.microsoft.playready",f=function(e){function t(t){var r=e.call(this,t,n.default.MEDIA_ATTACHED,n.default.MANIFEST_PARSED)||this;return r._widevineLicenseUrl=t.config.widevineLicenseUrl,r._licenseXhrSetup=t.config.licenseXhrSetup,r._emeEnabled=t.config.emeEnabled,r._requestMediaKeySystemAccess=t.config.requestMediaKeySystemAccessFunc,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._isMediaEncrypted=!1,r._requestLicenseFailureCount=0,r}return i(t,e),t.prototype.getLicenseServerUrl=function(e){var t;switch(e){case u:t=this._widevineLicenseUrl;break;default:t=null}return t||(s.logger.error('No license server URL configured for key-system "'+e+'"'),this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},t.prototype._attemptKeySystemAccess=function(e,t,r){var i=this,a=function(e,t,r){switch(e){case u:return function(e,t,r){var i={videoCapabilities:[]};return t.forEach(function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})}),[i]}(0,r);default:throw Error("Unknown key-system: "+e)}}(e,0,r);a?(s.logger.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(e,a).then(function(t){i._onMediaKeySystemAccessObtained(e,t)}).catch(function(t){s.logger.error('Failed to obtain key-system "'+e+'" access:',t)})):s.logger.warn("Can not create config for key-system (maybe because platform is not supported):",e)},Object.defineProperty(t.prototype,"requestMediaKeySystemAccess",{get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess},enumerable:!0,configurable:!0}),t.prototype._onMediaKeySystemAccessObtained=function(e,t){var r=this;s.logger.log('Access for key-system "'+e+'" obtained');var i={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(i),t.createMediaKeys().then(function(t){i.mediaKeys=t,s.logger.log('Media-keys created for key-system "'+e+'"'),r._onMediaKeysCreated()}).catch(function(e){s.logger.error("Failed to create media-keys:",e)})},t.prototype._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))})},t.prototype._onNewMediaKeySession=function(e){var t=this;s.logger.log("New key-system session "+e.sessionId),e.addEventListener("message",function(r){t._onKeySessionMessage(e,r.message)},!1)},t.prototype._onKeySessionMessage=function(e,t){s.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(t){s.logger.log("Received license data, updating key-session"),e.update(t)})},t.prototype._onMediaEncrypted=function(e,t){s.logger.log('Media is encrypted using "'+e+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=e,this._mediaEncryptionInitData=t,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},t.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return s.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});s.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},t.prototype._generateRequestWithPreferredKeySession=function(){var e=this,t=this._mediaKeysList[0];if(!t)return s.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(t.mediaKeysSessionInitialized)s.logger.warn("Key-Session already initialized but requested again");else{var r=t.mediaKeysSession;r||(s.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0}));var i=this._mediaEncryptionInitDataType,a=this._mediaEncryptionInitData;s.logger.log('Generating key-session request for "'+i+'" init data type'),t.mediaKeysSessionInitialized=!0,r.generateRequest(i,a).then(function(){s.logger.debug("Key-session generation succeeded")}).catch(function(t){s.logger.error("Error generating key-session request:",t),e.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},t.prototype._createLicenseXhr=function(e,t,r){var i=new l,a=this._licenseXhrSetup;try{if(a)try{a(i,e)}catch(t){i.open("POST",e,!0),a(i,e)}i.readyState||i.open("POST",e,!0)}catch(e){return s.logger.error("Error setting up key-system license XHR",e),void this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,e,t,r),i},t.prototype._onLicenseRequestReadyStageChange=function(e,t,r,i){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,s.logger.log("License request succeeded"),i(e.response);else{if(s.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount<=3){var a=3-this._requestLicenseFailureCount+1;return s.logger.warn("Retrying license request, "+a+" attempts left"),void this._requestLicense(r,i)}this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},t.prototype._generateLicenseRequestChallenge=function(e,t){var r;return e.mediaKeySystemDomain===d?s.logger.error("PlayReady is not supported (yet)"):e.mediaKeySystemDomain===u?r=t:s.logger.error("Unsupported key-system:",e.mediaKeySystemDomain),r},t.prototype._requestLicense=function(e,t){s.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return s.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});var i=this.getLicenseServerUrl(r.mediaKeySystemDomain),a=this._createLicenseXhr(i,e,t);s.logger.log("Sending license request to URL: "+i),a.send(this._generateLicenseRequestChallenge(r,e))},t.prototype.onMediaAttached=function(e){var t=this;if(this._emeEnabled){var r=e.media;this._media=r,r.addEventListener("encrypted",function(e){t._onMediaEncrypted(e.initDataType,e.initData)})}},t.prototype.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map(function(e){return e.audioCodec}),r=e.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(u,t,r)}},t}(a.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;t.requestMediaKeySystemAccess=i}]).default});


//main.js


var testwest,testwest2,ancestorOrig=window.location.ancestorOrigins?window.location.ancestorOrigins[window.location.ancestorOrigins.length-1]:document.referrer||"firefox";ancestorOrig=ancestorOrig||(document.referrer||"empty"),window.getParam=function(e){if(e=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(location.search))return decodeURIComponent(e[1])};var styleSenseStorage={},main=function(n){var r={};function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}return o.m=n,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./",o(o.s=2)}([function(Gt,Qt,e){var Kt;!function(e,t){"use strict";"object"==typeof Gt&&"object"==typeof Gt.exports?Gt.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(T,e){"use strict";function m(e){return null!=e&&e===e.window}var t=[],k=T.document,n=Object.getPrototypeOf,s=t.slice,v=t.concat,l=t.push,o=t.indexOf,r={},i=r.toString,g=r.hasOwnProperty,a=g.toString,u=a.call(Object),y={},b=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},c={type:!0,src:!0,noModule:!0};function w(e,t,n){var r,o=(t=t||k).createElement("script");if(o.text=e,n)for(r in c)n[r]&&(o[r]=n[r]);t.head.appendChild(o).parentNode.removeChild(o)}function h(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?r[i.call(e)]||"object":typeof e}var f="3.3.1",S=function(e,t){return new S.fn.init(e,t)},d=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function p(e){var t=!!e&&"length"in e&&e.length,n=h(e);return!b(e)&&!m(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){e=S.merge(this.constructor(),e);return e.prevObject=this,e},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,e=+e+(e<0?t:0);return this.pushStack(0<=e&&e<t?[this[e]]:[])},end:function(){return this.prevObject||this.constructor()},push:l,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,o,i=arguments[0]||{},a=1,s=arguments.length,l=!1;for("boolean"==typeof i&&(l=i,i=arguments[a]||{},a++),"object"==typeof i||b(i)||(i={}),a===s&&(i=this,a--);a<s;a++)if(null!=(e=arguments[a]))for(t in e)o=i[t],i!==(n=e[t])&&(l&&n&&(S.isPlainObject(n)||(r=Array.isArray(n)))?(o=r?(r=!1,o&&Array.isArray(o)?o:[]):o&&S.isPlainObject(o)?o:{},i[t]=S.extend(l,o,n)):void 0!==n&&(i[t]=n));return i},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){return!(!e||"[object Object]"!==i.call(e))&&(!(e=n(e))||"function"==typeof(e=g.call(e,"constructor")&&e.constructor)&&a.call(e)===u)},isEmptyObject:function(e){for(var t in e)return!1;return!0},globalEval:function(e){w(e)},each:function(e,t){var n,r=0;if(p(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(d,"")},makeArray:function(e,t){t=t||[];return null!=e&&(p(Object(e))?S.merge(t,"string"==typeof e?[e]:e):l.call(t,e)),t},inArray:function(e,t,n){return null==t?-1:o.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,o=e.length;r<n;r++)e[o++]=t[r];return e.length=o,e},grep:function(e,t,n){for(var r=[],o=0,i=e.length,a=!n;o<i;o++)!t(e[o],o)!=a&&r.push(e[o]);return r},map:function(e,t,n){var r,o,i=0,a=[];if(p(e))for(r=e.length;i<r;i++)null!=(o=t(e[i],i,n))&&a.push(o);else for(i in e)null!=(o=t(e[i],i,n))&&a.push(o);return v.apply([],a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){r["[object "+t+"]"]=t.toLowerCase()});var x=function(n){function f(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(65536+r):String.fromCharCode(r>>10|55296,1023&r|56320)}function r(){T()}var e,p,w,i,o,h,d,m,x,l,u,T,k,a,S,v,s,c,g,C="sizzle"+ +new Date,y=n.document,E=0,b=0,A=ae(),D=ae(),j=ae(),N=function(e,t){return e===t&&(u=!0),0},O={}.hasOwnProperty,t=[],L=t.pop,P=t.push,q=t.push,M=t.slice,_=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},H="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",F="\\["+I+"*("+R+")(?:"+I+"*([*^$|!~]?=)"+I+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+R+"))|)"+I+"*\\]",B=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",W=new RegExp(I+"+","g"),$=new RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),z=new RegExp("^"+I+"*,"+I+"*"),V=new RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),U=new RegExp("="+I+"*([^\\]'\"]*?)"+I+"*\\]","g"),X=new RegExp(B),J=new RegExp("^"+R+"$"),Y={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:new RegExp("^(?:"+H+")$","i"),needsContext:new RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},G=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),ne=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,re=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=ve(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{q.apply(t=M.call(y.childNodes),y.childNodes),t[y.childNodes.length].nodeType}catch(e){q={apply:t.length?function(e,t){P.apply(e,M.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function ie(e,t,n,r){var o,i,a,s,l,u,c,f=t&&t.ownerDocument,d=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==d&&9!==d&&11!==d)return n;if(!r&&((t?t.ownerDocument||t:y)!==k&&T(t),t=t||k,S)){if(11!==d&&(l=Z.exec(e)))if(o=l[1]){if(9===d){if(!(a=t.getElementById(o)))return n;if(a.id===o)return n.push(a),n}else if(f&&(a=f.getElementById(o))&&g(t,a)&&a.id===o)return n.push(a),n}else{if(l[2])return q.apply(n,t.getElementsByTagName(e)),n;if((o=l[3])&&p.getElementsByClassName&&t.getElementsByClassName)return q.apply(n,t.getElementsByClassName(o)),n}if(p.qsa&&!j[e+" "]&&(!v||!v.test(e))){if(1!==d)f=t,c=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(ne,re):t.setAttribute("id",s=C),i=(u=h(e)).length;i--;)u[i]="#"+s+" "+me(u[i]);c=u.join(","),f=ee.test(e)&&pe(t.parentNode)||t}if(c)try{return q.apply(n,f.querySelectorAll(c)),n}catch(e){}finally{s===C&&t.removeAttribute("id")}}}return m(e.replace($,"$1"),t,n,r)}function ae(){var n=[];function r(e,t){return n.push(e+" ")>w.cacheLength&&delete r[n.shift()],r[e+" "]=t}return r}function se(e){return e[C]=!0,e}function le(e){var t=k.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ue(e,t){for(var n=e.split("|"),r=n.length;r--;)w.attrHandle[n[r]]=t}function ce(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function fe(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&oe(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function de(a){return se(function(i){return i=+i,se(function(e,t){for(var n,r=a([],e.length,i),o=r.length;o--;)e[n=r[o]]&&(e[n]=!(t[n]=e[n]))})})}function pe(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in p=ie.support={},o=ie.isXML=function(e){e=e&&(e.ownerDocument||e).documentElement;return!!e&&"HTML"!==e.nodeName},T=ie.setDocument=function(e){var t,e=e?e.ownerDocument||e:y;return e!==k&&9===e.nodeType&&e.documentElement&&(a=(k=e).documentElement,S=!o(k),y!==k&&(t=k.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",r,!1):t.attachEvent&&t.attachEvent("onunload",r)),p.attributes=le(function(e){return e.className="i",!e.getAttribute("className")}),p.getElementsByTagName=le(function(e){return e.appendChild(k.createComment("")),!e.getElementsByTagName("*").length}),p.getElementsByClassName=K.test(k.getElementsByClassName),p.getById=le(function(e){return a.appendChild(e).id=C,!k.getElementsByName||!k.getElementsByName(C).length}),p.getById?(w.filter.ID=function(e){var t=e.replace(te,f);return function(e){return e.getAttribute("id")===t}},w.find.ID=function(e,t){if(void 0!==t.getElementById&&S){e=t.getElementById(e);return e?[e]:[]}}):(w.filter.ID=function(e){var t=e.replace(te,f);return function(e){e=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return e&&e.value===t}},w.find.ID=function(e,t){if(void 0!==t.getElementById&&S){var n,r,o,i=t.getElementById(e);if(i){if((n=i.getAttributeNode("id"))&&n.value===e)return[i];for(o=t.getElementsByName(e),r=0;i=o[r++];)if((n=i.getAttributeNode("id"))&&n.value===e)return[i]}return[]}}),w.find.TAG=p.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):p.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"!==e)return i;for(;n=i[o++];)1===n.nodeType&&r.push(n);return r},w.find.CLASS=p.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&S)return t.getElementsByClassName(e)},s=[],v=[],(p.qsa=K.test(k.querySelectorAll))&&(le(function(e){a.appendChild(e).innerHTML="<a id='"+C+"'></a><select id='"+C+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+H+")"),e.querySelectorAll("[id~="+C+"-]").length||v.push("~="),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+C+"+*").length||v.push(".#.+[+~]")}),le(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=k.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+I+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(p.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&le(function(e){p.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",B)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),g=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(n.contains?n.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},N=t?function(e,t){if(e===t)return u=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!p.sortDetached&&t.compareDocumentPosition(e)===n?e===k||e.ownerDocument===y&&g(y,e)?-1:t===k||t.ownerDocument===y&&g(y,t)?1:l?_(l,e)-_(l,t):0:4&n?-1:1)}:function(e,t){if(e===t)return u=!0,0;var n,r=0,o=e.parentNode,i=t.parentNode,a=[e],s=[t];if(!o||!i)return e===k?-1:t===k?1:o?-1:i?1:l?_(l,e)-_(l,t):0;if(o===i)return ce(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?ce(a[r],s[r]):a[r]===y?-1:s[r]===y?1:0}),k},ie.matches=function(e,t){return ie(e,null,null,t)},ie.matchesSelector=function(e,t){if((e.ownerDocument||e)!==k&&T(e),t=t.replace(U,"='$1']"),p.matchesSelector&&S&&!j[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||p.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<ie(t,k,null,[e]).length},ie.contains=function(e,t){return(e.ownerDocument||e)!==k&&T(e),g(e,t)},ie.attr=function(e,t){(e.ownerDocument||e)!==k&&T(e);var n=w.attrHandle[t.toLowerCase()],n=n&&O.call(w.attrHandle,t.toLowerCase())?n(e,t,!S):void 0;return void 0!==n?n:p.attributes||!S?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ie.escape=function(e){return(e+"").replace(ne,re)},ie.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ie.uniqueSort=function(e){var t,n=[],r=0,o=0;if(u=!p.detectDuplicates,l=!p.sortStable&&e.slice(0),e.sort(N),u){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return l=null,e},i=ie.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=i(t);return n},(w=ie.selectors={cacheLength:50,createPseudo:se,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,f),e[3]=(e[3]||e[4]||e[5]||"").replace(te,f),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ie.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ie.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,f).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=A[e+" "];return t||(t=new RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&A(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(t,n,r){return function(e){e=ie.attr(e,t);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e.replace(W," ")+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(h,e,t,m,v){var g="nth"!==h.slice(0,3),y="last"!==h.slice(-4),b="of-type"===e;return 1===m&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,o,i,a,s,l,u=g!=y?"nextSibling":"previousSibling",c=e.parentNode,f=b&&e.nodeName.toLowerCase(),d=!n&&!b,p=!1;if(c){if(g){for(;u;){for(a=e;a=a[u];)if(b?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;l=u="only"===h&&!l&&"nextSibling"}return!0}if(l=[y?c.firstChild:c.lastChild],y&&d){for(p=(s=(r=(o=(i=(a=c)[C]||(a[C]={}))[a.uniqueID]||(i[a.uniqueID]={}))[h]||[])[0]===E&&r[1])&&r[2],a=s&&c.childNodes[s];a=++s&&a&&a[u]||(p=s=0)||l.pop();)if(1===a.nodeType&&++p&&a===e){o[h]=[E,s,p];break}}else if(d&&(p=s=(r=(o=(i=(a=e)[C]||(a[C]={}))[a.uniqueID]||(i[a.uniqueID]={}))[h]||[])[0]===E&&r[1]),!1===p)for(;(a=++s&&a&&a[u]||(p=s=0)||l.pop())&&((b?a.nodeName.toLowerCase()!==f:1!==a.nodeType)||!++p||(d&&((o=(i=a[C]||(a[C]={}))[a.uniqueID]||(i[a.uniqueID]={}))[h]=[E,p]),a!==e)););return(p-=v)===m||p%m==0&&0<=p/m}}},PSEUDO:function(e,i){var t,a=w.pseudos[e]||w.setFilters[e.toLowerCase()]||ie.error("unsupported pseudo: "+e);return a[C]?a(i):1<a.length?(t=[e,e,"",i],w.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,t){for(var n,r=a(e,i),o=r.length;o--;)e[n=_(e,r[o])]=!(t[n]=r[o])}):function(e){return a(e,0,t)}):a}},pseudos:{not:se(function(e){var r=[],o=[],s=d(e.replace($,"$1"));return s[C]?se(function(e,t,n,r){for(var o,i=s(e,null,r,[]),a=e.length;a--;)(o=i[a])&&(e[a]=!(t[a]=o))}):function(e,t,n){return r[0]=e,s(r,null,n,o),r[0]=null,!o.pop()}}),has:se(function(t){return function(e){return 0<ie(t,e).length}}),contains:se(function(t){return t=t.replace(te,f),function(e){return-1<(e.textContent||e.innerText||i(e)).indexOf(t)}}),lang:se(function(n){return J.test(n||"")||ie.error("unsupported lang: "+n),n=n.replace(te,f).toLowerCase(),function(e){var t;do{if(t=S?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===k.activeElement&&(!k.hasFocus||k.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:fe(!1),disabled:fe(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:de(function(){return[0]}),last:de(function(e,t){return[t-1]}),eq:de(function(e,t,n){return[n<0?n+t:n]}),even:de(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:de(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:de(function(e,t,n){for(var r=n<0?n+t:n;0<=--r;)e.push(r);return e}),gt:de(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=w.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[e]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(e);for(e in{submit:!0,reset:!0})w.pseudos[e]=function(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}(e);function he(){}function me(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ve(a,e,t){var s=e.dir,l=e.next,u=l||s,c=t&&"parentNode"===u,f=b++;return e.first?function(e,t,n){for(;e=e[s];)if(1===e.nodeType||c)return a(e,t,n);return!1}:function(e,t,n){var r,o,i=[E,f];if(n){for(;e=e[s];)if((1===e.nodeType||c)&&a(e,t,n))return!0}else for(;e=e[s];)if(1===e.nodeType||c)if(r=(o=e[C]||(e[C]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[s]||e;else{if((o=r[u])&&o[0]===E&&o[1]===f)return i[2]=o[2];if((r[u]=i)[2]=a(e,t,n))return!0}return!1}}function ge(o){return 1<o.length?function(e,t,n){for(var r=o.length;r--;)if(!o[r](e,t,n))return!1;return!0}:o[0]}function ye(e,t,n,r,o){for(var i,a=[],s=0,l=e.length,u=null!=t;s<l;s++)(i=e[s])&&(n&&!n(i,r,o)||(a.push(i),u&&t.push(s)));return a}function be(p,h,m,v,g,e){return v&&!v[C]&&(v=be(v)),g&&!g[C]&&(g=be(g,e)),se(function(e,t,n,r){var o,i,a,s=[],l=[],u=t.length,c=e||function(e,t,n){for(var r=0,o=t.length;r<o;r++)ie(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!p||!e&&h?c:ye(c,s,p,n,r),d=m?g||(e?p:u||v)?[]:t:f;if(m&&m(f,d,n,r),v)for(o=ye(d,l),v(o,[],n,r),i=o.length;i--;)(a=o[i])&&(d[l[i]]=!(f[l[i]]=a));if(e){if(g||p){if(g){for(o=[],i=d.length;i--;)(a=d[i])&&o.push(f[i]=a);g(null,d=[],o,r)}for(i=d.length;i--;)(a=d[i])&&-1<(o=g?_(e,a):s[i])&&(e[o]=!(t[o]=a))}}else d=ye(d===t?d.splice(u,d.length):d),g?g(null,t,d,r):q.apply(t,d)})}function we(v,g){function e(e,t,n,r,o){var i,a,s,l=0,u="0",c=e&&[],f=[],d=x,p=e||b&&w.find.TAG("*",o),h=E+=null==d?1:Math.random()||.1,m=p.length;for(o&&(x=t===k||t||o);u!==m&&null!=(i=p[u]);u++){if(b&&i){for(a=0,t||i.ownerDocument===k||(T(i),n=!S);s=v[a++];)if(s(i,t||k,n)){r.push(i);break}o&&(E=h)}y&&((i=!s&&i)&&l--,e&&c.push(i))}if(l+=u,y&&u!==l){for(a=0;s=g[a++];)s(c,f,t,n);if(e){if(0<l)for(;u--;)c[u]||f[u]||(f[u]=L.call(r));f=ye(f)}q.apply(r,f),o&&!e&&0<f.length&&1<l+g.length&&ie.uniqueSort(r)}return o&&(E=h,x=d),c}var y=0<g.length,b=0<v.length;return y?se(e):e}return he.prototype=w.filters=w.pseudos,w.setFilters=new he,h=ie.tokenize=function(e,t){var n,r,o,i,a,s,l,u=D[e+" "];if(u)return t?0:u.slice(0);for(a=e,s=[],l=w.preFilter;a;){for(i in n&&!(r=z.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(o=[])),n=!1,(r=V.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),w.filter)!(r=Y[i].exec(a))||l[i]&&!(r=l[i](r))||(n=r.shift(),o.push({value:n,type:i,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ie.error(e):D(e,s).slice(0)},d=ie.compile=function(e,t){var n,r=[],o=[],i=j[e+" "];if(!i){for(n=(t=t||h(e)).length;n--;)((i=function e(t){for(var r,n,o,i=t.length,a=w.relative[t[0].type],s=a||w.relative[" "],l=a?1:0,u=ve(function(e){return e===r},s,!0),c=ve(function(e){return-1<_(r,e)},s,!0),f=[function(e,t,n){return n=!a&&(n||t!==x)||((r=t).nodeType?u:c)(e,t,n),r=null,n}];l<i;l++)if(n=w.relative[t[l].type])f=[ve(ge(f),n)];else{if((n=w.filter[t[l].type].apply(null,t[l].matches))[C]){for(o=++l;o<i&&!w.relative[t[o].type];o++);return be(1<l&&ge(f),1<l&&me(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace($,"$1"),n,l<o&&e(t.slice(l,o)),o<i&&e(t=t.slice(o)),o<i&&me(t))}f.push(n)}return ge(f)}(t[n]))[C]?r:o).push(i);(i=j(e,we(o,r))).selector=e}return i},m=ie.select=function(e,t,n,r){var o,i,a,s,l,u="function"==typeof e&&e,c=!r&&h(e=u.selector||e);if(n=n||[],1===c.length){if(2<(i=c[0]=c[0].slice(0)).length&&"ID"===(a=i[0]).type&&9===t.nodeType&&S&&w.relative[i[1].type]){if(!(t=(w.find.ID(a.matches[0].replace(te,f),t)||[])[0]))return n;u&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=Y.needsContext.test(e)?0:i.length;o--&&(a=i[o],!w.relative[s=a.type]);)if((l=w.find[s])&&(r=l(a.matches[0].replace(te,f),ee.test(i[0].type)&&pe(t.parentNode)||t))){if(i.splice(o,1),!(e=r.length&&me(i)))return q.apply(n,r),n;break}}return(u||d(e,c))(r,t,!S,n,!t||ee.test(e)&&pe(t.parentNode)||t),n},p.sortStable=C.split("").sort(N).join("")===C,p.detectDuplicates=!!u,T(),p.sortDetached=le(function(e){return 1&e.compareDocumentPosition(k.createElement("fieldset"))}),le(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ue("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),p.attributes&&le(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ue("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),le(function(e){return null==e.getAttribute("disabled")})||ue(H,function(e,t,n){if(!n)return!0===e[t]?t.toLowerCase():(t=e.getAttributeNode(t))&&t.specified?t.value:null}),ie}(T);S.find=x,S.expr=x.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=x.uniqueSort,S.text=x.getText,S.isXMLDoc=x.isXML,S.contains=x.contains,S.escapeSelector=x.escape;function C(e,t,n){for(var r=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&S(e).is(n))break;r.push(e)}return r}function E(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}var A=S.expr.match.needsContext;function D(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var j=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function N(e,n,r){return b(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<o.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,o=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(o[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,o[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(N(this,e||[],!1))},not:function(e){return this.pushStack(N(this,e||[],!0))},is:function(e){return!!N(this,"string"==typeof e&&A.test(e)?S(e):e||[],!1).length}});var O,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){if(!e)return this;if(n=n||O,"string"!=typeof e)return e.nodeType?(this[0]=e,this.length=1,this):b(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this);if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:L.exec(e))||!r[1]&&t)return(!t||t.jquery?t||n:this.constructor(t)).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:k,!0)),j.test(r[1])&&S.isPlainObject(t))for(var r in t)b(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(e=k.getElementById(r[2]))&&(this[0]=e,this.length=1),this}).prototype=S.fn,O=S(k);var P=/^(?:parents|prev(?:Until|All))/,q={children:!0,contents:!0,next:!0,prev:!0};function M(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,o=this.length,i=[],a="string"!=typeof e&&S(e);if(!A.test(e))for(;r<o;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){i.push(n);break}return this.pushStack(1<i.length?S.uniqueSort(i):i)},index:function(e){return e?"string"==typeof e?o.call(S(e),this[0]):o.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return C(e,"parentNode")},parentsUntil:function(e,t,n){return C(e,"parentNode",n)},next:function(e){return M(e,"nextSibling")},prev:function(e){return M(e,"previousSibling")},nextAll:function(e){return C(e,"nextSibling")},prevAll:function(e){return C(e,"previousSibling")},nextUntil:function(e,t,n){return C(e,"nextSibling",n)},prevUntil:function(e,t,n){return C(e,"previousSibling",n)},siblings:function(e){return E((e.parentNode||{}).firstChild,e)},children:function(e){return E(e.firstChild)},contents:function(e){return D(e,"iframe")?e.contentDocument:(D(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,o){S.fn[r]=function(e,t){var n=S.map(this,o,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(q[r]||S.uniqueSort(n),P.test(r)&&n.reverse()),this.pushStack(n)}});var _=/[^\x20\t\r\n\f]+/g;function H(e){return e}function I(e){throw e}function R(e,t,n,r){var o;try{e&&b(o=e.promise)?o.call(e).done(t).fail(n):e&&b(o=e.then)?o.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(_)||[],function(e,t){n[t]=!0}),n):S.extend({},r);function o(){for(s=s||r.once,a=i=!0;u.length;c=-1)for(t=u.shift();++c<l.length;)!1===l[c].apply(t[0],t[1])&&r.stopOnFalse&&(c=l.length,t=!1);r.memory||(t=!1),i=!1,s&&(l=t?[]:"")}var i,t,a,s,l=[],u=[],c=-1,f={add:function(){return l&&(t&&!i&&(c=l.length-1,u.push(t)),function n(e){S.each(e,function(e,t){b(t)?r.unique&&f.has(t)||l.push(t):t&&t.length&&"string"!==h(t)&&n(t)})}(arguments),t&&!i&&o()),this},remove:function(){return S.each(arguments,function(e,t){for(var n;-1<(n=S.inArray(t,l,n));)l.splice(n,1),n<=c&&c--}),this},has:function(e){return e?-1<S.inArray(e,l):0<l.length},empty:function(){return l=l&&[],this},disable:function(){return s=u=[],l=t="",this},disabled:function(){return!l},lock:function(){return s=u=[],t||i||(l=t=""),this},locked:function(){return!!s},fireWith:function(e,t){return s||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||o()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!a}};return f},S.extend({Deferred:function(e){var i=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],o="pending",a={state:function(){return o},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return a.then(null,e)},pipe:function(){var o=arguments;return S.Deferred(function(r){S.each(i,function(e,t){var n=b(o[t[4]])&&o[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&b(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),o=null}).promise()},then:function(t,n,r){var l=0;function u(o,i,a,s){return function(){function e(){var e,t;if(!(o<l)){if((e=a.apply(n,r))===i.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,b(t)?s?t.call(e,u(l,i,H,s),u(l,i,I,s)):(l++,t.call(e,u(l,i,H,s),u(l,i,I,s),u(l,i,H,i.notifyWith))):(a!==H&&(n=void 0,r=[e]),(s||i.resolveWith)(n,r))}}var n=this,r=arguments,t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),l<=o+1&&(a!==I&&(n=void 0,r=[e]),i.rejectWith(n,r))}};o?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),T.setTimeout(t))}}return S.Deferred(function(e){i[0][3].add(u(0,e,b(r)?r:H,e.notifyWith)),i[1][3].add(u(0,e,b(t)?t:H)),i[2][3].add(u(0,e,b(n)?n:I))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(i,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){o=r},i[3-e][2].disable,i[3-e][3].disable,i[0][2].lock,i[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){function t(t){return function(e){o[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||a.resolveWith(o,i)}}var n=arguments.length,r=n,o=Array(r),i=s.call(arguments),a=S.Deferred();if(n<=1&&(R(e,a.done(t(r)).resolve,a.reject,!n),"pending"===a.state()||b(i[r]&&i[r].then)))return a.then();for(;r--;)R(i[r],t(r),a.reject);return a.promise()}});var F=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){T.console&&T.console.warn&&e&&F.test(e.name)&&T.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){T.setTimeout(function(){throw e})};var B=S.Deferred();function W(){k.removeEventListener("DOMContentLoaded",W),T.removeEventListener("load",W),S.ready()}S.fn.ready=function(e){return B.then(e).catch(function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||B.resolveWith(k,[S])}}),S.ready.then=B.then,"complete"===k.readyState||"loading"!==k.readyState&&!k.documentElement.doScroll?T.setTimeout(S.ready):(k.addEventListener("DOMContentLoaded",W),T.addEventListener("load",W));var $=function(e,t,n,r,o,i,a){var s=0,l=e.length,u=null==n;if("object"===h(n))for(s in o=!0,n)$(e,t,s,n[s],!0,i,a);else if(void 0!==r&&(o=!0,b(r)||(a=!0),u&&(t=a?(t.call(e,r),null):(u=t,function(e,t,n){return u.call(S(e),n)})),t))for(;s<l;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return o?e:u?t.call(e):l?t(e[0],n):i},z=/^-ms-/,V=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(z,"ms-").replace(V,U)}function J(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function Y(){this.expando=S.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(e){var t=e[this.expando];return t||(t={},J(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,o=this.cache(e);if("string"==typeof t)o[X(t)]=n;else for(r in t)o[X(r)]=t[r];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(_)||[]).length;for(;n--;)delete r[t[n]]}void 0!==t&&!S.isEmptyObject(r)||(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){e=e[this.expando];return void 0!==e&&!S.isEmptyObject(e)}};var G=new Y,Q=new Y,K=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function ee(e,t,n){var r,o;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(Z,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(o=n)||"false"!==o&&("null"===o?null:o===+o+""?+o:K.test(o)?JSON.parse(o):o)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||G.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return G.access(e,t,n)},_removeData:function(e,t){G.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,o,i=this[0],a=i&&i.attributes;if(void 0!==n)return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;return i&&void 0===e?void 0!==(t=Q.get(i,n))||void 0!==(t=ee(i,n))?t:void 0:void this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0);if(this.length&&(o=Q.get(i),1===i.nodeType&&!G.get(i,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),ee(i,r,o[r]));G.set(i,"hasDataAttrs",!0)}return o},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=G.get(e,t),n&&(!r||Array.isArray(n)?r=G.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,o=n.shift(),i=S._queueHooks(e,t);"inprogress"===o&&(o=n.shift(),r--),o&&("fx"===t&&n.unshift("inprogress"),delete i.stop,o.call(e,function(){S.dequeue(e,t)},i)),!r&&i&&i.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return G.get(e,n)||G.access(e,n,{empty:S.Callbacks("once memory").add(function(){G.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--o||i.resolveWith(a,[a])}var r,o=1,i=S.Deferred(),a=this,s=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(r=G.get(a[s],e+"queueHooks"))&&r.empty&&(o++,r.empty.add(n));return n(),i.promise(t)}});function te(e,t,n,r){var o,i={};for(o in t)i[o]=e.style[o],e.style[o]=t[o];for(o in r=n.apply(e,r||[]),t)e.style[o]=i[o];return r}var f=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ne=new RegExp("^(?:([+-])=|)("+f+")([a-z%]*)$","i"),re=["Top","Right","Bottom","Left"],oe=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&S.contains(e.ownerDocument,e)&&"none"===S.css(e,"display")};function ie(e,t,n,r){var o,i,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},l=s(),u=n&&n[3]||(S.cssNumber[t]?"":"px"),c=(S.cssNumber[t]||"px"!==u&&+l)&&ne.exec(S.css(e,t));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;a--;)S.style(e,t,c+u),(1-i)*(1-(i=s()/l||.5))<=0&&(a=0),c/=i;c*=2,S.style(e,t,c+u),n=n||[]}return n&&(c=+c||+l||0,o=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=c,r.end=o)),o}var ae={};function se(e,t){for(var n,r,o,i,a,s=[],l=0,u=e.length;l<u;l++)(r=e[l]).style&&(n=r.style.display,t?("none"===n&&(s[l]=G.get(r,"display")||null,s[l]||(r.style.display="")),""===r.style.display&&oe(r)&&(s[l]=(a=i=void 0,i=(o=r).ownerDocument,a=o.nodeName,(o=ae[a])||(i=i.body.appendChild(i.createElement(a)),o=S.css(i,"display"),i.parentNode.removeChild(i),"none"===o&&(o="block"),ae[a]=o)))):"none"!==n&&(s[l]="none",G.set(r,"display",n)));for(l=0;l<u;l++)null!=s[l]&&(e[l].style.display=s[l]);return e}S.fn.extend({show:function(){return se(this,!0)},hide:function(){return se(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){oe(this)?S(this).show():S(this).hide()})}});var le=/^(?:checkbox|radio)$/i,ue=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ce=/^$|^module$|\/(?:java|ecma)script/i,fe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function de(e,t){var n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&D(e,t)?S.merge([e],n):n}function pe(e,t){for(var n=0,r=e.length;n<r;n++)G.set(e[n],"globalEval",!t||G.get(t[n],"globalEval"))}fe.optgroup=fe.option,fe.tbody=fe.tfoot=fe.colgroup=fe.caption=fe.thead,fe.th=fe.td;var he=/<|&#?\w+;/;function me(e,t,n,r,o){for(var i,a,s,l,u,c=t.createDocumentFragment(),f=[],d=0,p=e.length;d<p;d++)if((i=e[d])||0===i)if("object"===h(i))S.merge(f,i.nodeType?[i]:i);else if(he.test(i)){for(a=a||c.appendChild(t.createElement("div")),s=(ue.exec(i)||["",""])[1].toLowerCase(),s=fe[s]||fe._default,a.innerHTML=s[1]+S.htmlPrefilter(i)+s[2],u=s[0];u--;)a=a.lastChild;S.merge(f,a.childNodes),(a=c.firstChild).textContent=""}else f.push(t.createTextNode(i));for(c.textContent="",d=0;i=f[d++];)if(r&&-1<S.inArray(i,r))o&&o.push(i);else if(l=S.contains(i.ownerDocument,i),a=de(c.appendChild(i),"script"),l&&pe(a),n)for(u=0;i=a[u++];)ce.test(i.type||"")&&n.push(i);return c}t=k.createDocumentFragment().appendChild(k.createElement("div")),(x=k.createElement("input")).setAttribute("type","radio"),x.setAttribute("checked","checked"),x.setAttribute("name","t"),t.appendChild(x),y.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue;var ve=k.documentElement,ge=/^key/,ye=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function xe(){return!1}function Te(){try{return k.activeElement}catch(e){}}function ke(e,t,n,r,o,i){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)ke(e,s,n,r,t[s],i);return e}if(null==r&&null==o?(o=n,r=n=void 0):null==o&&("string"==typeof n?(o=r,r=void 0):(o=r,r=n,n=void 0)),!1===o)o=xe;else if(!o)return e;return 1===i&&(a=o,(o=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,o,r,n)})}S.event={global:{},add:function(t,e,n,r,o){var i,a,s,l,u,c,f,d,p,h=G.get(t);if(h)for(n.handler&&(n=(i=n).handler,o=i.selector),o&&S.find.matchesSelector(ve,o),n.guid||(n.guid=S.guid++),(s=h.events)||(s=h.events={}),(a=h.handle)||(a=h.handle=function(e){return void 0!==S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(_)||[""]).length;l--;)f=p=(u=be.exec(e[l])||[])[1],d=(u[2]||"").split(".").sort(),f&&(c=S.event.special[f]||{},f=(o?c.delegateType:c.bindType)||f,c=S.event.special[f]||{},u=S.extend({type:f,origType:p,data:r,handler:n,guid:n.guid,selector:o,needsContext:o&&S.expr.match.needsContext.test(o),namespace:d.join(".")},i),(p=s[f])||((p=s[f]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(t,r,d,a)||t.addEventListener&&t.addEventListener(f,a)),c.add&&(c.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,u):p.push(u),S.event.global[f]=!0)},remove:function(e,t,n,r,o){var i,a,s,l,u,c,f,d,p,h,m,v=G.hasData(e)&&G.get(e);if(v&&(l=v.events)){for(u=(t=(t||"").match(_)||[""]).length;u--;)if(p=m=(s=be.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),p){for(f=S.event.special[p]||{},d=l[p=(r?f.delegateType:f.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=i=d.length;i--;)c=d[i],!o&&m!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(d.splice(i,1),c.selector&&d.delegateCount--,f.remove&&f.remove.call(e,c));a&&!d.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,p,v.handle),delete l[p])}else for(p in l)S.event.remove(e,p+t[u],n,r,!0);S.isEmptyObject(l)&&G.remove(e,"handle events")}},dispatch:function(e){var t,n,r,o,i,a=S.event.fix(e),s=new Array(arguments.length),l=(G.get(this,"events")||{})[a.type]||[],e=S.event.special[a.type]||{};for(s[0]=a,t=1;t<arguments.length;t++)s[t]=arguments[t];if(a.delegateTarget=this,!e.preDispatch||!1!==e.preDispatch.call(this,a)){for(i=S.event.handlers.call(this,a,l),t=0;(r=i[t++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(o=((S.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s))&&!1===(a.result=o)&&(a.preventDefault(),a.stopPropagation()));return e.postDispatch&&e.postDispatch.call(this,a),a.result}},handlers:function(e,t){var n,r,o,i,a,s=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!("click"===e.type&&1<=e.button))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(i=[],a={},n=0;n<l;n++)void 0===a[o=(r=t[n]).selector+" "]&&(a[o]=r.needsContext?-1<S(o,this).index(u):S.find(o,this,null,[u]).length),a[o]&&i.push(r);i.length&&s.push({elem:u,handlers:i})}return u=this,l<t.length&&s.push({elem:u,handlers:t.slice(l)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:b(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Te()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Te()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&D(this,"input"))return this.click(),!1},_default:function(e){return D(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:xe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:xe,isPropagationStopped:xe,isImmediatePropagationStopped:xe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&ge.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&ye.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},S.event.addProp),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,o){S.event.special[e]={delegateType:o,bindType:o,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=o),t}}}),S.fn.extend({on:function(e,t,n,r){return ke(this,e,t,n,r)},one:function(e,t,n,r){return ke(this,e,t,n,r,1)},off:function(e,t,n){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=xe),this.each(function(){S.event.remove(this,e,n,t)});for(o in e)this.off(o,t,e[o]);return this}});var Se=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ce=/<script|<style|<link/i,Ee=/checked\s*(?:[^=]|=\s*.checked.)/i,Ae=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function De(e,t){return D(e,"table")&&D(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function je(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Ne(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Oe(e,t){var n,r,o,i,a,s;if(1===t.nodeType){if(G.hasData(e)&&(i=G.access(e),a=G.set(t,i),s=i.events))for(o in delete a.handle,a.events={},s)for(n=0,r=s[o].length;n<r;n++)S.event.add(t,o,s[o][n]);Q.hasData(e)&&(e=Q.access(e),e=S.extend({},e),Q.set(t,e))}}function Le(n,r,o,i){r=v.apply([],r);var e,t,a,s,l,u,c=0,f=n.length,d=f-1,p=r[0],h=b(p);if(h||1<f&&"string"==typeof p&&!y.checkClone&&Ee.test(p))return n.each(function(e){var t=n.eq(e);h&&(r[0]=p.call(this,e,t.html())),Le(t,r,o,i)});if(f&&(t=(e=me(r,n[0].ownerDocument,!1,n,i)).firstChild,1===e.childNodes.length&&(e=t),t||i)){for(s=(a=S.map(de(e,"script"),je)).length;c<f;c++)l=e,c!==d&&(l=S.clone(l,!0,!0),s&&S.merge(a,de(l,"script"))),o.call(n[c],l,c);if(s)for(u=a[a.length-1].ownerDocument,S.map(a,Ne),c=0;c<s;c++)l=a[c],ce.test(l.type||"")&&!G.access(l,"globalEval")&&S.contains(u,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?S._evalUrl&&S._evalUrl(l.src):w(l.textContent.replace(Ae,""),u,l))}return n}function Pe(e,t,n){for(var r,o=t?S.filter(t,e):e,i=0;null!=(r=o[i]);i++)n||1!==r.nodeType||S.cleanData(de(r)),r.parentNode&&(n&&S.contains(r.ownerDocument,r)&&pe(de(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e.replace(Se,"<$1></$2>")},clone:function(e,t,n){var r,o,i,a,s,l,u,c=e.cloneNode(!0),f=S.contains(e.ownerDocument,e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=de(c),r=0,o=(i=de(e)).length;r<o;r++)s=i[r],l=a[r],u=void 0,"input"===(u=l.nodeName.toLowerCase())&&le.test(s.type)?l.checked=s.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=s.defaultValue);if(t)if(n)for(i=i||de(e),a=a||de(c),r=0,o=i.length;r<o;r++)Oe(i[r],a[r]);else Oe(e,c);return 0<(a=de(c,"script")).length&&pe(a,!f&&de(e,"script")),c},cleanData:function(e){for(var t,n,r,o=S.event.special,i=0;void 0!==(n=e[i]);i++)if(J(n)){if(t=n[G.expando]){if(t.events)for(r in t.events)o[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[G.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Pe(this,e,!0)},remove:function(e){return Pe(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Le(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||De(this,e).appendChild(e)})},prepend:function(){return Le(this,arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=De(this,e)).insertBefore(e,t.firstChild)})},before:function(){return Le(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Le(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(de(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ce.test(e)&&!fe[(ue.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(de(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return Le(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(de(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),o=r.length-1,i=0;i<=o;i++)t=i===o?this:this.clone(!0),S(r[i])[a](t),l.apply(n,t.get());return this.pushStack(n)}});var qe,Me,_e,He,Ie,Re,Fe,Be=new RegExp("^("+f+")(?!px)[a-z%]+$","i"),We=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=T),t.getComputedStyle(e)},$e=new RegExp(re.join("|"),"i");function ze(){var e;Fe&&(Re.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Fe.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ve.appendChild(Re).appendChild(Fe),e=T.getComputedStyle(Fe),qe="1%"!==e.top,Ie=12===Ve(e.marginLeft),Fe.style.right="60%",He=36===Ve(e.right),Me=36===Ve(e.width),Fe.style.position="absolute",_e=36===Fe.offsetWidth||"absolute",ve.removeChild(Re),Fe=null)}function Ve(e){return Math.round(parseFloat(e))}function Ue(e,t,n){var r,o,i=e.style;return(n=n||We(e))&&(""!==(o=n.getPropertyValue(t)||n[t])||S.contains(e.ownerDocument,e)||(o=S.style(e,t)),!y.pixelBoxStyles()&&Be.test(o)&&$e.test(t)&&(r=i.width,e=i.minWidth,t=i.maxWidth,i.minWidth=i.maxWidth=i.width=o,o=n.width,i.width=r,i.minWidth=e,i.maxWidth=t)),void 0!==o?o+"":o}function Xe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}Re=k.createElement("div"),(Fe=k.createElement("div")).style&&(Fe.style.backgroundClip="content-box",Fe.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===Fe.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return ze(),Me},pixelBoxStyles:function(){return ze(),He},pixelPosition:function(){return ze(),qe},reliableMarginLeft:function(){return ze(),Ie},scrollboxSize:function(){return ze(),_e}}));var Je=/^(none|table(?!-c[ea]).+)/,Ye=/^--/,Ge={position:"absolute",visibility:"hidden",display:"block"},Qe={letterSpacing:"0",fontWeight:"400"},Ke=["Webkit","Moz","ms"],Ze=k.createElement("div").style;function et(e){return S.cssProps[e]||(S.cssProps[e]=function(e){if(e in Ze)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=Ke.length;n--;)if((e=Ke[n]+t)in Ze)return e}(e)||e)}function tt(e,t,n){var r=ne.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function nt(e,t,n,r,o,i){var a="width"===t?1:0,s=0,l=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(l+=S.css(e,n+re[a],!0,o)),r?("content"===n&&(l-=S.css(e,"padding"+re[a],!0,o)),"margin"!==n&&(l-=S.css(e,"border"+re[a]+"Width",!0,o))):(l+=S.css(e,"padding"+re[a],!0,o),"padding"!==n?l+=S.css(e,"border"+re[a]+"Width",!0,o):s+=S.css(e,"border"+re[a]+"Width",!0,o));return!r&&0<=i&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-i-l-s-.5))),l}function rt(e,t,n){var r=We(e),o=Ue(e,t,r),i="border-box"===S.css(e,"boxSizing",!1,r),a=i;if(Be.test(o)){if(!n)return o;o="auto"}return a=a&&(y.boxSizingReliable()||o===e.style[t]),"auto"!==o&&(parseFloat(o)||"inline"!==S.css(e,"display",!1,r))||(o=e["offset"+t[0].toUpperCase()+t.slice(1)],a=!0),(o=parseFloat(o)||0)+nt(e,t,n||(i?"border":"content"),a,r,o)+"px"}function ot(e,t,n,r,o){return new ot.prototype.init(e,t,n,r,o)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){e=Ue(e,"opacity");return""===e?"1":e}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,i,a,s=X(t),l=Ye.test(t),u=e.style;if(l||(t=et(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(o=a.get(e,!1,r))?o:u[t];"string"===(i=typeof n)&&(o=ne.exec(n))&&o[1]&&(n=ie(e,t,o),i="number"),null!=n&&n==n&&("number"===i&&(n+=o&&o[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(l?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,r){var o,i=X(t);return Ye.test(t)||(t=et(i)),(i=S.cssHooks[t]||S.cssHooks[i])&&"get"in i&&(o=i.get(e,!0,n)),void 0===o&&(o=Ue(e,t,r)),"normal"===o&&t in Qe&&(o=Qe[t]),""===n||n?(t=parseFloat(o),!0===n||isFinite(t)?t||0:o):o}}),S.each(["height","width"],function(e,a){S.cssHooks[a]={get:function(e,t,n){if(t)return!Je.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?rt(e,a,n):te(e,Ge,function(){return rt(e,a,n)})},set:function(e,t,n){var r,o=We(e),i="border-box"===S.css(e,"boxSizing",!1,o),n=n&&nt(e,a,n,i,o);return i&&y.scrollboxSize()===o.position&&(n-=Math.ceil(e["offset"+a[0].toUpperCase()+a.slice(1)]-parseFloat(o[a])-nt(e,a,"border",!1,o)-.5)),n&&(r=ne.exec(t))&&"px"!==(r[3]||"px")&&(e.style[a]=t,t=S.css(e,a)),tt(0,t,n)}}}),S.cssHooks.marginLeft=Xe(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ue(e,"marginLeft"))||e.getBoundingClientRect().left-te(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(o,i){S.cssHooks[o+i]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[o+re[t]+i]=r[t]||r[t-2]||r[0];return n}},"margin"!==o&&(S.cssHooks[o+i].set=tt)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,o,i={},a=0;if(Array.isArray(t)){for(r=We(e),o=t.length;a<o;a++)i[t[a]]=S.css(e,t[a],!1,r);return i}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),(S.Tween=ot).prototype={constructor:ot,init:function(e,t,n,r,o,i){this.elem=e,this.prop=n,this.easing=o||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=i||(S.cssNumber[n]?"":"px")},cur:function(){var e=ot.propHooks[this.prop];return(e&&e.get?e:ot.propHooks._default).get(this)},run:function(e){var t,n=ot.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(n&&n.set?n:ot.propHooks._default).set(this),this}},ot.prototype.init.prototype=ot.prototype,ot.propHooks={_default:{get:function(e){return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(e=S.css(e.elem,e.prop,""))&&"auto"!==e?e:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[S.cssProps[e.prop]]&&!S.cssHooks[e.prop]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}},ot.propHooks.scrollTop=ot.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=ot.prototype.init,S.fx.step={};var it,at,st=/^(?:toggle|show|hide)$/,lt=/queueHooks$/;function ut(){at&&(!1===k.hidden&&T.requestAnimationFrame?T.requestAnimationFrame(ut):T.setTimeout(ut,S.fx.interval),S.fx.tick())}function ct(){return T.setTimeout(function(){it=void 0}),it=Date.now()}function ft(e,t){var n,r=0,o={height:e};for(t=t?1:0;r<4;r+=2-t)o["margin"+(n=re[r])]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function dt(e,t,n){for(var r,o=(pt.tweeners[t]||[]).concat(pt.tweeners["*"]),i=0,a=o.length;i<a;i++)if(r=o[i].call(n,t,e))return r}function pt(o,e,t){var n,i,r=0,a=pt.prefilters.length,s=S.Deferred().always(function(){delete l.elem}),l=function(){if(i)return!1;for(var e=it||ct(),e=Math.max(0,u.startTime+u.duration-e),t=1-(e/u.duration||0),n=0,r=u.tweens.length;n<r;n++)u.tweens[n].run(t);return s.notifyWith(o,[u,t,e]),t<1&&r?e:(r||s.notifyWith(o,[u,1,0]),s.resolveWith(o,[u]),!1)},u=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:it||ct(),duration:t.duration,tweens:[],createTween:function(e,t){e=S.Tween(o,u.opts,e,t,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(e),e},stop:function(e){var t=0,n=e?u.tweens.length:0;if(i)return this;for(i=!0;t<n;t++)u.tweens[t].run(1);return e?(s.notifyWith(o,[u,1,0]),s.resolveWith(o,[u,e])):s.rejectWith(o,[u,e]),this}}),c=u.props;for(!function(e,t){var n,r,o,i,a;for(n in e)if(o=t[r=X(n)],i=e[n],Array.isArray(i)&&(o=i[1],i=e[n]=i[0]),n!==r&&(e[r]=i,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in i=a.expand(i),delete e[r],i)n in e||(e[n]=i[n],t[n]=o);else t[r]=o}(c,u.opts.specialEasing);r<a;r++)if(n=pt.prefilters[r].call(u,o,c,u.opts))return b(n.stop)&&(S._queueHooks(u.elem,u.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,dt,u),b(u.opts.start)&&u.opts.start.call(o,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),S.fx.timer(S.extend(l,{elem:o,anim:u,queue:u.opts.queue})),u}S.Animation=S.extend(pt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ie(n.elem,e,ne.exec(t),n),n}]},tweener:function(e,t){for(var n,r=0,o=(e=b(e)?(t=e,["*"]):e.match(_)).length;r<o;r++)n=e[r],pt.tweeners[n]=pt.tweeners[n]||[],pt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,o,i,a,s,l,u,c="width"in t||"height"in t,f=this,d={},p=e.style,h=e.nodeType&&oe(e),m=G.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,f.always(function(){f.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(o=t[r],st.test(o)){if(delete t[r],i=i||"toggle"===o,o===(h?"hide":"show")){if("show"!==o||!m||void 0===m[r])continue;h=!0}d[r]=m&&m[r]||S.style(e,r)}if((l=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in c&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(u=m&&m.display)&&(u=G.get(e,"display")),"none"===(c=S.css(e,"display"))&&(u?c=u:(se([e],!0),u=e.style.display||u,c=S.css(e,"display"),se([e]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===S.css(e,"float")&&(l||(f.done(function(){p.display=u}),null==u&&(c=p.display,u="none"===c?"":c)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",f.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),l=!1,d)l||(m?"hidden"in m&&(h=m.hidden):m=G.access(e,"fxshow",{display:u}),i&&(m.hidden=!h),h&&se([e],!0),f.done(function(){for(r in h||se([e]),G.remove(e,"fxshow"),d)S.style(e,r,d[r])})),l=dt(h?m[r]:0,r,f),r in m||(m[r]=l.start,h&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?pt.prefilters.unshift(e):pt.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||b(e)&&e,duration:e,easing:n&&t||t&&!b(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){b(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(oe).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var o=S.isEmptyObject(t),i=S.speed(e,n,r),r=function(){var e=pt(this,S.extend({},t),i);(o||G.get(this,"finish"))&&e.stop(!0)};return r.finish=r,o||!1===i.queue?this.each(r):this.queue(i.queue,r)},stop:function(o,e,i){function a(e){var t=e.stop;delete e.stop,t(i)}return"string"!=typeof o&&(i=e,e=o,o=void 0),e&&!1!==o&&this.queue(o||"fx",[]),this.each(function(){var e=!0,t=null!=o&&o+"queueHooks",n=S.timers,r=G.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&lt.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=o&&n[t].queue!==o||(n[t].anim.stop(i),e=!1,n.splice(t,1));!e&&i||S.dequeue(this,o)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=G.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],o=S.timers,i=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===a&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<i;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var o=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?o.apply(this,arguments):this.animate(ft(r,!0),e,t,n)}}),S.each({slideDown:ft("show"),slideUp:ft("hide"),slideToggle:ft("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(it=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),it=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){at||(at=!0,ut())},S.fx.stop=function(){at=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=T.setTimeout(e,r);t.stop=function(){T.clearTimeout(n)}})},t=k.createElement("input"),f=k.createElement("select").appendChild(k.createElement("option")),t.type="checkbox",y.checkOn=""!==t.value,y.optSelected=f.selected,(t=k.createElement("input")).value="t",t.type="radio",y.radioValue="t"===t.value;var ht,mt=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,o,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===e.getAttribute?S.prop(e,t,n):(1===i&&S.isXMLDoc(e)||(o=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ht:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):o&&"set"in o&&void 0!==(r=o.set(e,n,t))?r:(e.setAttribute(t,n+""),n):!(o&&"get"in o&&null!==(r=o.get(e,t)))&&null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&D(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,o=t&&t.match(_);if(o&&1===e.nodeType)for(;n=o[r++];)e.removeAttribute(n)}}),ht={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=mt[t]||S.find.attr;mt[t]=function(e,t,n){var r,o,i=t.toLowerCase();return n||(o=mt[i],mt[i]=r,r=null!=a(e,t,n)?i:null,mt[i]=o),r}});var vt=/^(?:input|select|textarea|button)$/i,gt=/^(?:a|area)$/i;function yt(e){return(e.match(_)||[]).join(" ")}function bt(e){return e.getAttribute&&e.getAttribute("class")||""}function wt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(_)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,o,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&S.isXMLDoc(e)||(t=S.propFix[t]||t,o=S.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(r=o.set(e,n,t))?r:e[t]=n:o&&"get"in o&&null!==(r=o.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):vt.test(e.nodeName)||gt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){e=e.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(e){e=e.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,o,i,a,s=0;if(b(t))return this.each(function(e){S(this).addClass(t.call(this,e,bt(this)))});if((e=wt(t)).length)for(;n=this[s++];)if(a=bt(n),r=1===n.nodeType&&" "+yt(a)+" "){for(i=0;o=e[i++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");a!==(a=yt(r))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,r,o,i,a,s=0;if(b(t))return this.each(function(e){S(this).removeClass(t.call(this,e,bt(this)))});if(!arguments.length)return this.attr("class","");if((e=wt(t)).length)for(;n=this[s++];)if(a=bt(n),r=1===n.nodeType&&" "+yt(a)+" "){for(i=0;o=e[i++];)for(;-1<r.indexOf(" "+o+" ");)r=r.replace(" "+o+" "," ");a!==(a=yt(r))&&n.setAttribute("class",a)}return this},toggleClass:function(o,t){var i=typeof o,a="string"==i||Array.isArray(o);return"boolean"==typeof t&&a?t?this.addClass(o):this.removeClass(o):b(o)?this.each(function(e){S(this).toggleClass(o.call(this,e,bt(this),t),t)}):this.each(function(){var e,t,n,r;if(a)for(t=0,n=S(this),r=wt(o);e=r[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else void 0!==o&&"boolean"!=i||((e=bt(this))&&G.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",!e&&!1!==o&&G.get(this,"__className__")||""))})},hasClass:function(e){for(var t,n=0,r=" "+e+" ";t=this[n++];)if(1===t.nodeType&&-1<(" "+yt(bt(t))+" ").indexOf(r))return!0;return!1}});var xt=/\r/g;S.fn.extend({val:function(t){var n,e,r,o=this[0];return arguments.length?(r=b(t),this.each(function(e){1===this.nodeType&&(null==(e=r?t.call(this,e,S(this).val()):t)?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=S.map(e,function(e){return null==e?"":e+""})),(n=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value")||(this.value=e))})):o?(n=S.valHooks[o.type]||S.valHooks[o.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(o,"value"))?e:"string"==typeof(e=o.value)?e.replace(xt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:yt(S.text(e))}},select:{get:function(e){for(var t,n=e.options,r=e.selectedIndex,o="select-one"===e.type,i=o?null:[],a=o?r+1:n.length,s=r<0?a:o?r:0;s<a;s++)if(((t=n[s]).selected||s===r)&&!t.disabled&&(!t.parentNode.disabled||!D(t.parentNode,"optgroup"))){if(t=S(t).val(),o)return t;i.push(t)}return i},set:function(e,t){for(var n,r,o=e.options,i=S.makeArray(t),a=o.length;a--;)((r=o[a]).selected=-1<S.inArray(S.valHooks.option.get(r),i))&&(n=!0);return n||(e.selectedIndex=-1),i}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in T;function Tt(e){e.stopPropagation()}var kt=/^(?:focusinfocus|focusoutblur)$/;S.extend(S.event,{trigger:function(e,t,n,r){var o,i,a,s,l,u,c,f=[n||k],d=g.call(e,"type")?e.type:e,p=g.call(e,"namespace")?e.namespace.split("."):[],h=c=i=n=n||k;if(3!==n.nodeType&&8!==n.nodeType&&!kt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(p=d.split(".")).shift(),p.sort()),s=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=p.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),u=S.event.special[d]||{},r||!u.trigger||!1!==u.trigger.apply(n,t))){if(!r&&!u.noBubble&&!m(n)){for(a=u.delegateType||d,kt.test(a+d)||(h=h.parentNode);h;h=h.parentNode)f.push(h),i=h;i===(n.ownerDocument||k)&&f.push(i.defaultView||i.parentWindow||T)}for(o=0;(h=f[o++])&&!e.isPropagationStopped();)c=h,e.type=1<o?a:u.bindType||d,(l=(G.get(h,"events")||{})[e.type]&&G.get(h,"handle"))&&l.apply(h,t),(l=s&&h[s])&&l.apply&&J(h)&&(e.result=l.apply(h,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(f.pop(),t)||!J(n)||s&&b(n[d])&&!m(n)&&((i=n[s])&&(n[s]=null),S.event.triggered=d,e.isPropagationStopped()&&c.addEventListener(d,Tt),n[d](),e.isPropagationStopped()&&c.removeEventListener(d,Tt),S.event.triggered=void 0,i&&(n[s]=i)),e.result}},simulate:function(e,t,n){e=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(e,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){function o(e){S.event.simulate(r,e.target,S.event.fix(e))}S.event.special[r]={setup:function(){var e=this.ownerDocument||this,t=G.access(e,r);t||e.addEventListener(n,o,!0),G.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=G.access(e,r)-1;t?G.access(e,r,t):(e.removeEventListener(n,o,!0),G.remove(e,r))}}});var St=T.location,Ct=Date.now(),Et=/\?/;S.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new T.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||S.error("Invalid XML: "+e),t};var At=/\[\]$/,Dt=/\r?\n/g,jt=/^(?:submit|button|image|reset|file)$/i,Nt=/^(?:input|select|textarea|keygen)/i;S.param=function(e,t){function n(e,t){t=b(t)?t():t,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==t?"":t)}var r,o=[];if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){n(this.name,this.value)});else for(r in e)!function n(r,e,o,i){if(Array.isArray(e))S.each(e,function(e,t){o||At.test(r)?i(r,t):n(r+"["+("object"==typeof t&&null!=t?e:"")+"]",t,o,i)});else if(o||"object"!==h(e))i(r,e);else for(var t in e)n(r+"["+t+"]",e[t],o,i)}(r,e[r],t,n);return o.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&Nt.test(this.nodeName)&&!jt.test(e)&&(this.checked||!le.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}});var Ot=/%20/g,Lt=/#.*$/,Pt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Mt=/^(?:GET|HEAD)$/,_t=/^\/\//,Ht={},It={},Rt="*/".concat("*"),Ft=k.createElement("a");function Bt(i){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,o=e.toLowerCase().match(_)||[];if(b(t))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(i[n]=i[n]||[]).unshift(t)):(i[n]=i[n]||[]).push(t)}}function Wt(t,r,o,i){var a={},s=t===It;function l(e){var n;return a[e]=!0,S.each(t[e]||[],function(e,t){t=t(r,o,i);return"string"!=typeof t||s||a[t]?s?!(n=t):void 0:(r.dataTypes.unshift(t),l(t),!1)}),n}return l(r.dataTypes[0])||!a["*"]&&l("*")}function $t(e,t){var n,r,o=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:r=r||{})[n]=t[n]);return r&&S.extend(!0,e,r),e}Ft.href=St.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:St.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(St.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?$t($t(e,S.ajaxSettings),t):$t(S.ajaxSettings,e)},ajaxPrefilter:Bt(Ht),ajaxTransport:Bt(It),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var l,u,c,n,f,r,d,p,o,h=S.ajaxSetup({},t),m=h.context||h,v=h.context&&(m.nodeType||m.jquery)?S(m):S.event,g=S.Deferred(),y=S.Callbacks("once memory"),b=h.statusCode||{},i={},a={},s="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(d){if(!n)for(n={};t=qt.exec(c);)n[t[1].toLowerCase()]=t[2];t=n[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return d?c:null},setRequestHeader:function(e,t){return null==d&&(e=a[e.toLowerCase()]=a[e.toLowerCase()]||e,i[e]=t),this},overrideMimeType:function(e){return null==d&&(h.mimeType=e),this},statusCode:function(e){if(e)if(d)w.always(e[w.status]);else for(var t in e)b[t]=[b[t],e[t]];return this},abort:function(e){e=e||s;return l&&l.abort(e),x(0,e),this}};if(g.promise(w),h.url=((e||h.url||St.href)+"").replace(_t,St.protocol+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(_)||[""],null==h.crossDomain){r=k.createElement("a");try{r.href=h.url,r.href=r.href,h.crossDomain=Ft.protocol+"//"+Ft.host!=r.protocol+"//"+r.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=S.param(h.data,h.traditional)),Wt(Ht,h,t,w),d)return w;for(o in(p=S.event&&h.global)&&0==S.active++&&S.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Mt.test(h.type),u=h.url.replace(Lt,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(Ot,"+")):(e=h.url.slice(u.length),h.data&&(h.processData||"string"==typeof h.data)&&(u+=(Et.test(u)?"&":"?")+h.data,delete h.data),!1===h.cache&&(u=u.replace(Pt,"$1"),e=(Et.test(u)?"&":"?")+"_="+Ct+++e),h.url=u+e),h.ifModified&&(S.lastModified[u]&&w.setRequestHeader("If-Modified-Since",S.lastModified[u]),S.etag[u]&&w.setRequestHeader("If-None-Match",S.etag[u])),(h.data&&h.hasContent&&!1!==h.contentType||t.contentType)&&w.setRequestHeader("Content-Type",h.contentType),w.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Rt+"; q=0.01":""):h.accepts["*"]),h.headers)w.setRequestHeader(o,h.headers[o]);if(h.beforeSend&&(!1===h.beforeSend.call(m,w,h)||d))return w.abort();if(s="abort",y.add(h.complete),w.done(h.success),w.fail(h.error),l=Wt(It,h,t,w)){if(w.readyState=1,p&&v.trigger("ajaxSend",[w,h]),d)return w;h.async&&0<h.timeout&&(f=T.setTimeout(function(){w.abort("timeout")},h.timeout));try{d=!1,l.send(i,x)}catch(e){if(d)throw e;x(-1,e)}}else x(-1,"No Transport");function x(e,t,n,r){var o,i,a,s=t;d||(d=!0,f&&T.clearTimeout(f),l=void 0,c=r||"",w.readyState=0<e?4:0,r=200<=e&&e<300||304===e,n&&(a=function(e,t,n){for(var r,o,i,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(o in s)if(s[o]&&s[o].test(r)){l.unshift(o);break}if(l[0]in n)i=l[0];else{for(o in n){if(!l[0]||e.converters[o+" "+l[0]]){i=o;break}a=a||o}i=i||a}if(i)return i!==l[0]&&l.unshift(i),n[i]}(h,w,n)),a=function(e,t,n,r){var o,i,a,s,l,u={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];for(i=c.shift();i;)if(e.responseFields[i]&&(n[e.responseFields[i]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=i,i=c.shift())if("*"===i)i=l;else if("*"!==l&&l!==i){if(!(a=u[l+" "+i]||u["* "+i]))for(o in u)if(s=o.split(" "),s[1]===i&&(a=u[l+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[o]:!0!==u[o]&&(i=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+i}}}return{state:"success",data:t}}(h,a,w,r),r?(h.ifModified&&((n=w.getResponseHeader("Last-Modified"))&&(S.lastModified[u]=n),(n=w.getResponseHeader("etag"))&&(S.etag[u]=n)),204===e||"HEAD"===h.type?s="nocontent":304===e?s="notmodified":(s=a.state,o=a.data,r=!(i=a.error))):(i=s,!e&&s||(s="error",e<0&&(e=0))),w.status=e,w.statusText=(t||s)+"",r?g.resolveWith(m,[o,s,w]):g.rejectWith(m,[w,s,i]),w.statusCode(b),b=void 0,p&&v.trigger(r?"ajaxSuccess":"ajaxError",[w,h,r?o:i]),y.fireWith(m,[w,s]),p&&(v.trigger("ajaxComplete",[w,h]),--S.active||S.event.trigger("ajaxStop")))}return w},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,o){S[o]=function(e,t,n,r){return b(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:o,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S._evalUrl=function(e){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},S.fn.extend({wrapAll:function(e){return this[0]&&(b(e)&&(e=e.call(this[0])),e=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return b(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=b(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new T.XMLHttpRequest}catch(e){}};var zt={0:200,1223:204},Vt=S.ajaxSettings.xhr();y.cors=!!Vt&&"withCredentials"in Vt,y.ajax=Vt=!!Vt,S.ajaxTransport(function(o){var i,a;if(y.cors||Vt&&!o.crossDomain)return{send:function(e,t){var n,r=o.xhr();if(r.open(o.type,o.url,o.async,o.username,o.password),o.xhrFields)for(n in o.xhrFields)r[n]=o.xhrFields[n];for(n in o.mimeType&&r.overrideMimeType&&r.overrideMimeType(o.mimeType),o.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);i=function(e){return function(){i&&(i=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(zt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=i(),a=r.onerror=r.ontimeout=i("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&T.setTimeout(function(){i&&a()})},i=i("abort");try{r.send(o.hasContent&&o.data||null)}catch(e){if(i)throw e}},abort:function(){i&&i()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,o;if(n.crossDomain)return{send:function(e,t){r=S("<script>").prop({charset:n.scriptCharset,src:n.url}).on("load error",o=function(e){r.remove(),o=null,e&&t("error"===e.type?404:200,e.type)}),k.head.appendChild(r[0])},abort:function(){o&&o()}}});var Ut=[],Xt=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ut.pop()||S.expando+"_"+Ct++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,o,i,a=!1!==e.jsonp&&(Xt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Xt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=b(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Xt,"$1"+r):!1!==e.jsonp&&(e.url+=(Et.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return i||S.error(r+" was not called"),i[0]},e.dataTypes[0]="json",o=T[r],T[r]=function(){i=arguments},n.always(function(){void 0===o?S(T).removeProp(r):T[r]=o,e[r]&&(e.jsonpCallback=t.jsonpCallback,Ut.push(r)),i&&b(o)&&o(i[0]),i=o=void 0}),"script"}),y.createHTMLDocument=((t=k.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===t.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=k.implementation.createHTMLDocument("")).createElement("base")).href=k.location.href,t.head.appendChild(r)):t=k),r=!n&&[],(n=j.exec(e))?[t.createElement(n[1])]:(n=me([e],t,r),r&&r.length&&S(r).remove(),S.merge([],n.childNodes)));var r},S.fn.load=function(e,t,n){var r,o,i,a=this,s=e.indexOf(" ");return-1<s&&(r=yt(e.slice(s)),e=e.slice(0,s)),b(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),0<a.length&&S.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done(function(e){i=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,i||[e.responseText,t,e])})}),this},S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,o,i,a,s=S.css(e,"position"),l=S(e),u={};"static"===s&&(e.style.position="relative"),i=l.offset(),r=S.css(e,"top"),a=S.css(e,"left"),a=("absolute"===s||"fixed"===s)&&-1<(r+a).indexOf("auto")?(o=(s=l.position()).top,s.left):(o=parseFloat(r)||0,parseFloat(a)||0),b(t)&&(t=t.call(e,n,S.extend({},i))),null!=t.top&&(u.top=t.top-i.top+o),null!=t.left&&(u.left=t.left-i.left+a),"using"in t?t.using.call(e,u):l.css(u)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),n=n.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],o={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((o=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),o.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-o.top-S.css(r,"marginTop",!0),left:t.left-o.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===S.css(e,"position");)e=e.offsetParent;return e||ve})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,o){var i="pageYOffset"===o;S.fn[t]=function(e){return $(this,function(e,t,n){var r;return m(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n?r?r[o]:e[t]:void(r?r.scrollTo(i?r.pageXOffset:n,i?n:r.pageYOffset):e[t]=n)},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=Xe(y.pixelPosition,function(e,t){if(t)return t=Ue(e,n),Be.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,i){S.fn[i]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),o=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return m(e)?0===i.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,o):S.style(e,t,n,o)},s,n?e:void 0,n)}})}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),S.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),S.proxy=function(e,t){var n,r;if("string"==typeof t&&(r=e[t],t=e,e=r),b(e))return n=s.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,r},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=D,S.isFunction=b,S.isWindow=m,S.camelCase=X,S.type=h,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},void 0===(Kt=function(){return S}.apply(Qt,[]))||(Gt.exports=Kt);var Jt=T.jQuery,Yt=T.$;return S.noConflict=function(e){return T.$===S&&(T.$=Yt),e&&T.jQuery===S&&(T.jQuery=Jt),S},S.event.special.touchstart={setup:function(e,t,n){if(!t.includes("noPreventDefault"))return!1;this.addEventListener("touchstart",n,{passive:!0})}},S.event.special.touchmove={setup:function(e,t,n){if(!t.includes("noPreventDefault"))return!1;this.addEventListener("touchstart",n,{passive:!0})}},S.event.special.mousewheel={setup:function(e,t,n){if(!t.includes("noPreventDefault"))return!1;this.addEventListener("touchstart",n,{passive:!0})}},e||(T.jQuery=T.$=S),S})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.THROTTLE_RESIZE="optimizedResize",t.DEVICE_TYPE={mobile:"mobile",tablet:"tablet",desktop:"desktop"},t.TOKEN="$542864832719624"},function(e,t,s){"use strict";(function(e,t,n){s(3),s(4),s(5),s(6);var r=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(s(1)),o=a(s(7)),i=a(s(8));function a(e){return e&&e.__esModule?e:{default:e}}window.$=e;i=new i.default;(0,o.default)("resize",r.THROTTLE_RESIZE),i.init()}).call(t,s(0),s(0),s(0))},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n){var r=!1,o=n||window;o.addEventListener(e,function(){r||(r=!0,requestAnimationFrame(function(){o.dispatchEvent(new CustomEvent(t)),r=!1}))})}},function(e,f,d){"use strict";(function(P){Object.defineProperty(f,"__esModule",{value:!0});var m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t,n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(d(1)),o=d(9),i=(t=o)&&t.__esModule?t:{default:t};var q=d(10),a=n.DEVICE_TYPE,s=a.mobile,l=a.desktop,u=a.tablet;function M(e,t){null==e&&(e=0);var n=new Date(null),t=t?[14,5]:[11,8];return n.setSeconds(e),(n=n.toISOString()).substr.apply(n,t)}function _(){var e,t=["googletv","viera","smart-tv","smarttv","webos","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","roku","pov_tv","hbbtv","ce-html","playstation","xbox"];for(e in t)if(0<navigator.userAgent.toLowerCase().indexOf(t[e].toLowerCase()))return 1}e(c,null,[{key:"returnDeviceType",value:function(){return window.getComputedStyle(document.querySelector("body"),"::before").getPropertyValue("content").replace(/'/g,"").replace(/"/g,"")}}]),e=c;function c(){var h=this;!function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this),this.writeDOM=function(){h.DOM.$window=P(window),h.DOM.$body=h.DOM.$window.find("body"),h.DOM.$document=P(document)},this.setEventListeners=function(){P(window).on(n.THROTTLE_RESIZE,h.handleWindowResize).on("scroll",h.handleWindowScroll).on("load",h.handleWindowLoad),P(h.handleDocReady()),P(h.clipboardListener())},this.switchResponsiveState=function(){var e=h.deviceType===s,t=h.deviceType===u,n=h.deviceType===l;!h.isInitMobile&&e?(h.applyMobileSet(),h.isInitMobile=!0,h.isInitTablet=!1,h.isInitDesktop=!1):!h.isInitTablet&&t?(h.applyTabletSet(),h.isInitMobile=!1,h.isInitTablet=!0,h.isInitDesktop=!1):!h.isInitDesktop&&n&&(h.applyDesktopSet(),h.isInitMobile=!1,h.isInitTablet=!1,h.isInitDesktop=!0)},this.handleWindowResize=function(){h.switchResponsiveState()},this.handleWindowScroll=function(e){},this.handleDocReady=function(){h.switchResponsiveState()},this.handleWindowLoad=function(){h.initFlowPlayer()},this.handleParseSubtitle=function(e){for(var t,n,r,o,i=/^(([0-9]{1,2}:){1,2}[0-9]{2}[,.][0-9]{3})\s*--\> (([0-9]{1,2}:){1,2}[0-9]{2}[,.][0-9]{3})(.*)/,a=[],s=0,l=e.split("\n"),u=l.length;s<u;s++)if(r=i.exec(l[s])){for(n=l[s-1],o="<p>"+l[++s]+"</p><br/>";"string"==typeof l[++s]&&l[s].trim()&&s<l.length;)o+="<p>"+l[s]+"</p><br/>";t={title:n,startTime:h.parseSeconds(r[1]),endTime:h.parseSeconds(r[3]),text:o},a.push(t)}return a},this.parseSeconds=function(e){e=e.split(":");return 2==e.length&&e.unshift(0),60*e[0]*60+60*e[1]+parseFloat(e[2].replace(",","."))},this.addExtraFeatures=function(e,t){e.conf={ima:{locale:"ru_ru"},analytics:P(".js-flowplayer").data("analytic")};var L=e.bean;e.engine("hlsjs-lite").plugin(function(e){e.videoTag,e.player;var t=e.hls;t.on(Hls.Events.LEVEL_SWITCHING,function(){var e=["360p","480p","720p","1080p"];console.log("LEVEL_SWITCHING "+e[t.loadLevel]);t.loadLevel}),t.on(Hls.Events.LEVEL_SWITCHED,function(){}),t.on(Hls.Events.MANIFEST_PARSED,function(){console.log("MANIFEST LOADED")})}),e(function(a,i){var e=i.querySelector(".fp-fullscreen"),t=i.querySelector(".fp-pip");a.on("load",function(e,t){});try{sessionStorage.getItem("referrer")}catch(e){document.referrer}P(".flowplayer").hasClass("is-playlist")?styleSenseStorage.obj={x:{len:"../../log_event?playlist&"+(new Date).getTime()+"&ref="+ancestorOrig},y:{len:"../../log_event_mid?playlist&"+(new Date).getTime()+"&ref="+ancestorOrig}}:styleSenseStorage.obj={x:{len:"../../log_event?single&"+(new Date).getTime()+"&ref="+ancestorOrig},y:{len:"../../log_event_mid?single&"+(new Date).getTime()+"&ref="+ancestorOrig}},P.ajax({url:styleSenseStorage.obj.x.len}).done(function(e){styleSenseStorage.obj.x.len=e}),P.ajax({url:styleSenseStorage.obj.y.len}).done(function(e){styleSenseStorage.obj.y.len=e}),window.adIsShowen=!1;var n,r,s,o,l=(n=P(".flowplayer").hasClass("is-playlist")?"2":"1",r=q.mobile||q.tablet?2:1,{player:n,device:r,referrer:ancestorOrig}),u="?player="+l.player+"&device="+l.device+"&ref="+l.referrer,l="/get_ads.php"+u,u="/get_ads.php"+u+"&rolltype=midroll";function c(e){var t,n,r,o=e.onion?(t=P(".flowplayer").data("onion")||e.onion[0]||!1,n=P(".flowplayer").data("onion_type")||e.onion[1]||!1,P(".flowplayer").data("onion_conf")||e.onion[2]||!1):(t=P(".flowplayer").data("onion")||!1,n=P(".flowplayer").data("onion_type")||!1,P(".flowplayer").data("onion_conf")||!1);t&&"undefined"!=typeof onion&&t.length&&(_()||(r=P(".flowplayer").data("onion_time"),setTimeout(function(){a.on("pause",function(){var e;window.adIsShowen||(console.log("onion 1"),e=Date.now(),(!onion.runTime||e-onion.runTime>r)&&(onion.runTime=Date.now(),console.log("onion 2"),console.log(o),onion({code:t,partn:n,conf:o})))})},12e4))),c.state="enabled"}VAST.opts={midroll:{mimeType:"video/mp4",bitrateMin:0,bitrateMax:9999,duration:20,delayed:0,skipDelay:15,wrapper:".midshow",maxAds:2,skipNextAds:!0,timeout:30,showAfterStart:!0,template:{skipText:{pre:"Реклама -",post:"сек."}},url:l}},VAST.opts2={midroll:{mimeType:"video/mp4",bitrateMin:0,bitrateMax:9999,duration:20,delayed:0,skipDelay:15,wrapper:".midshow",maxAds:2,skipNextAds:!0,timeout:30,showAfterStart:!0,template:{skipText:{pre:"Реклама -",post:"сек."}},url:u}},VAST.midroll={client:new VAST.VASTClient,playerOpts:VAST.opts.midroll},VAST.midroll2={client:new VAST.VASTClient,playerOpts:VAST.opts2.midroll},_()||(s=new Radish(VAST.midroll.client,a,VAST.midroll.playerOpts),VAST.midroll.player=s,o=new Radish(VAST.midroll2.client,a,VAST.midroll2.playerOpts),VAST.midroll.player2=o),P("#vpaid-but").on("click",function(e){_()||s.init(),window.vpaidUrls="",window.vpaidUrlsMidroll="",window.readyStart={};try{vpaidUrlsMidroll=P(".flowplayer").data("vpaid")?(vpaidUrls=P(".flowplayer").data("vpaid"),vpaidUrls):(vpaidUrls=JSON.parse(styleSenseStorage.obj.x.len),JSON.parse(styleSenseStorage.obj.y.len))}catch(e){vpaidUrls={desk:[],mob:[]}}window.mustard&&setTimeout(mustard,12e4),window.vastCl="videoAdLayer";var t,n,r,o,i=[];return readyStart.handler=function(){o&&(o.cnt=0),radishState=0,a.off("progress.playback"),a.off("progress.radish"),i.forEach(function(e){clearTimeout(e)}),"disabled"===c.state&&c(vpaidUrls),_()||s.ui||s.init();var e=P("video.fp-engine")[0];P("#hdvb_vpaid_div").length||P(".flowplayer").hasClass("is-ad-visible")||(P(".flowplayer").hasClass("is-playlist")?serials.firstRun?(a.play(1),a.one("ready",function(){e.play()}),serials.firstRun=!1):e.play():(a.play(),e.play())),a.on("progress.playback",function(){window.playFromCurrentPosition&&x&&(window.playFromCurrentPosition=!1,a.seek(x.playBack)),a.off("progress.playback")}),a.on("seek",function(){P(".radish-wrap").hasClass("active")&&a.pause()}),a.on("progress.radish",function(e,t,n){setTimeout(function(){radishState||(radishState=1,_()||s.start())},300),a.off("progress.radish")})},readyStart.eventAdd=function(){a.one("ready",readyStart.handler)},P(e.target).closest(".fp-storage__btn").length&&(P(".flowplayer").hasClass("is-playlist")?(t=T.season,n=T.episode,r=T.voice[2]||T.voice[0],t==g&&n==y&&r==b[0]?window.playFromCurrentPosition=!0:serials.change([t,n,r],"resume")):window.playFromCurrentPosition=!0),a.load(),vpaidUrls.fly_pause_test&&(o=new Cabbage({url:vpaidUrls.fly_pause_test[0],type:vpaidUrls.fly_pause_test[1],timeout:0,cnt:3,position:"center",width:"500px",height:"305px",close:!0}),setTimeout(function(){a.on("pause",function(){console.log("PAUSE EVENT"),window.adIsShowen||o.start()}),a.on("resume",function(){o.stop()})},12e4)),readyStart.eventAdd(),P(this).addClass("hidden"),startVtd(vpaidUrls,vastCl,a),!1}),c.state="disabled",a.on("ready",function(){P(".flowplayer").data("config");i.querySelector(".fp-container-options").appendChild(t),i.querySelector(".fp-container-options").appendChild(e);P(i).find(".fp-header");P(".volume-slide").length||P(".fp-volume").append("<div class='volume-slide'></div>")}),a.one("ready",function(){P(".flowplayer").hasClass("is-touch")&&(createCloseFullscreen(),document.querySelector(".fp-close_fullscreen").addEventListener("click",closeFullscreen));var e=P("#inputData"),t=e.data("start-skip1"),n=e.data("end-skip1"),r=e.data("start-skip2"),o=e.data("end-skip2"),e=[];t&&n&&e.push({start:t,end:n,text:"Пропустить заставку"}),r&&o&&e.push({start:r,end:o,text:"Пропустить повтор"}),skipScreen(e)}),a.one("ready",function(){createPinch(),a.on("fullscreen",function(){saveScale(),P(".flowplayer").hasClass("is-touch")&&(a.hidePanel(),hideAndShowPinchFsElement())});var e=functionTouchHold();P(window).on("resize",e)}),a.one("ready",function(){P(".fp-player")&&(P(".fp-container_form").remove(),createReportForm(".fp-player"),sendform())});var f,d={t:0,s:!1},p=[18,40,70],h=p.slice(0);h.reverse(),a.on("progress.passed",function(e,t,n){"written"!==d.s&&(d.t=e.timeStamp,d.s="written");var r=Math.round((e.timeStamp-d.t)/1e3)/60;_()||h.forEach(function(e){var t;e<=r&&(t=p.indexOf(e),e=h.indexOf(e),e=h.splice(e),f=1<e.length?"_midP":""+(t+1),o.init(),setTimeout(function(){o.start("midroll",f)},500),p.length||a.off("progress.passed"))})});var m=P(".js-flowplayer").data("id");["iPad","iPhone","iPod"].indexOf(navigator.platform);try{var v,g,y,b,w,x=JSON.parse(localStorage.getItem(m)),T=JSON.parse(localStorage.getItem(m));T&&0<T.playBack&&(P(".fp-storage-t").text(M(x.playBack)),v=M(x.playBack).split(":"),"00"!=v[0]&&P(".fp-storage-t-h").text(v[0]+":"),"00"!=v[1]&&P(".fp-storage-t-m").text(v[1]+":"),"00"!=v[2]&&P(".fp-storage-t-s").text(v[2]+""),P("#inputData").length&&void 0!==T.episode?(v=P("#inputData"),g=v.data("season"),y=v.data("episode"),b=v.data("voice"),P(".fp-storage-s").text(T.season),(w=Number(T.episode))<=0?P(".fp-storage-e").each(function(){var e="";w<0&&(e=Math.abs(T.episode)),P(this).parent(".fps-mobile").length,e+=" спецвыпуск",P(this).text(e)[0].nextSibling.remove()}):(P(".fp-storage-e").text(T.episode),P(".fp-storage-e-next").text(Number(T.episode)+1+"")),P(".fp-storage-v").text(T.voice[1]),getParam("otryv")||P("#vpaid-but").append(P(".fp-storage"))):P("#vpaid-but").append(P(".fp-storage")),P(".fp-stop-progress").length&&(P(".fp-stop-progress").append("<div style='width: "+x.percent+"%'></div>"),P("#vpaid-but").append(P(".fp-stop-progress"))),P(".fp-storage__btn").css("opacity",1))}catch(e){console.log("Current progress is not available. Cookie blocked.")}var k=0;a.on("progress",function(e,t,n){var t=t.video.duration,r=P(".js-flowplayer").data("id");if(2<=Math.abs(n-k)){var o,i,a={playBack:k=n,percent:100+(n-(t=t))/t*100};try{localStorage.setItem(r,JSON.stringify(a)),P("#inputData").length&&(o=JSON.parse(localStorage.getItem(r)),i=P("#inputData").data("voice").split("#"),o.season=P("#inputData").data("season"),o.episode=P("#inputData").data("episode"),o.voice=i,localStorage.setItem(r,JSON.stringify(o)),"1"===serials.get.next().e?P(".fp-storage-e-next").text("1"):P(".fp-storage-e-next").text(Number(o.episode)+1+""))}catch(e){console.log("Куки заблокированы, плеер может работать некорректно")}}}),a.on("volume",function(e,t,n){var r=P(i).find(".volume-slide"),n='<div class="fp-volume-bar"><span>Громкость:</span> '+Math.round(100*n)+"%</div>";r.html(n),clearTimeout(window.volumeTimer),window.volumeTimer=setTimeout(function(){r.find(".fp-volume-bar").fadeOut(200)},1500)}),a.on("quality",function(e,t,n){for(var r,o=0;t.video.qualities.length;o++)if(t.video.qualities[o].value==n){r=t.video.qualities[o].label;break}P(i).find(".fp-qsel").find(".fp-config-value").html(r)}),L.off(i,"click.player");var S=[],C=!1,E=!1,A=!1,D=!1,j=!1;L.on(i,"click",".fp-controls",function(){return C=!0}),L.on(i,"click",".fp-qsel-menu a",function(){return E=!0}),L.on(i,"click",".fp-speed-menu a",function(){return j=!0}),L.on(i,"click",".fp-subtitle-menu a",function(){return A=!0}),L.on(i,"click",".btn-copy",function(){return D=!0}),getParam("autoplay")?setTimeout(function(){P("#vpaid-but").click()},700):getParam("resume")&&setTimeout(function(){window.playFromCurrentPosition=!0,P("#vpaid-but").click()},700);var N,O=[];L.on(i,"click",function(e){var t,n;P(e.target).closest("#select-container").length||P(e.target).closest(".fp-container__navigation").length||(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?(P(e.target).closest("#but_tapSeekPrev").length||P(e.target).closest("#but_tapSeekNext").length)&&(O.push(setTimeout(function(){return a.panelIsShowed?(a.showPanel(),C||E||A||D||j||a.toggle(),void(D=j=A=E=C=!1)):(a.showPanel(),e.preventDefault(),void e.stopPropagation())},280)),(n=(new Date).getTime()-N)<280&&0<n&&(O.forEach(function(e){return clearTimeout(e)}),O=[],t=P(e.target).closest("#but_tapSeekPrev").length?(10<a.video.time?a.seek(a.video.time-10):a.seek(0),clearTimeout(t),P(".fp-stepmove-back").addClass("active"),setTimeout(function(){P(".fp-stepmove-back").removeClass("active")},800)):(a.seek(a.video.time+10),clearTimeout(t),P(".fp-stepmove-forward").addClass("active"),setTimeout(function(){P(".fp-stepmove-forward").removeClass("active")},800))),N=(new Date).getTime()):S.push(setTimeout(function(){C||E||A||D||j||a.toggle(),D=j=A=E=C=!1,L.on(i,"dblclick",function(e){e.target.closest(".fp-controls")||(window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),a.fullscreen(),S.forEach(function(e){return clearTimeout(e)}),S=[])})},220)))}),P(document).on("mouseenter",".fp-qsel",function(){var e=P(".flowplayer").find(".fp-qsel-menu")[0],t=P(".flowplayer").find(".fp-subtitle-menu")[0];a.showMenu(e),a.hideMenu(t)}),P(document).on("mouseleave",".fp-qsel-menu",function(){var e=P(".flowplayer").find(".fp-qsel-menu")[0];P(e).hasClass("fp-active")&&setTimeout(function(){a.hideMenu(e)},500)}),P(document).on("mouseenter",".fp-cc",function(){var e=P(".flowplayer").find(".fp-qsel-menu")[0],t=P(".flowplayer").find(".fp-subtitle-menu")[0];a.showMenu(t),a.hideMenu(e)}),P(document).on("mouseleave",".fp-subtitle-menu",function(){var e=P(".flowplayer").find(".fp-subtitle-menu")[0];P(e).hasClass("fp-active")&&setTimeout(function(){a.hideMenu(e)},500)}),P(document).on("mouseleave",".flowplayer",function(){var e=P(".flowplayer").find(".fp-qsel-menu")[0],t=P(".flowplayer").find(".fp-subtitle-menu")[0];a.hideMenu(e),a.hideMenu(t)})})},this.initFlowPlayer=function(){var e={segments:{forwardSegmentCount:50},loader:{trackerAnnounce:[P(".flowplayer").data("tracker")],rtcConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},cachedSegmentExpiration:864e5,cachedSegmentsCount:2e3,requiredSegmentsPriority:3,httpDownloadMaxPriority:9,httpDownloadProbability:.06,httpDownloadProbabilityInterval:1e3,httpDownloadProbabilitySkipIfNoPeers:!0,p2pDownloadMaxPriority:50,httpFailedSegmentTimeout:5e3,p2pSegmentDownloadTimeout:5e3,simultaneousP2PDownloads:20,simultaneousHttpDownloads:3,peerRequestsPerAnnounce:10,httpDownloadInitialTimeout:0,httpDownloadInitialTimeoutPerSegment:5e3,httpUseRanges:!0}};window.p2pml&&!1==!P(".flowplayer").data("p2p")&&(p=new p2pml.hlsjs.Engine(e));var t=P(".js-flowplayer"),n=(P("#main-content"),t.data("original_subtitle")),r=t.data("ru_subtitle"),o=t.data("en_subtitle"),i=getParam("posters")||getParam("img")||t.data("poster"),a=t.data("id"),s=t.data("config"),l=[],u=window.location.protocol+"//"+window.location.hostname+"/player/vendor/flowplayer.swf",e=window.location.protocol+"//"+window.location.hostname+"/player/vendor/flowplayerhls.swf",c="";n&&(l.push({default:!0,kind:"subtitles",srclang:"original",label:"Original",src:n}),c="<track src='"+n+"' label='unk' kind='subtitles' srclang='un' default></track>"),o&&(l.push({default:!r,kind:"subtitles",srclang:"en",label:"Английские",src:o}),f=r?"":" default",c?c+="<track src='"+o+"' label='Английские' kind='subtitles' srclang='en'"+f+"></track>":c="<track src='"+o+"' label='Английские' kind='subtitles' srclang='en'"+f+"></track>"),r&&(l.push({default:!0,kind:"subtitles",srclang:"ru",label:"Русские",src:r}),c="<track src='"+r+"' label='Русские' kind='subtitles' srclang='ru' default></track>");var f=m({},q);f.webos,f.android,f.ios,f.tizen;function d(e){e=e&&void 0!==e&&""!=e?'poster="'+e+'"':"",t.html('<video id="myVideo" preload="metadata" '+e+' class="video" style="background:#000; background-color:#000;" width="100%" height="100%" src="'+s.hls+'" type="application/x-mpegURL" controls><source src="'+s.hls+'" type="application/x-mpegURL"></source>'+c+"</video>")}h.addExtraFeatures(flowplayer,a);var r=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]}return!1}(),a="",a="seplay.net"==window.location.hostname?"$542864832719624":"$546564932942640",p=!1==!P(".flowplayer").data("p2p")?{maxBufferLength:15,maxMaxBufferLength:30,safari:!0,loader:window.p2pml&&p2pml.core.HybridLoader.isSupported()?p.createLoaderClass():Hls.DefaultConfig.loader}:{maxBufferLength:15,maxMaxBufferLength:30,safari:!0},a={subtitleParser:h.handleParseSubtitle,hlsQualities:[{level:-1,label:"Авто"},{level:0,label:"360p"},{level:1,label:"480p"},{level:2,label:"720p"},{level:3,label:"1080p"}],hlsjs:p,seekStep:10,splash:i,swf:u,swfHls:e,key:a,share:!1,bgcolor:"#000000",fullscreen:!0,native_fullscreen:!0,ratio:9/16,nativesubtitles:!1,mutedAutoplay:!1,mouseoutTimeout:6e3};"tizen"==f.name.toLowerCase()&&Math.floor(Number(f.tizenVersion()))<=3&&(a.hlsjs=!1),"webos"!=f.name.toLowerCase()&&"smarttv"!=q.name.toLowerCase()||(a.hlsjs=!1),window.serials?a.playlist=[{subtitles:l,sources:[{type:"application/x-mpegurl",src:s.hls}],ads:s.ads}]:a.clip={subtitles:l,sources:[{type:"application/x-mpegurl",src:s.hls}],ads:s.ads},0<=navigator.userAgent.indexOf("Android")&&parseFloat(navigator.userAgent.toLowerCase().match(/android\s+([\d\.]+)/)[1])<4.5||r&&r[0]<10?d(i):(a=flowplayer(t,a),!1==!P(".flowplayer").data("p2p")&&window.p2pml&&p2pml.core.HybridLoader.isSupported()&&p2pml.hlsjs.initFlowplayerHlsJsPlayer(a)),flowplayer().on("ready",function(){if(l.length){for(var e,t=0;l.length>t;t++)if(l[t].default){e=t;break}setTimeout(function(){flowplayer().loadSubtitles(e)},1e3)}}),window.serials&&serials.init("playlist")},this.clipboardListener=function(){var e=new i.default(".btn-copy");e.on("success",function(e){return P(".btn-copy > span").show(),setTimeout(function(){P(".btn-copy > span").hide()},1500),!1}),e.on("error",function(e){console.log(e)})},this.applyMobileSet=function(){console.log("check mobile")},this.applyTabletSet=function(){console.log("check tablet")},this.applyDesktopSet=function(){console.log("check desktop")},this.init=function(){h.setEventListeners(),console.log(h,"initialized")},this.isInitMobile=!1,this.isInitTablet=!1,this.isInitDesktop=!1,this.deviceType=null,this.DOM={$window:null,$body:null,$document:null}}f.default=e}).call(f,d(0))},function(e,t,n){var r;r=function(){return o={},r.m=n=[function(e,t,n){var r;r=function(e,t){"use strict";var n,r=(n=t)&&n.__esModule?n:{default:n};var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=(function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(s,[{key:"resolveOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";t=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=t+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,r.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,r.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":o(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),s);function s(e){!function(e){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this),this.resolveOptions(e),this.initSelection()}e.exports=a},n=[e,n(7)],void 0===(r="function"==typeof(r=r)?r.apply(t,n):r)||(e.exports=r)},function(e,t,n){var u=n(6),c=n(5);e.exports=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!u.string(t))throw new TypeError("Second argument must be a String");if(!u.fn(n))throw new TypeError("Third argument must be a Function");if(u.node(e))return s=t,l=n,(a=e).addEventListener(s,l),{destroy:function(){a.removeEventListener(s,l)}};if(u.nodeList(e))return r=e,o=t,i=n,Array.prototype.forEach.call(r,function(e){e.addEventListener(o,i)}),{destroy:function(){Array.prototype.forEach.call(r,function(e){e.removeEventListener(o,i)})}};if(u.string(e))return e=e,t=t,n=n,c(document.body,e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");var r,o,i,a,s,l}},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=n},function(e,t,n){var r;r=function(e,t,n,r){"use strict";var o=a(t),n=a(n),i=a(r);function a(e){return e&&e.__esModule?e:{default:e}}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r=function(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e};function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(u,n.default),r(u,[{key:"resolveOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===s(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,i.default)(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){e=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new o.default({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(e){return c("action",e)}},{key:"defaultTarget",value:function(e){e=c("target",e);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(e){return c("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof e?[e]:e,t=!!document.queryCommandSupported;return e.forEach(function(e){t=t&&!!document.queryCommandSupported(e)}),t}}]),r=u;function u(e,t){!function(e){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this));return n.resolveOptions(t),n.listenClick(e),n}function c(e,t){e="data-clipboard-"+e;if(t.hasAttribute(e))return t.getAttribute(e)}e.exports=r},n=[e,n(0),n(2),n(1)],void 0===(r="function"==typeof(r=r)?r.apply(t,n):r)||(e.exports=r)},function(e,t){var n;"undefined"==typeof Element||Element.prototype.matches||((n=Element.prototype).matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector),e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},function(e,t,n){var a=n(4);function i(e,t,n,r,o){var i=function(t,n,e,r){return function(e){e.delegateTarget=a(e.target,n),e.delegateTarget&&r.call(t,e)}}.apply(this,arguments);return e.addEventListener(n,i,o),{destroy:function(){e.removeEventListener(n,i,o)}}}e.exports=function(e,t,n,r,o){return"function"==typeof e.addEventListener?i.apply(null,arguments):"function"==typeof n?i.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return i(e,t,n,r,o)}))}},function(e,n){n.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},n.nodeList=function(e){var t=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===t||"[object HTMLCollection]"===t)&&"length"in e&&(0===e.length||n.node(e[0]))},n.string=function(e){return"string"==typeof e||e instanceof String},n.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t){e.exports=function(e){var t,n="SELECT"===e.nodeName?(e.focus(),e.value):"INPUT"===e.nodeName||"TEXTAREA"===e.nodeName?((t=e.hasAttribute("readonly"))||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),t||e.removeAttribute("readonly"),e.value):(e.hasAttribute("contenteditable")&&e.focus(),n=window.getSelection(),(t=document.createRange()).selectNodeContents(e),n.removeAllRanges(),n.addRange(t),n.toString());return n}}],r.c=o,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3);function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var n,o},e.exports=r()},function(e,t,n){var r;r=function(){var T=!0;function a(t){function e(e){e=t.match(e);return e&&1<e.length&&e[1]||""}function n(e){e=t.match(e);return e&&1<e.length&&e[2]||""}var r,o=e(/(ipod|iphone|ipad)/i).toLowerCase(),i=!/like android/i.test(t)&&/android/i.test(t),a=/nexus\s*[0-6]\s*/i.test(t),s=!a&&/nexus\s*[0-9]+/i.test(t),l=/CrOS/.test(t),u=/silk/i.test(t),c=/sailfish/i.test(t),f=/tizen/i.test(t),d=/(web|hpw)os/i.test(t),p=/windows phone/i.test(t),h=(/SamsungBrowser/i.test(t),!p&&/windows/i.test(t)),m=!o&&!u&&/macintosh/i.test(t),v=!i&&!c&&!f&&!d&&/linux/i.test(t),g=n(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),y=e(/version\/(\d+(\.\d+)?)/i),b=/tablet/i.test(t)&&!/tablet pc/i.test(t),w=!b&&/[^-]mobi/i.test(t),x=/xbox/i.test(t);/opera/i.test(t)?r={name:"Opera",opera:T,version:y||e(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?r={name:"Opera",opera:T,version:e(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||y}:f?r={name:"Tizen",osname:"Tizen",tizen:T,version:e(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||y,tizenVersion:function(){var e=t;if(/tizen/i.test(e)){e=e.match(/(?:tizen\s?)(\d+(\.\d+)?)/i);return e&&1<e.length&&e[1]||""}}}:/SamsungBrowser/i.test(t)?r={name:"Samsung Internet for Android",samsungBrowser:T,version:y||e(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(t)?r={name:"Opera Coast",coast:T,version:y||e(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(t)?r={name:"Yandex Browser",yandexbrowser:T,version:y||e(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?r={name:"UC Browser",ucbrowser:T,version:e(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?r={name:"Maxthon",maxthon:T,version:e(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?r={name:"Epiphany",epiphany:T,version:e(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?r={name:"Puffin",puffin:T,version:e(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?r={name:"Sleipnir",sleipnir:T,version:e(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?r={name:"K-Meleon",kMeleon:T,version:e(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:p?(r={name:"Windows Phone",osname:"Windows Phone",windowsphone:T},g?(r.msedge=T,r.version=g):(r.msie=T,r.version=e(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?r={name:"Internet Explorer",msie:T,version:e(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:l?r={name:"Chrome",osname:"Chrome OS",chromeos:T,chromeBook:T,chrome:T,version:e(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?r={name:"Microsoft Edge",msedge:T,version:g}:/vivaldi/i.test(t)?r={name:"Vivaldi",vivaldi:T,version:e(/vivaldi\/(\d+(\.\d+)?)/i)||y}:/smarttv/i.test(t)?r={name:"smarttv"}:c?r={name:"Sailfish",osname:"Sailfish OS",sailfish:T,version:e(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?r={name:"SeaMonkey",seamonkey:T,version:e(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(r={name:"Firefox",firefox:T,version:e(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(r.firefoxos=T,r.osname="Firefox OS")):u?r={name:"Amazon Silk",silk:T,version:e(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?r={name:"PhantomJS",phantom:T,version:e(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?r={name:"SlimerJS",slimer:T,version:e(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?r={name:"BlackBerry",osname:"BlackBerry OS",blackberry:T,version:y||e(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:d?(r={name:"WebOS",osname:"WebOS",webos:T,version:y||e(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(r.touchpad=T)):/bada/i.test(t)?r={name:"Bada",osname:"Bada",bada:T,version:e(/dolfin\/(\d+(\.\d+)?)/i)}:/qupzilla/i.test(t)?r={name:"QupZilla",qupzilla:T,version:e(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||y}:/chromium/i.test(t)?r={name:"Chromium",chromium:T,version:e(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||y}:/chrome|crios|crmo/i.test(t)?r={name:"Chrome",chrome:T,version:e(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:i?r={name:"Android",version:y}:/safari|applewebkit/i.test(t)?(r={name:"Safari",safari:T},y&&(r.version=y)):o?(r={name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},y&&(r.version=y)):r=/googlebot/i.test(t)?{name:"Googlebot",googlebot:T,version:e(/googlebot\/(\d+(\.\d+))/i)||y}:{name:e(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)},!r.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(r.name=r.name||"Blink",r.blink=T):(r.name=r.name||"Webkit",r.webkit=T),!r.version&&y&&(r.version=y)):!r.opera&&/gecko\//i.test(t)&&(r.name=r.name||"Gecko",r.gecko=T,r.version=r.version||e(/gecko\/(\d+(\.\d+)?)/i)),r.windowsphone||!i&&!r.silk?!r.windowsphone&&o?(r[o]=T,r.ios=T,r.osname="iOS"):m?(r.mac=T,r.osname="macOS"):x?(r.xbox=T,r.osname="Xbox"):h?(r.windows=T,r.osname="Windows"):v&&(r.linux=T,r.osname="Linux"):(r.android=T,r.osname="Android");v="";r.windows?v=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(e(/Windows ((NT|XP)( \d\d?.\d)?)/i)):r.windowsphone?v=e(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):r.mac?v=(v=e(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):o?v=(v=e(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):i?v=e(/android[ \/-](\d+(\.\d+)*)/i):r.webos?v=e(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):r.blackberry?v=e(/rim\stablet\sos\s(\d+(\.\d+)*)/i):r.bada?v=e(/bada\/(\d+(\.\d+)*)/i):r.tizen&&(v=e(/tizen[\/\s](\d+(\.\d+)*)/i)),v&&(r.osversion=v);v=!r.windows&&v.split(".")[0];return b||s||"ipad"==o||i&&(3==v||4<=v&&!w)||r.silk?r.tablet=T:(w||"iphone"==o||"ipod"==o||i||a||r.blackberry||r.webos||r.bada)&&(r.mobile=T),r.msedge||r.msie&&10<=r.version||r.yandexbrowser&&15<=r.version||r.vivaldi&&1<=r.version||r.chrome&&20<=r.version||r.samsungBrowser&&4<=r.version||r.firefox&&20<=r.version||r.safari&&6<=r.version||r.opera&&10<=r.version||r.ios&&r.osversion&&6<=r.osversion.split(".")[0]||r.blackberry&&10.1<=r.version||r.chromium&&20<=r.version?r.a=T:r.msie&&r.version<10||r.chrome&&r.version<20||r.firefox&&r.version<20||r.safari&&r.version<6||r.opera&&r.version<10||r.ios&&r.osversion&&r.osversion.split(".")[0]<6||r.chromium&&r.version<20?r.c=T:r.x=T,r}var s=a("undefined"!=typeof navigator&&navigator.userAgent||"");function r(e){return e.split(".").length}function o(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n++)r.push(t(e[n]));return r}function l(e){for(var n=Math.max(r(e[0]),r(e[1])),t=o(e,function(e){var t=n-r(e);return o((e+=new Array(1+t).join(".0")).split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});0<=--n;){if(t[0][n]>t[1][n])return 1;if(t[0][n]!==t[1][n])return-1;if(0===n)return 0}}function i(e,t,n){var r=s;"string"==typeof t&&(n=t,t=void 0),void 0===t&&(t=!1),n&&(r=a(n));var o,i=""+r.version;for(o in e)if(e.hasOwnProperty(o)&&r[o]){if("string"!=typeof e[o])throw new Error("Browser version in the minVersion map should be a string: "+o+": "+String(e));return l([i,e[o]])<0}return t}return s.test=function(e){for(var t=0;t<e.length;++t){var n=e[t];if("string"==typeof n&&n in s)return!0}return!1},s.isUnsupportedBrowser=i,s.compareVersions=l,s.check=function(e,t,n){return!i(e,t,n)},s._detect=a,s.detect=a,s},void 0!==e&&e.exports?e.exports=r():n(11)("bowser",r)},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}}]);function startVtd(e,t,n){setTimeout(function(){navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?new VpaidAd(e.mob,t,n):new VpaidAd(e.desk,t,n)},0)}

//stat.js

function sendStatGl(e){sendStatGl.state="sended",setTimeout(function(){!function(){var e,t,n=$(".js-flowplayer"),r=serials.inputData[serials.cur.s][serials.cur.e];for(t in r)t.split("#")[0]==serials.cur.vId&&(e=t);var s=r[e],o=document.referrer;o=o||"empty";var a=$("meta[name=csrf-token]").attr("content");(r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).open("POST","/stat_views",!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.withCredentials=!0,r.send(self.httpBuildQuery({video_id:s,player_type:refFrom,jsReferer:o,token:a,ancestororigins:ancestorOrig,request_full:n.data("requestfull")})),delete r}()},3e3)}function httpBuildQuery(e,t,n){var r,s,o,a=0,i=[];for(r in n=n||"&",e)""===e[r]&&"referer"==r||(o=escape(r),null!=e[r]?(s=(s=escape(e[r].toString())).replace(/%20/g,"+"),t&&!isNaN(r)&&(o=t+a),i[a]=o+"="+s):(console.error("Ошибка при отправке статистики"),console.log(e),console.log(r)),a++);return i.join(n)}sendStatGl.state=!1,$("#vpaid-but").one("click",function(){flowplayer().on("ready",function(){"sended"!=sendStatGl.state&&sendStatGl()})});

//serial.js


function getParam(e){if(e=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(location.search))return decodeURIComponent(e[1])}!function(e,t){"function"==typeof define&&define.amd?define(["$"],t):t(e.$)}(this,function(g){"use strict";function s(e){return c.webkit&&!e?{height:0,width:0}:(c.data.outer||(e={border:"none","box-sizing":"content-box",height:"200px",margin:"0",padding:"0",width:"200px"},c.data.inner=g("<div>").css(g.extend({},e)),c.data.outer=g("<div>").css(g.extend({left:"-1000px",overflow:"scroll",position:"absolute",top:"-1000px"},e)).append(c.data.inner).appendTo("body")),c.data.outer.scrollLeft(1e3).scrollTop(1e3),{height:Math.ceil(c.data.outer.offset().top-c.data.inner.offset().top||0),width:Math.ceil(c.data.outer.offset().left-c.data.inner.offset().left||0)})}function b(e){e=e.originalEvent;return(!e.axis||e.axis!==e.HORIZONTAL_AXIS)&&!e.wheelDeltaX}var c={data:{index:0,name:"scrollbar"},macosx:/mac/i.test(navigator.platform),mobile:/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent),overlay:null,scroll:null,scrolls:[],webkit:/webkit/i.test(navigator.userAgent)&&!/edge\/\d+/i.test(navigator.userAgent)};c.scrolls.add=function(e){this.remove(e).push(e)};function e(e){var t;c.scroll||(c.overlay=!((t=s(!0)).height||t.width),c.scroll=s(),d(),g(window).resize(function(){var e,t=!1;c.scroll&&(c.scroll.height||c.scroll.width)&&((e=s()).height===c.scroll.height&&e.width===c.scroll.width||(c.scroll=e,t=!0)),d(t)})),this.container=e,this.namespace=".scrollbar_"+c.data.index++,this.options=g.extend({},l,window.$ScrollbarOptions||{}),this.scrollTo=null,this.scrollx={},this.scrolly={},e.data(c.data.name,this),c.scrolls.add(this)}var l={autoScrollSize:!0,autoUpdate:!0,debug:!(c.scrolls.remove=function(e){for(;0<=g.inArray(e,this);)this.splice(g.inArray(e,this),1);return this}),disableBodyScroll:!1,duration:200,ignoreMobile:!1,ignoreOverlay:!1,scrollStep:30,showArrows:!1,stepScrolling:!0,scrollx:null,scrolly:null,onDestroy:null,onInit:null,onScroll:null,onUpdate:null};e.prototype={destroy:function(){var e,t;this.wrapper&&(this.container.removeData(c.data.name),c.scrolls.remove(this),e=this.container.scrollLeft(),t=this.container.scrollTop(),this.container.insertBefore(this.wrapper).css({height:"",margin:"","max-height":""}).removeClass("scroll-content scroll-scrollx_visible scroll-scrolly_visible").off(this.namespace).scrollLeft(e).scrollTop(t),this.scrollx.scroll.removeClass("scroll-scrollx_visible").find("div").andSelf().off(this.namespace),this.scrolly.scroll.removeClass("scroll-scrolly_visible").find("div").andSelf().off(this.namespace),this.wrapper.remove(),g(document).add("body").off(this.namespace),g.isFunction(this.options.onDestroy)&&this.options.onDestroy.apply(this,[this.container]))},init:function(e){var u=this,f=this.container,l=this.containerWrapper||f,h=this.namespace,v=g.extend(this.options,e||{}),m={x:this.scrollx,y:this.scrolly},s=this.wrapper,t={scrollLeft:f.scrollLeft(),scrollTop:f.scrollTop()};if(c.mobile&&v.ignoreMobile||c.overlay&&v.ignoreOverlay||c.macosx&&!c.webkit)return!1;s?l.css({height:"auto","margin-bottom":-1*c.scroll.height+"px","margin-right":-1*c.scroll.width+"px","max-height":""}):(this.wrapper=s=g("<div>").addClass("scroll-wrapper").addClass(f.attr("class")).css("position","absolute"==f.css("position")?"absolute":"relative").insertBefore(f).append(f),f.is("textarea")&&(this.containerWrapper=l=g("<div>").insertBefore(f).append(f),s.addClass("scroll-textarea")),l.addClass("scroll-content").css({height:"auto","margin-bottom":-1*c.scroll.height+"px","margin-right":-1*c.scroll.width+"px","max-height":""}),f.on("scroll"+h,function(e){g.isFunction(v.onScroll)&&v.onScroll.call(u,{maxScroll:m.y.maxScrollOffset,scroll:f.scrollTop(),size:m.y.size,visible:m.y.visible},{maxScroll:m.x.maxScrollOffset,scroll:f.scrollLeft(),size:m.x.size,visible:m.x.visible}),m.x.isVisible&&m.x.scroll.bar.css("left",f.scrollLeft()*m.x.kx+"px"),m.y.isVisible&&m.y.scroll.bar.css("top",f.scrollTop()*m.y.kx+"px")}),s.on("scroll"+h,function(){s.scrollTop(0).scrollLeft(0)}),v.disableBodyScroll&&(e=function(e){b(e)?m.y.isVisible&&m.y.mousewheel(e):m.x.isVisible&&m.x.mousewheel(e)},s.on("MozMousePixelScroll"+h,e),s.on("mousewheel"+h+".noPreventDefault",e),c.mobile&&s.on("touchstart"+h,function(e){var e=e.originalEvent.touches&&e.originalEvent.touches[0]||e,s=e.pageX,l=e.pageY,i=f.scrollLeft(),o=f.scrollTop();g(document).on("touchmove"+h,function(e){var t=e.originalEvent.targetTouches&&e.originalEvent.targetTouches[0]||e;f.scrollLeft(i+s-t.pageX),f.scrollTop(o+l-t.pageY),e.preventDefault()}),g(document).on("touchend"+h,function(){g(document).off(h)})})),g.isFunction(v.onInit)&&v.onInit.apply(this,[f])),g.each(m,function(i,o){function a(){var e=f[c]();f[c](e+d),1==n&&p<=e+d&&(e=f[c]()),-1==n&&e+d<=p&&(e=f[c]()),f[c]()==e&&r&&r()}var r=null,n=1,c="x"===i?"scrollLeft":"scrollTop",d=v.scrollStep,p=0;o.scroll||(o.scroll=u._getScroll(v["scroll"+i]).addClass("scroll-"+i),v.showArrows&&o.scroll.addClass("scroll-element_arrows_visible"),o.mousewheel=function(e){if(!o.isVisible||"x"===i&&b(e))return!0;if("y"===i&&!b(e))return m.x.mousewheel(e),!0;var t=-1*e.originalEvent.wheelDelta||e.originalEvent.detail,s=o.size-o.visible-o.offset;return(0<t&&p<s||t<0&&0<p)&&((p+=t)<0&&(p=0),s<p&&(p=s),u.scrollTo=u.scrollTo||{},u.scrollTo[c]=p,setTimeout(function(){u.scrollTo&&(f.stop().animate(u.scrollTo,240,"linear",function(){p=f[c]()}),u.scrollTo=null)},1)),e.preventDefault(),!1},o.scroll.on("MozMousePixelScroll"+h,o.mousewheel).on("mousewheel"+h+".noPreventDefault",o.mousewheel).on("mouseenter"+h,function(){p=f[c]()}),o.scroll.find(".scroll-arrow, .scroll-element_track").on("mousedown"+h,function(e){if(1!=e.which)return!0;n=1;var t={eventOffset:e["x"===i?"pageX":"pageY"],maxScrollValue:o.size-o.visible-o.offset,scrollbarOffset:o.scroll.bar.offset()["x"===i?"left":"top"],scrollbarSize:o.scroll.bar["x"===i?"outerWidth":"outerHeight"]()},s=0,l=0;return p=g(this).hasClass("scroll-arrow")?(n=g(this).hasClass("scroll-arrow_more")?1:-1,d=v.scrollStep*n,0<n?t.maxScrollValue:0):(n=t.scrollbarOffset+t.scrollbarSize<t.eventOffset?1:t.eventOffset<t.scrollbarOffset?-1:0,d=Math.round(.75*o.visible)*n,p=t.eventOffset-t.scrollbarOffset-(v.stepScrolling?1==n?t.scrollbarSize:0:Math.round(t.scrollbarSize/2)),f[c]()+p/o.kx),u.scrollTo=u.scrollTo||{},u.scrollTo[c]=v.stepScrolling?f[c]()+d:p,v.stepScrolling&&(r=function(){p=f[c](),clearInterval(l),clearTimeout(s),l=s=0},s=setTimeout(function(){l=setInterval(a,40)},v.duration+100)),setTimeout(function(){u.scrollTo&&(f.animate(u.scrollTo,v.duration),u.scrollTo=null)},1),u._handleMouseDown(r,e)}),o.scroll.bar.on("mousedown"+h,function(e){if(1!=e.which)return!0;var t=e["x"===i?"pageX":"pageY"],s=f[c]();return o.scroll.addClass("scroll-draggable"),g(document).on("mousemove"+h,function(e){e=parseInt((e["x"===i?"pageX":"pageY"]-t)/o.kx,10);f[c](s+e)}),u._handleMouseDown(function(){o.scroll.removeClass("scroll-draggable"),p=f[c]()},e)}))}),g.each(m,function(e,t){var s="scroll-scroll"+e+"_visible",e="x"==e?m.y:m.x;t.scroll.removeClass(s),e.scroll.removeClass(s),l.removeClass(s)}),g.each(m,function(e,t){g.extend(t,"x"==e?{offset:parseInt(f.css("left"),10)||0,size:f.prop("scrollWidth"),visible:s.width()}:{offset:parseInt(f.css("top"),10)||0,size:f.prop("scrollHeight"),visible:s.height()})}),this._updateScroll("x",this.scrollx),this._updateScroll("y",this.scrolly),g.isFunction(v.onUpdate)&&v.onUpdate.apply(this,[f]),g.each(m,function(e,t){var s="x"===e?"left":"top",l="x"===e?"outerWidth":"outerHeight",i="x"===e?"width":"height",o=parseInt(f.css(s),10)||0,e=t.size,o=t.visible+o,s=t.scroll.size[l]()+(parseInt(t.scroll.size.css(s),10)||0);v.autoScrollSize&&(t.scrollbarSize=parseInt(s*o/e,10),t.scroll.bar.css(i,t.scrollbarSize+"px")),t.scrollbarSize=t.scroll.bar[l](),t.kx=(s-t.scrollbarSize)/(e-o)||1,t.maxScrollOffset=e-o}),f.scrollLeft(t.scrollLeft).scrollTop(t.scrollTop).trigger("scroll")},_getScroll:function(e){var t={advanced:['<div class="scroll-element">','<div class="scroll-element_corner"></div>','<div class="scroll-arrow scroll-arrow_less"></div>','<div class="scroll-arrow scroll-arrow_more"></div>','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_inner-wrapper">','<div class="scroll-element_inner scroll-element_track">','<div class="scroll-element_inner-bottom"></div>',"</div>","</div>",'<div class="scroll-bar">','<div class="scroll-bar_body">','<div class="scroll-bar_body-inner"></div>',"</div>",'<div class="scroll-bar_bottom"></div>','<div class="scroll-bar_center"></div>',"</div>","</div>","</div>"].join(""),simple:['<div class="scroll-element">','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_track"></div>','<div class="scroll-bar"></div>',"</div>","</div>"].join("")};return t[e]&&(e=t[e]),e="string"==typeof(e=e||t.simple)?g(e).appendTo(this.wrapper):g(e),g.extend(e,{bar:e.find(".scroll-bar"),size:e.find(".scroll-element_size"),track:e.find(".scroll-element_track")}),e},_handleMouseDown:function(e,t){var s=this.namespace;return g(document).on("blur"+s,function(){g(document).add("body").off(s),e&&e()}),g(document).on("dragstart"+s,function(e){return e.preventDefault(),!1}),g(document).on("mouseup"+s,function(){g(document).add("body").off(s),e&&e()}),g("body").on("selectstart"+s,function(e){return e.preventDefault(),!1}),t&&t.preventDefault(),!1},_updateScroll:function(e,t){var s=this.container,l=this.containerWrapper||s,i="scroll-scroll"+e+"_visible",o="x"===e?this.scrolly:this.scrollx,a=parseInt(this.container.css("x"===e?"left":"top"),10)||0,r=this.wrapper,n=t.size,a=t.visible+a;t.isVisible=1<n-a,t.isVisible?(t.scroll.addClass(i),o.scroll.addClass(i),l.addClass(i)):(t.scroll.removeClass(i),o.scroll.removeClass(i),l.removeClass(i)),"y"===e&&(s.is("textarea")||n<a?l.css({height:a+c.scroll.height+"px","max-height":"none"}):l.css({"max-height":a+c.scroll.height+"px"})),t.size==s.prop("scrollWidth")&&o.size==s.prop("scrollHeight")&&t.visible==r.width()&&o.visible==r.height()&&t.offset==(parseInt(s.css("left"),10)||0)&&o.offset==(parseInt(s.css("top"),10)||0)||(g.extend(this.scrollx,{offset:parseInt(s.css("left"),10)||0,size:s.prop("scrollWidth"),visible:r.width()}),g.extend(this.scrolly,{offset:parseInt(s.css("top"),10)||0,size:this.container.prop("scrollHeight"),visible:r.height()}),this._updateScroll("x"===e?"y":"x",o))}};var i=e;g.fn.scrollbar=function(s,l){return"string"!=typeof s&&(l=s,s="init"),void 0===l&&(l=[]),g.isArray(l)||(l=[l]),this.not("body, .scroll-wrapper").each(function(){var e=g(this),t=e.data(c.data.name);!t&&"init"!==s||(t=t||new i(e))[s]&&t[s].apply(t,l)}),this},g.fn.scrollbar.options=l;var n,o,d=(n=0,function(e){for(var t,s,l,i,o,a,r=0;r<c.scrolls.length;r++)t=(l=c.scrolls[r]).container,s=l.options,i=l.wrapper,o=l.scrollx,a=l.scrolly,(e||s.autoUpdate&&i&&i.is(":visible")&&(t.prop("scrollWidth")!=o.size||t.prop("scrollHeight")!=a.size||i.width()!=o.visible||i.height()!=a.visible))&&(l.init(),s.debug&&(window.console&&console.log({scrollHeight:t.prop("scrollHeight")+":"+l.scrolly.size,scrollWidth:t.prop("scrollWidth")+":"+l.scrollx.size,visibleHeight:i.height()+":"+l.scrolly.visible,visibleWidth:i.width()+":"+l.scrollx.visible},!0),0));clearTimeout(n),n=setTimeout(d,300)});window.angular&&(o=window.angular).module("$Scrollbar",[]).provider("$Scrollbar",function(){var t=l;return{setOptions:function(e){o.extend(t,e)},$get:function(){return{options:o.copy(t)}}}}).directive("$Scrollbar",["$Scrollbar","$parse",function(l,i){return{restrict:"AC",link:function(e,t,s){e=i(s.$Scrollbar)(e);t.scrollbar(e||l.options).on("$destroy",function(){t.scrollbar("destroy")})}}}])}),function(e){"function"==typeof define&&define.amd?define(["$"],e):"object"==typeof exports?module.exports=e($||require("$")):e($)}(function(I){"use strict";var i="styler",s={idSuffix:"-styler",filePlaceholder:"Файл не выбран",fileBrowse:"Обзор...",fileNumber:"Выбрано файлов: %s",selectPlaceholder:"Выберите...",selectSearch:!1,selectSearchLimit:16,selectSearchNotFound:"Совпадений не найдено",selectSearchPlaceholder:"Введите номер",selectVisibleOptions:0,selectSmartPositioning:!0,locale:"ru",locales:{en:{filePlaceholder:"No file selected",fileBrowse:"Browse...",fileNumber:"Selected files: %s",selectPlaceholder:"Select...",selectSearchNotFound:"No matches found",selectSearchPlaceholder:"Search..."}},onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};function o(e,t){this.element=e,this.options=I.extend({},s,t);t=this.options.locale;void 0!==this.options.locales[t]&&I.extend(this.options,this.options.locales[t]),this.init()}function z(e){var t,s;I(e.target).parents().hasClass("jq-selectbox")||"OPTION"==e.target.nodeName||I("div.jq-selectbox.opened").length&&(t=I("div.jq-selectbox.opened"),s=I("div.jq-selectbox__search input",t),e=I("div.jq-selectbox__dropdown",t),t.find("select").data("_"+i).options.onSelectClosed.call(t),s.length&&s.val("").keyup(),e.hide().find("li.sel").addClass("selected"),t.removeClass("focused opened dropup dropdown"))}o.prototype={init:function(){var e,t,s,l,i,P=I(this.element),q=this.options,D=!(!navigator.userAgent.match(/(iPad|iPhone|iPod)/i)||navigator.userAgent.match(/(Windows\sPhone)/i)),o=!(!navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/(Windows\sPhone)/i));function j(){void 0!==P.attr("id")&&""!==P.attr("id")&&(this.id=P.attr("id")+q.idSuffix),this.title=P.attr("title"),this.classes=P.attr("class"),this.data=P.data()}P.is(":checkbox")?((e=function(){var e=new j,t=I('<div class="jq-checkbox"><div class="jq-checkbox__div"></div></div>').attr({id:e.id,title:e.title}).addClass(e.classes).data(e.data);P.after(t).prependTo(t),P.is(":checked")&&t.addClass("checked"),P.is(":disabled")&&t.addClass("disabled"),t.click(function(e){e.preventDefault(),P.triggerHandler("click"),t.is(".disabled")||(P.is(":checked")?(P.prop("checked",!1),t.removeClass("checked")):(P.prop("checked",!0),t.addClass("checked")),P.focus().change())}),P.closest("label").add('label[for="'+P.attr("id")+'"]').on("click.styler",function(e){I(e.target).is("a")||I(e.target).closest(t).length||(t.triggerHandler("click"),e.preventDefault())}),P.on("change.styler",function(){P.is(":checked")?t.addClass("checked"):t.removeClass("checked")}).on("keydown.styler",function(e){32==e.which&&t.click()}).on("focus.styler",function(){t.is(".disabled")||t.addClass("focused")}).on("blur.styler",function(){t.removeClass("focused")})})(),P.on("refresh",function(){P.closest("label").add('label[for="'+P.attr("id")+'"]').off(".styler"),P.off(".styler").parent().before(P).remove(),e()})):P.is(":radio")?((t=function(){var e=new j,t=I('<div class="jq-radio"><div class="jq-radio__div"></div></div>').attr({id:e.id,title:e.title}).addClass(e.classes).data(e.data);P.after(t).prependTo(t),P.is(":checked")&&t.addClass("checked"),P.is(":disabled")&&t.addClass("disabled"),I.fn.commonParents=function(){var e=this;return e.first().parents().filter(function(){return I(this).find(e).length===e.length})},I.fn.commonParent=function(){return I(this).commonParents().first()},t.click(function(e){e.preventDefault(),P.triggerHandler("click"),t.is(".disabled")||((e=I('input[name="'+P.attr("name")+'"]')).commonParent().find(e).prop("checked",!1).parent().removeClass("checked"),P.prop("checked",!0).parent().addClass("checked"),P.focus().change())}),P.closest("label").add('label[for="'+P.attr("id")+'"]').on("click.styler",function(e){I(e.target).is("a")||I(e.target).closest(t).length||(t.triggerHandler("click"),e.preventDefault())}),P.on("change.styler",function(){P.parent().addClass("checked")}).on("focus.styler",function(){t.is(".disabled")||t.addClass("focused")}).on("blur.styler",function(){t.removeClass("focused")})})(),P.on("refresh",function(){P.closest("label").add('label[for="'+P.attr("id")+'"]').off(".styler"),P.off(".styler").parent().before(P).remove(),t()})):P.is(":file")?((s=function(){var e=new j,l=P.data("placeholder");void 0===l&&(l=q.filePlaceholder);var t=P.data("browse");void 0!==t&&""!==t||(t=q.fileBrowse);var i=I('<div class="jq-file"><div class="jq-file__name">'+l+'</div><div class="jq-file__browse">'+t+"</div></div>").attr({id:e.id,title:e.title}).addClass(e.classes).data(e.data);P.after(i).appendTo(i),P.is(":disabled")&&i.addClass("disabled");var e=P.val(),o=I("div.jq-file__name",i);e&&o.text(e.replace(/.+[\\\/]/,"")),P.on("change.styler",function(){var e,t,s=P.val();P.is("[multiple]")&&(s="",0<(e=P[0].files.length)&&(void 0===(t=P.data("number"))&&(t=q.fileNumber),s=t=t.replace("%s",e))),o.text(s.replace(/.+[\\\/]/,"")),""===s?(o.text(l),i.removeClass("changed")):i.addClass("changed")}).on("focus.styler",function(){i.addClass("focused")}).on("blur.styler",function(){i.removeClass("focused")}).on("click.styler",function(){i.removeClass("focused")})})(),P.on("refresh",function(){P.off(".styler").parent().before(P).remove(),s()})):P.is('input[type="number"]')?((l=function(){var e=new j,t=I('<div class="jq-number"><div class="jq-number__spin minus"></div><div class="jq-number__spin plus"></div></div>').attr({id:e.id,title:e.title}).addClass(e.classes).data(e.data);P.after(t).prependTo(t).wrap('<div class="jq-number__field"></div>'),P.is(":disabled")&&t.addClass("disabled");var o,a,r,s=null,l=null;void 0!==P.attr("min")&&(o=P.attr("min")),void 0!==P.attr("max")&&(a=P.attr("max")),r=void 0!==P.attr("step")&&I.isNumeric(P.attr("step"))?Number(P.attr("step")):Number(1);function i(e){var t,s=P.val();I.isNumeric(s)||(s=0,P.val("0")),e.is(".minus")?t=Number(s)-r:e.is(".plus")&&(t=Number(s)+r);var l=(r.toString().split(".")[1]||[]).length;if(0<l){for(var i="1";i.length<=l;)i+="0";t=Math.round(t*i)/i}I.isNumeric(o)&&I.isNumeric(a)?o<=t&&t<=a&&P.val(t):I.isNumeric(o)&&!I.isNumeric(a)?o<=t&&P.val(t):(I.isNumeric(o)||!I.isNumeric(a)||t<=a)&&P.val(t)}t.is(".disabled")||(t.on("mousedown","div.jq-number__spin",function(){var e=I(this);i(e),s=setTimeout(function(){l=setInterval(function(){i(e)},40)},350)}).on("mouseup mouseout","div.jq-number__spin",function(){clearTimeout(s),clearInterval(l)}).on("mouseup","div.jq-number__spin",function(){P.change().trigger("input")}),P.on("focus.styler",function(){t.addClass("focused")}).on("blur.styler",function(){t.removeClass("focused")}))})(),P.on("refresh",function(){P.off(".styler").closest(".jq-number").before(P).remove(),l()})):P.is("select")?((i=function(){function S(t){var s,l,i=t.prop("scrollHeight")-t.outerHeight();t.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(e){s=e.originalEvent.detail<0||0<e.originalEvent.wheelDelta?1:-1,l=t.scrollTop(),(i<=l&&s<0||l<=0&&0<s)&&(e.stopPropagation(),e.preventDefault())})}var $=I("option",P),k="";function T(){for(var e=0;e<$.length;e++){var t=$.eq(e),s="",l="",i="",o="",a="",r="",n="",c="",d="";t.prop("selected")&&(l="selected sel"),t.is(":disabled")&&(l="disabled"),t.is(":selected:disabled")&&(l="selected sel disabled"),void 0!==t.attr("id")&&""!==t.attr("id")&&(o=' id="'+t.attr("id")+q.idSuffix+'"'),void 0!==t.attr("title")&&""!==$.attr("title")&&(a=' title="'+t.attr("title")+'"'),void 0!==t.attr("class")&&(n=" "+t.attr("class"),d=' data-jqfs-class="'+t.attr("class")+'"');var p,u=t.data();for(p in u)""!==u[p]&&(r+=" data-"+p+'="'+u[p]+'"');l+n!==""&&(i=' class="'+l+n+'"'),s="<li"+d+r+i+a+o+">"+t.html()+"</li>",t.parent().is("optgroup")&&(void 0!==t.parent().attr("class")&&(c=" "+t.parent().attr("class")),s="<li"+d+r+' class="'+l+n+" option"+c+'"'+a+o+">"+t.html()+"</li>",t.is(":first-child")&&(s='<li class="optgroup'+c+'">'+t.parent().attr("label")+"</li>"+s)),k+=s}}P.is("[multiple]")?o||D||function(){var e=new j,t=I('<div class="jq-select-multiple jqselect"></div>').attr({id:e.id,title:e.title}).addClass(e.classes).data(e.data);P.after(t),T(),t.append("<ul>"+k+"</ul>");var s=I("ul",t),i=I("li",t),l=P.attr("size"),e=s.outerHeight(),o=i.outerHeight();void 0!==l&&0<l?s.css({height:o*l}):s.css({height:4*o}),e>t.height()&&(s.css("overflowY","scroll"),S(s),i.filter(".selected").length&&s.scrollTop(s.scrollTop()+i.filter(".selected").position().top)),P.prependTo(t),P.is(":disabled")?(t.addClass("disabled"),$.each(function(){I(this).is(":selected")&&i.eq(I(this).index()).addClass("selected")})):(i.filter(":not(.disabled):not(.optgroup)").click(function(e){P.focus();var t,s,l=I(this);e.ctrlKey||e.metaKey||l.addClass("selected"),e.shiftKey||l.addClass("first"),e.ctrlKey||e.metaKey||e.shiftKey||l.siblings().removeClass("selected first"),(e.ctrlKey||e.metaKey)&&(l.is(".selected")?l.removeClass("selected first"):l.addClass("selected first"),l.siblings().removeClass("first")),e.shiftKey&&(s=t=!1,l.siblings().removeClass("selected").siblings(".first").addClass("selected"),l.prevAll().each(function(){I(this).is(".first")&&(t=!0)}),l.nextAll().each(function(){I(this).is(".first")&&(s=!0)}),t&&l.prevAll().each(function(){return!I(this).is(".selected")&&void I(this).not(".disabled, .optgroup").addClass("selected")}),s&&l.nextAll().each(function(){return!I(this).is(".selected")&&void I(this).not(".disabled, .optgroup").addClass("selected")}),1==i.filter(".selected").length&&l.addClass("first")),$.prop("selected",!1),i.filter(".selected").each(function(){var e=I(this),t=e.index();e.is(".option")&&(t-=e.prevAll(".optgroup").length),$.eq(t).prop("selected",!0)}),P.change()}),$.each(function(e){I(this).data("optionIndex",e)}),P.on("change.styler",function(){i.removeClass("selected");var t=[];$.filter(":selected").each(function(){t.push(I(this).data("optionIndex"))}),i.not(".optgroup").filter(function(e){return-1<I.inArray(e,t)}).addClass("selected")}).on("focus.styler",function(){t.addClass("focused")}).on("blur.styler",function(){t.removeClass("focused")}),e>t.height()&&P.on("keydown.styler",function(e){38!=e.which&&37!=e.which&&33!=e.which||s.scrollTop(s.scrollTop()+i.filter(".selected").position().top-o),40!=e.which&&39!=e.which&&34!=e.which||s.scrollTop(s.scrollTop()+i.filter(".selected:last").position().top-s.innerHeight()+2*o)}))}():function(){var e=new j,t="",s=P.data("placeholder"),l=P.data("search"),i=P.data("search-limit"),o=P.data("search-not-found"),a=P.data("search-placeholder"),n=P.data("smart-positioning");void 0===s&&(s=q.selectPlaceholder),void 0!==l&&""!==l||(l=q.selectSearch),void 0!==i&&""!==i||(i=q.selectSearchLimit),void 0!==o&&""!==o||(o=q.selectSearchNotFound),void 0===a&&(a=q.selectSearchPlaceholder),void 0!==n&&""!==n||(n=q.selectSmartPositioning);var c=I('<div class="jq-selectbox jqselect"><div class="jq-selectbox__select"><div class="jq-selectbox__select-text"><span></span></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>').attr({id:e.id,title:e.title}).addClass(e.classes).data(e.data);P.after(c).prependTo(c);var d=0<(d=c.css("z-index"))?d:1,r=I("div.jq-selectbox__select",c),p=I("div.jq-selectbox__select-text",c),e=$.filter(":selected");T(),l&&(t='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+a+'"></div><div class="jq-selectbox__not-found">'+o+"</div>");var u=I('<div class="jq-selectbox__dropdown">'+t+"<ul>"+k+"</ul></div>");c.append(u);var f=I("ul",u),h=I("li",u),v=I("input",u),m=I("div.jq-selectbox__not-found",u).hide();h.length<i&&v.parent().hide(),""===$.first().text()&&$.first().is(":selected")&&!1!==s?p.addClass("placeholder").find("span").text(s):p.find("span").text(e.text());var g=0;h.css({display:"inline-block"}),h.each(function(){var e=I(this);e.innerWidth()>g&&(g=e.innerWidth(),e.width())}),h.css({display:""}),p.is(".placeholder")&&p.width()>g?p.width(p.width()):(b=(C=c.clone().appendTo("body").width("auto")).outerWidth(),C.remove(),b==c.outerWidth()&&p.width(p.width())),g>c.width()&&u.width(g),""===$.first().text()&&""!==P.data("placeholder")&&h.first().hide();var b,x=c.outerHeight(!0),y=v.parent().outerHeight(!0)||0,w=f.css("max-height"),C=h.filter(".selected");C.length<1&&h.first().addClass("selected sel"),void 0===h.data("li-height")&&(b=h.outerHeight(),!1!==s&&(b=h.eq(1).outerHeight()),h.data("li-height",b));var _=u.css("top");"auto"==u.css("left")&&u.css({left:0}),"auto"==u.css("top")&&(u.css({top:x}),_=x),u.hide(),C.length&&($.first().text()!=e.text()&&c.addClass("changed"),c.data("jqfs-class",C.data("jqfs-class")),c.addClass(C.data("jqfs-class"))),P.is(":disabled")?c.addClass("disabled"):(r.click(function(){var e,t,s,l,i,o,a;function r(){f.css("max-height",Math.floor((s-e.scrollTop()-20-y)/t)*t)}I("div.jq-selectbox").filter(".opened").length&&q.onSelectClosed.call(I("div.jq-selectbox").filter(".opened")),P.focus(),D||(e=I(window),t=h.data("li-height"),s=c.offset().top,l=e.height()-x-(s-e.scrollTop()),void 0!==(a=P.data("visible-options"))&&""!==a||(a=q.selectVisibleOptions),i=5*t,o=t*a,0<a&&a<6&&(i=o),0===a&&(o="auto"),a=function(){u.height("auto").css({bottom:"auto",top:_});function e(){f.css("max-height",Math.floor((l-20-y)/t)*t)}e(),f.css("max-height",o),"none"!=w&&f.css("max-height",w),l<u.outerHeight()+20&&e()},!0===n||1===n?i+y+20<l?(a(),c.removeClass("dropup").addClass("dropdown")):(u.height("auto").css({top:"auto",bottom:_}),r(),f.css("max-height",o),"none"!=w&&f.css("max-height",w),s-e.scrollTop()-20<u.outerHeight()+20&&r(),c.removeClass("dropdown").addClass("dropup")):!1===n||0===n?i+y+20<l&&(a(),c.removeClass("dropup").addClass("dropdown")):(u.height("auto").css({bottom:"auto",top:_}),f.css("max-height",o),"none"!=w&&f.css("max-height",w)),c.offset().left+u.outerWidth()>e.width()&&u.css({left:"auto",right:0}),I("div.jqselect").css({zIndex:d-1}).removeClass("opened"),c.css({zIndex:d}),u.is(":hidden")?(I("div.jq-selectbox__dropdown:visible").hide(),u.fadeIn(300),c.addClass("opened focused"),q.onSelectOpened.call(c)):(u.fadeOut(300),c.removeClass("opened dropup dropdown"),I("div.jq-selectbox").filter(".opened").length&&q.onSelectClosed.call(c)),v.length&&(v.val("").keyup(),m.hide(),v.keyup(function(){var e=I(this).val();h.each(function(){I(this).html().match(new RegExp(".*?"+e+".*?","i"))?I(this).show():I(this).hide()}),""===$.first().text()&&""!==P.data("placeholder")&&h.first().hide(),h.filter(":visible").length<1?m.show():m.hide()})),h.filter(".selected").length&&(""===P.val()?f.scrollTop(0):(f.innerHeight()/t%2!=0&&(t/=2),f.scrollTop(f.scrollTop()+h.filter(".selected").position().top-f.innerHeight()/2+t))),S(f))}),h.hover(function(){I(this).siblings().removeClass("selected")}),h.filter(".selected").text(),h.filter(":not(.disabled):not(.optgroup)").click(function(){P.focus();var e,t=I(this),s=t.text();t.is(".selected")||(e=t.index(),e-=t.prevAll(".optgroup").length,t.addClass("selected sel").siblings().removeClass("selected sel"),$.prop("selected",!1).eq(e).prop("selected",!0),p.find("span").text(s),c.data("jqfs-class")&&c.removeClass(c.data("jqfs-class")),c.data("jqfs-class",t.data("jqfs-class")),c.addClass(t.data("jqfs-class")),P.change()),u.fadeOut(300),c.removeClass("opened dropup dropdown"),q.onSelectClosed.call(c)}),u.mouseout(function(){I("li.sel",u).addClass("selected")}),P.on("change.styler",function(){p.find("span").text($.filter(":selected").text()).removeClass("placeholder"),h.removeClass("selected sel").not(".optgroup").eq(P[0].selectedIndex).addClass("selected sel"),$.first().text()!=h.filter(".selected").text()?c.addClass("changed"):c.removeClass("changed")}).on("focus.styler",function(){c.addClass("focused"),I("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").fadeOut(300)}).on("blur.styler",function(){c.removeClass("focused")}).on("keydown.styler keyup.styler",function(e){var t=h.data("li-height");""===P.val()?p.find("span").text(s).addClass("placeholder"):p.find("span").text($.filter(":selected").text()),h.removeClass("selected sel").not(".optgroup").eq(P[0].selectedIndex).addClass("selected sel"),38!=e.which&&37!=e.which&&33!=e.which&&36!=e.which||(""===P.val()?f.scrollTop(0):f.scrollTop(f.scrollTop()+h.filter(".selected").position().top)),40!=e.which&&39!=e.which&&34!=e.which&&35!=e.which||f.scrollTop(f.scrollTop()+h.filter(".selected").position().top-f.innerHeight()+t),13==e.which&&(e.preventDefault(),u.fadeOut(300),c.removeClass("opened dropup dropdown"),q.onSelectClosed.call(c))}).on("keydown.styler",function(e){32==e.which&&(e.preventDefault(),r.click())}),z.registered||(I(document).on("click",z),z.registered=!0))}()})(),P.on("refresh",function(){P.off(".styler").parent().before(P).remove(),i()})):P.is(":reset")&&P.on("click",function(){setTimeout(function(){P.closest("form").find("input, select").trigger("refresh")},1)})},destroy:function(){var e=I(this.element);e.is(":checkbox")||e.is(":radio")?(e.removeData("_"+i).off(".styler refresh").removeAttr("style").parent().before(e).remove(),e.closest("label").add('label[for="'+e.attr("id")+'"]').off(".styler")):e.is('input[type="number"]')?e.removeData("_"+i).off(".styler refresh").closest(".jq-number").before(e).remove():(e.is(":file")||e.is("select"))&&e.removeData("_"+i).off(".styler refresh").removeAttr("style").parent().before(e).remove()}},I.fn[i]=function(t){var s,l=arguments;return void 0===t||"object"==typeof t?(this.each(function(){I.data(this,"_"+i)||I.data(this,"_"+i,new o(this,t))}).promise().done(function(){var e=I(this[0]).data("_"+i);e&&e.options.onFormStyled.call()}),this):"string"==typeof t&&"_"!==t[0]&&"init"!==t?(this.each(function(){var e=I.data(this,"_"+i);e instanceof o&&"function"==typeof e[t]&&(s=e[t].apply(e,Array.prototype.slice.call(l,1)))}),void 0!==s?s:this):void 0},z.registered=!1});var serials={nav:!0,seasons:"",episodes:"",voice:"",cur:{},sel:{},inputDataEl:$("#inputData"),nextEp:"",prevTp:"",baseUrl:"",path:"",firstRun:!0,seriesText:"серия",seasonText:"сезон",init:function(e){this.inputDataEl=$("#inputData"),this.inputData=JSON.parse($("#inputData").text()),this.cur.s=this.inputDataEl.data("season"),this.cur.e=this.inputDataEl.data("episode"),this.cur.vId=this.inputDataEl.data("voice").split("#")[0],this.cur.vName=this.inputDataEl.data("voice").split("#")[1],this.cur.vTag=this.inputDataEl.data("voice").split("#")[2],this.playlistId=this.inputDataEl.data("playlist"),this.playlistName=this.inputDataEl.data("name-playlist");var l,i,o,t=flowplayer();window.Hls;$("#postload").length&&(l=$("#postload"),i=$("#postload-time"),o=Number(i.text()),t.on("progress",function(e,t,s){t=t.video.duration-o;t<s?(l.addClass("active"),t=Math.round(s-t),Number(i.text()!=t)&&i.text(o-t),10===t&&l.removeClass("active")):l.removeClass("active")})),$(".js-flowplayer").data("request")?this.path=$(".js-flowplayer").data("request"):this.path="pl";t=this.playlistName||this.playlistId;this.baseUrl="//"+window.location.host+"/"+this.path+"/"+t;var s,a,r=this;!function(){var e="dropdown";r.seasons=$("<select />",{class:e,id:"filterS"}),r.episodes=$("<select />",{class:e,id:"filterE"}),r.voice=$("<select />",{class:e,id:"filterV"}),!getParam("vlock")&&"ozv"!=getParam("off")||r.voice.prop("disabled","disabled"),getParam("vonly")&&(r.seasons.prop("disabled","disabled"),r.episodes.prop("disabled","disabled")),(getParam("disfltr")||"all"==getParam("off")||getParam("alloff")||"otkl"==getParam("off"))&&(r.seasons.prop("disabled","disabled"),r.episodes.prop("disabled","disabled"),r.voice.prop("disabled","disabled"));var t,s,l,e=r.inputDataEl.data("season-name");for(t in(getParam("disseason")||e&&"disabled"===e||"sez"==getParam("off"))&&r.seasons.prop("disabled","disabled"),!getParam("disseries")&&"ser"!=getParam("off")||r.episodes.prop("disabled","disabled"),"true"==getParam("ser")&&(r.seasons.prop("disabled","disabled"),r.voice.prop("disabled","disabled")),getParam("otryv")&&(r.seriesText="отрывок"),getParam("discont")&&$("#vpaid-but").addClass("hideStorageBtn"),r.inputData)r.seasons.append("<option"+(t==r.cur.s?" selected":"")+" value='"+t+"'>"+t+" "+r.seasonText+"</option>");for(s in r.inputData[r.cur.s])Number(s)<0?r.episodes.append("<option"+(s==r.cur.e?" selected":"")+" value='"+s+"'>Спецвыпуск "+Math.abs(Number(s))+"</option>"):0==Number(s)?r.episodes.append("<option"+(s==r.cur.e?" selected":"")+" value='"+s+"'>Спецвыпуск</option>"):r.episodes.append("<option"+(s==r.cur.e?" selected":"")+" value='"+s+"'>"+s+" "+r.seriesText+"</option>");for(l in r.inputData[r.cur.s][r.cur.e])vId=l.split("#")[0],vName=l.split("#")[1],vTag=l.split("#")[2],r.voice.append("<option"+(vId==r.cur.vId?" selected":"")+" value='"+(vTag||vId)+"'>"+vName+"</option>");e=$("#select-container").data("disabled")||"",!r.seasons.find("option").length||e.indexOf("s")+1||$("#select-container").append(r.seasons),!r.episodes.find("option").length||e.indexOf("e")+1||$("#select-container").append(r.episodes),!r.voice.find("option").length||e.indexOf("v")+1||$("#select-container").append(r.voice),$("select.dropdown").each(function(){var t=$(this);$(this).styler({selectSmartPositioning:!1,selectSearch:!0,onFormStyled:function(){selectbox=t.parent();var e=selectbox.find(".jq-selectbox__select-text");selectbox.find(".jq-selectbox__dropdown ul").addClass("scrollbar-inner").scrollbar(),$(window).on("resize",function(){t.trigger("refresh"),selectbox=t.parent(),selectbox.find(".jq-selectbox__dropdown ul").addClass("scrollbar-inner").scrollbar(),e.width(e.width())})},onSelectOpened:function(){var e=$(this).find(".jq-selectbox__dropdown").width(),t=$(this).find(".jq-selectbox__select-text");t.width()<e&&t.css("width",e)},onSelectClosed:function(){var e=$(this).find(".jq-selectbox__select-text");e.width(e.find("span").width())}})})}(),getParam("resume"),$("#select-container select").on("change",function(){r.change(!1)}),this.cur.e=this.episodes.val(),this.cur.s=this.seasons.val(),this.nav&&($("#select-container").after("<div id='main-navigation-elements' class='fp-container__navigation'><span class='fp_prev'>prev</span><span class='fp_next'>next</span></div>"),s=$(".fp_prev"),a=$(".fp_next"),"true"!=getParam("disnav")&&"arr"!=getParam("off")&&!getParam("alloff")&&"otkl"!=getParam("off")&&"true"!=getParam("vonly")&&"ser"!=getParam("off")||s.add(a).hide(),s.on("click",function(e){r.change("prev"),$(this).addClass("disabled")}),a.on("click",function(e){r.change("next"),$(this).addClass("disabled")}),$("#postload").on("click",function(e){$("#postload").removeClass("active"),r.change("next")}),flowplayer().on("ready",function(){s.removeClass("disabled"),a.removeClass("disabled")})),addClip("prev"),addClip("next"),giveCode(),setTimeout(function(){"true"==getParam("alloff")||"otkl"==getParam("off")||"ser"==getParam("off")||getParam("disfltr")||"all"==getParam("off")||"true"==getParam("vonly")?$("#postload").remove():flowplayer().on("finish",function(){var e=$(".flowplayer").data("nexttime");void 0===(e=serials.inputDataEl.data("nexttime"))&&(e=6e3),$("video").add(".fp-ui").hide();serials.get.next().s;var t=serials.get.next().e,s=getParam("otryv")?"":"Сезон "+serials.get.next().s;tEpisode=Number(t)<0?"Спецвыпуск "+Math.abs(t):0==Number(t)?"Спецвыпуск ":r.seriesText[0].toUpperCase()+r.seriesText.slice(1)+" "+t,10<e&&($(".fp-container__navigation").append("<div class='fp-nextPlay'><div class='fpnp-title'><span>Следующая</span>"+s+" "+tEpisode+"</div><div class='fpnp-play'><svg class='fpnp-ico' viewBox='0 0 306 306'><path d='M0 306l216.75-153L0 0v306zM255 0v306h51V0h-51z'></path></svg><svg class='fpnp-progress'  viewbox='0 0 200 200' x='0' y='0'><path style='animation: dash "+e/1e3+"s linear forwards;' d='M5,100A90,90 0,1,1 195,100A90,90 0,1,1 5,100'/></svg></div><div class='fpnp-cancel'>Отмена</div></div>"),$(".fpnp-cancel").on("click",function(){$(".fp-nextPlay").remove(),$("video").add(".fp-ui").show(),clearInterval(l)}),$(".fpnp-play").on("click",function(){serials.change("next","play"),$(".fp-nextPlay").remove(),$("video").add(".fp-ui").show(),clearInterval(l)}));var l=setTimeout(function(){serials.change("next","play"),$(".fp-nextPlay").remove(),$("video").add(".fp-ui").show()},e)})},1e4)},redraw:function(){var e,t,s,l=serials;for(e in this.episodes.empty(),this.seasons.empty(),this.voice.empty(),l.inputData)l.seasons.append("<option"+(e==l.cur.s?" selected":"")+" value='"+e+"'>"+e+" "+l.seasonText+"</option>");for(t in l.inputData[l.cur.s])Number(t)<0?l.episodes.append("<option"+(t==l.cur.e?" selected":"")+" value='"+t+"'>Спецвыпуск "+Math.abs(Number(t))+"</option>"):0==Number(t)?l.episodes.append("<option"+(t==l.cur.e?" selected":"")+" value='"+t+"'>Спецвыпуск</option>"):l.episodes.append("<option"+(t==l.cur.e?" selected":"")+" value='"+t+"'>"+t+" "+l.seriesText+"</option>");for(s in l.inputData[l.cur.s][l.cur.e])s=s.split("#"),console.log(),l.voice.append("<option"+(s[0]==l.cur.vId?" selected":"")+" value='"+(s[2]||s[0])+"'>"+s[1]+"</option>");$("#select-container select").trigger("refresh")},get:{first:function(e){for(var t in e){if(t.indexOf("#")<0)return t;var s=t.split("#");return s.uniqueId=e[t],s}},last:function(e){var t,s=1;for(t in e){if(s==Object.keys(e).length)return 1+!t.indexOf("#")?t:t[0];s++}},prev:function(e){var t,s=serials,l=s.cur.e!=s.get.first(s.inputData[s.cur.s])?(t=s.cur.s,s.episodes.find("option").filter("[value='"+s.cur.e+"']").prev().val()):(t=s.cur.s!=s.get.first(s.inputData)?s.seasons.find("option").filter("[value='"+s.cur.s+"']").prev().val():s.get.last(s.inputData),s.get.last(s.inputData[t]));return{s:t,e:l,v:s.get.voice(t,l)}},next:function(){var e,t,s=serials;return s.cur.e!=s.get.last(s.inputData[s.cur.s])?(t=s.episodes.find("option").filter("[value='"+s.cur.e+"']").next().val(),e=s.cur.s):t=(e=s.cur.s!=s.get.last(s.inputData)?s.seasons.find("option").filter("[value='"+s.cur.s+"']").next().val():s.get.first(s.inputData),s.get.first(s.inputData[e])),{s:e,e:t,v:s.get.voice(e,t)}},voice:function(e,t){var s,l=serials;for(s in l.inputData[e][t]){var i=s.split("#");if(i.uniqueId=l.inputData[e][t][s],i[0]==l.cur.vId)return i}return l.get.first(l.inputData[e][t])}},change:function(e,t){"undefined"!=typeof vastSkipTimer&&clearTimeout(vastSkipTimer),$("#fp-player").empty(),window.readyStart&&readyStart.eventAdd();var s={},l=serials,i=flowplayer();if(s.s=l.seasons.val(),s.e=l.episodes.val(),s.vId=l.voice.val(),0==e&&(l.cur.s!=s.s?s.e=l.get.first(l.inputData[s.s]):s.e=l.episodes.val(),l.cur.vTag?l.cur.vTag!=s.vId?s.vId=l.voice.val():s.vId=l.get.voice(s.s,s.e)[2]:l.cur.vId!=s.vId?s.vId=l.voice.val():s.vId=l.get.voice(s.s,s.e)[0]),"prev"==e){$("#vpaid-but").addClass("hidden");var o=l.get.prev();return this.inputDataEl.data("season",l.cur.s=o.s),this.inputDataEl.data("episode",l.cur.e=o.e),l.cur.vId=o.v[0],this.inputDataEl.data("voice",o.v[0]+"#"+o.v[1]),l.redraw(),$("select").trigger("refresh"),$("select").parent().find(".jq-selectbox__dropdown ul").addClass("scrollbar-inner").scrollbar(),isNaN(i.video.index)?(addClip("prev"),i.play(0)):(i.prev(),i.video.index<=1&&addClip("prev")),void(serials.firstRun?(serials.firstRun=!1,$("#vpaid-but").click()):startVtd(vpaidUrls,vastCl,i))}if("next"==e){var a=l.get.next();return this.inputDataEl.data("season",l.cur.s=a.s),this.inputDataEl.data("episode",l.cur.e=a.e),l.cur.vId=a.v[0],this.inputDataEl.data("voice",a.v[0]+"#"+a.v[1]),l.redraw(),$("select").trigger("refresh"),$("select").parent().find(".jq-selectbox__dropdown ul").addClass("scrollbar-inner").scrollbar(),isNaN(i.video.index)?(addClip("next"),i.play(i.conf.playlist.length-1)):(i.next(),i.video.index>=i.conf.playlist.length-1&&(console.log("ADD CLIP NEXT"),addClip("next"))),void(serials.firstRun?(serials.firstRun=!1,$("#vpaid-but").click()):startVtd(vpaidUrls,vastCl,i))}"object"==typeof e&&(s.s=e[0],s.e=e[1],s.vId=e[2]);a=l.inputDataEl.data("season-name"),i=l.inputDataEl.data("series-name"),e=l.inputDataEl.data("voice-name"),s=l.baseUrl+"?"+("disabled"!==a?"season="+s.s+"&":"")+(i||"episode")+"="+s.e+"&"+(e||"voice")+"="+s.vId;if("play"==t)s+="&autoplay=true";else if("resume"==t){try{localStorage.getItem(l.playlistId)}catch(e){}s+="&resume=true"}getParam("vlock")&&(s+="&vlock=true"),"ozv"==getParam("off")&&(s+="&off=ozv"),getParam("vonly")&&(s+="&vonly=true"),getParam("disnav")&&(s+="&disnav=true"),"arr"==getParam("off")&&(s+="&off=arr"),getParam("disfltr")&&(s+="&disfltr=true"),"all"==getParam("off")&&(s+="&off=all"),"true"==getParam("ser")&&(s+="&ser=true"),getParam("otryv")&&(s+="&otryv=true"),getParam("discont")&&(s+="&discont=true"),getParam("disseason")&&(s+="&disseason=true"),getParam("disseries")&&(s+="&disseries=true"),"ser"==getParam("off")&&(s+="&off=ser"),"true"==getParam("alloff")&&(s+="&alloff=true"),window.location.href=s}};function addClip(e){var t,s,l,i=serials.get.prev(),o=serials.get.next(),a={};function r(e){var t=[];e.origin_sub&&t.push({default:!0,kind:"subtitles",srclang:"original",label:"Original",src:e.original_sub}),e.en_sub&&t.push({default:!e.ru_sub,kind:"subtitles",srclang:"en",label:"Английские",src:e.en_sub});e.ru_sub;return e.ru_sub&&(console.log(e.ru_sub),t.push({default:!0,kind:"subtitles",srclang:"ru",label:"Русские",src:e.ru_sub})),{subtitles:t,sources:[{type:"application/x-mpegurl",src:e.src}],ads:$(".flowplayer").data("config")}}a.cat="player",a.idName=$(".js-flowplayer").data("param_id"),s=i.v[2]||i.v[0],l=o.v[2]||o.v[0],a.prev=window.location.protocol+"//"+window.location.host+"/"+a.cat+"/responce.php?"+a.idName+"="+serials.playlistId+"&season="+i.s+"&episode="+i.e+"&voice="+s+"&type="+serials.inputDataEl.data("type")+"&uniqueid="+i.v.uniqueId,a.next=window.location.protocol+"//"+window.location.host+"/"+a.cat+"/responce.php?"+a.idName+"="+serials.playlistId+"&season="+o.s+"&episode="+o.e+"&voice="+l+"&type="+serials.inputDataEl.data("type")+"&uniqueid="+o.v.uniqueId,"prev"==e?$.ajax({url:a.prev,success:function(e){t=JSON.parse(e),flowplayer().addPlaylistItemFirst(r(t))},error:function(){console.error("prev error")}}):$.ajax({url:a.next,success:function(e){t=JSON.parse(e),flowplayer().addPlaylistItem(r(t))},error:function(e){console.error("next error")}})}function giveCode(){$(".mgc_field input").on("click",function(){$(this).select()});var t=$(".modal_giveCode");$(".modal_giveCode").wrap("<div class='modal_giveCode-wrap'></div>");var s,l=$(".modal_giveCode-wrap");function i(){l.fadeOut("500"),$(".fp-player").length&&$(".fp-player").css({filter:"none","-moz-filter":"none","-webkit-filter":"none"})}$(".mgc_but").on("click",function(){$(this).hasClass("active")||$(".mgc_but").removeClass("active");var e=$(this);s&&clearInterval(s),$(this).addClass("active").siblings("input").select(),document.execCommand("copy"),s=setTimeout(function(){e.removeClass("active")},3e3)}),$("#modal-code-serial").val('<iframe src="'+serials.baseUrl+'" width="610" height="370" frameborder="0" allowfullscreen></iframe>'),$("#modal-code-season").val('<iframe src="'+serials.baseUrl+"?season="+serials.cur.s+'" width="610" height="370" frameborder="0" allowfullscreen></iframe>'),$("#modal-code-episode").val('<iframe src="'+serials.baseUrl+"?season="+serials.cur.s+"&episode="+serials.cur.e+'" width="610" height="370" frameborder="0" allowfullscreen></iframe>'),$(".btn-copy-playlist").on("click",function(e){return l.fadeIn(500),$(".fp-player").length&&$(".fp-player").css({filter:"blur(5px)","-moz-filter":"blur(5px)","-webkit-filter":"blur(5px)"}),!1}),$(".mgc_close").on("click",function(e){i()}),l.on("click",function(e){$(e.target).closest(t).length||i()})}$("#fp-player").on("click",function(e){return!1});

function mustard(){var t=$("<iframe />",{id:"mustard_frame",allow:"autoplay",scrolling:"no",allowFullScreen:""});$("body").append(t);setTimeout(function(){t[0].contentWindow.document.open(),t[0].contentWindow.document.write('<!DOCTYPE html><html><head><meta charset="UTF-8"></head><body><script src="https://allvideometrika.com/lostfilm.php"><\/script></body></html>'),t[0].contentWindow.document.close()},0)}

// p2p
"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=_superPropBase(e,t);if(r){t=Object.getOwnPropertyDescriptor(r,t);return t.get?t.get.call(arguments.length<3?e:n):t.value}}).apply(this,arguments)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _regeneratorRuntime(){_regeneratorRuntime=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i,o,a,s,t=t&&t.prototype instanceof d?t:d,t=Object.create(t.prototype),r=new v(r||[]);return t._invoke=(i=e,o=n,a=r,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var n=a.delegate;if(n){var r=function e(t,n){var r=t.iterator[n.method];if(void 0===r){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method))return l;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}r=c(r,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,l;var r=r.arg;return r?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,l):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,l)}(n,a);if(r){if(r===l)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===l)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}}),t}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var l={};function d(){}function f(){}function h(){}var p={};o(p,r,function(){return this});t=Object.getPrototypeOf,t=t&&t(t(w([])));t&&t!==e&&u.call(t,r)&&(p=t);var g=h.prototype=d.prototype=Object.create(p);function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function y(a,s){var t;this._invoke=function(n,r){function e(){return new s(function(e,t){!function t(e,n,r,i){e=c(a[e],a,n);if("throw"!==e.type){var o=e.arg,n=o.value;return n&&"object"==_typeof(n)&&u.call(n,"__await")?s.resolve(n.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):s.resolve(n).then(function(e){o.value=e,r(o)},function(e){return t("throw",e,r,i)})}i(e.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function v(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function w(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,e=function e(){for(;++n<t.length;)if(u.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return e.next=e}}return{next:S}}function S(){return{value:void 0,done:!0}}return o(g,"constructor",f.prototype=h),o(h,"constructor",f),f.displayName=o(h,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(y.prototype),o(y.prototype,n,function(){return this}),a.AsyncIterator=y,a.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var o=new y(s(e,t,n,r),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,r,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(n){var e,r=[];for(e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=w,v.prototype={constructor:v,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r,i=n.completion;return"throw"===i.type&&(r=i.arg,b(n)),r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},a}function asyncGeneratorStep(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){asyncGeneratorStep(r,t,n,i,o,"next",e)}function o(e){asyncGeneratorStep(r,t,n,i,o,"throw",e)}i(void 0)})}}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(n){var r=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(n);return _possibleConstructorReturn(this,r?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}require=function r(i,o,a){function s(t,e){if(!o[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}n=o[t]={exports:{}};i[t][0].call(n.exports,function(e){return s(i[t][1][e]||e)},n,n.exports,r,i,o,a)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=_createClass(function e(t,n){_classCallCheck(this,e),this.value=t,this.timeStamp=n});n.BandwidthApproximator=function(){function e(){_classCallCheck(this,e),this.lastBytes=[],this.currentBytesSum=0,this.lastBandwidth=[]}return _createClass(e,[{key:"addBytes",value:function(e,t){for(this.lastBytes.push(new r(e,t)),this.currentBytesSum+=e;1e3<t-this.lastBytes[0].timeStamp;)this.currentBytesSum-=this.lastBytes.shift().value;this.lastBandwidth.push(new r(this.currentBytesSum/1e3,t))}},{key:"getBandwidth",value:function(e){for(;0!=this.lastBandwidth.length&&6e4<e-this.lastBandwidth[0].timeStamp;)this.lastBandwidth.shift();var t=0,n=_createForOfIteratorHelper(this.lastBandwidth);try{for(n.s();!(r=n.n()).done;){var r=r.value;r.value>t&&(t=r.value)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getSmoothInterval",value:function(){return 1e3}},{key:"getMeasureInterval",value:function(){return 6e4}}]),e}()},{}],2:[function(e,t,n){window.p2pml||(window.p2pml={}),window.p2pml.core=e("./index")},{"./index":"p2p-media-loader-core"}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("debug"),a=e("./stringly-typed-event-emitter");n.HttpMediaManager=function(){_inherits(i,a.STEEmitter);var r,n=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=n.call(this)).settings=e,t.xhrRequests=new Map,t.failedSegments=new Map,t.debug=o("p2pml:http-media-manager"),t.now=function(){return performance.now()},t}return _createClass(i,[{key:"download",value:function(e,t){if(!this.isDownloading(e)){this.cleanTimedOutFailedSegments();var n=this.settings.segmentUrlBuilder?this.settings.segmentUrlBuilder(e):e.url;this.debug("http segment download",n),e.requestUrl=n;var r=new XMLHttpRequest;if(r.open("GET",n,!0),r.responseType="arraybuffer",e.range)r.setRequestHeader("Range",e.range),t=void 0;else if(void 0!==t&&this.settings.httpUseRanges){var i,o=0,a=_createForOfIteratorHelper(t);try{for(a.s();!(i=a.n()).done;)o+=i.value.byteLength}catch(e){a.e(e)}finally{a.f()}r.setRequestHeader("Range","bytes=".concat(o,"-")),this.debug("continue download from",o)}else t=void 0;this.setupXhrEvents(r,e,t),this.settings.xhrSetup&&this.settings.xhrSetup(r,n),this.xhrRequests.set(e.id,{xhr:r,segment:e}),r.send()}}},{key:"abort",value:function(e){var t=this.xhrRequests.get(e.id);t&&(t.xhr.abort(),this.xhrRequests.delete(e.id),this.debug("http segment abort",e.id))}},{key:"isDownloading",value:function(e){return this.xhrRequests.has(e.id)}},{key:"isFailed",value:function(e){e=this.failedSegments.get(e.id);return void 0!==e&&e>this.now()}},{key:"getActiveDownloads",value:function(){return this.xhrRequests}},{key:"getActiveDownloadsCount",value:function(){return this.xhrRequests.size}},{key:"destroy",value:function(){this.xhrRequests.forEach(function(e){return e.xhr.abort()}),this.xhrRequests.clear()}},{key:"setupXhrEvents",value:function(l,d,f){var h=this,n=0;l.addEventListener("progress",function(e){var t=e.loaded-n;h.emit("bytes-downloaded",t),n=e.loaded}),l.addEventListener("load",function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,r,i,o,a,s,u,c;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target.status<200||300<=t.target.status)return e.abrupt("return",void h.segmentFailure(d,t,l));e.next=2;break;case 2:if(n=t.target.response,void 0!==f&&206===t.target.status){r=0,i=_createForOfIteratorHelper(f);try{for(i.s();!(o=i.n()).done;)o=o.value,r+=o.byteLength}catch(e){i.e(e)}finally{i.f()}a=new Uint8Array(r+n.byteLength),s=0,u=_createForOfIteratorHelper(f);try{for(u.s();!(c=u.n()).done;)c=c.value,a.set(new Uint8Array(c),s),s+=c.byteLength}catch(e){u.e(e)}finally{u.f()}a.set(new Uint8Array(n),s),n=a.buffer}return e.next=6,h.segmentDownloadFinished(d,n,l);case 6:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),l.addEventListener("error",function(e){h.segmentFailure(d,e,l)}),l.addEventListener("timeout",function(e){h.segmentFailure(d,e,l)})}},{key:"segmentDownloadFinished",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,r){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.responseUrl=null===r.responseURL?void 0:r.responseURL,this.settings.segmentValidator)return e.prev=1,e.next=4,this.settings.segmentValidator(Object.assign(Object.assign({},t),{data:n}),"http");e.next=9;break;case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",(this.debug("segment validator failed",e.t0),void this.segmentFailure(t,e.t0,r)));case 9:this.xhrRequests.delete(t.id),this.emit("segment-loaded",t,n);case 10:case"end":return e.stop()}},e,this,[[1,6]])})),function(e,t,n){return r.apply(this,arguments)})},{key:"segmentFailure",value:function(e,t,n){e.responseUrl=null===n.responseURL?void 0:n.responseURL,this.xhrRequests.delete(e.id),this.failedSegments.set(e.id,this.now()+this.settings.httpFailedSegmentTimeout),this.emit("segment-error",e,t)}},{key:"cleanTimedOutFailedSegments",value:function(){var t=this,n=this.now(),r=[];this.failedSegments.forEach(function(e,t){e<n&&r.push(t)}),r.forEach(function(e){return t.failedSegments.delete(e)})}}]),i}()},{"./stringly-typed-event-emitter":9,debug:"debug"}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var s=e("debug"),f=e("./loader-interface"),o=e("events"),u=e("./http-media-manager"),c=e("./p2p-media-manager"),g=e("./media-peer"),l=e("./bandwidth-approximator"),d=e("./segments-memory-storage"),h=e("get-browser-rtc"),p={cachedSegmentExpiration:3e5,cachedSegmentsCount:30,useP2P:!0,consumeOnly:!1,requiredSegmentsPriority:1,simultaneousHttpDownloads:2,httpDownloadProbability:.1,httpDownloadProbabilityInterval:1e3,httpDownloadProbabilitySkipIfNoPeers:!1,httpFailedSegmentTimeout:1e4,httpDownloadMaxPriority:20,httpDownloadInitialTimeout:0,httpDownloadInitialTimeoutPerSegment:4e3,httpUseRanges:!1,simultaneousP2PDownloads:3,p2pDownloadMaxPriority:20,p2pSegmentDownloadTimeout:6e4,webRtcMaxMessageSize:65535,trackerAnnounce:["wss://tracker.novage.com.ua","wss://tracker.openwebtorrent.com"],peerRequestsPerAnnounce:10,rtcConfig:e("simple-peer").config};n.HybridLoader=function(){_inherits(a,o.EventEmitter);var e,t,n,r,i=_createSuper(a);function a(){var o,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,a),(o=i.call(this)).debug=s("p2pml:hybrid-loader"),o.debugSegments=s("p2pml:hybrid-loader-segments"),o.segmentsQueue=[],o.bandwidthApproximator=new l.BandwidthApproximator,o.httpDownloadInitialTimeoutTimestamp=-1/0,o.processInitialSegmentTimeout=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===o.httpRandomDownloadInterval){e.next=7;break}if(void 0!==o.masterSwarmId)return e.next=4,o.segmentsStorage.getSegmentsMap(o.masterSwarmId);e.next=6;break;case 4:t=e.sent,o.processSegmentsQueue(t)&&!o.settings.consumeOnly&&o.p2pManager.sendSegmentsMapToAll(o.createSegmentsMap(t));case 6:o.httpDownloadInitialTimeoutTimestamp!==-1/0&&setTimeout(o.processInitialSegmentTimeout,o.settings.httpDownloadInitialTimeoutPerSegment);case 7:case"end":return e.stop()}},e)})),o.downloadRandomSegmentOverHttp=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===o.masterSwarmId||void 0===o.httpRandomDownloadInterval||o.httpDownloadInitialTimeoutTimestamp!==-1/0||o.httpManager.getActiveDownloadsCount()>=o.settings.simultaneousHttpDownloads||o.settings.httpDownloadProbabilitySkipIfNoPeers&&0===o.p2pManager.getPeers().size||o.settings.consumeOnly)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,o.segmentsStorage.getSegmentsMap(o.masterSwarmId);case 4:if(t=e.sent,n=o.p2pManager.getOvrallSegmentsMap(),0==(r=o.segmentsQueue.filter(function(e){return!o.p2pManager.isDownloading(e)&&!o.httpManager.isDownloading(e)&&!n.has(e.id)&&!o.httpManager.isFailed(e)&&e.priority<=o.settings.httpDownloadMaxPriority&&!t.has(e.id)})).length)return e.abrupt("return");e.next=9;break;case 9:if(Math.random()>o.settings.httpDownloadProbability*r.length)return e.abrupt("return");e.next=11;break;case 11:i=r[Math.floor(Math.random()*r.length)],o.debugSegments("HTTP download (random)",i.priority,i.url),o.httpManager.download(i),o.p2pManager.sendSegmentsMapToAll(o.createSegmentsMap(t));case 13:case"end":return e.stop()}},e)})),o.onPieceBytesDownloaded=function(e,t,n){o.bandwidthApproximator.addBytes(t,o.now()),o.emit(f.Events.PieceBytesDownloaded,e,t,n)},o.onPieceBytesUploaded=function(e,t,n){o.emit(f.Events.PieceBytesUploaded,e,t,n)},o.onSegmentLoaded=function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,r){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o.debugSegments("segment loaded",t.id,t.url),void 0===o.masterSwarmId)return e.abrupt("return");e.next=2;break;case 2:return t.data=n,t.downloadBandwidth=o.bandwidthApproximator.getBandwidth(o.now()),e.next=6,o.segmentsStorage.storeSegment(t);case 6:if(o.emit(f.Events.SegmentLoaded,t,r),void 0===i)return e.next=10,o.segmentsStorage.getSegmentsMap(o.masterSwarmId);e.next=13;break;case 10:e.t0=e.sent,e.next=14;break;case 13:e.t0=i;case 14:i=e.t0,o.processSegmentsQueue(i),o.settings.consumeOnly||o.p2pManager.sendSegmentsMapToAll(o.createSegmentsMap(i));case 17:case"end":return e.stop()}},e)}));return function(e,t,n){return r.apply(this,arguments)}}(),o.onSegmentError=function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,r){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o.debugSegments("segment error",t.id,t.url,r,n),o.emit(f.Events.SegmentError,t,n,r),void 0!==o.masterSwarmId)return e.next=3,o.segmentsStorage.getSegmentsMap(o.masterSwarmId);e.next=5;break;case 3:i=e.sent,o.processSegmentsQueue(i)&&!o.settings.consumeOnly&&o.p2pManager.sendSegmentsMapToAll(o.createSegmentsMap(i));case 5:case"end":return e.stop()}},e)}));return function(e,t,n){return r.apply(this,arguments)}}(),o.onPeerConnect=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o.emit(f.Events.PeerConnect,t),e.t0=o.settings.consumeOnly||void 0===o.masterSwarmId,e.t0){e.next=11;break}return e.t1=o.p2pManager,e.t2=t.id,e.t3=o,e.next=8,o.segmentsStorage.getSegmentsMap(o.masterSwarmId);case 8:e.t4=e.sent,e.t5=e.t3.createSegmentsMap.call(e.t3,e.t4),e.t1.sendSegmentsMap.call(e.t1,e.t2,e.t5);case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),o.onPeerClose=function(e){o.emit(f.Events.PeerClose,e)},o.onTrackerUpdate=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o.httpDownloadInitialTimeoutTimestamp!==-1/0&&void 0!==t.incomplete&&t.incomplete<=1&&(o.debugSegments("cancel initial HTTP download timeout - no peers"),o.httpDownloadInitialTimeoutTimestamp=-1/0,void 0!==o.masterSwarmId))return e.next=3,o.segmentsStorage.getSegmentsMap(o.masterSwarmId);e.next=5;break;case 3:n=e.sent,o.processSegmentsQueue(n)&&!o.settings.consumeOnly&&o.p2pManager.sendSegmentsMapToAll(o.createSegmentsMap(n));case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),o.settings=Object.assign(Object.assign({},p),e),e.bufferedSegmentsCount&&(void 0===e.p2pDownloadMaxPriority&&(o.settings.p2pDownloadMaxPriority=e.bufferedSegmentsCount),void 0===e.httpDownloadMaxPriority&&(o.settings.p2pDownloadMaxPriority=e.bufferedSegmentsCount),delete o.settings.bufferedSegmentsCount),o.segmentsStorage=void 0===o.settings.segmentsStorage?new d.SegmentsMemoryStorage(o.settings):o.settings.segmentsStorage,o.debug("loader settings",o.settings),o.httpManager=o.createHttpManager(),o.httpManager.on("segment-loaded",o.onSegmentLoaded),o.httpManager.on("segment-error",o.onSegmentError),o.httpManager.on("bytes-downloaded",function(e){return o.onPieceBytesDownloaded("http",e)}),o.p2pManager=o.createP2PManager(),o.p2pManager.on("segment-loaded",o.onSegmentLoaded),o.p2pManager.on("segment-error",o.onSegmentError),o.p2pManager.on("peer-data-updated",_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===o.masterSwarmId)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,o.segmentsStorage.getSegmentsMap(o.masterSwarmId);case 4:t=e.sent,o.processSegmentsQueue(t)&&!o.settings.consumeOnly&&o.p2pManager.sendSegmentsMapToAll(o.createSegmentsMap(t));case 6:case"end":return e.stop()}},e)}))),o.p2pManager.on("bytes-downloaded",function(e,t){return o.onPieceBytesDownloaded("p2p",e,t)}),o.p2pManager.on("bytes-uploaded",function(e,t){return o.onPieceBytesUploaded("p2p",e,t)}),o.p2pManager.on("peer-connected",o.onPeerConnect),o.p2pManager.on("peer-closed",o.onPeerClose),o.p2pManager.on("tracker-update",o.onTrackerUpdate),o}return _createClass(a,[{key:"createHttpManager",value:function(){return new u.HttpMediaManager(this.settings)}},{key:"createP2PManager",value:function(){return new c.P2PMediaManager(this.segmentsStorage,this.settings)}},{key:"load",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function e(n,t){var r,i,o,a,s,u,c,l,d=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:void 0===this.httpRandomDownloadInterval&&(this.httpRandomDownloadInterval=setInterval(this.downloadRandomSegmentOverHttp,this.settings.httpDownloadProbabilityInterval),0<this.settings.httpDownloadInitialTimeout&&0<this.settings.httpDownloadInitialTimeoutPerSegment&&(this.debugSegments("enable initial HTTP download timeout",this.settings.httpDownloadInitialTimeout,"per segment",this.settings.httpDownloadInitialTimeoutPerSegment),this.httpDownloadInitialTimeoutTimestamp=this.now(),setTimeout(this.processInitialSegmentTimeout,this.settings.httpDownloadInitialTimeoutPerSegment+100))),0<n.length&&(this.masterSwarmId=n[0].masterSwarmId),void 0!==this.masterSwarmId&&this.p2pManager.setStreamSwarmId(t,this.masterSwarmId),this.debug("load segments"),r=!1,i=_createForOfIteratorHelper(this.segmentsQueue);try{for(a=function(){var t=o.value;n.find(function(e){return e.url==t.url})||(d.debug("remove segment",t.url),d.httpManager.isDownloading(t)?(r=!0,d.httpManager.abort(t)):d.p2pManager.abort(t),d.emit(f.Events.SegmentAbort,t))},i.s();!(o=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}if(this.debug.enabled){s=_createForOfIteratorHelper(n);try{for(c=function(){var t=u.value;d.segmentsQueue.find(function(e){return e.url==t.url})||d.debug("add segment",t.url)},s.s();!(u=s.n()).done;)c()}catch(e){s.e(e)}finally{s.f()}}if(this.segmentsQueue=n,void 0===this.masterSwarmId)return e.abrupt("return");e.next=7;break;case 7:return e.next=9,this.segmentsStorage.getSegmentsMap(this.masterSwarmId);case 9:return l=e.sent,r=this.processSegmentsQueue(l)||r,e.next=13,this.cleanSegmentsStorage();case 13:if(e.t0=e.sent,e.t0)return e.next=17,this.segmentsStorage.getSegmentsMap(this.masterSwarmId);e.next=19;break;case 17:l=e.sent,r=!0;case 19:r&&!this.settings.consumeOnly&&this.p2pManager.sendSegmentsMapToAll(this.createSegmentsMap(l));case 20:case"end":return e.stop()}},e,this)})),function(e,t){return r.apply(this,arguments)})},{key:"getSegment",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0===this.masterSwarmId?void 0:this.segmentsStorage.getSegment(t,this.masterSwarmId));case 1:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"getSettings",value:function(){return this.settings}},{key:"getDetails",value:function(){return{peerId:this.p2pManager.getPeerId()}}},{key:"destroy",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0!==this.httpRandomDownloadInterval&&(clearInterval(this.httpRandomDownloadInterval),this.httpRandomDownloadInterval=void 0),this.httpDownloadInitialTimeoutTimestamp=-1/0,this.segmentsQueue=[],this.httpManager.destroy(),this.p2pManager.destroy(),this.masterSwarmId=void 0,e.next=8,this.segmentsStorage.destroy();case 8:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"processSegmentsQueue",value:function(e){if(this.debugSegments("process segments queue. priority",0<this.segmentsQueue.length?this.segmentsQueue[0].priority:0),void 0===this.masterSwarmId||0===this.segmentsQueue.length)return!1;var t,n=!1,r=!0;if(this.httpDownloadInitialTimeoutTimestamp!==-1/0){var i,o=_createForOfIteratorHelper(this.segmentsQueue);try{for(o.s();!(a=o.n()).done;){var a=a.value;if(!e.has(a.id)){i=a.priority;break}}}catch(e){o.e(e)}finally{o.f()}var s=this.now()-this.httpDownloadInitialTimeoutTimestamp;(r=s>=this.settings.httpDownloadInitialTimeout||void 0!==i&&s>this.settings.httpDownloadInitialTimeoutPerSegment&&i<=0)&&(this.debugSegments("cancel initial HTTP download timeout - timed out"),this.httpDownloadInitialTimeoutTimestamp=-1/0)}for(var u=0;u<this.segmentsQueue.length;u++){var c=this.segmentsQueue[u];if(!e.has(c.id)&&!this.httpManager.isDownloading(c)){if(c.priority<=this.settings.requiredSegmentsPriority&&r&&!this.httpManager.isFailed(c)){if(this.httpManager.getActiveDownloadsCount()>=this.settings.simultaneousHttpDownloads)for(var l=this.segmentsQueue.length-1;u<l;l--){var d=this.segmentsQueue[l];if(this.httpManager.isDownloading(d)){this.debugSegments("cancel HTTP download",d.priority,d.url),this.httpManager.abort(d);break}}if(this.httpManager.getActiveDownloadsCount()<this.settings.simultaneousHttpDownloads){var f=this.p2pManager.abort(c);this.httpManager.download(c,f),this.debugSegments("HTTP download (priority)",c.priority,c.url),n=!0;continue}}if(!this.p2pManager.isDownloading(c))if(c.priority<=this.settings.requiredSegmentsPriority){if((t=t||this.p2pManager.getOvrallSegmentsMap()).get(c.id)===g.MediaPeerSegmentStatus.Loaded){if(this.p2pManager.getActiveDownloadsCount()>=this.settings.simultaneousP2PDownloads)for(var h=this.segmentsQueue.length-1;u<h;h--){var p=this.segmentsQueue[h];if(this.p2pManager.isDownloading(p)){this.debugSegments("cancel P2P download",p.priority,p.url),this.p2pManager.abort(p);break}}this.p2pManager.getActiveDownloadsCount()<this.settings.simultaneousP2PDownloads&&this.p2pManager.download(c)&&this.debugSegments("P2P download (priority)",c.priority,c.url)}}else this.p2pManager.getActiveDownloadsCount()<this.settings.simultaneousP2PDownloads&&c.priority<=this.settings.p2pDownloadMaxPriority&&this.p2pManager.download(c)&&this.debugSegments("P2P download",c.priority,c.url)}}return n}},{key:"getStreamSwarmId",value:function(e){return void 0===e.streamId?e.masterSwarmId:"".concat(e.masterSwarmId,"+").concat(e.streamId)}},{key:"createSegmentsMap",value:function(e){function t(e,t){var n=i.getStreamSwarmId(e),r=e.sequence;void 0===(e=o[n])&&(e=["",[]],o[n]=e),n=e[1],e[0]+=0==n.length?r:"|".concat(r),n.push(t)}var n,i=this,o={},r=_createForOfIteratorHelper(e.values());try{for(r.s();!(n=r.n()).done;)t(n.value.segment,g.MediaPeerSegmentStatus.Loaded)}catch(e){r.e(e)}finally{r.f()}var a,s=_createForOfIteratorHelper(this.httpManager.getActiveDownloads().values());try{for(s.s();!(a=s.n()).done;)t(a.value.segment,g.MediaPeerSegmentStatus.LoadingByHttp)}catch(e){s.e(e)}finally{s.f()}return o}},{key:"cleanSegmentsStorage",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var n=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0!==this.masterSwarmId&&this.segmentsStorage.clean(this.masterSwarmId,function(t){return void 0!==n.segmentsQueue.find(function(e){return e.id===t})}));case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"now",value:function(){return performance.now()}}],[{key:"isSupported",value:function(){var e=h();return e&&void 0!==e.RTCPeerConnection.prototype.createDataChannel}}]),a}()},{"./bandwidth-approximator":1,"./http-media-manager":3,"./loader-interface":5,"./media-peer":6,"./p2p-media-manager":7,"./segments-memory-storage":8,debug:"debug",events:"events","get-browser-rtc":18,"simple-peer":44}],5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),(n=n.Events||(n.Events={})).SegmentLoaded="segment_loaded",n.SegmentError="segment_error",n.SegmentAbort="segment_abort",n.PeerConnect="peer_connect",n.PeerClose="peer_close",n.PieceBytesDownloaded="piece_bytes_downloaded",n.PieceBytesUploaded="piece_bytes_uploaded"},{}],6:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o,l,a=e("debug"),r=e("./stringly-typed-event-emitter"),s=e("buffer");(e=o=o||{})[e.SegmentData=0]="SegmentData",e[e.SegmentAbsent=1]="SegmentAbsent",e[e.SegmentsMap=2]="SegmentsMap",e[e.SegmentRequest=3]="SegmentRequest",e[e.CancelSegmentRequest=4]="CancelSegmentRequest",(e=l=n.MediaPeerSegmentStatus||(n.MediaPeerSegmentStatus={}))[e.Loaded=0]="Loaded",e[e.LoadingByHttp=1]="LoadingByHttp";var u=_createClass(function e(t,n){_classCallCheck(this,e),this.id=t,this.size=n,this.bytesDownloaded=0,this.pieces=[]});n.MediaPeer=function(){_inherits(i,r.STEEmitter);var n=_createSuper(i);function i(e,t){var r;return _classCallCheck(this,i),(r=n.call(this)).peer=e,r.settings=t,r.remoteAddress="",r.downloadingSegmentId=null,r.downloadingSegment=null,r.segmentsMap=new Map,r.debug=a("p2pml:media-peer"),r.timer=null,r.onPeerConnect=function(){r.debug("peer connect",r.id,_assertThisInitialized(r)),r.remoteAddress=r.peer.remoteAddress,r.emit("connect",_assertThisInitialized(r))},r.onPeerClose=function(){r.debug("peer close",r.id,_assertThisInitialized(r)),r.terminateSegmentRequest(),r.emit("close",_assertThisInitialized(r))},r.onPeerError=function(e){r.debug("peer error",r.id,e,_assertThisInitialized(r))},r.onPeerData=function(e){var t=r.getJsonCommand(e);if(null!=t){if(r.downloadingSegment){r.debug("peer segment download is interrupted by a command",r.id,_assertThisInitialized(r));var n=r.downloadingSegment.id;return r.terminateSegmentRequest(),void r.emit("segment-error",_assertThisInitialized(r),n,"Segment download is interrupted by a command")}switch(r.debug("peer receive command",r.id,t,_assertThisInitialized(r)),t.c){case o.SegmentsMap:r.segmentsMap=r.createSegmentsMap(t.m),r.emit("data-updated");break;case o.SegmentRequest:r.emit("segment-request",_assertThisInitialized(r),t.i);break;case o.SegmentData:r.downloadingSegmentId===t.i&&(r.downloadingSegment=new u(t.i,t.s),r.cancelResponseTimeoutTimer());break;case o.SegmentAbsent:r.downloadingSegmentId===t.i&&(r.terminateSegmentRequest(),r.segmentsMap.delete(t.i),r.emit("segment-absent",_assertThisInitialized(r),t.i));break;case o.CancelSegmentRequest:}}else r.receiveSegmentPiece(e)},r.peer.on("connect",r.onPeerConnect),r.peer.on("close",r.onPeerClose),r.peer.on("error",r.onPeerError),r.peer.on("data",r.onPeerData),r.id=e.id,r}return _createClass(i,[{key:"receiveSegmentPiece",value:function(e){if(this.downloadingSegment){this.downloadingSegment.bytesDownloaded+=e.byteLength,this.downloadingSegment.pieces.push(e),this.emit("bytes-downloaded",this,e.byteLength);e=this.downloadingSegment.id;if(this.downloadingSegment.bytesDownloaded==this.downloadingSegment.size){var t=new Uint8Array(this.downloadingSegment.size),n=0,r=_createForOfIteratorHelper(this.downloadingSegment.pieces);try{for(r.s();!(i=r.n()).done;){var i=i.value;t.set(new Uint8Array(i),n),n+=i.byteLength}}catch(e){r.e(e)}finally{r.f()}this.debug("peer segment download done",this.id,e,this),this.terminateSegmentRequest(),this.emit("segment-loaded",this,e,t.buffer)}else this.downloadingSegment.bytesDownloaded>this.downloadingSegment.size&&(this.debug("peer segment download bytes mismatch",this.id,e,this),this.terminateSegmentRequest(),this.emit("segment-error",this,e,"Too many bytes received for segment"))}else this.debug("peer segment not requested",this.id,this)}},{key:"getJsonCommand",value:function(e){var t=new Uint8Array(e);if(123==t[0]&&34==t[1]&&125==t[e.byteLength-1])try{return JSON.parse((new TextDecoder).decode(e))}catch(e){}return null}},{key:"createSegmentsMap",value:function(e){if(null==e||!(e instanceof Object))return new Map;for(var t=new Map,n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],o=e[i];if(!(o instanceof Array&&2===o.length&&"string"==typeof o[0]&&o[1]instanceof Array))return new Map;var a=o[0].split("|"),s=o[1];if(a.length!==s.length)return new Map;for(var u=0;u<a.length;u++){var c=s[u];if("number"!=typeof c||void 0===l[c])return new Map;t.set("".concat(i,"+").concat(a[u]),c)}}return t}},{key:"sendCommand",value:function(e){this.debug("peer send command",this.id,e,this),this.peer.write(JSON.stringify(e))}},{key:"destroy",value:function(){this.debug("peer destroy",this.id,this),this.terminateSegmentRequest(),this.peer.destroy()}},{key:"getDownloadingSegmentId",value:function(){return this.downloadingSegmentId}},{key:"getSegmentsMap",value:function(){return this.segmentsMap}},{key:"sendSegmentsMap",value:function(e){this.sendCommand({c:o.SegmentsMap,m:e})}},{key:"sendSegmentData",value:function(e,t){this.sendCommand({c:o.SegmentData,i:e,s:t.byteLength});for(var n=t.byteLength;0<n;){var r=n>=this.settings.webRtcMaxMessageSize?this.settings.webRtcMaxMessageSize:n,i=s.Buffer.from(t,t.byteLength-n,r);this.peer.write(i),n-=r}this.emit("bytes-uploaded",this,t.byteLength)}},{key:"sendSegmentAbsent",value:function(e){this.sendCommand({c:o.SegmentAbsent,i:e})}},{key:"requestSegment",value:function(e){if(this.downloadingSegmentId)throw new Error("A segment is already downloading: "+this.downloadingSegmentId);this.sendCommand({c:o.SegmentRequest,i:e}),this.downloadingSegmentId=e,this.runResponseTimeoutTimer()}},{key:"cancelSegmentRequest",value:function(){var e,t;return this.downloadingSegmentId&&(e=this.downloadingSegmentId,t=this.downloadingSegment?this.downloadingSegment.pieces:void 0,this.terminateSegmentRequest(),this.sendCommand({c:o.CancelSegmentRequest,i:e})),t}},{key:"runResponseTimeoutTimer",value:function(){var t=this;this.timer=setTimeout(function(){var e;t.timer=null,t.downloadingSegmentId&&(e=t.downloadingSegmentId,t.cancelSegmentRequest(),t.emit("segment-timeout",t,e))},this.settings.p2pSegmentDownloadTimeout)}},{key:"cancelResponseTimeoutTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"terminateSegmentRequest",value:function(){this.downloadingSegmentId=null,this.downloadingSegment=null,this.cancelResponseTimeoutTimer()}}]),i}()},{"./stringly-typed-event-emitter":9,buffer:16,debug:"debug"}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("debug"),a=e("bittorrent-tracker/client"),s=e("./stringly-typed-event-emitter"),u=e("./media-peer"),c=e("buffer"),l=e("sha.js/sha1"),e=e("./index"),d="-WW".concat(e.version.replace(/\d*./g,function(e){return"0".concat(parseInt(e,10)%100).slice(-2)}).slice(0,4),"-"),f=_createClass(function e(t,n){_classCallCheck(this,e),this.peerId=t,this.segment=n});n.P2PMediaManager=function(){_inherits(i,s.STEEmitter);var n,r=_createSuper(i);function i(e,t){var a;return _classCallCheck(this,i),(a=r.call(this)).sementsStorage=e,a.settings=t,a.trackerClient=null,a.peers=new Map,a.peerCandidates=new Map,a.peerSegmentRequests=new Map,a.streamSwarmId=null,a.debug=o("p2pml:p2p-media-manager"),a.pendingTrackerClient=null,a.onTrackerError=function(e){a.debug("tracker error",e)},a.onTrackerWarning=function(e){a.debug("tracker warning",e)},a.onTrackerUpdate=function(e){a.debug("tracker update",e),a.emit("tracker-update",e)},a.onTrackerPeer=function(e){if(a.debug("tracker peer",e.id,e),a.peers.has(e.id))return a.debug("tracker peer already connected",e.id,e),void e.destroy();var t=new u.MediaPeer(e,a.settings);t.on("connect",a.onPeerConnect),t.on("close",a.onPeerClose),t.on("data-updated",a.onPeerDataUpdated),t.on("segment-request",a.onSegmentRequest),t.on("segment-loaded",a.onSegmentLoaded),t.on("segment-absent",a.onSegmentAbsent),t.on("segment-error",a.onSegmentError),t.on("segment-timeout",a.onSegmentTimeout),t.on("bytes-downloaded",a.onPieceBytesDownloaded),t.on("bytes-uploaded",a.onPieceBytesUploaded);e=a.peerCandidates.get(t.id);e||(e=[],a.peerCandidates.set(t.id,e)),e.push(t)},a.onPieceBytesDownloaded=function(e,t){a.emit("bytes-downloaded",t,e.id)},a.onPieceBytesUploaded=function(e,t){a.emit("bytes-uploaded",t,e.id)},a.onPeerConnect=function(e){if(a.peers.get(e.id))return a.debug("tracker peer already connected (in peer connect)",e.id,e),void e.destroy();a.peers.set(e.id,e);var t=a.peerCandidates.get(e.id);if(t){var n=_createForOfIteratorHelper(t);try{for(n.s();!(r=n.n()).done;){var r=r.value;r!=e&&r.destroy()}}catch(e){n.e(e)}finally{n.f()}a.peerCandidates.delete(e.id)}a.emit("peer-connected",{id:e.id,remoteAddress:e.remoteAddress})},a.onPeerClose=function(e){if(a.peers.get(e.id)!=e){var t=a.peerCandidates.get(e.id);if(!t)return;var n=t.indexOf(e);return-1!=n&&t.splice(n,1),void(0==t.length&&a.peerCandidates.delete(e.id))}var r=_createForOfIteratorHelper(a.peerSegmentRequests);try{for(r.s();!(o=r.n()).done;){var i=_slicedToArray(o.value,2),o=i[0];i[1].peerId==e.id&&a.peerSegmentRequests.delete(o)}}catch(e){r.e(e)}finally{r.f()}a.peers.delete(e.id),a.emit("peer-data-updated"),a.emit("peer-closed",e.id)},a.onPeerDataUpdated=function(){a.emit("peer-data-updated")},a.onSegmentRequest=function(){var n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var r;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===a.masterSwarmId)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,a.sementsStorage.getSegment(n,a.masterSwarmId);case 4:(r=e.sent)?t.sendSegmentData(n,r.data):t.sendSegmentAbsent(n);case 6:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),a.onSegmentLoaded=function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,r){var i,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.peerSegmentRequests.get(n)){e.next=3;break}return e.abrupt("return");case 3:if(o=i.segment,a.settings.segmentValidator)return e.prev=5,e.next=8,a.settings.segmentValidator(Object.assign(Object.assign({},o),{data:r}),"p2p",t.id);e.next=13;break;case 8:e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(5),e.abrupt("return",(a.debug("segment validator failed",e.t0),a.peerSegmentRequests.delete(n),a.emit("segment-error",o,e.t0,t.id),void a.onPeerClose(t)));case 13:a.peerSegmentRequests.delete(n),a.emit("segment-loaded",o,r,t.id);case 14:case"end":return e.stop()}},e,null,[[5,10]])}));return function(e,t,n){return r.apply(this,arguments)}}(),a.onSegmentAbsent=function(e,t){a.peerSegmentRequests.delete(t),a.emit("peer-data-updated")},a.onSegmentError=function(e,t,n){var r=a.peerSegmentRequests.get(t);r&&(a.peerSegmentRequests.delete(t),a.emit("segment-error",r.segment,n,e.id))},a.onSegmentTimeout=function(e,t){var n=a.peerSegmentRequests.get(t);n&&(a.peerSegmentRequests.delete(t),e.destroy(),a.peers.delete(n.peerId)&&a.emit("peer-data-updated"))},a.peerId=t.useP2P?function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=d,n=0;n<20-d.length;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return(new TextEncoder).encode(t).buffer}():new ArrayBuffer(0),a.debug.enabled&&a.debug("peer ID",a.getPeerId(),(new TextDecoder).decode(a.peerId)),a}return _createClass(i,[{key:"getPeers",value:function(){return this.peers}},{key:"getPeerId",value:function(){return c.Buffer.from(this.peerId).toString("hex")}},{key:"setStreamSwarmId",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var r,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.streamSwarmId===t)return e.abrupt("return");e.next=2;break;case 2:this.destroy(!0),this.streamSwarmId=t,this.masterSwarmId=n,this.debug("stream swarm ID",this.streamSwarmId),this.pendingTrackerClient={isDestroyed:!1},r=this.pendingTrackerClient,i=(new l).update(2+this.streamSwarmId).digest(),r.isDestroyed?null!=this.trackerClient&&(this.trackerClient.destroy(),this.trackerClient=null):(this.pendingTrackerClient=null,this.createClient(i));case 5:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"createClient",value:function(e){var t,n=this;this.settings.useP2P&&(t={infoHash:c.Buffer.from(e,0,20),peerId:c.Buffer.from(this.peerId,0,20),announce:this.settings.trackerAnnounce,rtcConfig:this.settings.rtcConfig,port:6881,getAnnounceOpts:function(){return{numwant:n.settings.peerRequestsPerAnnounce}}},e=this.trackerClient,this.trackerClient=new a(t),this.trackerClient.on("error",this.onTrackerError),this.trackerClient.on("warning",this.onTrackerWarning),this.trackerClient.on("update",this.onTrackerUpdate),this.trackerClient.on("peer",this.onTrackerPeer),this.trackerClient.start(),null!=e&&(e.destroy(),e=null))}},{key:"download",value:function(e){if(this.isDownloading(e))return!1;var t=[],n=_createForOfIteratorHelper(this.peers.values());try{for(n.s();!(r=n.n()).done;){var r=r.value;null==r.getDownloadingSegmentId()&&r.getSegmentsMap().get(e.id)===u.MediaPeerSegmentStatus.Loaded&&t.push(r)}}catch(e){n.e(e)}finally{n.f()}if(0===t.length)return!1;var i=t[Math.floor(Math.random()*t.length)];return i.requestSegment(e.id),this.peerSegmentRequests.set(e.id,new f(i.id,e)),!0}},{key:"abort",value:function(e){var t,n=this.peerSegmentRequests.get(e.id);return n&&((n=this.peers.get(n.peerId))&&(t=n.cancelSegmentRequest()),this.peerSegmentRequests.delete(e.id)),t}},{key:"isDownloading",value:function(e){return this.peerSegmentRequests.has(e.id)}},{key:"getActiveDownloadsCount",value:function(){return this.peerSegmentRequests.size}},{key:"destroy",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.streamSwarmId=null,this.trackerClient&&(this.trackerClient.stop(),e?(this.trackerClient.removeAllListeners("error"),this.trackerClient.removeAllListeners("warning"),this.trackerClient.removeAllListeners("update"),this.trackerClient.removeAllListeners("peer")):(this.trackerClient.destroy(),this.trackerClient=null)),this.pendingTrackerClient&&(this.pendingTrackerClient.isDestroyed=!0,this.pendingTrackerClient=null),this.peers.forEach(function(e){return e.destroy()}),this.peers.clear(),this.peerSegmentRequests.clear();var t,n=_createForOfIteratorHelper(this.peerCandidates.values());try{for(n.s();!(t=n.n()).done;){var r,i=_createForOfIteratorHelper(t.value);try{for(i.s();!(r=i.n()).done;)r.value.destroy()}catch(e){i.e(e)}finally{i.f()}}}catch(e){n.e(e)}finally{n.f()}this.peerCandidates.clear()}},{key:"sendSegmentsMapToAll",value:function(t){this.peers.forEach(function(e){return e.sendSegmentsMap(t)})}},{key:"sendSegmentsMap",value:function(e,t){e=this.peers.get(e);e&&e.sendSegmentsMap(t)}},{key:"getOvrallSegmentsMap",value:function(){var e,t=new Map,n=_createForOfIteratorHelper(this.peers.values());try{for(n.s();!(e=n.n()).done;){var r=_createForOfIteratorHelper(e.value.getSegmentsMap());try{for(r.s();!(o=r.n()).done;){var i=_slicedToArray(o.value,2),o=i[0];i[1]===u.MediaPeerSegmentStatus.Loaded?t.set(o,u.MediaPeerSegmentStatus.Loaded):t.get(o)||t.set(o,u.MediaPeerSegmentStatus.LoadingByHttp)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}return t}}]),i}()},{"./index":"p2p-media-loader-core","./media-peer":6,"./stringly-typed-event-emitter":9,"bittorrent-tracker/client":11,buffer:16,debug:"debug","sha.js/sha1":43}],8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SegmentsMemoryStorage=function(){function t(e){_classCallCheck(this,t),this.settings=e,this.cache=new Map}var e,n,r,i,o,a;return _createClass(t,[{key:"storeSegment",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.cache.set(t.id,{segment:t,lastAccessed:performance.now()});case 1:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"getSegmentsMap",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cache);case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getSegment",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var r;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=this.cache.get(t)))return e.abrupt("return",(r.lastAccessed=performance.now(),r.segment));e.next=3;break;case 3:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"hasSegment",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cache.has(t));case 1:case"end":return e.stop()}},e,this)})),function(e,t){return r.apply(this,arguments)})},{key:"clean",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var r,i,o,a,s,u,c,l,d=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=[],o=performance.now(),a=_createForOfIteratorHelper(this.cache.values());try{for(a.s();!(s=a.n()).done;)s=s.value,o-s.lastAccessed>this.settings.cachedSegmentExpiration?r.push(s.segment.id):i.push(s)}catch(e){a.e(e)}finally{a.f()}if(!(0<(u=i.length-this.settings.cachedSegmentsCount))){e.next=23;break}i.sort(function(e,t){return e.lastAccessed-t.lastAccessed}),c=_createForOfIteratorHelper(i),e.prev=7,c.s();case 9:if((l=c.n()).done){e.next=15;break}if(l=l.value,void 0!==n&&n(l.segment.id)||(r.push(l.segment.id),0!=--u)){e.next=13;break}return e.abrupt("break",15);case 13:e.next=9;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),c.e(e.t0);case 20:return e.prev=20,c.f(),e.finish(20);case 23:return e.abrupt("return",(r.forEach(function(e){return d.cache.delete(e)}),0<r.length));case 24:case"end":return e.stop()}},e,this,[[7,17,20,23]])})),function(e,t){return n.apply(this,arguments)})},{key:"destroy",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.cache.clear();case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),t}()},{}],9:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("events");n.STEEmitter=function(){_inherits(o,r.EventEmitter);var e=_createSuper(o);function o(){return _classCallCheck(this,o),e.apply(this,arguments)}return _createClass(o,[{key:"on",value:function(e,t){return _get(_getPrototypeOf(o.prototype),"on",this).call(this,e,t)}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=_get(_getPrototypeOf(o.prototype),"emit",this)).call.apply(t,[this,e].concat(r))}}]),o}()},{events:"events"}],10:[function(e,t,n){n.byteLength=function(e){var t=l(e),e=t[0],t=t[1];return 3*(e+t)/4-t},n.toByteArray=function(e){for(var t,n=l(e),r=n[0],n=n[1],i=new c(3*(r+n)/4-n),o=0,a=0<n?r-4:r,s=0;s<a;s+=4)t=u[e.charCodeAt(s)]<<18|u[e.charCodeAt(s+1)]<<12|u[e.charCodeAt(s+2)]<<6|u[e.charCodeAt(s+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=255&t;return 2===n&&(t=u[e.charCodeAt(s)]<<2|u[e.charCodeAt(s+1)]>>4,i[o++]=255&t),1===n&&(t=u[e.charCodeAt(s)]<<10|u[e.charCodeAt(s+1)]<<4|u[e.charCodeAt(s+2)]>>2,i[o++]=t>>8&255,i[o++]=255&t),i},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,i=[],o=0,a=n-r;o<a;o+=16383)i.push(function(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(s[r>>18&63]+s[r>>12&63]+s[r>>6&63]+s[63&r]);return i.join("")}(e,o,a<o+16383?a:o+16383));return 1==r?(t=e[n-1],i.push(s[t>>2]+s[t<<4&63]+"==")):2==r&&(t=(e[n-2]<<8)+e[n-1],i.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"=")),i.join("")};for(var s=[],u=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=r.length;i<o;++i)s[i]=r[i],u[r.charCodeAt(i)]=i;function l(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],11:[function(t,n,e){(function(a,s){var u=t("debug")("bittorrent-tracker:client"),e=t("events"),c=t("once"),r=t("run-parallel"),l=t("simple-peer"),d=t("uniq"),i=t("./lib/common"),f=t("./lib/client/http-tracker"),h=t("./lib/client/udp-tracker"),p=t("./lib/client/websocket-tracker"),g=function(){_inherits(n,e);var t=_createSuper(n);function n(){var r,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,n),r=t.call(this),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");if(!a.browser&&!e.port)throw new Error("Option `port` is required");r.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),r._peerIdBuffer=s.from(r.peerId,"hex"),r._peerIdBinary=r._peerIdBuffer.toString("binary"),r.infoHash="string"==typeof e.infoHash?e.infoHash.toLowerCase():e.infoHash.toString("hex"),r._infoHashBuffer=s.from(r.infoHash,"hex"),r._infoHashBinary=r._infoHashBuffer.toString("binary"),u("new client %s",r.infoHash),r.destroyed=!1,r._port=e.port,r._getAnnounceOpts=e.getAnnounceOpts,r._rtcConfig=e.rtcConfig,r._userAgent=e.userAgent,r._wrtc="function"==typeof e.wrtc?e.wrtc():e.wrtc;e=(e="string"==typeof e.announce?[e.announce]:null==e.announce?[]:e.announce).map(function(e){return"/"===(e=e.toString())[e.length-1]&&(e=e.substring(0,e.length-1)),e});e=d(e);function i(e){a.nextTick(function(){r.emit("warning",e)})}var o=!1!==r._wrtc&&(!!r._wrtc||l.WEBRTC_SUPPORT);return r._trackers=e.map(function(e){var t;try{t=new URL(e)}catch(t){return i(new Error("Invalid tracker URL: ".concat(e))),null}var n=t.port;if(n<0||65535<n)return i(new Error("Invalid tracker port: ".concat(e))),null;n=t.protocol;return"http:"!==n&&"https:"!==n||"function"!=typeof f?"udp:"===n&&"function"==typeof h?new h(_assertThisInitialized(r),e):"ws:"!==n&&"wss:"!==n||!o||"ws:"===n&&"undefined"!=typeof window&&"https:"===window.location.protocol?(i(new Error("Unsupported tracker protocol: ".concat(e))),null):new p(_assertThisInitialized(r),e):new f(_assertThisInitialized(r),e)}).filter(Boolean),_possibleConstructorReturn(r)}return _createClass(n,[{key:"start",value:function(e){(e=this._defaultAnnounceOpts(e)).event="started",u("send `start` %o",e),this._announce(e),this._trackers.forEach(function(e){e.setInterval()})}},{key:"stop",value:function(e){(e=this._defaultAnnounceOpts(e)).event="stopped",u("send `stop` %o",e),this._announce(e)}},{key:"complete",value:function(e){e=e||{},(e=this._defaultAnnounceOpts(e)).event="completed",u("send `complete` %o",e),this._announce(e)}},{key:"update",value:function(e){(e=this._defaultAnnounceOpts(e)).event&&delete e.event,u("send `update` %o",e),this._announce(e)}},{key:"_announce",value:function(t){this._trackers.forEach(function(e){e.announce(t)})}},{key:"scrape",value:function(t){u("send `scrape`"),t=t||{},this._trackers.forEach(function(e){e.scrape(t)})}},{key:"setInterval",value:function(t){u("setInterval %d",t),this._trackers.forEach(function(e){e.setInterval(t)})}},{key:"destroy",value:function(e){var t;this.destroyed||(this.destroyed=!0,u("destroy"),t=this._trackers.map(function(t){return function(e){t.destroy(e)}}),r(t,e),this._trackers=[],this._getAnnounceOpts=null)}},{key:"_defaultAnnounceOpts",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return null==e.numwant&&(e.numwant=i.DEFAULT_ANNOUNCE_PEERS),null==e.uploaded&&(e.uploaded=0),null==e.downloaded&&(e.downloaded=0),this._getAnnounceOpts&&(e=Object.assign({},e,this._getAnnounceOpts())),e}}]),n}();g.scrape=function(e,t){if(t=c(t),!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");var n=Object.assign({},e,{infoHash:Array.isArray(e.infoHash)?e.infoHash[0]:e.infoHash,peerId:s.from("01234567890123456789"),port:6881}),r=new g(n);r.once("error",t),r.once("warning",t);var i=Array.isArray(e.infoHash)?e.infoHash.length:1,o={};return r.on("scrape",function(e){--i,o[e.infoHash]=e,0===i&&(r.destroy(),1===(e=Object.keys(o)).length?t(null,o[e[0]]):t(null,o))}),e.infoHash=Array.isArray(e.infoHash)?e.infoHash.map(function(e){return s.from(e,"hex")}):s.from(e.infoHash,"hex"),r.scrape({infoHash:e.infoHash}),r},n.exports=g}).call(this,t("_process"),t("buffer").Buffer)},{"./lib/client/http-tracker":15,"./lib/client/udp-tracker":15,"./lib/client/websocket-tracker":13,"./lib/common":14,_process:23,buffer:16,debug:"debug",events:"events",once:22,"run-parallel":40,"simple-peer":44,uniq:47}],12:[function(e,t,n){var o=e("events");t.exports=function(){_inherits(i,o);var t,r=_createSuper(i);function i(e,t){var n;return _classCallCheck(this,i),(n=r.call(this)).client=e,n.announceUrl=t,n.interval=null,n.destroyed=!1,n}function e(e){return t.apply(this,arguments)}return _createClass(i,[{key:"setInterval",value:(t=function(e){var t=this;null==e&&(e=this.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(this.interval),e&&(this.interval=setInterval(function(){t.announce(t.client._defaultAnnounceOpts())},e),this.interval.unref&&this.interval.unref())},e.toString=function(){return t.toString()},e)}]),i}()},{events:"events"}],13:[function(e,t,n){var a=e("debug")("bittorrent-tracker:websocket-tracker"),o=e("simple-peer"),s=e("randombytes"),u=e("simple-websocket"),c=e("../common"),l=e("./tracker"),d={},e=function(){_inherits(i,l);var r=_createSuper(i);function i(e,t,n){return _classCallCheck(this,i),e=r.call(this,e,t),a("new websocket tracker %s",t),e.peers={},e.socket=null,e.reconnecting=!1,e.retries=0,e.reconnectTimer=null,e.expectingResponse=!1,e._openSocket(),e}return _createClass(i,[{key:"announce",value:function(e){var t,n,r=this;this.destroyed||this.reconnecting||(this.socket.connected?(t=Object.assign({},e,{action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary}),this._trackerId&&(t.trackerid=this._trackerId),"stopped"===e.event||"completed"===e.event?this._send(t):(n=Math.min(e.numwant,10),this._generateOffers(n,function(e){t.numwant=n,t.offers=e,r._send(t)}))):this.socket.once("connect",function(){r.announce(e)}))}},{key:"scrape",value:function(e){var t,n=this;this.destroyed||this.reconnecting||(this.socket.connected?(t={action:"scrape",info_hash:Array.isArray(e.infoHash)&&0<e.infoHash.length?e.infoHash.map(function(e){return e.toString("binary")}):e.infoHash&&e.infoHash.toString("binary")||this.client._infoHashBinary},this._send(t)):this.socket.once("connect",function(){n.scrape(e)}))}},{key:"destroy",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f;if(this.destroyed)return t(null);for(e in this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer),this.peers){var n=this.peers[e];clearTimeout(n.trackerTimeout),n.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,d[this.announceUrl]&&--d[this.announceUrl].consumers,0<d[this.announceUrl].consumers)return t();var r=d[this.announceUrl];if(delete d[this.announceUrl],r.on("error",f),r.once("close",t),!this.expectingResponse)return o();var i=setTimeout(o,c.DESTROY_TIMEOUT);function o(){i&&(clearTimeout(i),i=null),r.removeListener("data",o),r.destroy(),r=null}r.once("data",o)}},{key:"_openSocket",value:function(){var t=this;this.destroyed=!1,this.peers||(this.peers={}),this._onSocketConnectBound=function(){t._onSocketConnect()},this._onSocketErrorBound=function(e){t._onSocketError(e)},this._onSocketDataBound=function(e){t._onSocketData(e)},this._onSocketCloseBound=function(){t._onSocketClose()},this.socket=d[this.announceUrl],this.socket?(d[this.announceUrl].consumers+=1,this.socket.connected&&this._onSocketConnectBound()):(this.socket=d[this.announceUrl]=new u(this.announceUrl),this.socket.consumers=1,this.socket.once("connect",this._onSocketConnectBound)),this.socket.on("data",this._onSocketDataBound),this.socket.once("close",this._onSocketCloseBound),this.socket.once("error",this._onSocketErrorBound)}},{key:"_onSocketConnect",value:function(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))}},{key:"_onSocketData",value:function(e){if(!this.destroyed){this.expectingResponse=!1;try{e=JSON.parse(e)}catch(e){return void this.client.emit("warning",new Error("Invalid tracker response"))}"announce"===e.action?this._onAnnounceResponse(e):"scrape"===e.action?this._onScrapeResponse(e):this._onSocketError(new Error("invalid action in WS response: ".concat(e.action)))}}},{key:"_onAnnounceResponse",value:function(t){var n=this;if(t.info_hash===this.client._infoHashBinary){if(!t.peer_id||t.peer_id!==this.client._peerIdBinary){a("received %s from %s for %s",JSON.stringify(t),this.announceUrl,this.client.infoHash);var e=t["failure reason"];if(e)return this.client.emit("warning",new Error(e));e=t["warning message"];e&&this.client.emit("warning",new Error(e));e=t.interval||t["min interval"];e&&this.setInterval(1e3*e);var r,i,e=t["tracker id"];e&&(this._trackerId=e),null!=t.complete&&(i=Object.assign({},t,{announce:this.announceUrl,infoHash:c.binaryToHex(t.info_hash)}),this.client.emit("update",i)),t.offer&&t.peer_id&&(a("creating peer (from remote offer)"),(r=this._createPeer()).id=c.binaryToHex(t.peer_id),r.once("signal",function(e){e={action:"announce",info_hash:n.client._infoHashBinary,peer_id:n.client._peerIdBinary,to_peer_id:t.peer_id,answer:e,offer_id:t.offer_id};n._trackerId&&(e.trackerid=n._trackerId),n._send(e)}),r.signal(t.offer),this.client.emit("peer",r)),t.answer&&t.peer_id&&(i=c.binaryToHex(t.offer_id),(r=this.peers[i])?(r.id=c.binaryToHex(t.peer_id),r.signal(t.answer),this.client.emit("peer",r),clearTimeout(r.trackerTimeout),r.trackerTimeout=null,delete this.peers[i]):a("got unexpected answer: ".concat(JSON.stringify(t.answer))))}}else a("ignoring websocket data from %s for %s (looking for %s: reused socket)",this.announceUrl,c.binaryToHex(t.info_hash),this.client.infoHash)}},{key:"_onScrapeResponse",value:function(t){var n=this;t=t.files||{};var e=Object.keys(t);0!==e.length?e.forEach(function(e){e=Object.assign(t[e],{announce:n.announceUrl,infoHash:c.binaryToHex(e)});n.client.emit("scrape",e)}):this.client.emit("warning",new Error("invalid scrape response"))}},{key:"_onSocketClose",value:function(){this.destroyed||(this.destroy(),this._startReconnectTimer())}},{key:"_onSocketError",value:function(e){this.destroyed||(this.destroy(),this.client.emit("warning",e),this._startReconnectTimer())}},{key:"_startReconnectTimer",value:function(){var e=this,t=Math.floor(12e4*Math.random())+Math.min(1e4*Math.pow(2,this.retries),18e5);this.reconnecting=!0,clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(function(){e.retries++,e._openSocket()},t),this.reconnectTimer.unref&&this.reconnectTimer.unref(),a("reconnecting socket in %s ms",t)}},{key:"_send",value:function(e){this.destroyed||(this.expectingResponse=!0,e=JSON.stringify(e),a("send %s",e),this.socket.send(e))}},{key:"_generateOffers",value:function(e,t){var n=this,r=[];a("generating %s offers",e);for(var i=0;i<e;++i)!function(){var t=s(20).toString("hex");a("creating peer (from _generateOffers)");var e=n.peers[t]=n._createPeer({initiator:!0});e.once("signal",function(e){r.push({offer:e,offer_id:c.hexToBinary(t)}),o()}),e.trackerTimeout=setTimeout(function(){a("tracker timeout: destroying peer"),e.trackerTimeout=null,delete n.peers[t],e.destroy()},5e4),e.trackerTimeout.unref&&e.trackerTimeout.unref()}();function o(){r.length===e&&(a("generated %s offers",e),t(r))}o()}},{key:"_createPeer",value:function(e){var t=this;e=Object.assign({trickle:!1,config:t.client._rtcConfig,wrtc:t.client._wrtc},e);var n=new o(e);return n.once("error",r),n.once("connect",function e(){n.removeListener("error",r),n.removeListener("connect",e)}),n;function r(e){t.client.emit("warning",new Error("Connection error: ".concat(e.message))),n.destroy()}}}]),i}();function f(){}e.prototype.DEFAULT_ANNOUNCE_INTERVAL=3e4,e._socketPool=d,t.exports=e},{"../common":14,"./tracker":12,debug:"debug",randombytes:24,"simple-peer":44,"simple-websocket":45}],14:[function(n,e,r){(function(t){r.DEFAULT_ANNOUNCE_PEERS=50,r.MAX_ANNOUNCE_PEERS=82,r.binaryToHex=function(e){return"string"!=typeof e&&(e=String(e)),t.from(e,"binary").toString("hex")},r.hexToBinary=function(e){return"string"!=typeof e&&(e=String(e)),t.from(e,"hex").toString("binary")};var e=n("./common-node");Object.assign(r,e)}).call(this,n("buffer").Buffer)},{"./common-node":15,buffer:16}],15:[function(e,t,n){},{}],16:[function(x,e,M){(function(d){var s=x("base64-js"),o=x("ieee754"),e="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;M.Buffer=d,M.SlowBuffer=function(e){return+e!=e&&(e=0),d.alloc(+e)},M.INSPECT_MAX_BYTES=50;var t=2147483647;function i(e){if(t<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return Object.setPrototypeOf(e,d.prototype),e}function d(e,t,n){if("number"!=typeof e)return r(e,t,n);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}function r(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!d.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|f(e,t),r=i(n),t=r.write(e,t);return t!==n&&(r=r.slice(0,t)),r}(e,t);if(ArrayBuffer.isView(e))return c(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_typeof(e));if(A(e,ArrayBuffer)||e&&A(e.buffer,ArrayBuffer))return function(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');n=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n);return Object.setPrototypeOf(n,d.prototype),n}(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return d.from(r,t,n);r=function(e){if(d.isBuffer(e)){var t=0|l(e.length),n=i(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||I(e.length)?i(0):c(e):"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return d.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_typeof(e))}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return a(e),i(e<0?0:0|l(e))}function c(e){for(var t=e.length<0?0:0|l(e.length),n=i(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function l(e){if(t<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function f(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||A(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+_typeof(e));var n=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return E(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return T(e).length;default:if(i)return r?-1:E(e).length;t=(""+t).toLowerCase(),i=!0}}function n(e,t,n){var r,i,o,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var i="",o=t;o<n;++o)i+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[o]);return i}(this,t,n);case"utf8":case"utf-8":return y(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}(this,t,n);case"base64":return r=this,o=n,0===(i=t)&&o===r.length?s.fromByteArray(r):s.fromByteArray(r.slice(i,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function h(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function p(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),I(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=d.from(t,r)),d.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):g(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,i){var o=1,a=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a/=o=2,s/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i)for(var c=-1,l=n;l<a;l++)if(u(e,l)===u(t,-1===c?0:l-c)){if(-1===c&&(c=l),l-c+1===s)return c*o}else-1!==c&&(l-=l-c),c=-1;else for(a<n+s&&(n=a-s),l=n;0<=l;l--){for(var d=!0,f=0;f<s;f++)if(u(e,l+f)!==u(t,f)){d=!1;break}if(d)return l}return-1}function m(e,t,n,r){return R(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function y(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,c=e[i],l=null,d=239<c?4:223<c?3:191<c?2:1;if(i+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&127<(u=(31&c)<<6|63&o)&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&2047<(u=(15&c)<<12|(63&o)<<6|63&a)&&(u<55296||57343<u)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)&&u<1114112&&(l=u)}null===l?(l=65533,d=1):65535<l&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return function(e){var t=e.length;if(t<=_)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=_));return n}(r)}M.kMaxLength=t,(d.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),d.poolSize=8192,d.from=r,Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(e,t,n){return t=t,n=n,a(e=e),!(e<=0)&&void 0!==t?"string"==typeof n?i(e).fill(t,n):i(e).fill(t):i(e)},d.allocUnsafe=u,d.allocUnsafeSlow=u,d.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==d.prototype},d.compare=function(e,t){if(A(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),A(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var n=d.allocUnsafe(t),r=0,i=0;i<e.length;++i){var o=e[i];if(A(o,Uint8Array)&&(o=d.from(o)),!d.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},d.byteLength=f,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},d.prototype.toLocaleString=d.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?y(this,0,e):n.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=M.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},e&&(d.prototype[e]=d.prototype.inspect),d.prototype.compare=function(e,t,n,r,i){if(A(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+_typeof(e));if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=t)return 0;if(i<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),c=e.slice(t,n),l=0;l<s;++l)if(u[l]!==c[l]){o=u[l],a=c[l];break}return o<a?-1:a<o?1:0},d.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},d.prototype.indexOf=function(e,t,n){return p(this,e,t,n,!0)},d.prototype.lastIndexOf=function(e,t,n){return p(this,e,t,n,!1)},d.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||i<n)&&(n=i),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,a,s,u,c,l,d=!1;;)switch(r){case"hex":return function(e,t,n,r){n=Number(n)||0;var i=e.length-n;(!r||(r=Number(r))>i)&&(r=i),(i=t.length)/2<r&&(r=i/2);for(var o=0;o<r;++o){var a=parseInt(t.substr(2*o,2),16);if(I(a))return o;e[n+o]=a}return o}(this,e,t,n);case"utf8":case"utf-8":return c=t,l=n,R(E(e,(u=this).length-c),u,c,l);case"ascii":return m(this,e,t,n);case"latin1":case"binary":return m(this,e,t,n);case"base64":return o=this,a=t,s=n,R(T(e),o,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o=t,a=n,R(function(e,t){for(var n,r,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,r=r%256,i.push(r),i.push(n);return i}(e,(s=this).length-o),s,o,a);default:if(d)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),d=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function b(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function v(e,t,n,r,i,o){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function w(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function S(e,t,n,r,i){return t=+t,n>>>=0,i||w(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function k(e,t,n,r,i){return t=+t,n>>>=0,i||w(e,0,n,8),o.write(e,t,n,r,52,8),n+8}d.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e);t=this.subarray(e,t);return Object.setPrototypeOf(t,d.prototype),t},d.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||b(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},d.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||b(e,t,this.length);for(var r=this[e+--t],i=1;0<t&&(i*=256);)r+=this[e+--t]*i;return r},d.prototype.readUInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||b(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},d.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||b(e,t,this.length);for(var r=t,i=1,o=this[e+--r];0<r&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},d.prototype.readInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||b(e,2,this.length);e=this[e]|this[e+1]<<8;return 32768&e?4294901760|e:e},d.prototype.readInt16BE=function(e,t){e>>>=0,t||b(e,2,this.length);e=this[e+1]|this[e]<<8;return 32768&e?4294901760|e:e},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return e>>>=0,t||b(e,4,this.length),o.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||b(e,4,this.length),o.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||b(e,8,this.length),o.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||b(e,8,this.length),o.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||v(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},d.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||v(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;0<=--i&&(o*=256);)this[t+i]=e/o&255;return t+n},d.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeIntLE=function(e,t,n,r){e=+e,t>>>=0,r||v(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,o=1,a=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},d.prototype.writeIntBE=function(e,t,n,r){e=+e,t>>>=0,r||v(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,o=1,a=0;for(this[t+i]=255&e;0<=--i&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},d.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeFloatLE=function(e,t,n){return S(this,e,t,!0,n)},d.prototype.writeFloatBE=function(e,t,n){return S(this,e,t,!1,n)},d.prototype.writeDoubleLE=function(e,t,n){return k(this,e,t,!0,n)},d.prototype.writeDoubleBE=function(e,t,n){return k(this,e,t,!1,n)},d.prototype.copy=function(e,t,n,r){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var o=i-1;0<=o;--o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return i},d.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!d.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i;1===e.length&&(i=e.charCodeAt(0),("utf8"===r&&i<128||"latin1"===r)&&(e=i))}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(o=t;o<n;++o)this[o]=e;else{var a=d.isBuffer(e)?e:d.from(e,r),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var C=/[^+\/0-9A-Za-z-_]/g;function E(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if(55295<(n=e.charCodeAt(a))&&n<57344){if(!i){if(56319<n){-1<(t-=3)&&o.push(239,191,189);continue}if(a+1===r){-1<(t-=3)&&o.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(t-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(t-=3)&&o.push(239,191,189);if(i=null,n<128){if(--t<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function T(e){return s.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(C,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function R(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function A(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function I(e){return e!=e}}).call(this,x("buffer").Buffer)},{"base64-js":10,buffer:16,ieee754:19}],17:[function(e,t,n){t.exports=function(t){function n(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return c.colors[Math.abs(t)%c.colors.length]}function c(e){var s;function u(){for(var r,e,t,i,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];u.enabled&&(r=u,t=(e=Number(new Date))-(s||e),r.diff=t,r.prev=s,r.curr=e,s=e,o[0]=c.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O"),o[i=0]=o[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;i++;var n=c.formatters[t];return"function"==typeof n&&(t=o[i],e=n.call(r,t),o.splice(i,1),i--),e}),c.formatArgs.call(r,o),(r.log||c.log).apply(r,o))}return u.namespace=e,u.enabled=c.enabled(e),u.useColors=c.useColors(),u.color=n(e),u.destroy=r,u.extend=i,"function"==typeof c.init&&c.init(u),c.instances.push(u),u}function r(){var e=c.instances.indexOf(this);return-1!==e&&(c.instances.splice(e,1),!0)}function i(e,t){e=c(this.namespace+(void 0===t?":":t)+e);return e.log=this.log,e}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return((c.debug=c).default=c).coerce=function(e){return e instanceof Error?e.stack||e.message:e},c.disable=function(){var e=[].concat(_toConsumableArray(c.names.map(o)),_toConsumableArray(c.skips.map(o).map(function(e){return"-"+e}))).join(",");return c.enable(""),e},c.enable=function(e){c.save(e),c.names=[],c.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)t[r]&&("-"===(e=t[r].replace(/\*/g,".*?"))[0]?c.skips.push(new RegExp("^"+e.substr(1)+"$")):c.names.push(new RegExp("^"+e+"$")));for(r=0;r<c.instances.length;r++){var i=c.instances[r];i.enabled=c.enabled(i.namespace)}},c.enabled=function(e){if("*"===e[e.length-1])return!0;for(var t=0,n=c.skips.length;t<n;t++)if(c.skips[t].test(e))return!1;for(t=0,n=c.names.length;t<n;t++)if(c.names[t].test(e))return!0;return!1},c.humanize=e("ms"),Object.keys(t).forEach(function(e){c[e]=t[e]}),c.instances=[],c.names=[],c.skips=[],c.formatters={},c.selectColor=n,c.enable(c.load()),c}},{ms:21}],18:[function(e,t,n){t.exports=function(){if("undefined"==typeof window)return null;var e={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}},{}],19:[function(e,t,n){n.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?i-1:0,f=n?-1:1,n=e[t+d];for(d+=f,o=n&(1<<-l)-1,n>>=-l,l+=s;0<l;o=256*o+e[t+d],d+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;0<l;a=256*a+e[t+d],d+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,r),o-=c}return(n?-1:1)*a*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var a,s,u=8*o-i-1,c=(1<<u)-1,l=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,h=r?1:-1,o=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-a))<1&&(a--,r*=2),2<=(t+=1<=a+l?d/r:d*Math.pow(2,1-l))*r&&(a++,r/=2),c<=a+l?(s=0,a=c):1<=a+l?(s=(t*r-1)*Math.pow(2,i),a+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,i),a=0));8<=i;e[n+f]=255&s,f+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;0<u;e[n+f]=255&a,f+=h,a/=256,u-=8);e[n+f-h]|=128*o}},{}],20:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){var n;t&&(e.super_=t,(n=function(){}).prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e)}},{}],21:[function(e,t,n){var o=36e5,a=864e5;function s(e,t,n,r){t=1.5*n<=t;return Math.round(e/n)+" "+r+(t?"s":"")}t.exports=function(e,t){t=t||{};var n,r,i=_typeof(e);if("string"===i&&0<e.length)return function(e){if(!(100<(e=String(e)).length)){e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(e){var t=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*t;case"weeks":case"week":case"w":return 6048e5*t;case"days":case"day":case"d":return t*a;case"hours":case"hour":case"hrs":case"hr":case"h":return t*o;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*t;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}(e);if("number"===i&&isFinite(e))return t.long?(n=e,r=Math.abs(n),a<=r?s(n,r,a,"day"):o<=r?s(n,r,o,"hour"):6e4<=r?s(n,r,6e4,"minute"):1e3<=r?s(n,r,1e3,"second"):n+" ms"):(r=e,n=Math.abs(r),a<=n?Math.round(r/a)+"d":o<=n?Math.round(r/o)+"h":6e4<=n?Math.round(r/6e4)+"m":1e3<=n?Math.round(r/1e3)+"s":r+"ms");throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],22:[function(e,t,n){e=e("wrappy");function r(e){function t(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))}return t.called=!1,t}function i(e){function t(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)}var n=e.name||"Function wrapped with `once`";return t.onceError=n+" shouldn't be called more than once",t.called=!1,t}t.exports=e(r),t.exports.strict=e(i),r.proto=r(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return r(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return i(this)},configurable:!0})})},{wrappy:49}],23:[function(e,t,n){var r,i,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&h())}function h(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++d<t;)u&&u[d].run();d=-1,t=c.length}u=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=g,t.addListener=g,t.once=g,t.off=g,t.removeListener=g,t.removeAllListeners=g,t.emit=g,t.prependListener=g,t.prependOnceListener=g,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],24:[function(t,n,e){(function(i,e){var o=t("safe-buffer").Buffer,a=e.crypto||e.msCrypto;a&&a.getRandomValues?n.exports=function(e,t){if(4294967295<e)throw new RangeError("requested too many random bytes");var n=o.allocUnsafe(e);if(0<e)if(65536<e)for(var r=0;r<e;r+=65536)a.getRandomValues(n.slice(r,r+65536));else a.getRandomValues(n);return"function"==typeof t?i.nextTick(function(){t(null,n)}):n}:n.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:23,"safe-buffer":41}],25:[function(e,t,n){var s={};function r(e,r,t){t=t||Error;var i,n,o,o=(o=i=t,(n=a).prototype=Object.create(o.prototype),(n.prototype.constructor=n).__proto__=o,a);function a(e,t,n){return i.call(this,"string"==typeof r?r:r(e,t,n))||this}o.prototype.name=t.name,o.prototype.code=e,s[e]=o}function u(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map(function(e){return String(e)}),2<n?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(e,t,n){var r,i,o,a;return"string"==typeof t&&"not "===t.substr(0,"not ".length)?(r="must not be",t=t.replace(/^not /,"")):r="must be",o=" argument",(void 0===a||a>e.length)&&(a=e.length),(e.substring(a-o.length,a)===o?"The ".concat(e," ").concat(r," ").concat(u(t,"type")):("number"!=typeof i&&(i=0),i=i+".".length>e.length||-1===e.indexOf(".",i)?"argument":"property",'The "'.concat(e,'" ').concat(i," ").concat(r," ").concat(u(t,"type"))))+". Received type ".concat(_typeof(n))},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=s},{}],26:[function(e,t,n){(function(n){var r=new Set;t.exports.emitExperimentalWarning=n.emitWarning?function(e){var t;r.has(e)||(t=e+" is an experimental feature. This feature could change at any time",r.add(e),n.emitWarning(t,"ExperimentalWarning"))}:function(){}}).call(this,e("_process"))},{_process:23}],27:[function(l,d,e){(function(e){var t=Object.keys||function(e){var t,n=[];for(t in e)n.push(t);return n};d.exports=s;var n=l("./_stream_readable"),r=l("./_stream_writable");l("inherits")(s,n);for(var i=t(r.prototype),o=0;o<i.length;o++){var a=i[o];s.prototype[a]||(s.prototype[a]=r.prototype[a])}function s(e){if(!(this instanceof s))return new s(e);n.call(this,e),r.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||e.nextTick(c,this)}function c(e){e.end()}Object.defineProperty(s.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(s.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(s.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(s.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,l("_process"))},{"./_stream_readable":29,"./_stream_writable":31,_process:23,inherits:20}],28:[function(e,t,n){t.exports=i;var r=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e("inherits")(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":30,inherits:20}],29:[function(B,N,e){(function(g,e){var r;(N.exports=v).ReadableState=b,B("events").EventEmitter;function m(e,t){return e.listeners(t).length}var i,t,o=B("./internal/streams/stream"),l=B("buffer").Buffer,d=e.Uint8Array||function(){},n=B("util"),y=n&&n.debuglog?n.debuglog("stream"):function(){},a=B("./internal/streams/buffer_list"),e=B("./internal/streams/destroy"),s=B("./internal/streams/state").getHighWaterMark,n=B("../errors").codes,f=n.ERR_INVALID_ARG_TYPE,h=n.ERR_STREAM_PUSH_AFTER_EOF,u=n.ERR_METHOD_NOT_IMPLEMENTED,p=n.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,c=B("../experimentalWarning").emitExperimentalWarning;B("inherits")(v,o);var _=["error","close","destroy","pause","resume"];function b(e,t,n){r=r||B("./_stream_duplex"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=s(this,e,"readableHighWaterMark",n),this.buffer=new a,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(i=i||B("string_decoder/").StringDecoder,this.decoder=new i(e.encoding),this.encoding=e.encoding)}function v(e){if(r=r||B("./_stream_duplex"),!(this instanceof v))return new v(e);var t=this instanceof r;this._readableState=new b(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function w(e,t,n,r,i){y("readableAddChunk",t);var o,a,s,u,c=e._readableState;if(null===t)c.reading=!1,a=e,(s=c).ended||(!s.decoder||(u=s.decoder.end())&&u.length&&(s.buffer.push(u),s.length+=s.objectMode?1:u.length),s.ended=!0,s.sync?C(a):(s.needReadable=!1,s.emittedReadable||(s.emittedReadable=!0,E(a))));else if(i||(s=c,i=a=t,l.isBuffer(i)||i instanceof d||"string"==typeof a||void 0===a||s.objectMode||(o=new f("chunk",["string","Buffer","Uint8Array"],a)),o=o),o)e.emit("error",o);else if(c.objectMode||t&&0<t.length)if("string"==typeof t||c.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=l.from(t)),r)c.endEmitted?e.emit("error",new p):S(e,c,t,!0);else if(c.ended)e.emit("error",new h);else{if(c.destroyed)return!1;c.reading=!1,c.decoder&&!n?(t=c.decoder.write(t),c.objectMode||0!==t.length?S(e,c,t,!1):T(e,c)):S(e,c,t,!1)}else r||(c.reading=!1,T(e,c));return!c.ended&&(c.length<c.highWaterMark||0===c.length)}function S(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&C(e)),T(e,t)}Object.defineProperty(v.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=e.destroy,v.prototype._undestroy=e.undestroy,v.prototype._destroy=function(e,t){t(e)},v.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),n=!0),w(this,e,t,!1,n)},v.prototype.unshift=function(e){return w(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return i=i||B("string_decoder/").StringDecoder,this._readableState.decoder=new i(e),this._readableState.encoding=this._readableState.decoder.encoding,this};function k(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?(t.flowing&&t.length?t.buffer.head.data:t).length:(e>t.highWaterMark&&(t.highWaterMark=(8388608<=(n=e)?n=8388608:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var n}function C(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(y("emitReadable",t.flowing),t.emittedReadable=!0,g.nextTick(E,e))}function E(e){var t=e._readableState;y("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||e.emit("readable"),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,M(e)}function T(e,t){t.readingMore||(t.readingMore=!0,g.nextTick(R,e,t))}function R(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(y("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function A(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function I(e){y("readable nexttick read 0"),e.read(0)}function x(e,t){y("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(y("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function P(e){var t=e._readableState;y("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,g.nextTick(L,t,e))}function L(e,t){y("endReadableNT",e.endEmitted,e.length),e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function D(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}v.prototype.read=function(e){y("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:0<t.length)||t.ended))return y("read: emitReadable",t.length,t.ended),(0===t.length&&t.ended?P:C)(this),null;if(0===(e=k(e,t))&&t.ended)return 0===t.length&&P(this),null;var r=t.needReadable;return y("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&y("length less than watermark",r=!0),t.ended||t.reading?y("reading or ended",r=!1):r&&(y("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=k(n,t))),null===(r=0<e?O(e,t):null)?(t.needReadable=!0,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&P(this)),null!==r&&this.emit("data",r),r},v.prototype._read=function(e){this.emit("error",new u("_read()"))},v.prototype.pipe=function(r,e){var i=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=r;break;case 1:o.pipes=[o.pipes,r];break;default:o.pipes.push(r)}o.pipesCount+=1,y("pipe count=%d opts=%j",o.pipesCount,e);var t=e&&!1===e.end||r===g.stdout||r===g.stderr?p:a;function a(){y("onend"),r.end()}o.endEmitted?g.nextTick(t):i.once("end",t),r.on("unpipe",function e(t,n){y("onunpipe"),t===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,y("cleanup"),r.removeListener("close",f),r.removeListener("finish",h),r.removeListener("drain",s),r.removeListener("error",d),r.removeListener("unpipe",e),i.removeListener("end",a),i.removeListener("end",p),i.removeListener("data",l),c=!0,!o.awaitDrain||r._writableState&&!r._writableState.needDrain||s())});var n,s=(n=i,function(){var e=n._readableState;y("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&m(n,"data")&&(e.flowing=!0,M(n))});r.on("drain",s);var u,c=!1;function l(e){y("ondata");e=r.write(e);y("dest.write",e),!1===e&&((1===o.pipesCount&&o.pipes===r||1<o.pipesCount&&-1!==D(o.pipes,r))&&!c&&(y("false write response, pause",o.awaitDrain),o.awaitDrain++),i.pause())}function d(e){y("onerror",e),p(),r.removeListener("error",d),0===m(r,"error")&&r.emit("error",e)}function f(){r.removeListener("finish",h),p()}function h(){y("onfinish"),r.removeListener("close",f),p()}function p(){y("unpipe"),i.unpipe(r)}return i.on("data",l),u="error",e=d,"function"==typeof(t=r).prependListener?t.prependListener(u,e):t._events&&t._events[u]?Array.isArray(t._events[u])?t._events[u].unshift(e):t._events[u]=[e,t._events[u]]:t.on(u,e),r.once("close",f),r.once("finish",h),r.emit("pipe",i),o.flowing||(y("pipe resume"),i.resume()),r},v.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=D(t.pipes,e);return-1===a||(t.pipes.splice(a,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},v.prototype.addListener=v.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t),t=this._readableState;return"data"===e?(t.readableListening=0<this.listenerCount("readable"),!1!==t.flowing&&this.resume()):"readable"===e&&(t.endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.flowing=!1,t.emittedReadable=!1,y("on readable",t.length,t.reading),t.length?C(this):t.reading||g.nextTick(I,this))),n},v.prototype.removeListener=function(e,t){t=o.prototype.removeListener.call(this,e,t);return"readable"===e&&g.nextTick(A,this),t},v.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||g.nextTick(A,this),t},v.prototype.resume=function(){var e,t,n=this._readableState;return n.flowing||(y("resume"),n.flowing=!n.readableListening,e=this,(t=n).resumeScheduled||(t.resumeScheduled=!0,g.nextTick(x,e,t))),n.paused=!1,this},v.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},v.prototype.wrap=function(t){var e,n=this,r=this._readableState,i=!1;for(e in t.on("end",function(){var e;y("wrapped end"),r.decoder&&!r.ended&&(e=r.decoder.end())&&e.length&&n.push(e),n.push(null)}),t.on("data",function(e){y("wrapped data"),r.decoder&&(e=r.decoder.write(e)),r.objectMode&&null==e||(r.objectMode||e&&e.length)&&(n.push(e)||(i=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var o=0;o<_.length;o++)t.on(_[o],this.emit.bind(this,_[o]));return this._read=function(e){y("wrapped _read",e),i&&(i=!1,t.resume())},this},"function"==typeof Symbol&&(v.prototype[Symbol.asyncIterator]=function(){return c("Readable[Symbol.asyncIterator]"),void 0===t&&(t=B("./internal/streams/async_iterator")),t(this)}),Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(v.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(v.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),v._fromList=O,Object.defineProperty(v.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}})}).call(this,B("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":25,"../experimentalWarning":26,"./_stream_duplex":27,"./internal/streams/async_iterator":32,"./internal/streams/buffer_list":33,"./internal/streams/destroy":34,"./internal/streams/state":37,"./internal/streams/stream":38,_process:23,buffer:16,events:"events",inherits:20,"string_decoder/":46,util:15}],30:[function(e,t,n){t.exports=u;var t=e("../errors").codes,r=t.ERR_METHOD_NOT_IMPLEMENTED,i=t.ERR_MULTIPLE_CALLBACK,o=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=t.ERR_TRANSFORM_WITH_LENGTH_0,s=e("./_stream_duplex");function u(e){if(!(this instanceof u))return new u(e);s.call(this,e),this._transformState={afterTransform:function(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new i);n.writechunk=null,(n.writecb=null)!=t&&this.push(t),r(e),(e=this._readableState).reading=!1,(e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",c)}function c(){var n=this;"function"!=typeof this._flush||this._readableState.destroyed?l(this,null,null):this._flush(function(e,t){l(n,e,t)})}function l(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(u,s),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,n){n(new r("_transform()"))},u.prototype._write=function(e,t,n){var r=this._transformState;r.writecb=n,r.writechunk=e,r.writeencoding=t,r.transforming||(t=this._readableState,(r.needTransform||t.needReadable||t.length<t.highWaterMark)&&this._read(t.highWaterMark))},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){s.prototype._destroy.call(this,e,function(e){t(e)})}},{"../errors":25,"./_stream_duplex":27,inherits:20}],31:[function(A,I,e){(function(d,e){function l(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t){var n=e.entry;for(e.entry=null;n;){var r=n.callback;t.pendingcb--,r(void 0),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var r;(I.exports=w).WritableState=v;var n,t={deprecate:A("util-deprecate")},i=A("./internal/streams/stream"),f=A("buffer").Buffer,h=e.Uint8Array||function(){},o=A("./internal/streams/destroy"),a=A("./internal/streams/state").getHighWaterMark,e=A("../errors").codes,p=e.ERR_INVALID_ARG_TYPE,s=e.ERR_METHOD_NOT_IMPLEMENTED,c=e.ERR_MULTIPLE_CALLBACK,u=e.ERR_STREAM_CANNOT_PIPE,g=e.ERR_STREAM_DESTROYED,m=e.ERR_STREAM_NULL_VALUES,y=e.ERR_STREAM_WRITE_AFTER_END,_=e.ERR_UNKNOWN_ENCODING;function b(){}function v(e,t,n){r=r||A("./_stream_duplex"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=a(this,e,"writableHighWaterMark",n),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;n=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n,r,i,o,a=e._writableState,s=a.sync,u=a.writecb;if("function"!=typeof u)throw new c;(o=a).writing=!1,o.writecb=null,o.length-=o.writelen,o.writelen=0,t?(n=e,i=s,o=t,t=u,--(r=a).pendingcb,i?(d.nextTick(t,o),d.nextTick(R,n,r),n._writableState.errorEmitted=!0,n.emit("error",o)):(t(o),n._writableState.errorEmitted=!0,n.emit("error",o),R(n,r))):((r=E(a)||e.destroyed)||a.corked||a.bufferProcessing||!a.bufferedRequest||C(e,a),s?d.nextTick(k,e,a,r,u):k(e,a,r,u))}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function w(e){var t=this instanceof(r=r||A("./_stream_duplex"));if(!t&&!n.call(w,this))return new w(e);this._writableState=new v(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),i.call(this)}function S(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function k(e,t,n,r){n||(n=e,0===t.length&&t.needDrain&&(t.needDrain=!1,n.emit("drain"))),t.pendingcb--,r(),R(e,t)}function C(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),r=t.corkedRequestsFree;r.entry=n;for(var o=0,a=!0;n;)(i[o]=n).isBuf||(a=!1),n=n.next,o+=1;i.allBuffers=a,S(e,t,!0,t.length,i,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new l(t),t.bufferedRequestCount=0}else{for(;n;){var s=n.chunk,u=n.encoding,c=n.callback;if(S(e,t,!1,t.objectMode?1:s.length,s,u,c),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function E(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(t,n){t._final(function(e){n.pendingcb--,e&&t.emit("error",e),n.prefinished=!0,t.emit("prefinish"),R(t,n)})}function R(e,t){var n,r,i=E(t);return i&&(n=e,(r=t).prefinished||r.finalCalled||("function"!=typeof n._final||r.destroyed?(r.prefinished=!0,n.emit("prefinish")):(r.pendingcb++,r.finalCalled=!0,d.nextTick(T,n,r))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),i}A("inherits")(w,i),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(n=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(e){return!!n.call(this,e)||this===w&&e&&e._writableState instanceof v}})):n=function(e){return e instanceof this},w.prototype.pipe=function(){this.emit("error",new u)},w.prototype.write=function(e,t,n){var r,i,o,a,s,u=this._writableState,c=!1,l=!u.objectMode&&(r=e,f.isBuffer(r)||r instanceof h);return l&&!f.isBuffer(e)&&(e=f.from(e)),"function"==typeof t&&(n=t,t=null),t=l?"buffer":t||u.defaultEncoding,"function"!=typeof n&&(n=b),u.ending?(o=this,a=n,s=new y,o.emit("error",s),d.nextTick(a,s)):!l&&(r=this,o=u,a=n,null===(s=e)?i=new m:"string"==typeof s||o.objectMode||(i=new p("chunk",["string","Buffer"],s)),i&&(r.emit("error",i),d.nextTick(a,i),!0))||(u.pendingcb++,c=function(e,t,n,r,i,o){n||(u=r,t.objectMode||!1===t.decodeStrings||"string"!=typeof u||(u=f.from(u,i)),r!==(s=u)&&(n=!0,i="buffer",r=s));var a=t.objectMode?1:r.length;t.length+=a;var s,u=t.length<t.highWaterMark;return u||(t.needDrain=!0),t.writing||t.corked?(s=t.lastBufferedRequest,t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1):S(e,t,!1,a,r,i,o),u}(this,u,l,e,t,n)),c},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},w.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(e,t,n){n(new s("_write()"))},w.prototype._writev=null,w.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,t=e=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||(t=this,n=n,(r=r).ending=!0,R(t,r),n&&(r.finished?d.nextTick(n):t.once("finish",n)),r.ended=!0,t.writable=!1),this},Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),w.prototype.destroy=o.destroy,w.prototype._undestroy=o.undestroy,w.prototype._destroy=function(e,t){t(e)}}).call(this,A("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":25,"./_stream_duplex":27,"./internal/streams/destroy":34,"./internal/streams/state":37,"./internal/streams/stream":38,_process:23,buffer:16,inherits:20,"util-deprecate":48}],32:[function(r,m,e){(function(o){var e;function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=r("./end-of-stream"),a=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function h(e,t){return{value:e,done:t}}function p(e){var t,n=e[a];null===n||null!==(t=e[f].read())&&(e[l]=null,e[a]=null,e[s]=null,n(h(t,!1)))}var t=Object.getPrototypeOf(function(){}),g=Object.setPrototypeOf((n(e={get stream(){return this[f]},next:function(){var n=this,e=this[u];if(null!==e)return Promise.reject(e);if(this[c])return Promise.resolve(h(void 0,!0));if(this[f].destroyed)return new Promise(function(e,t){o.nextTick(function(){n[u]?t(n[u]):e(h(void 0,!0))})});var t,r,i,e=this[l];if(e)t=new Promise((r=e,i=this,function(e,t){r.then(function(){i[c]?e(h(void 0,!0)):i[d](e,t)},t)}));else{e=this[f].read();if(null!==e)return Promise.resolve(h(e,!1));t=new Promise(this[d])}return this[l]=t}},Symbol.asyncIterator,function(){return this}),n(e,"return",function(){var e=this;return new Promise(function(t,n){e[f].destroy(null,function(e){e?n(e):t(h(void 0,!0))})})}),e),t);m.exports=function(e){var t,r=Object.create(g,(n(t={},f,{value:e,writable:!0}),n(t,a,{value:null,writable:!0}),n(t,s,{value:null,writable:!0}),n(t,u,{value:null,writable:!0}),n(t,c,{value:e._readableState.endEmitted,writable:!0}),n(t,d,{value:function(e,t){var n=r[f].read();n?(r[l]=null,r[a]=null,r[s]=null,e(h(n,!1))):(r[a]=e,r[s]=t)},writable:!0}),t));return r[l]=null,i(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[l]=null,r[a]=null,r[s]=null,t(e)),void(r[u]=e)}e=r[a];null!==e&&(r[l]=null,r[a]=null,e(h(void 0,!(r[s]=null)))),r[c]=!0}),e.on("readable",function(e){o.nextTick(p,e)}.bind(null,r)),r}}).call(this,r("_process"))},{"./end-of-stream":35,_process:23}],33:[function(e,t,n){var a=e("buffer").Buffer,r=e("util").inspect,e=r&&r.custom||"inspect";function i(){this.head=null,this.tail=null,this.length=0}t.exports=((t=i.prototype).push=function(e){e={data:e,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.unshift=function(e){e={data:e,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},t.clear=function(){this.head=this.tail=null,this.length=0},t.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},t.concat=function(e){if(0===this.length)return a.alloc(0);for(var t,n=a.allocUnsafe(e>>>0),r=this.head,i=0;r;)t=r.data,a.prototype.copy.call(t,n,i),i+=r.data.length,r=r.next;return n},t.consume=function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n},t.first=function(){return this.head.data},t._getString=function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t).data=i.slice(o);break}++n}return this.length-=n,r},t._getBuffer=function(e){var t=a.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n).data=i.slice(o);break}++r}return this.length-=r,t},t[e]=function(e,t){return r(this,function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n;t=r,e=i[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e})}return r}({},t,{depth:0,customInspect:!1}))},i)},{buffer:16,util:15}],34:[function(e,t,n){(function(o){function a(e,t){u(e,t),s(e)}function s(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function u(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||o.nextTick(u,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(o.nextTick(a,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t?(o.nextTick(s,n),t(e)):o.nextTick(s,n)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}}).call(this,e("_process"))},{_process:23}],35:[function(e,t,n){var m=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function y(){}t.exports=function e(t,n,r){if("function"==typeof n)return e(t,null,n);var i,o;i=r||y,o=!1,r=function(){if(!o){o=!0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(this,t)}};function a(){t.writable||p()}function s(){g=!(d=!1),f||r.call(t)}function u(e){r.call(t,e)}function c(){var e;return d&&!g?(t._readableState&&t._readableState.ended||(e=new m),r.call(t,e)):f&&!h?(t._writableState&&t._writableState.ended||(e=new m),r.call(t,e)):void 0}function l(){t.req.on("finish",p)}var d=(n=n||{}).readable||!1!==n.readable&&t.readable,f=n.writable||!1!==n.writable&&t.writable,h=t._writableState&&t._writableState.finished,p=function(){h=!(f=!1),d||r.call(t)},g=t._readableState&&t._readableState.endEmitted;return t.setHeader&&"function"==typeof t.abort?(t.on("complete",p),t.on("abort",c),t.req?l():t.on("request",l)):f&&!t._writableState&&(t.on("end",a),t.on("close",a)),t.on("end",s),t.on("finish",p),!1!==n.error&&t.on("error",u),t.on("close",c),function(){t.removeListener("complete",p),t.removeListener("abort",c),t.removeListener("request",l),t.req&&t.req.removeListener("finish",p),t.removeListener("end",a),t.removeListener("close",a),t.removeListener("finish",p),t.removeListener("end",s),t.removeListener("error",u),t.removeListener("close",c)}}},{"../../../errors":25}],36:[function(u,e,t){var c,n=u("../../../errors").codes,s=n.ERR_MISSING_ARGS,l=n.ERR_STREAM_DESTROYED;function d(e){if(e)throw e}function f(e){e()}function h(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var i,o=r.length&&"function"==typeof r[r.length-1]?r.pop():d;if(Array.isArray(r[0])&&(r=r[0]),r.length<2)throw new s("streams");var a=r.map(function(e,t){var n=t<r.length-1;return function(t,e,n,r){var i,o;i=r,o=!1;var a=!(r=function(){o||(o=!0,i.apply(void 0,arguments))});t.on("close",function(){a=!0}),void 0===c&&(c=u("./end-of-stream")),c(t,{readable:e,writable:n},function(e){return e?r(e):(a=!0,void r())});var s=!1;return function(e){if(!a&&!s)return s=!0,t.setHeader&&"function"==typeof t.abort?t.abort():"function"==typeof t.destroy?t.destroy():void r(e||new l("pipe"))}}(e,n,0<t,function(e){i=i||e,e&&a.forEach(f),n||(a.forEach(f),o(i))})});return r.reduce(h)}},{"../../../errors":25,"./end-of-stream":35}],37:[function(e,t,n){var i=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,r){t=null!=t.highWaterMark?t.highWaterMark:r?t[n]:null;if(null==t)return e.objectMode?16:16384;if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new i(r?n:"highWaterMark",t);return Math.floor(t)}}},{"../../../errors":25}],38:[function(e,t,n){t.exports=e("events").EventEmitter},{events:"events"}],39:[function(e,t,n){(((n=t.exports=e("./lib/_stream_readable.js")).Stream=n).Readable=n).Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":27,"./lib/_stream_passthrough.js":28,"./lib/_stream_readable.js":29,"./lib/_stream_transform.js":30,"./lib/_stream_writable.js":31,"./lib/internal/streams/end-of-stream.js":35,"./lib/internal/streams/pipeline.js":36}],40:[function(e,t,n){(function(u){t.exports=function(e,n){var r,i,t,o=!0;function a(e){function t(){n&&n(e,r),n=null}o?u.nextTick(t):t()}function s(e,t,n){r[e]=n,0!=--i&&!t||a(t)}(i=Array.isArray(e)?(r=[],e.length):(t=Object.keys(e),r={},t.length))?t?t.forEach(function(n){e[n](function(e,t){s(n,e,t)})}):e.forEach(function(e,n){e(function(e,t){s(n,e,t)})}):a(null),o=!1}}).call(this,e("_process"))},{_process:23}],41:[function(e,t,n){var r=e("buffer"),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,n),n.Buffer=a),a.prototype=Object.create(i.prototype),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=i(e);return void 0!==t?"string"==typeof n?e.fill(t,n):e.fill(t):e.fill(0),e},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},{buffer:16}],42:[function(e,t,n){var l=e("safe-buffer").Buffer;function r(e,t){this._block=l.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}r.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=l.from(e,t));for(var n=this._block,r=this._blockSize,i=e.length,o=this._len,a=0;a<i;){for(var s=o%r,u=Math.min(i-a,r-s),c=0;c<u;c++)n[s+c]=e[a+c];a+=u,(o+=u)%r==0&&this._update(n)}return this._len+=i,this},r.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,1+t),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));t=8*this._len;t<=4294967295?this._block.writeUInt32BE(t,this._blockSize-4):(t=(t-(n=(4294967295&t)>>>0))/4294967296,this._block.writeUInt32BE(t,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)),this._update(this._block);var n=this._hash();return e?n.toString(e):n},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=r},{"safe-buffer":41}],43:[function(e,t,n){var r=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,g=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function s(){this.init(),this._w=a,i.call(this,64,56)}r(s,i),s.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},s.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,a=0|this._d,s=0|this._e,u=0;u<16;++u)n[u]=e.readInt32BE(4*u);for(;u<80;++u)n[u]=(t=n[u-3]^n[u-8]^n[u-14]^n[u-16])<<1|t>>>31;for(var c,l,d,f=0;f<80;++f)var h=~~(f/20),p=0|((d=r)<<5|d>>>27)+(c=i,l=o,p=a,0===(d=h)?c&l|~c&p:2===d?c&l|c&p|l&p:c^l^p)+s+n[f]+g[h],s=a,a=o,o=(h=i)<<30|h>>>2,i=r,r=p;this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=s+this._e|0},s.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=s},{"./hash":42,inherits:20,"safe-buffer":41}],44:[function(l,d,e){(function(t){d.exports=s;var n=l("debug")("simple-peer"),r=l("get-browser-rtc"),e=l("inherits"),i=l("randombytes"),o=l("readable-stream"),a=5e3;function s(e){var t=this;if(!(t instanceof s))return new s(e);if(t._id=i(4).toString("hex").slice(0,7),t._debug("new peer %o",e),e=Object.assign({allowHalfOpen:!1},e),o.Duplex.call(t,e),t.channelName=e.initiator?e.channelName||i(20).toString("hex"):null,t.initiator=e.initiator||!1,t.channelConfig=e.channelConfig||s.channelConfig,t.config=Object.assign({},s.config,e.config),t.offerOptions=e.offerOptions||{},t.answerOptions=e.answerOptions||{},t.sdpTransform=e.sdpTransform||function(e){return e},t.streams=e.streams||(e.stream?[e.stream]:[]),t.trickle=void 0===e.trickle||e.trickle,t.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,t.iceCompleteTimeout=e.iceCompleteTimeout||a,t.destroyed=!1,t._connected=!1,t.remoteAddress=void 0,t.remoteFamily=void 0,t.remotePort=void 0,t.localAddress=void 0,t.localFamily=void 0,t.localPort=void 0,t._wrtc=e.wrtc&&"object"==_typeof(e.wrtc)?e.wrtc:r(),!t._wrtc)throw"undefined"==typeof window?c("No WebRTC support: Specify `opts.wrtc` option in this environment","ERR_WEBRTC_SUPPORT"):c("No WebRTC support: Not a supported browser","ERR_WEBRTC_SUPPORT");t._pcReady=!1,t._channelReady=!1,t._iceComplete=!1,t._iceCompleteTimer=null,t._channel=null,t._pendingCandidates=[],t._isNegotiating=!t.initiator,t._batchedNegotiation=!1,t._queuedNegotiation=!1,t._sendersAwaitingStable=[],t._senderMap=new Map,t._firstStable=!0,t._closingInterval=null,t._remoteTracks=[],t._remoteStreams=[],t._chunk=null,t._cb=null,t._interval=null;try{t._pc=new t._wrtc.RTCPeerConnection(t.config)}catch(e){return void setTimeout(function(){return t.destroy(e)},0)}t._isReactNativeWebrtc="number"==typeof t._pc._peerConnectionId,t._pc.oniceconnectionstatechange=function(){t._onIceStateChange()},t._pc.onicegatheringstatechange=function(){t._onIceStateChange()},t._pc.onsignalingstatechange=function(){t._onSignalingStateChange()},t._pc.onicecandidate=function(e){t._onIceCandidate(e)},t.initiator?t._setupData({channel:t._pc.createDataChannel(t.channelName,t.channelConfig)}):t._pc.ondatachannel=function(e){t._setupData(e)},t.streams&&t.streams.forEach(function(e){t.addStream(e)}),t._pc.ontrack=function(e){t._onTrack(e)},t.initiator&&t._needsNegotiation(),t._onFinishBound=function(){t._onFinish()},t.once("finish",t._onFinishBound)}function u(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}function c(e,t){e=new Error(e);return e.code=t,e}e(s,o.Duplex),s.WEBRTC_SUPPORT=!!r(),s.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}],sdpSemantics:"unified-plan"},s.channelConfig={},Object.defineProperty(s.prototype,"bufferSize",{get:function(){return this._channel&&this._channel.bufferedAmount||0}}),Object.defineProperty(s.prototype,"connected",{get:function(){return this._connected&&"open"===this._channel.readyState}}),s.prototype.address=function(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}},s.prototype.signal=function(e){var t=this;if(t.destroyed)throw c("cannot signal after peer is destroyed","ERR_SIGNALING");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}t._debug("signal()"),e.renegotiate&&t.initiator&&(t._debug("got request to renegotiate"),t._needsNegotiation()),e.transceiverRequest&&t.initiator&&(t._debug("got request for transceiver"),t.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(t._pc.localDescription&&t._pc.localDescription.type&&t._pc.remoteDescription&&t._pc.remoteDescription.type?t._addIceCandidate(e.candidate):t._pendingCandidates.push(e.candidate)),e.sdp&&t._pc.setRemoteDescription(new t._wrtc.RTCSessionDescription(e)).then(function(){t.destroyed||(t._pendingCandidates.forEach(function(e){t._addIceCandidate(e)}),t._pendingCandidates=[],"offer"===t._pc.remoteDescription.type&&t._createAnswer())}).catch(function(e){t.destroy(c(e,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||t.destroy(c("signal() called with invalid signal data","ERR_SIGNALING"))},s.prototype._addIceCandidate=function(e){var t=this,n=new t._wrtc.RTCIceCandidate(e);t._pc.addIceCandidate(n).catch(function(e){!n.address||n.address.endsWith(".local")?console.warn("Ignoring unsupported ICE candidate."):t.destroy(c(e,"ERR_ADD_ICE_CANDIDATE"))})},s.prototype.send=function(e){this._channel.send(e)},s.prototype.addTransceiver=function(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(e){this.destroy(e)}else this.emit("signal",{transceiverRequest:{kind:e,init:t}})},s.prototype.addStream=function(t){var n=this;n._debug("addStream()"),t.getTracks().forEach(function(e){n.addTrack(e,t)})},s.prototype.addTrack=function(e,t){this._debug("addTrack()");var n=this._senderMap.get(e)||new Map,r=n.get(t);r?r.removed?this.destroy(c("Track has been removed. You should enable/disable tracks that you want to re-add.","ERR_SENDER_REMOVED")):this.destroy(c("Track has already been added to that stream.","ERR_SENDER_ALREADY_ADDED")):(r=this._pc.addTrack(e,t),n.set(t,r),this._senderMap.set(e,n),this._needsNegotiation())},s.prototype.replaceTrack=function(e,t,n){this._debug("replaceTrack()");e=this._senderMap.get(e),n=e?e.get(n):null;n||this.destroy(c("Cannot replace track that was never added.","ERR_TRACK_NOT_ADDED")),t&&this._senderMap.set(t,e),null!=n.replaceTrack?n.replaceTrack(t):this.destroy(c("replaceTrack is not supported in this browser","ERR_UNSUPPORTED_REPLACETRACK"))},s.prototype.removeTrack=function(e,t){this._debug("removeSender()");var n=this._senderMap.get(e),r=n?n.get(t):null;r||this.destroy(c("Cannot remove track that was never added.","ERR_TRACK_NOT_ADDED"));try{r.removed=!0,this._pc.removeTrack(r)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?this._sendersAwaitingStable.push(r):this.destroy(e)}this._needsNegotiation()},s.prototype.removeStream=function(t){var n=this;n._debug("removeSenders()"),t.getTracks().forEach(function(e){n.removeTrack(e,t)})},s.prototype._needsNegotiation=function(){var e=this;e._debug("_needsNegotiation"),e._batchedNegotiation||(e._batchedNegotiation=!0,setTimeout(function(){e._batchedNegotiation=!1,e._debug("starting batched negotiation"),e.negotiate()},0))},s.prototype.negotiate=function(){var e=this;e.initiator?e._isNegotiating?(e._queuedNegotiation=!0,e._debug("already negotiating, queueing")):(e._debug("start negotiation"),setTimeout(function(){e._createOffer()},0)):e._isNegotiating||(e._debug("requesting negotiation from initiator"),e.emit("signal",{renegotiate:!0})),e._isNegotiating=!0},s.prototype.destroy=function(e){this._destroy(e,function(){})},s.prototype._destroy=function(e,t){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.destroyed=!0,this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()}},s.prototype._setupData=function(e){var t=this;if(!e.channel)return t.destroy(c("Data channel event is missing `channel` property","ERR_DATA_CHANNEL"));t._channel=e.channel,t._channel.binaryType="arraybuffer","number"==typeof t._channel.bufferedAmountLowThreshold&&(t._channel.bufferedAmountLowThreshold=65536),t.channelName=t._channel.label,t._channel.onmessage=function(e){t._onChannelMessage(e)},t._channel.onbufferedamountlow=function(){t._onChannelBufferedAmountLow()},t._channel.onopen=function(){t._onChannelOpen()},t._channel.onclose=function(){t._onChannelClose()};var n=!(t._channel.onerror=function(e){t.destroy(c(e,"ERR_DATA_CHANNEL"))});t._closingInterval=setInterval(function(){n=!(!t._channel||"closing"!==t._channel.readyState)&&(n&&t._onChannelClose(),!0)},5e3)},s.prototype._read=function(){},s.prototype._write=function(e,t,n){if(this.destroyed)return n(c("cannot write after peer is destroyed","ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(e){return this.destroy(c(e,"ERR_DATA_CHANNEL"))}65536<this._channel.bufferedAmount?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n},s.prototype._onFinish=function(){var e=this;function t(){setTimeout(function(){e.destroy()},1e3)}e.destroyed||(e._connected?t():e.once("connect",t))},s.prototype._startIceCompleteTimeout=function(){var e=this;e.destroyed||e._iceCompleteTimer||(e._debug("started iceComplete timeout"),e._iceCompleteTimer=setTimeout(function(){e._iceComplete||(e._iceComplete=!0,e._debug("iceComplete timeout completed"),e.emit("iceTimeout"),e.emit("_iceComplete"))},e.iceCompleteTimeout))},s.prototype._createOffer=function(){var n=this;n.destroyed||n._pc.createOffer(n.offerOptions).then(function(t){function e(){var e;n.destroyed||(e=n._pc.localDescription||t,n._debug("signal"),n.emit("signal",{type:e.type,sdp:e.sdp}))}n.destroyed||(n.trickle||n.allowHalfTrickle||(t.sdp=u(t.sdp)),t.sdp=n.sdpTransform(t.sdp),n._pc.setLocalDescription(t).then(function(){n._debug("createOffer success"),n.destroyed||(n.trickle||n._iceComplete?e():n.once("_iceComplete",e))}).catch(function(e){n.destroy(c(e,"ERR_SET_LOCAL_DESCRIPTION"))}))}).catch(function(e){n.destroy(c(e,"ERR_CREATE_OFFER"))})},s.prototype._requestMissingTransceivers=function(){var t=this;t._pc.getTransceivers&&t._pc.getTransceivers().forEach(function(e){e.mid||!e.sender.track||e.requested||(e.requested=!0,t.addTransceiver(e.sender.track.kind))})},s.prototype._createAnswer=function(){var n=this;n.destroyed||n._pc.createAnswer(n.answerOptions).then(function(t){function e(){var e;n.destroyed||(e=n._pc.localDescription||t,n._debug("signal"),n.emit("signal",{type:e.type,sdp:e.sdp}),n.initiator||n._requestMissingTransceivers())}n.destroyed||(n.trickle||n.allowHalfTrickle||(t.sdp=u(t.sdp)),t.sdp=n.sdpTransform(t.sdp),n._pc.setLocalDescription(t).then(function(){n.destroyed||(n.trickle||n._iceComplete?e():n.once("_iceComplete",e))}).catch(function(e){n.destroy(c(e,"ERR_SET_LOCAL_DESCRIPTION"))}))}).catch(function(e){n.destroy(c(e,"ERR_CREATE_ANSWER"))})},s.prototype._onIceStateChange=function(){var e,t;this.destroyed||(e=this._pc.iceConnectionState,t=this._pc.iceGatheringState,this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(c("Ice connection failed.","ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(c("Ice connection closed.","ERR_ICE_CONNECTION_CLOSED")))},s.prototype.getStats=function(n){var t=this;function i(t){return"[object Array]"===Object.prototype.toString.call(t.values)&&t.values.forEach(function(e){Object.assign(t,e)}),t}0===t._pc.getStats.length?t._pc.getStats().then(function(e){var t=[];e.forEach(function(e){t.push(i(e))}),n(null,t)},function(e){n(e)}):t._isReactNativeWebrtc?t._pc.getStats(null,function(e){var t=[];e.forEach(function(e){t.push(i(e))}),n(null,t)},function(e){n(e)}):0<t._pc.getStats.length?t._pc.getStats(function(e){var r;t.destroyed||(r=[],e.result().forEach(function(t){var n={};t.names().forEach(function(e){n[e]=t.stat(e)}),n.id=t.id,n.type=t.type,n.timestamp=t.timestamp,r.push(i(n))}),n(null,r))},function(e){n(e)}):n(null,[])},s.prototype._maybeReady=function(){var u=this;u._debug("maybeReady pc %s channel %s",u._pcReady,u._channelReady),!u._connected&&!u._connecting&&u._pcReady&&u._channelReady&&(u._connecting=!0,function s(){u.destroyed||u.getStats(function(e,t){if(!u.destroyed){e&&(t=[]);var n={},r={},i={},o=!1;if(t.forEach(function(e){"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(n[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(r[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(i[e.id]=e)}),t.forEach(function(e){"transport"===e.type&&e.selectedCandidatePairId&&a(i[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&a(e)}),o||Object.keys(i).length&&!Object.keys(r).length){if(u._connecting=!1,u._connected=!0,u._chunk){try{u.send(u._chunk)}catch(e){return u.destroy(c(e,"ERR_DATA_CHANNEL"))}u._chunk=null,u._debug('sent chunk from "write before connect"'),(0,u._cb)(u._cb=null)}"number"!=typeof u._channel.bufferedAmountLowThreshold&&(u._interval=setInterval(function(){u._onInterval()},150),u._interval.unref&&u._interval.unref()),u._debug("connect"),u.emit("connect")}else setTimeout(s,100)}function a(e){o=!0;var t=r[e.localCandidateId];t&&(t.ip||t.address)?(u.localAddress=t.ip||t.address,u.localPort=Number(t.port)):t&&t.ipAddress?(u.localAddress=t.ipAddress,u.localPort=Number(t.portNumber)):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),u.localAddress=t[0],u.localPort=Number(t[1])),u.localAddress&&(u.localFamily=u.localAddress.includes(":")?"IPv6":"IPv4");t=n[e.remoteCandidateId];t&&(t.ip||t.address)?(u.remoteAddress=t.ip||t.address,u.remotePort=Number(t.port)):t&&t.ipAddress?(u.remoteAddress=t.ipAddress,u.remotePort=Number(t.portNumber)):"string"==typeof e.googRemoteAddress&&(t=e.googRemoteAddress.split(":"),u.remoteAddress=t[0],u.remotePort=Number(t[1])),u.remoteAddress&&(u.remoteFamily=u.remoteAddress.includes(":")?"IPv6":"IPv4"),u._debug("connect local: %s:%s remote: %s:%s",u.localAddress,u.localPort,u.remoteAddress,u.remotePort)}})}())},s.prototype._onInterval=function(){!this._cb||!this._channel||65536<this._channel.bufferedAmount||this._onChannelBufferedAmountLow()},s.prototype._onSignalingStateChange=function(){var t=this;t.destroyed||("stable"!==t._pc.signalingState||t._firstStable||(t._isNegotiating=!1,t._debug("flushing sender queue",t._sendersAwaitingStable),t._sendersAwaitingStable.forEach(function(e){t._pc.removeTrack(e),t._queuedNegotiation=!0}),t._sendersAwaitingStable=[],t._queuedNegotiation&&(t._debug("flushing negotiation queue"),t._queuedNegotiation=!1,t._needsNegotiation()),t._debug("negotiate"),t.emit("negotiate")),t._firstStable=!1,t._debug("signalingStateChange %s",t._pc.signalingState),t.emit("signalingStateChange",t._pc.signalingState))},s.prototype._onIceCandidate=function(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())},s.prototype._onChannelMessage=function(e){this.destroyed||((e=e.data)instanceof ArrayBuffer&&(e=t.from(e)),this.push(e))},s.prototype._onChannelBufferedAmountLow=function(){!this.destroyed&&this._cb&&(this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount),(0,this._cb)(this._cb=null))},s.prototype._onChannelOpen=function(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())},s.prototype._onChannelClose=function(){this.destroyed||(this._debug("on channel close"),this.destroy())},s.prototype._onTrack=function(e){var n=this;n.destroyed||e.streams.forEach(function(t){n._debug("on track"),n.emit("track",e.track,t),n._remoteTracks.push({track:e.track,stream:t}),n._remoteStreams.some(function(e){return e.id===t.id})||(n._remoteStreams.push(t),setTimeout(function(){n.emit("stream",t)},0))})},s.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],n.apply(null,e)}}).call(this,l("buffer").Buffer)},{buffer:16,debug:"debug","get-browser-rtc":18,inherits:20,randombytes:24,"readable-stream":39}],45:[function(r,c,e){(function(i,t){var o=r("debug")("simple-websocket"),a=r("randombytes"),e=r("readable-stream"),s=r("ws"),u="function"!=typeof s?WebSocket:s,n=function(){_inherits(r,e.Duplex);var n=_createSuper(r);function r(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,r),"string"==typeof e&&(e={url:e}),t=n.call(this,e=Object.assign({allowHalfOpen:!1},e)),null==e.url&&null==e.socket)throw new Error("Missing required `url` or `socket` option");if(null!=e.url&&null!=e.socket)throw new Error("Must specify either `url` or `socket` option, not both");if(t._id=a(4).toString("hex").slice(0,7),t._debug("new websocket: %o",e),t.connected=!1,t.destroyed=!1,t._chunk=null,t._cb=null,t._interval=null,e.socket)t.url=e.socket.url,t._ws=e.socket,t.connected=e.socket.readyState===u.OPEN;else{t.url=e.url;try{t._ws="function"==typeof s?new u(e.url,e):new u(e.url)}catch(e){return _possibleConstructorReturn(t,void i.nextTick(function(){return t.destroy(e)}))}}return t._ws.binaryType="arraybuffer",t._ws.onopen=function(){t._onOpen()},t._ws.onmessage=function(e){t._onMessage(e)},t._ws.onclose=function(){t._onClose()},t._ws.onerror=function(){t.destroy(new Error("connection error to "+t.url))},t._onFinishBound=function(){t._onFinish()},t.once("finish",t._onFinishBound),_possibleConstructorReturn(t)}return _createClass(r,[{key:"send",value:function(e){this._ws.send(e)}},{key:"destroy",value:function(e){this._destroy(e,function(){})}},{key:"_destroy",value:function(e,t){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.connected=!1,this.destroyed=!0,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._ws){var n=this._ws,r=function(){n.onclose=null};if(n.readyState===u.CLOSED)r();else try{n.onclose=r,n.close()}catch(e){r()}n.onopen=null,n.onmessage=null,n.onerror=function(){}}var i;this._ws=null,e&&("undefined"!=typeof DOMException&&e instanceof DOMException&&(i=e.code,(e=new Error(e.message)).code=i),this.emit("error",e)),this.emit("close"),t()}}},{key:"_read",value:function(){}},{key:"_write",value:function(e,t,n){if(this.destroyed)return n(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(e){return this.destroy(e)}"function"!=typeof s&&65536<this._ws.bufferedAmount?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n}},{key:"_onFinish",value:function(){var e,t=this;this.destroyed||(e=function(){setTimeout(function(){return t.destroy()},1e3)},this.connected?e():this.once("connect",e))}},{key:"_onMessage",value:function(e){this.destroyed||((e=e.data)instanceof ArrayBuffer&&(e=t.from(e)),this.push(e))}},{key:"_onOpen",value:function(){var e=this;if(!this.connected&&!this.destroyed){if(this.connected=!0,this._chunk){try{this.send(this._chunk)}catch(e){return this.destroy(e)}this._chunk=null,this._debug('sent chunk from "write before connect"'),(0,this._cb)(this._cb=null)}"function"!=typeof s&&(this._interval=setInterval(function(){return e._onInterval()},150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}}},{key:"_onInterval",value:function(){!this._cb||!this._ws||65536<this._ws.bufferedAmount||(this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount),(0,this._cb)(this._cb=null))}},{key:"_onClose",value:function(){this.destroyed||(this._debug("on close"),this.destroy())}},{key:"_debug",value:function(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],o.apply(null,e)}}]),r}();n.WEBSOCKET_SUPPORT=!!u,c.exports=n}).call(this,r("_process"),r("buffer").Buffer)},{_process:23,buffer:16,debug:"debug",randombytes:24,"readable-stream":39,ws:15}],46:[function(e,t,n){var r=e("safe-buffer").Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=l,this.end=d,t=3;break;default:return this.write=f,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t,n,r=this.lastTotal-this.lastNeed,t=(t=this,128!=(192&(n=e)[0])?(t.lastNeed=0,"�"):1<t.lastNeed&&1<n.length?128!=(192&n[1])?(t.lastNeed=1,"�"):2<t.lastNeed&&2<n.length&&128!=(192&n[2])?(t.lastNeed=2,"�"):void 0:void 0);return void 0!==t?t:this.lastNeed<=e.length?(e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,r,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var n=e.toString("utf16le",t);if(n){t=n.charCodeAt(n.length-1);if(55296<=t&&t<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){e=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,e)}return t}function l(e,t){var n=(e.length-t)%3;return 0==n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}(n.StringDecoder=o).prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"�":e},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=a(t[r]);return 0<=i?(0<i&&(e.lastNeed=i-1),i):--r<n||-2===i?0:0<=(i=a(t[r]))?(0<i&&(e.lastNeed=i-2),i):!(--r<n||-2===i)&&0<=(i=a(t[r]))?(0<i&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;n=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":41}],47:[function(e,t,n){t.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],a=1;a<r;++a)o=i,t(i=e[a],o)&&(a!==n?e[n++]=i:n++);return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)i=r,(r=e[o])!==i&&(o!==t?e[t++]=r:t++);return e.length=t,e}(e))}},{}],48:[function(e,n,t){(function(t){function r(e){try{if(!t.localStorage)return}catch(e){return}e=t.localStorage[e];return null!=e&&"true"===String(e).toLowerCase()}n.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(e,t,n){t.exports=function e(i,t){if(i&&t)return e(i)(t);if("function"!=typeof i)throw new TypeError("need wrapper function");return Object.keys(i).forEach(function(e){n[e]=i[e]}),n;function n(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];var n=i.apply(this,e),r=e[e.length-1];return"function"==typeof n&&n!==r&&Object.keys(r).forEach(function(e){n[e]=r[e]}),n}}},{}],debug:[function(e,i,n){(function(t){n.log=function(){var e;return"object"==("undefined"==typeof console?"undefined":_typeof(console))&&console.log&&(e=console).log.apply(e,arguments)},n.formatArgs=function(e){var t,n,r;e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),this.useColors&&(t="color: "+this.color,e.splice(1,0,t,"color: inherit"),e[r=n=0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(r=n))}),e.splice(r,0,t))},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}},n.load=function(){var e;try{e=n.storage.getItem("debug")}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e},n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(e){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],i.exports=e("./common")(n),i.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,e("_process"))},{"./common":17,_process:23}],events:[function(e,t,n){var s=Object.create||function(e){function t(){}return t.prototype=e,new t},a=Object.keys||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return t},r=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function i(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=s(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((t.exports=i).EventEmitter=i).prototype._events=void 0,i.prototype._maxListeners=void 0;var o,u=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),o=0===c.x}catch(e){o=!1}function l(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return(i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener||n),i=e._events),o=i[t]):(i=e._events=s(null),e._eventsCount=0),o?("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(a=l(e))&&0<a&&o.length>a&&(o.warned=!0,(a=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.')).name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,"object"==("undefined"==typeof console?"undefined":_typeof(console))&&console.warn&&console.warn("%s: %s",a.name,a.message))):(o=i[t]=n,++e._eventsCount),e}function f(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function h(e,t,n){e={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},t=r.call(f,e);return t.listener=n,e.wrapFn=t}function p(e,t,n){e=e._events;if(!e)return[];t=e[t];return t?"function"==typeof t?n?[t.listener||t]:[t]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):m(t,t.length):[]}function g(e){var t=this._events;if(t){e=t[e];if("function"==typeof e)return 1;if(e)return e.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}o?Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');u=e}}):i.defaultMaxListeners=u,i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(e){var t,n,r,i,o,a,s="error"===e;if(a=this._events)s=s&&null==a.error;else if(!s)return!1;if(s){if(1<arguments.length&&(t=arguments[1]),t instanceof Error)throw t;s=new Error('Unhandled "error" event. ('+t+")");throw s.context=t,s}if(!(n=a[e]))return!1;var u="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t){if(u)e.call(t);else for(var n=e.length,r=m(e,n),i=0;i<n;++i)r[i].call(t)}(n,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=m(e,i),a=0;a<i;++a)o[a].call(n,r)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=m(e,o),s=0;s<o;++s)a[s].call(n,r,i)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=m(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];!function(e,t,n){if(u)e.apply(t,n);else for(var r=e.length,i=m(e,r),o=0;o<r;++o)i[o].apply(t,n)}(n,this,i)}return!0},i.prototype.on=i.prototype.addListener=function(e,t){return d(this,e,t,!1)},i.prototype.prependListener=function(e,t){return d(this,e,t,!0)},i.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,h(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,h(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=s(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;0<=o;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e){for(var t=i,n=t+1,r=e.length;n<r;t+=1,n+=1)e[t]=e[n];e.pop()}(n),1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=s(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=s(null):delete n[e]),this;if(0===arguments.length){for(var r,i=a(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=s(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},i.prototype.listeners=function(e){return p(this,e,!0)},i.prototype.rawListeners=function(e){return p(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},i.prototype.listenerCount=g,i.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],"p2p-media-loader-core":[function(e,t,n){function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),n.version="0.6.2",r(e("./loader-interface")),r(e("./hybrid-loader"))},{"./hybrid-loader":4,"./loader-interface":5}]},{},[2]);

"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],s=!0,o=!1;try{for(r=r.call(t);!(s=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);s=!0);}catch(t){o=!0,i=t}finally{try{s||null==r.return||r.return()}finally{if(o)throw i}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,e=function(){};return{s:e,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _regeneratorRuntime(){_regeneratorRuntime=function(){return s};var s={},t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",i=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,r){return t[e]=r}}function o(t,e,r,n){var i,a,s,o,e=e&&e.prototype instanceof f?e:f,e=Object.create(e.prototype),n=new S(n||[]);return e._invoke=(i=t,a=r,s=n,o="suspendedStart",function(t,e){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===t)throw e;return E()}for(s.method=t,s.arg=e;;){var r=s.delegate;if(r){var n=function t(e,r){var n=e.iterator[r.method];if(void 0===n){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method))return c;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}n=l(n,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,c;var n=n.arg;return n?n.done?(r[e.resultName]=n.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,c):n:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,c)}(r,s);if(n){if(n===c)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===o)throw o="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);o="executing";n=l(i,a,s);if("normal"===n.type){if(o=s.done?"completed":"suspendedYield",n.arg===c)continue;return{value:n.arg,done:s.done}}"throw"===n.type&&(o="completed",s.method="throw",s.arg=n.arg)}}),e}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}s.wrap=o;var c={};function f(){}function g(){}function d(){}var h={};a(h,n,function(){return this});e=Object.getPrototypeOf,e=e&&e(e(w([])));e&&e!==t&&u.call(e,n)&&(h=e);var p=d.prototype=f.prototype=Object.create(h);function m(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function y(s,o){var e;this._invoke=function(r,n){function t(){return new o(function(t,e){!function e(t,r,n,i){t=l(s[t],s,r);if("throw"!==t.type){var a=t.arg,r=a.value;return r&&"object"==_typeof(r)&&u.call(r,"__await")?o.resolve(r.__await).then(function(t){e("next",t,n,i)},function(t){e("throw",t,n,i)}):o.resolve(r).then(function(t){a.value=t,n(a)},function(t){return e("throw",t,n,i)})}i(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}}function v(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(v,this),this.reset(!0)}function w(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return t.next=t}}return{next:E}}function E(){return{value:void 0,done:!0}}return a(p,"constructor",g.prototype=d),a(d,"constructor",g),g.displayName=a(d,i,"GeneratorFunction"),s.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,i,"GeneratorFunction")),t.prototype=Object.create(p),t},s.awrap=function(t){return{__await:t}},m(y.prototype),a(y.prototype,r,function(){return this}),s.AsyncIterator=y,s.async=function(t,e,r,n,i){void 0===i&&(i=Promise);var a=new y(o(t,e,r,n),i);return s.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},m(p),a(p,i,"Generator"),a(p,n,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),s.keys=function(r){var t,n=[];for(t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},s.values=w,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return a.type="throw",a.arg=r,n.next=t,e&&(n.method="next",n.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=u.call(i,"catchLoc"),o=u.call(i,"finallyLoc");if(s&&o){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),b(r),c}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n,i=r.completion;return"throw"===i.type&&(n=i.arg,b(r)),n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:w(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},s}function asyncGeneratorStep(t,e,r,n,i,a,s){try{var o=t[a](s),u=o.value}catch(t){return void r(t)}o.done?e(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator(o){return function(){var t=this,s=arguments;return new Promise(function(e,r){var n=o.apply(t,s);function i(t){asyncGeneratorStep(n,e,r,i,a,"next",t)}function a(t){asyncGeneratorStep(n,e,r,i,a,"throw",t)}i(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}require=function n(i,a,s){function o(e,t){if(!a[e]){if(!i[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(u)return u(e,!0);r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r=a[e]={exports:{}};i[e][0].call(r.exports,function(t){return o(i[e][1][t]||t)},r,r.exports,n,i,a,s)}return a[e].exports}for(var u="function"==typeof require&&require,t=0;t<s.length;t++)o(s[t]);return o}({1:[function(t,e,r){window.p2pml||(window.p2pml={}),window.p2pml.hlsjs=t("p2p-media-loader-hlsjs")},{"p2p-media-loader-hlsjs":"p2p-media-loader-hlsjs"}],2:[function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0});var n=t("events"),a=t("p2p-media-loader-core"),s=t("./segment-manager"),i=t("./hlsjs-loader"),o=t("./hlsjs-loader-class");r.Engine=function(){_inherits(r,n.EventEmitter);var t,e=_createSuper(r);function r(){var i,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,r),(i=e.call(this)).loader=new a.HybridLoader(t.loader),i.segmentManager=new s.SegmentManager(i.loader,t.segments),Object.keys(a.Events).map(function(t){return a.Events[t]}).forEach(function(n){return i.loader.on(n,function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.emit.apply(i,[n].concat(e))})}),i}return _createClass(r,[{key:"createLoaderClass",value:function(){return o.createHlsJsLoaderClass(i.HlsJsLoader,this)}},{key:"destroy",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.segmentManager.destroy();case 2:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"getSettings",value:function(){return{segments:this.segmentManager.getSettings(),loader:this.loader.getSettings()}}},{key:"getDetails",value:function(){return{loader:this.loader.getDetails()}}},{key:"setPlayingSegment",value:function(t,e,r,n){this.segmentManager.setPlayingSegment(t,e,r,n)}},{key:"setPlayingSegmentByCurrentTime",value:function(t){this.segmentManager.setPlayingSegmentByCurrentTime(t)}}],[{key:"isSupported",value:function(){return a.HybridLoader.isSupported()}}]),r}()},{"./hlsjs-loader":4,"./hlsjs-loader-class":3,"./segment-manager":5,events:"events","p2p-media-loader-core":"p2p-media-loader-core"}],3:[function(t,e,r){e.exports.createHlsJsLoaderClass=function(t,e){function r(){this.impl=new t(e.segmentManager),this.stats=this.impl.stats}return r.prototype.load=function(t,e,r){this.context=t,this.impl.load(t,e,r)},r.prototype.abort=function(){this.impl.abort(this.context)},r.prototype.destroy=function(){this.context&&this.impl.abort(this.context)},r.getEngine=function(){return e},r}},{}],4:[function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0});r.HlsJsLoader=function(){function e(t){_classCallCheck(this,e),this.stats={},this.segmentManager=t}var n;return _createClass(e,[{key:"load",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,n){var i,a,s=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.type)return t.prev=1,t.next=4,this.segmentManager.loadPlaylist(e.url);t.next=13;break;case 4:i=t.sent,this.successPlaylist(i,e,n),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),this.error(t.t0,e,n);case 11:t.next=27;break;case 13:if(e.frag)return t.prev=14,t.next=17,this.segmentManager.loadSegment(e.url,null==e.rangeStart||null==e.rangeEnd?void 0:{offset:e.rangeStart,length:e.rangeEnd-e.rangeStart});t.next=26;break;case 17:void 0!==(a=t.sent).content&&setTimeout(function(){return s.successSegment(a.content,a.downloadBandwidth,e,n)},0),t.next=24;break;case 21:t.prev=21,t.t1=t.catch(14),setTimeout(function(){return s.error(t.t1,e,n)},0);case 24:t.next=27;break;case 26:console.warn("Unknown load request",e);case 27:case"end":return t.stop()}},t,this,[[1,8],[14,21]])})),function(t,e,r){return n.apply(this,arguments)})},{key:"abort",value:function(t){this.segmentManager.abortSegment(t.url,null==t.rangeStart||null==t.rangeEnd?void 0:{offset:t.rangeStart,length:t.rangeEnd-t.rangeStart})}},{key:"successPlaylist",value:function(t,e,r){var n=performance.now();this.stats.trequest=n-300,this.stats.tfirst=n-200,this.stats.tload=n,this.stats.loaded=t.response.length,r.onSuccess({url:t.responseURL,data:t.response},this.stats,e)}},{key:"successSegment",value:function(t,e,r,n){var i=performance.now(),e=t.byteLength/(void 0===e||e<=0?12500:e);this.stats.trequest=i-1-e,this.stats.tfirst=i-e,this.stats.tload=i,this.stats.loaded=t.byteLength,n.onSuccess({url:r.url,data:t},this.stats,r)}},{key:"error",value:function(t,e,r){r.onError(t,e)}}]),e}()},{}],5:[function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0});var s=t("p2p-media-loader-core"),f=t("m3u8-parser"),o={forwardSegmentCount:20,swarmId:void 0,assetsStorage:void 0};r.SegmentManager=function(){function n(t){var r=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,n),this.masterPlaylist=null,this.variantPlaylists=new Map,this.segmentRequest=null,this.playQueue=[],this.onSegmentLoaded=function(t){r.segmentRequest&&r.segmentRequest.segmentUrl===t.url&&p(r.segmentRequest.segmentByterange)===t.range&&(r.segmentRequest.onSuccess(t.data.slice(0),t.downloadBandwidth),r.segmentRequest=null)},this.onSegmentError=function(t,e){r.segmentRequest&&r.segmentRequest.segmentUrl===t.url&&p(r.segmentRequest.segmentByterange)===t.range&&(r.segmentRequest.onError(e),r.segmentRequest=null)},this.onSegmentAbort=function(t){r.segmentRequest&&r.segmentRequest.segmentUrl===t.url&&p(r.segmentRequest.segmentByterange)===t.range&&(r.segmentRequest.onError("Loading aborted: internal abort"),r.segmentRequest=null)},this.settings=Object.assign(Object.assign({},o),e),this.loader=t,this.loader.on(s.Events.SegmentLoaded,this.onSegmentLoaded),this.loader.on(s.Events.SegmentError,this.onSegmentError),this.loader.on(s.Events.SegmentAbort,this.onSegmentAbort)}var i,a,t,r,e;return _createClass(n,[{key:"getSettings",value:function(){return this.settings}},{key:"processPlaylist",value:function(t,e,r){var n=new f.Parser;n.push(e),n.end();var i=new g(t,r,n.manifest);if(i.manifest.playlists){this.masterPlaylist=i;var a=_createForOfIteratorHelper(this.variantPlaylists);try{for(a.s();!(c=a.n()).done;){var s=_slicedToArray(c.value,2),o=s[0],u=s[1],l=this.getStreamSwarmId(u.requestUrl),c=l.streamSwarmId,s=l.found,l=l.index;s?(u.streamSwarmId=c,u.streamId="V"+l.toString()):this.variantPlaylists.delete(o)}}catch(t){a.e(t)}finally{a.f()}}else{e=this.getStreamSwarmId(t),r=e.streamSwarmId,n=e.found,e=e.index;!n&&null!==this.masterPlaylist||(i.streamSwarmId=r,i.streamId=null===this.masterPlaylist?void 0:"V"+e.toString(),this.variantPlaylists.set(t,i),this.updateSegments())}}},{key:"loadPlaylist",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,i,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(r=this.settings.assetsStorage))return void 0===(i=this.getMasterSwarmId())&&(i=e.split("?")[0]),t.next=5,r.getAsset(e,void 0,i);t.next=16;break;case 5:if(void 0===(a=t.sent)){t.next=10;break}n={responseURL:a.responseUri,response:a.data},t.next=14;break;case 10:return t.next=12,this.loadContent(e,"text");case 12:n=t.sent,r.storeAsset({masterManifestUri:null!==this.masterPlaylist?this.masterPlaylist.requestUrl:e,masterSwarmId:i,requestUri:e,responseUri:n.responseURL,data:n.response});case 14:t.next=19;break;case 16:return t.next=18,this.loadContent(e,"text");case 18:n=t.sent;case 19:return t.abrupt("return",(this.processPlaylist(e,n.response,n.responseURL),n));case 20:case"end":return t.stop()}},t,this)})),function(t){return e.apply(this,arguments)})},{key:"loadSegment",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function t(n,i){var a,e,r,s,o,u,l,c,f,g=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=this.getSegmentLocation(n,i),e=p(i),a){t.next=22;break}if(void 0===(s=this.settings.assetsStorage)){t.next=17;break}if(u=null!==this.masterPlaylist?this.masterPlaylist.requestUrl:void 0,void 0===(o=this.getMasterSwarmId())&&1===this.variantPlaylists.size&&(o=this.variantPlaylists.values().next().value.requestUrl.split("?")[0]),void 0===u&&1===this.variantPlaylists.size&&(u=this.variantPlaylists.values().next().value.requestUrl),void 0!==o&&void 0!==u)return t.next=8,s.getAsset(n,e,o);t.next=17;break;case 8:if(void 0===(l=t.sent)){t.next=13;break}r=l.data,t.next=17;break;case 13:return t.next=15,this.loadContent(n,"arraybuffer",e);case 15:f=t.sent,r=f.response,s.storeAsset({masterManifestUri:u,masterSwarmId:o,requestUri:n,requestRange:e,responseUri:f.responseURL,data:r});case 17:if(void 0===r)return t.next=20,this.loadContent(n,"arraybuffer",e);t.next=21;break;case 20:r=t.sent.response;case 21:return t.abrupt("return",{content:r,downloadBandwidth:0});case 22:return c=(a.playlist.manifest.mediaSequence||0)+a.segmentIndex,0<this.playQueue.length&&this.playQueue[this.playQueue.length-1].segmentSequence!==c-1&&(this.playQueue=[]),this.segmentRequest&&this.segmentRequest.onError("Cancel segment request: simultaneous segment requests are not supported"),f=new Promise(function(r,e){g.segmentRequest=new d(n,i,c,a.playlist.requestUrl,function(t,e){return r({content:t,downloadBandwidth:e})},function(t){return e(t)})}),t.abrupt("return",(this.playQueue.push({segmentUrl:n,segmentByterange:i,segmentSequence:c}),this.loadSegments(a.playlist,a.segmentIndex,!0),f));case 27:case"end":return t.stop()}},t,this)})),function(t,e){return r.apply(this,arguments)})},{key:"setPlayingSegment",value:function(e,r,t,n){var i=this.playQueue.findIndex(function(t){return t.segmentUrl==e&&u(t.segmentByterange,r)});0<=i&&(this.playQueue=this.playQueue.slice(i),this.playQueue[0].playPosition={start:t,duration:n},this.updateSegments())}},{key:"setPlayingSegmentByCurrentTime",value:function(t){var e;0===this.playQueue.length||!this.playQueue[0].playPosition||(e=this.playQueue[0].playPosition).start+e.duration-t<.2&&(this.playQueue=this.playQueue.slice(1),this.updateSegments())}},{key:"abortSegment",value:function(t,e){this.segmentRequest&&this.segmentRequest.segmentUrl===t&&u(this.segmentRequest.segmentByterange,e)&&(this.segmentRequest.onSuccess(void 0,0),this.segmentRequest=null)}},{key:"destroy",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.segmentRequest&&(this.segmentRequest.onError("Loading aborted: object destroyed"),this.segmentRequest=null),this.masterPlaylist=null,this.variantPlaylists.clear(),this.playQueue=[],t.t0=void 0!==this.settings.assetsStorage,t.t0)return t.next=8,this.settings.assetsStorage.destroy();t.next=8;break;case 8:return t.next=10,this.loader.destroy();case 10:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"updateSegments",value:function(){var t;!this.segmentRequest||(t=this.getSegmentLocation(this.segmentRequest.segmentUrl,this.segmentRequest.segmentByterange))&&this.loadSegments(t.playlist,t.segmentIndex,!1)}},{key:"getSegmentLocation",value:function(t,e){var r=_createForOfIteratorHelper(this.variantPlaylists.values());try{for(r.s();!(i=r.n()).done;){var n=i.value,i=n.getSegmentIndex(t,e);if(0<=i)return{playlist:n,segmentIndex:i}}}catch(t){r.e(t)}finally{r.f()}}},{key:"loadSegments",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,n){var i,a,s,o,u,l,c,f,g,d,h;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=[],a=e.manifest.segments,s=e.manifest.mediaSequence||0,o=null,u=Math.max(0,this.playQueue.length-1),l=this.getMasterSwarmId(),c=r;c<a.length&&i.length<this.settings.forwardSegmentCount;++c)d=e.manifest.segments[c],f=e.getSegmentAbsoluteUrl(d.uri),g=d.byterange,d=this.getSegmentId(e,s+c),i.push({id:d,url:f,masterSwarmId:void 0!==l?l:e.streamSwarmId,masterManifestUri:(null!==this.masterPlaylist?this.masterPlaylist:e).requestUrl,streamId:e.streamId,sequence:(s+c).toString(),range:p(g),priority:u++}),n&&!o&&(o=d);if(this.loader.load(i,e.streamSwarmId),o)return t.next=7,this.loader.getSegment(o);t.next=9;break;case 7:(h=t.sent)&&this.onSegmentLoaded(h);case 9:case"end":return t.stop()}},t,this)})),function(t,e,r){return a.apply(this,arguments)})},{key:"getSegmentId",value:function(t,e){return"".concat(t.streamSwarmId,"+").concat(e)}},{key:"getMasterSwarmId",value:function(){var t=this.settings.swarmId&&0!==this.settings.swarmId.length?this.settings.swarmId:void 0;return void 0!==t?t:null!==this.masterPlaylist?this.masterPlaylist.requestUrl.split("?")[0]:void 0}},{key:"getStreamSwarmId",value:function(t){var e=this.getMasterSwarmId();if(null!==this.masterPlaylist)for(var r=0;r<this.masterPlaylist.manifest.playlists.length;++r)if(new URL(this.masterPlaylist.manifest.playlists[r].uri,this.masterPlaylist.responseUrl).toString()===t)return{streamSwarmId:"".concat(e,"+V").concat(r),found:!0,index:r};return{streamSwarmId:void 0!==e?e:t.split("?")[0],found:!1,index:-1}}},{key:"loadContent",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function t(i,a,s){var o=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,e){var r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType=a,s&&r.setRequestHeader("Range",s),r.addEventListener("readystatechange",function(){4===r.readyState&&(200<=r.status&&r.status<300?t(r):e(r.statusText))});var n=o.loader.getSettings().xhrSetup;n&&n(r,i),r.send()}));case 1:case"end":return t.stop()}},t)})),function(t,e,r){return i.apply(this,arguments)})}]),n}();var g=function(){function n(t,e,r){_classCallCheck(this,n),this.requestUrl=t,this.responseUrl=e,this.manifest=r,this.streamSwarmId=""}return _createClass(n,[{key:"getSegmentIndex",value:function(t,e){for(var r=0;r<this.manifest.segments.length;++r){var n=this.manifest.segments[r];if(t===this.getSegmentAbsoluteUrl(n.uri)&&u(n.byterange,e))return r}return-1}},{key:"getSegmentAbsoluteUrl",value:function(t){return new URL(t,this.responseUrl).toString()}}]),n}(),d=_createClass(function t(e,r,n,i,a,s){_classCallCheck(this,t),this.segmentUrl=e,this.segmentByterange=r,this.segmentSequence=n,this.playlistRequestUrl=i,this.onSuccess=a,this.onError=s});function u(t,e){return void 0===t?void 0===e:void 0!==e&&t.length===e.length&&t.offset===e.offset}function p(t){if(void 0!==t){var e=t.offset+t.length-1;return"bytes=".concat(t.offset,"-").concat(e)}}},{"m3u8-parser":7,"p2p-media-loader-core":"p2p-media-loader-core"}],6:[function(t,e,r){(function(t){t="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};e.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0});var f=(t=t("global/window"))&&"object"==_typeof(t)&&"default"in t?t.default:t;function g(){return(g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r,n=arguments[e];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function n(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function u(t){for(var e,r=t.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),n={},i=r.length;i--;)""!==r[i]&&((e=/([^=]*)=(.*)/.exec(r[i]).slice(1))[0]=e[0].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^['"](.*)['"]$/g,"$1"),n[e[0]]=e[1]);return n}var i,t=((t=s.prototype).on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},t.off=function(t,e){if(!this.listeners[t])return!1;e=this.listeners[t].indexOf(e);return this.listeners[t].splice(e,1),-1<e},t.trigger=function(t){var e,r,n,i=this.listeners[t];if(i)if(2===arguments.length)for(r=i.length,e=0;e<r;++e)i[e].call(this,arguments[1]);else for(n=Array.prototype.slice.call(arguments,1),r=i.length,e=0;e<r;++e)i[e].apply(this,n)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",function(t){e.push(t)})},s),d=(n(a,i=t),a.prototype.push=function(t){var e;for(this.buffer+=t,e=this.buffer.indexOf("\n");-1<e;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)},a),h=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}n(t,e);var r=t.prototype;return r.push=function(r){var a,s,o=this;0!==(r=r.trim()).length&&("#"===r[0]?this.tagMappers.reduce(function(t,e){e=e(r);return e===r?t:t.concat([e])},[r]).forEach(function(t){for(var e,r,n,i=0;i<o.customParsers.length;i++)if(o.customParsers[i].call(o,t))return;if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),a=/^#EXTM3U/.exec(t))o.trigger("data",{type:"tag",tagType:"m3u"});else{if(a=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return s={type:"tag",tagType:"inf"},a[1]&&(s.duration=parseFloat(a[1])),a[2]&&(s.title=a[2]),void o.trigger("data",s);if(a=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return s={type:"tag",tagType:"targetduration"},a[1]&&(s.duration=parseInt(a[1],10)),void o.trigger("data",s);if(a=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return s={type:"tag",tagType:"totalduration"},a[1]&&(s.duration=parseInt(a[1],10)),void o.trigger("data",s);if(a=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return s={type:"tag",tagType:"version"},a[1]&&(s.version=parseInt(a[1],10)),void o.trigger("data",s);if(a=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return s={type:"tag",tagType:"media-sequence"},a[1]&&(s.number=parseInt(a[1],10)),void o.trigger("data",s);if(a=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return s={type:"tag",tagType:"discontinuity-sequence"},a[1]&&(s.number=parseInt(a[1],10)),void o.trigger("data",s);if(a=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return s={type:"tag",tagType:"playlist-type"},a[1]&&(s.playlistType=a[1]),void o.trigger("data",s);if(a=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return s={type:"tag",tagType:"byterange"},a[1]&&(s.length=parseInt(a[1],10)),a[2]&&(s.offset=parseInt(a[2],10)),void o.trigger("data",s);if(a=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return s={type:"tag",tagType:"allow-cache"},a[1]&&(s.allowed=!/NO/.test(a[1])),void o.trigger("data",s);if(a=/^#EXT-X-MAP:?(.*)$/.exec(t))s={type:"tag",tagType:"map"},a[1]&&((e=u(a[1])).URI&&(s.uri=e.URI),e.BYTERANGE&&(n=(r=e.BYTERANGE.split("@"))[0],r=r[1],s.byterange={},n&&(s.byterange.length=parseInt(n,10)),r&&(s.byterange.offset=parseInt(r,10)))),o.trigger("data",s);else if(a=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t))s={type:"tag",tagType:"stream-inf"},a[1]&&(s.attributes=u(a[1]),s.attributes.RESOLUTION&&(n={},(r=s.attributes.RESOLUTION.split("x"))[0]&&(n.width=parseInt(r[0],10)),r[1]&&(n.height=parseInt(r[1],10)),s.attributes.RESOLUTION=n),s.attributes.BANDWIDTH&&(s.attributes.BANDWIDTH=parseInt(s.attributes.BANDWIDTH,10)),s.attributes["PROGRAM-ID"]&&(s.attributes["PROGRAM-ID"]=parseInt(s.attributes["PROGRAM-ID"],10))),o.trigger("data",s);else{if(a=/^#EXT-X-MEDIA:?(.*)$/.exec(t))return s={type:"tag",tagType:"media"},a[1]&&(s.attributes=u(a[1])),void o.trigger("data",s);if(a=/^#EXT-X-ENDLIST/.exec(t))o.trigger("data",{type:"tag",tagType:"endlist"});else{if(!(a=/^#EXT-X-DISCONTINUITY/.exec(t)))return(a=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t))?(s={type:"tag",tagType:"program-date-time"},a[1]&&(s.dateTimeString=a[1],s.dateTimeObject=new Date(a[1])),void o.trigger("data",s)):(a=/^#EXT-X-KEY:?(.*)$/.exec(t))?(s={type:"tag",tagType:"key"},a[1]&&(s.attributes=u(a[1]),s.attributes.IV&&("0x"===s.attributes.IV.substring(0,2).toLowerCase()&&(s.attributes.IV=s.attributes.IV.substring(2)),s.attributes.IV=s.attributes.IV.match(/.{8}/g),s.attributes.IV[0]=parseInt(s.attributes.IV[0],16),s.attributes.IV[1]=parseInt(s.attributes.IV[1],16),s.attributes.IV[2]=parseInt(s.attributes.IV[2],16),s.attributes.IV[3]=parseInt(s.attributes.IV[3],16),s.attributes.IV=new Uint32Array(s.attributes.IV))),void o.trigger("data",s)):(a=/^#EXT-X-START:?(.*)$/.exec(t))?(s={type:"tag",tagType:"start"},a[1]&&(s.attributes=u(a[1]),s.attributes["TIME-OFFSET"]=parseFloat(s.attributes["TIME-OFFSET"]),s.attributes.PRECISE=/YES/.test(s.attributes.PRECISE)),void o.trigger("data",s)):(a=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(t))?(s={type:"tag",tagType:"cue-out-cont"},a[1]?s.data=a[1]:s.data="",void o.trigger("data",s)):(a=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(t))?(s={type:"tag",tagType:"cue-out"},a[1]?s.data=a[1]:s.data="",void o.trigger("data",s)):(a=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t))?(s={type:"tag",tagType:"cue-in"},a[1]?s.data=a[1]:s.data="",void o.trigger("data",s)):void o.trigger("data",{type:"tag",data:t.slice(4)});o.trigger("data",{type:"tag",tagType:"discontinuity"})}}}else o.trigger("data",{type:"comment",text:t.slice(1)})}):this.trigger("data",{type:"uri",uri:r}))},r.addParser=function(t){var e=this,r=t.expression,n=t.customType,i=t.dataParser,a=t.segment;"function"!=typeof i&&(i=function(t){return t}),this.customParsers.push(function(t){if(r.exec(t))return e.trigger("data",{type:"custom",data:i(t),customType:n,segment:a}),!0})},r.addTagMapper=function(t){var e=t.expression,r=t.map;this.tagMappers.push(function(t){return e.test(t)?r(t):t})},t}(t);function a(){var t;return(t=i.call(this)||this).buffer="",t}function s(){this.listeners={}}t=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new d,t.parseStream=new h,t.lineStream.pipe(t.parseStream);var i,a,s=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t),o=[],u={},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c=0;return t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},t.parseStream.on("data",function(e){var r,n;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&((u.byterange=t).length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&((u.byterange=t).offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<e.duration&&(u.duration=e.duration),0===e.duration&&(u.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=o},key:function(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT)return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:function(t){for(var e=f.atob(t||""),r=new Uint8Array(e.length),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}(e.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(a.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else a=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,c=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){i={},e.uri&&(i.uri=e.uri),e.byterange&&(i.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=o,this.manifest.mediaGroups=this.manifest.mediaGroups||l,e.attributes?(u.attributes||(u.attributes={}),g(u.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){var t;this.manifest.mediaGroups=this.manifest.mediaGroups||l,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME?((t=this.manifest.mediaGroups[e.attributes.TYPE])[e.attributes["GROUP-ID"]]=t[e.attributes["GROUP-ID"]]||{},r=t[e.attributes["GROUP-ID"]],(n={default:/yes/i.test(e.attributes.DEFAULT)}).default?n.autoselect=!0:n.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(n.language=e.attributes.LANGUAGE),e.attributes.URI&&(n.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(n.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(n.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(n.forced=/yes/i.test(e.attributes.FORCED)),r[e.attributes.NAME]=n):this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){c+=1,u.discontinuity=!0,this.manifest.discontinuityStarts.push(o.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),u.dateTimeString=e.dateTimeString,u.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){u.cueOut=e.data},"cue-out-cont":function(){u.cueOutCont=e.data},"cue-in":function(){u.cueIn=e.data}}[e.tagType]||function(){}).call(s)},uri:function(){u.uri=e.uri,o.push(u),!this.manifest.targetDuration||"duration"in u||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),u.duration=this.manifest.targetDuration),a&&(u.key=a),u.timeline=c,i&&(u.map=i),u={}},comment:function(){},custom:function(){e.segment?(u.custom=u.custom||{},u.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(s)}),t}n(t,e);var r=t.prototype;return r.push=function(t){this.lineStream.push(t)},r.end=function(){this.lineStream.push("\n")},r.addParser=function(t){this.parseStream.addParser(t)},r.addTagMapper=function(t){this.parseStream.addTagMapper(t)},t}(t);r.LineStream=d,r.ParseStream=h,r.Parser=t},{"global/window":6}],"p2p-media-loader-hlsjs":[function(t,e,r){function n(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}function i(t){t&&t.config&&t.config.loader&&"function"==typeof t.config.loader.getEngine&&a(t,t.config.loader.getEngine())}function a(r,n){r.on("hlsFragChanged",function(t,e){var r=e.frag,e=2!==r.byteRange.length?void 0:{offset:r.byteRange[0],length:r.byteRange[1]-r.byteRange[0]};n.setPlayingSegment(r.url,e,r.start,r.duration)}),r.on("hlsDestroying",_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.destroy();case 2:case"end":return t.stop()}},t)}))),r.on("hlsError",function(t,e){"bufferStalledError"!==e.details||void 0!==(e=void 0===r.media?r.el_:r.media)&&n.setPlayingSegmentByCurrentTime(e.currentTime)})}Object.defineProperty(r,"__esModule",{value:!0}),r.version="0.6.2",n(t("./engine")),n(t("./segment-manager")),r.initHlsJsPlayer=i,r.initClapprPlayer=function(e){e.on("play",function(){var t=e.core.getCurrentPlayback();t._hls&&!t._hls._p2pm_linitialized&&(t._hls._p2pm_linitialized=!0,i(e.core.getCurrentPlayback()._hls))})},r.initFlowplayerHlsJsPlayer=function(t){t.on("ready",function(){return i(t.engine.hlsjs||t.engine.hls)})},r.initVideoJsContribHlsJsPlayer=function(e){e.ready(function(){var t=e.tech_.options_;t&&t.hlsjsConfig&&t.hlsjsConfig.loader&&"function"==typeof t.hlsjsConfig.loader.getEngine&&a(e.tech_,t.hlsjsConfig.loader.getEngine())})},r.initVideoJsHlsJsPlugin=function(){null!=videojs&&null!=videojs.Html5Hlsjs&&videojs.Html5Hlsjs.addHook("beforeinitialize",function(t,e){e.config&&e.config.loader&&"function"==typeof e.config.loader.getEngine&&a(e,e.config.loader.getEngine())})},r.initMediaElementJsPlayer=function(n){n.addEventListener("hlsFragChanged",function(t){var e,r=n.hlsPlayer;r&&r.config&&r.config.loader&&"function"==typeof r.config.loader.getEngine&&(e=r.config.loader.getEngine(),t.data&&1<t.data.length&&(t=2!==(r=t.data[1].frag).byteRange.length?void 0:{offset:r.byteRange[0],length:r.byteRange[1]-r.byteRange[0]},e.setPlayingSegment(r.url,t,r.start,r.duration)))}),n.addEventListener("hlsDestroying",_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((e=n.hlsPlayer)&&e.config&&e.config.loader&&"function"==typeof e.config.loader.getEngine)return e=e.config.loader.getEngine(),t.next=5,e.destroy();t.next=5;break;case 5:case"end":return t.stop()}},t)}))),n.addEventListener("hlsError",function(t){var e=n.hlsPlayer;e&&e.config&&e.config.loader&&"function"==typeof e.config.loader.getEngine&&void 0!==t.data&&"bufferStalledError"===t.data.details&&e.config.loader.getEngine().setPlayingSegmentByCurrentTime(e.media.currentTime)})},r.initJwPlayer=function(t,e){var r=setInterval(function(){t.hls&&t.hls.config&&(clearInterval(r),Object.assign(t.hls.config,e),i(t.hls))},200)}},{"./engine":2,"./segment-manager":5}]},{},[1]);

// hammer.js

/*! Hammer.JS - v2.0.8 - 2016-04-23
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e="DEPRECATED METHOD: "+c+"\n"+d+" AT \n";return function(){var c=new Error("get-stack-trace"),d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&la(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==oa?a.apply(b?b[0]||d:d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return a.indexOf(b)>-1}function q(a){return a.trim().split(/\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ma.length;){if(c=ma[g],e=c?c+f:b,e in a)return e;g++}return d}function v(){return ua++}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function y(a){var b,c=a.options.inputClass;return new(b=c?c:xa?M:ya?P:wa?R:L)(a,z)}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&Ea&&d-e===0,g=b&(Ga|Ha)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=ra(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=qa(j.x)>qa(j.y)?j.x:j.y,b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==Ea&&f.eventType!==Ga||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ha&&(i>Da||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=qa(l.x)>qa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:pa(a.pointers[c].clientX),clientY:pa(a.pointers[c].clientY)},c++;return{timeStamp:ra(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:pa(a[0].clientX),y:pa(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:pa(c/b),y:pa(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Ia:qa(a)>=qa(b)?0>a?Ja:Ka:0>b?La:Ma}function H(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function J(a,b){return I(b[1],b[0],Ra)+I(a[1],a[0],Ra)}function K(a,b){return H(b[0],b[1],Ra)/H(a[0],a[1],Ra)}function L(){this.evEl=Ta,this.evWin=Ua,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Xa,this.evWin=Ya,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=$a,this.evWin=_a,this.started=!1,x.apply(this,arguments)}function O(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Ga|Ha)&&(c=t(c.concat(d),"identifier",!0)),[c,d]}function P(){this.evTarget=bb,this.targetIds={},x.apply(this,arguments)}function Q(a,b){var c=s(a.touches),d=this.targetIds;if(b&(Ea|Fa)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===Ea)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ga|Ha)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),"identifier",!0),h]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,b){a&Ea?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Ga|Ha)&&T.call(this,b)}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches,e=function(){var a=d.indexOf(c);a>-1&&d.splice(a,1)};setTimeout(e,cb)}}function U(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(db>=f&&db>=g)return!0}return!1}function V(a,b){this.manager=a,this.set(b)}function W(a){if(p(a,jb))return jb;var b=p(a,kb),c=p(a,lb);return b&&c?jb:b||c?b?kb:lb:p(a,ib)?ib:hb}function X(){if(!fb)return!1;var b={},c=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(d){b[d]=c?a.CSS.supports("touch-action",d):!0}),b}function Y(a){this.options=la({},this.defaults,a||{}),this.id=v(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=nb,this.simultaneous={},this.requireFail=[]}function Z(a){return a&sb?"cancel":a&qb?"end":a&pb?"move":a&ob?"start":""}function $(a){return a==Ma?"down":a==La?"up":a==Ja?"left":a==Ka?"right":""}function _(a,b){var c=b.manager;return c?c.get(a):a}function aa(){Y.apply(this,arguments)}function ba(){aa.apply(this,arguments),this.pX=null,this.pY=null}function ca(){aa.apply(this,arguments)}function da(){Y.apply(this,arguments),this._timer=null,this._input=null}function ea(){aa.apply(this,arguments)}function fa(){aa.apply(this,arguments)}function ga(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ha(a,b){return b=b||{},b.recognizers=l(b.recognizers,ha.defaults.preset),new ia(a,b)}function ia(a,b){this.options=la({},ha.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=y(this),this.touchAction=new V(this,this.options.touchAction),ja(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ja(a,b){var c=a.element;if(c.style){var d;g(a.options.cssProps,function(e,f){d=u(c.style,f),b?(a.oldCssProps[d]=c.style[d],c.style[d]=e):c.style[d]=a.oldCssProps[d]||""}),b||(a.oldCssProps={})}}function ka(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var la,ma=["","webkit","Moz","MS","ms","o"],na=b.createElement("div"),oa="function",pa=Math.round,qa=Math.abs,ra=Date.now;la="function"!=typeof Object.assign?function(a){if(a===d||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}:Object.assign;var sa=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},"extend","Use `assign`."),ta=h(function(a,b){return sa(a,b,!0)},"merge","Use `assign`."),ua=1,va=/mobile|tablet|ip(ad|hone|od)|android/i,wa="ontouchstart"in a,xa=u(a,"PointerEvent")!==d,ya=wa&&va.test(navigator.userAgent),za="touch",Aa="pen",Ba="mouse",Ca="kinect",Da=25,Ea=1,Fa=2,Ga=4,Ha=8,Ia=1,Ja=2,Ka=4,La=8,Ma=16,Na=Ja|Ka,Oa=La|Ma,Pa=Na|Oa,Qa=["x","y"],Ra=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Sa={mousedown:Ea,mousemove:Fa,mouseup:Ga},Ta="mousedown",Ua="mousemove mouseup";i(L,x,{handler:function(a){var b=Sa[a.type];b&Ea&&0===a.button&&(this.pressed=!0),b&Fa&&1!==a.which&&(b=Ga),this.pressed&&(b&Ga&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:Ba,srcEvent:a}))}});var Va={pointerdown:Ea,pointermove:Fa,pointerup:Ga,pointercancel:Ha,pointerout:Ha},Wa={2:za,3:Aa,4:Ba,5:Ca},Xa="pointerdown",Ya="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Xa="MSPointerDown",Ya="MSPointerMove MSPointerUp MSPointerCancel"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Va[d],f=Wa[a.pointerType]||a.pointerType,g=f==za,h=r(b,a.pointerId,"pointerId");e&Ea&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ga|Ha)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Za={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},$a="touchstart",_a="touchstart touchmove touchend touchcancel";i(N,x,{handler:function(a){var b=Za[a.type];if(b===Ea&&(this.started=!0),this.started){var c=O.call(this,a,b);b&(Ga|Ha)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}}});var ab={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},bb="touchstart touchmove touchend touchcancel";i(P,x,{handler:function(a){var b=ab[a.type],c=Q.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}});var cb=2500,db=25;i(R,x,{handler:function(a,b,c){var d=c.pointerType==za,e=c.pointerType==Ba;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)S.call(this,b,c);else if(e&&U.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var eb=u(na.style,"touchAction"),fb=eb!==d,gb="compute",hb="auto",ib="manipulation",jb="none",kb="pan-x",lb="pan-y",mb=X();V.prototype={set:function(a){a==gb&&(a=this.compute()),fb&&this.manager.element.style&&mb[a]&&(this.manager.element.style[eb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),W(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=p(d,jb)&&!mb[jb],f=p(d,lb)&&!mb[lb],g=p(d,kb)&&!mb[kb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Na||g&&c&Oa?this.preventSrc(b):void 0},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var nb=1,ob=2,pb=4,qb=8,rb=qb,sb=16,tb=32;Y.prototype={defaults:{},set:function(a){return la(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=_(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=_(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=_(a,this),-1===r(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=_(a,this);var b=r(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;qb>d&&b(c.options.event+Z(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=qb&&b(c.options.event+Z(d))},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=tb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(tb|nb)))return!1;a++}return!0},recognize:function(a){var b=la({},a);return k(this.options.enable,[this,b])?(this.state&(rb|sb|tb)&&(this.state=nb),this.state=this.process(b),void(this.state&(ob|pb|qb|sb)&&this.tryEmit(b))):(this.reset(),void(this.state=tb))},process:function(a){},getTouchAction:function(){},reset:function(){}},i(aa,Y,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(ob|pb),e=this.attrTest(a);return d&&(c&Ha||!e)?b|sb:d||e?c&Ga?b|qb:b&ob?b|pb:ob:tb}}),i(ba,aa,{defaults:{event:"pan",threshold:10,pointers:1,direction:Pa},getTouchAction:function(){var a=this.options.direction,b=[];return a&Na&&b.push(lb),a&Oa&&b.push(kb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Na?(e=0===f?Ia:0>f?Ja:Ka,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ia:0>g?La:Ma,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return aa.prototype.attrTest.call(this,a)&&(this.state&ob||!(this.state&ob)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=$(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ca,aa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&ob)},emit:function(a){if(1!==a.scale){var b=a.scale<1?"in":"out";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(da,Y,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ga|Ha)&&!f)this.reset();else if(a.eventType&Ea)this.reset(),this._timer=e(function(){this.state=rb,this.tryEmit()},b.time,this);else if(a.eventType&Ga)return rb;return tb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===rb&&(a&&a.eventType&Ga?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=ra(),this.manager.emit(this.options.event,this._input)))}}),i(ea,aa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&ob)}}),i(fa,aa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Na|Oa,pointers:1},getTouchAction:function(){return ba.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Na|Oa)?b=a.overallVelocity:c&Na?b=a.overallVelocityX:c&Oa&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&qa(b)>this.options.velocity&&a.eventType&Ga},emit:function(a){var b=$(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(ga,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ib]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&Ea&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ga)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=rb,this.tryEmit()},b.interval,this),ob):rb}return tb},failTimeout:function(){return this._timer=e(function(){this.state=tb},this.options.interval,this),tb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==rb&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ha.VERSION="2.0.8",ha.defaults={domEvents:!1,touchAction:gb,enable:!0,inputTarget:null,inputClass:null,preset:[[ea,{enable:!1}],[ca,{enable:!1},["rotate"]],[fa,{direction:Na}],[ba,{direction:Na},["swipe"]],[ga],[ga,{event:"doubletap",taps:2},["tap"]],[da]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ub=1,vb=2;ia.prototype={set:function(a){return la(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?vb:ub},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&rb)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===vb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(ob|pb|qb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof Y)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a);-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ka(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},la(ha,{INPUT_START:Ea,INPUT_MOVE:Fa,INPUT_END:Ga,INPUT_CANCEL:Ha,STATE_POSSIBLE:nb,STATE_BEGAN:ob,STATE_CHANGED:pb,STATE_ENDED:qb,STATE_RECOGNIZED:rb,STATE_CANCELLED:sb,STATE_FAILED:tb,DIRECTION_NONE:Ia,DIRECTION_LEFT:Ja,DIRECTION_RIGHT:Ka,DIRECTION_UP:La,DIRECTION_DOWN:Ma,DIRECTION_HORIZONTAL:Na,DIRECTION_VERTICAL:Oa,DIRECTION_ALL:Pa,Manager:ia,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:Y,AttrRecognizer:aa,Tap:ga,Pan:ba,Swipe:fa,Pinch:ca,Rotate:ea,Press:da,on:m,off:n,each:g,merge:ta,extend:sa,assign:la,inherit:i,bindFn:j,prefixed:u});var wb="undefined"!=typeof a?a:"undefined"!=typeof self?self:{};wb.Hammer=ha,"function"==typeof define&&define.amd?define(function(){return ha}):"undefined"!=typeof module&&module.exports?module.exports=ha:a[c]=ha}(window,document,"Hammer");

!function(e){var t=$;"function"==typeof define&&define.amd?define(["jquery","hammerjs"],e):"object"==typeof exports?e(require("jquery"),require("hammerjs")):e(t,Hammer)}(function(n,a){var r;n.fn.hammer=function(r){return this.each(function(){var e,t;t=r,(e=n(e=this)).data("hammer")||e.data("hammer",new a(e[0],t))})},a.Manager.prototype.emit=(r=a.Manager.prototype.emit,function(e,t){r.call(this,e,t),n(this.element).trigger({type:e,gesture:t})})});



//pinchout

function createPinch(){var e,n,i,t,c,r=document.querySelector(".flowplayer"),a=new Hammer(r);a.get("pinch").set({enable:!0}),e=document.querySelector("video"),i=n=1,t="",c=e,a.on("pinch pinchend",function(e){return clearTimeout(touchHoldTimer),$(".flowplayer").hasClass("is-fullscreen")&&("pinch"==e.type&&(n=Math.max(.999,Math.min(i*e.scale,4))),"pinchend"==e.type&&(i=n),1!=n&&(stateVideoStyle=t="translate3d(0px,0px, 0) scale3d("+n+", "+n+", 1)"),t&&(c.style.webkitTransform=t)),!1}),createPinchFullscreenElement()}function createPinchFullscreenElement(){$(".fp-ui").after('<div class="fp-pinch-description"><div class="fp-pinch-anim"></div><div class="fp-pinch-description__text">Для изменения масштаба картинки, сделайте щипок двумя пальцами</div></div>')}function IsSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function hideAndShowPinchFsElement(){if(IsSafari())return!1;$(".fp-pinch-description").show(),setTimeout(function(){$(".fp-pinch-description").hide()},3e3)}

//touchhold

var touchHoldTimer;function functionTouchHold(){var e,t,o,i,n,r,l=document.querySelector(".fp-player"),d=flowplayer().video.duration,a=flowplayer().video.duration;function c(){e=$(".fp-player").outerWidth(),t=$(".fp-timeline").outerWidth(),i=t/e,n=d/e}c();var p=$(".fp-timeline").clone().addClass("fp-clone-timeline is-dragging"),u=$(".fp-timestamp").clone().addClass("fp-clone-timestamp"),f=p.find(".fp-progress");$timeline=$(".fp-timeline"),$timeStamp=$(".fp-timestamp");var h=0,m=0,s=0;function v(e){m<0&&(m=0),a<m&&(m=a),flowplayer().on("seek",function(){console.log("seeked"),p.remove(),u.remove()}),flowplayer().seek(m),document.removeEventListener("touchend",v),document.removeEventListener("touchmove",y)}function y(e){e=e.touches[0].pageX-h;flowplayer().showPanel();e=function(e){var t=o+e*i;t<0&&(t=0);r<t&&(t=r);(m=s+e*n)>flowplayer().video.duration&&(m=flowplayer().video.duration);return f.width(t),{time:m,pos:t}}(e);leftTS=e.pos+"px",$(".fp-clone-timestamp").css("left",leftTS);e=format(e.time);$(".fp-clone-timestamp").text(e)}return l.addEventListener("touchstart",function(t){return!$(t.target).closest(".fp-timeline").length&&void(1===t.touches.length&&(touchHoldTimer=setTimeout(function(){touchHoldTimer=null,$(".fp-touchhold-description").length||createTouchholdElement(),hideAndShowTouchholdElement(),p[0].style.zIndex="1002",u[0].style.display="block",u[0].style.zIndex="1002",$timeline.after(p),$timeStamp.after(u);var e=format(flowplayer().video.time);$(".fp-clone-timestamp").text(e),r=$(".fp-timeline").outerWidth(),s=flowplayer().video.time,o=$(".fp-progress").outerWidth(),h=t.touches[0].pageX,document.addEventListener("touchmove",y),document.addEventListener("touchend",v)},2e3)))}),l.addEventListener("touchend",function(){$(".fp-touchhold-description").hide(),clearTimeout(touchHoldTimer)}),c}function createTouchholdElement(){$(".fp-ui").after('<div class="fp-touchhold-description"><div class="fp-touchhold-anim"></div><div class="fp-touchhold-description__text">Чтобы перемотать видео вперед, проведите по экрану вправо,<br> а чтобы перемотать назад — влево</div></div>')}function hideAndShowTouchholdElement(){$(".fp-touchhold-description").show()}function format(e,t){e=Math.max(e||0,0),e=t?Math.ceil(e):Math.floor(e);var o=Math.floor(e/3600),t=Math.floor(e/60);return e-=60*t,1<=o?o+":"+zeropad(t-=60*o)+":"+zeropad(e):zeropad(t)+":"+zeropad(e)}function zeropad(e){return 10<=(e=parseInt(e,10))?e:"0"+e}

//v1


var refFrom;refFrom=$(".flowplayer").hasClass("is-playlist")?"2":"1";var xmlDoc,vastSkipTimer=0;function getParamFromString(e,t){var t=t,i=0,e=e.split("?")[1];return!(!e||!e.length)&&((e=e.split("&")).some(function(e){e=e.split("=");if(e[0]===t)return i=e[1],!0}),i)}function setParamFromString(e,i,t){var i=i,e=e,a=t,t="",n=e.split("?")[1];return!(!n||!n.length)&&((n=n.split("&")).some(function(e,t){e=e.split("=");if(e[0]===i)return e[1]=a,n[t]=e.join("="),!0}),t=n.join("&"),t=e.split("?")[0]+"?"+t)}var AdvPlayer=function(e,t,i){if(navigator.userAgent.match(/WebOS|Tizen|SmartTV\/6.0/i))throw"vast error";this.api=e,this.url=t,this.url1=i,this.video_play_2,this.timeline=document.getElementsByClassName("fp-timeline")[0],this.actPid=!1,this.preroll=!1,this.midroll=!1,this.postroll=!1,this.pauseroll=!1,this.prerollStart=!1,this.midrollStart=!1,this.postrollStart=!1,this.pauserollStart=!1,this.cnt=1,this.currentMidroll=0,this.readState=!1;var q=this;this.readVastFile=function(x,e){var w=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");w.open("GET",x,!0),w.timeout=3e3,w.withCredentials=!0;try{w.overrideMimeType("text/xml"),w.send(),w.ontimeout=function(e){console.log("timeout")},w.onreadystatechange=function(e){if(4==w.readyState)if(200!=w.status)console.error(w.status+": "+w.statusText,x),q.videoPlayerEnded("error");else if((xmlDoc=w.responseXML).getElementsByTagName("VAST").length&&xmlDoc.getElementsByTagName("Ad").length){var t={};if(0!==xmlDoc.getElementsByTagName("Wrapper").length){for(var i,a=xmlDoc.getElementsByTagName("VASTAdTagURI")[0].childNodes,n=0;a.length>n;n++)if(xmlDoc.getElementsByTagName("VASTAdTagURI")[0].childNodes[n].nodeValue.trim().length){a=xmlDoc.getElementsByTagName("VASTAdTagURI")[0].childNodes[n].nodeValue.trim();break}if(t.impression=[],null==(i=xmlDoc.getElementsByTagName("Impression")))return q.videoPlayerEnded("error"),!1;for(var r=0;i.length>r;r++)t.impression.push(i[r]);if(0===i.length)return q.videoPlayerEnded("error"),!1;try{t.adSystem=xmlDoc.getElementsByTagName("AdSystem")[0].textContent}catch(e){t.adSystem="empty"}for(var l,s,o=xmlDoc.getElementsByTagName("Creative"),d=0;d<o.length;d++){t.time="00:00:15";var c=t.time.split(":");if(t.time=60*+c[0]*60+60*+c[1]+ +c[2],null!=(v=o[d].getElementsByTagName("Linear")))for(var u=0;u<v.length;u++){if(null!=(y=v[u].getElementsByTagName("VideoClicks")))for(var g=0;g<y.length;g++)null!=(b=y[g].getElementsByTagName("ClickTracking"))&&(t.clickthrough_tracking=b);if(null!=(N=v[u].getElementsByTagName("TrackingEvents")))for(g=0;g<N.length;g++)null!=(A=N[g].getElementsByTagName("Tracking"))&&(h=A)}}(l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).open("GET",a,!1);try{w.withCredentials=!0}catch(e){}try{if(l.overrideMimeType("text/xml"),l.send(),null==(s=l.responseXML)||!s.getElementsByTagName("VAST").length||!s.getElementsByTagName("Ad").length)return console.log("!!!!!!!!WRAPPER Васт пустой, завершаем его проверку"),void q.videoPlayerEnded("error");var m,o=s.getElementsByTagName("Creative"),k=s.getElementsByTagName("Impression");if(null!=k)for(r=0;k.length>r;r++)t.impression.push(k[r]);for(d=0;d<o.length;d++)if(null!=(v=o[d].getElementsByTagName("Linear")))for(u=0;u<v.length;u++){try{t.adSystem=xmlDoc.getElementsByTagName("AdSystem")[0].textContent}catch(e){t.adSystem="empty"}if(null==(f=v[u].getElementsByTagName("MediaFiles")))return void q.videoPlayerEnded("error");for(g=0;g<f.length;g++)null!=(V=f[g].getElementsByTagName("MediaFile"))&&(p=V);try{if(null!=(y=v[u].getElementsByTagName("VideoClicks")))for(g=0;g<y.length;g++)null!=(B=y[g].getElementsByTagName("ClickThrough")[0].childNodes[0].nodeValue)&&(t.clickthrough_url=B)}catch(e){}if(null!=(E=v[u].getElementsByTagName("Duration")[0])&&(t.duration=E.childNodes[0].nodeValue,P=60*+(T=t.duration.split(":"))[0]*60+60*+T[1]+ +T[2],t.duration=P,t.duration<=t.time&&(t.time=t.time-1)),null!=(N=v[u].getElementsByTagName("TrackingEvents")))for(g=0;g<N.length;g++)null!=(A=N[g].getElementsByTagName("Tracking"))&&(m=A)}for(d=0;d<p.length;d++)for(var _=p[d].childNodes,n=0;_.length>n;n++)if(_[n].nodeValue.trim().length){t.media_file=_[n].nodeValue.trim();break}if(null!=h)for(d=0;d<h.length;d++)"start"==h[d].getAttribute("event")&&(null!=t.tracking_start?t.tracking_start+=" "+h[d].childNodes[0].nodeValue:t.tracking_start=h[d].childNodes[0].nodeValue,t.tracking_start_tracked=!1),"creativeView"==h[d].getAttribute("event")&&(null!=t.tracking_creativeView?t.tracking_creativeView+=" "+h[d].childNodes[0].nodeValue:t.tracking_creativeView=h[d].childNodes[0].nodeValue,t.tracking_creativeView_tracked=!1),"firstQuartile"==h[d].getAttribute("event")&&(null!=t.tracking_first_quartile?t.tracking_first_quartile+=" "+h[d].childNodes[0].nodeValue:t.tracking_first_quartile=h[d].childNodes[0].nodeValue,t.tracking_first_quartile_tracked=!1),"midpoint"==h[d].getAttribute("event")&&(null!=t.tracking_midpoint?t.tracking_midpoint+=" "+h[d].childNodes[0].nodeValue:t.tracking_midpoint=h[d].childNodes[0].nodeValue,t.tracking_midpoint_tracked=!1),"thirdQuartile"==h[d].getAttribute("event")&&(null!=t.tracking_third_quartile?t.tracking_third_quartile+=" "+h[d].childNodes[0].nodeValue:t.tracking_third_quartile=h[d].childNodes[0].nodeValue,t.tracking_third_quartile_tracked=!1),"complete"==h[d].getAttribute("event")&&(null!=t.tracking_complete?t.tracking_complete+=" "+h[d].childNodes[0].nodeValue:t.tracking_complete=h[d].childNodes[0].nodeValue,t.tracking_complete_tracked=!1),"mute"==h[d].getAttribute("event")&&(null!=t.tracking_mute?t.tracking_mute+=" "+h[d].childNodes[0].nodeValue:t.tracking_mute=h[d].childNodes[0].nodeValue,t.tracking_mute_tracked=!1),"unmute"==h[d].getAttribute("event")&&(null!=t.tracking_unmute?t.tracking_unmute+=" "+h[d].childNodes[0].nodeValue:t.tracking_unmute=h[d].childNodes[0].nodeValue,t.tracking_unmute_tracked=!1),"pause"==h[d].getAttribute("event")&&(null!=t.tracking_pause?t.tracking_pause+=" "+h[d].childNodes[0].nodeValue:t.tracking_pause=h[d].childNodes[0].nodeValue,t.tracking_pause_tracked=!1),"resume"==h[d].getAttribute("event")&&(null!=t.tracking_resume?t.tracking_resume+=" "+h[d].childNodes[0].nodeValue:t.tracking_resume=h[d].childNodes[0].nodeValue,t.tracking_resume_tracked=!1),"fullscreen"==h[d].getAttribute("event")&&(null!=t.tracking_fullscreen?t.tracking_fullscreen+=" "+h[d].childNodes[0].nodeValue:t.tracking_fullscreen=h[d].childNodes[0].nodeValue,t.tracking_fullscreen_tracked=!1),"skip"==h[d].getAttribute("event")&&(null!=t.tracking_skip?t.tracking_skip+=" "+h[d].childNodes[0].nodeValue:t.tracking_skip=h[d].childNodes[0].nodeValue,t.tracking_skip_tracked=!1),"close"==h[d].getAttribute("event")&&(null!=t.tracking_close?t.tracking_close+=" "+h[d].childNodes[0].nodeValue:t.tracking_close=h[d].childNodes[0].nodeValue,t.tracking_close_tracked=!1);if(null!=m)for(d=0;d<m.length;d++)"start"==m[d].getAttribute("event")&&(null!=t.tracking_start?t.tracking_start+=" "+m[d].childNodes[0].nodeValue:t.tracking_start=m[d].childNodes[0].nodeValue,t.tracking_start_tracked=!1),"creativeView"==m[d].getAttribute("event")&&(null!=t.tracking_creativeView?t.tracking_creativeView+=" "+m[d].childNodes[0].nodeValue:t.tracking_creativeView=m[d].childNodes[0].nodeValue,t.tracking_creativeView_tracked=!1),"firstQuartile"==m[d].getAttribute("event")&&(null!=t.tracking_first_quartile?t.tracking_first_quartile+=" "+m[d].childNodes[0].nodeValue:t.tracking_first_quartile=m[d].childNodes[0].nodeValue,t.tracking_first_quartile_tracked=!1),"midpoint"==m[d].getAttribute("event")&&(null!=t.tracking_midpoint?t.tracking_midpoint+=" "+m[d].childNodes[0].nodeValue:t.tracking_midpoint=m[d].childNodes[0].nodeValue,t.tracking_midpoint_tracked=!1),"thirdQuartile"==m[d].getAttribute("event")&&(null!=t.tracking_third_quartile?t.tracking_third_quartile+=" "+m[d].childNodes[0].nodeValue:t.tracking_third_quartile=m[d].childNodes[0].nodeValue,t.tracking_third_quartile_tracked=!1),"complete"==m[d].getAttribute("event")&&(null!=t.tracking_complete?t.tracking_complete+=" "+m[d].childNodes[0].nodeValue:t.tracking_complete=m[d].childNodes[0].nodeValue,t.tracking_complete_tracked=!1),"mute"==m[d].getAttribute("event")&&(null!=t.tracking_mute?t.tracking_mute+=" "+m[d].childNodes[0].nodeValue:t.tracking_mute=m[d].childNodes[0].nodeValue,t.tracking_mute_tracked=!1),"unmute"==m[d].getAttribute("event")&&(null!=t.tracking_unmute?t.tracking_unmute+=" "+m[d].childNodes[0].nodeValue:t.tracking_unmute=m[d].childNodes[0].nodeValue,t.tracking_unmute_tracked=!1),"pause"==m[d].getAttribute("event")&&(null!=t.tracking_pause?t.tracking_pause+=" "+m[d].childNodes[0].nodeValue:t.tracking_pause=m[d].childNodes[0].nodeValue,t.tracking_pause_tracked=!1),"resume"==m[d].getAttribute("event")&&(null!=t.tracking_resume?t.tracking_resume+=" "+m[d].childNodes[0].nodeValue:t.tracking_resume=m[d].childNodes[0].nodeValue,t.tracking_resume_tracked=!1),"fullscreen"==m[d].getAttribute("event")&&(null!=t.tracking_fullscreen?t.tracking_fullscreen+=" "+m[d].childNodes[0].nodeValue:t.tracking_fullscreen=m[d].childNodes[0].nodeValue,t.tracking_fullscreen_tracked=!1),"skip"==m[d].getAttribute("event")&&(null!=t.tracking_skip?t.tracking_skip+=" "+m[d].childNodes[0].nodeValue:t.tracking_skip=m[d].childNodes[0].nodeValue,t.tracking_skip_tracked=!1),"close"==m[d].getAttribute("event")&&(null!=t.tracking_close?t.tracking_close+=" "+m[d].childNodes[0].nodeValue:t.tracking_close=m[d].childNodes[0].nodeValue,t.tracking_close_tracked=!1)}catch(e){return console.log("skip ads VASTAdTagURI",e),q.videoPlayerEnded("error"),!1}}else{if(null==(i=xmlDoc.getElementsByTagName("Impression")))return q.videoPlayerEnded("error"),!1;t.impression=i,xmlDoc.getElementsByTagName("AdSystem")[0]&&xmlDoc.getElementsByTagName("AdSystem")[0].textContent&&(t.adSystem=xmlDoc.getElementsByTagName("AdSystem")[0].textContent),t.adSystem||(t.adSystem="other");for(var p,h,o=xmlDoc.getElementsByTagName("Creative"),d=0;d<o.length;d++){t.time=$(o[d].getElementsByTagName("Linear")).attr("skipoffset"),t.time||(t.time="00:00:15");var v,c=t.time.split(":");if(t.time=60*+c[0]*60+60*+c[1]+ +c[2],null!=(v=o[d].getElementsByTagName("Linear")))for(var f,u=0;u<v.length;u++){if(null==(f=v[u].getElementsByTagName("MediaFiles")))return void q.videoPlayerEnded("error");for(var V,y,N,E,T,P,g=0;g<f.length;g++)null!=(V=f[g].getElementsByTagName("MediaFile"))&&(p=V);if(null!=(y=v[u].getElementsByTagName("VideoClicks")))for(g=0;g<y.length;g++){var B=y[g].getElementsByTagName("ClickThrough")[0].childNodes[0].nodeValue,b=y[g].getElementsByTagName("ClickTracking");null!=B&&(t.clickthrough_url=B),null!=b&&(t.clickthrough_tracking=b)}if(null!=(N=v[u].getElementsByTagName("TrackingEvents")))for(var A,g=0;g<N.length;g++)null!=(A=N[g].getElementsByTagName("Tracking"))&&(h=A);null!=(E=v[u].getElementsByTagName("Duration")[0])&&(t.duration=E.childNodes[0].nodeValue,P=60*+(T=t.duration.split(":"))[0]*60+60*+T[1]+ +T[2],t.duration=P,t.duration<=t.time&&(t.time=t.duration-1),console.log("vast skip : "+t.time),console.log("vast duration : "+t.duration))}}for(d=0;d<p.length;d++)for(var S=0;p[d].childNodes.length>S;S++)if(p[d].childNodes[S].nodeValue.trim().length){t.media_file=p[d].childNodes[S].nodeValue;break}if(!t.media_file)return console.log("self.videoPlayerEnded"),q.videoPlayerEnded("error"),!1;if(null!=h)for(d=0;d<h.length;d++)"start"==h[d].getAttribute("event")&&(null!=t.tracking_start?t.tracking_start+=" "+h[d].childNodes[0].nodeValue:t.tracking_start=h[d].childNodes[0].nodeValue,t.tracking_start_tracked=!1),"creativeView"==h[d].getAttribute("event")&&(null!=t.tracking_creativeView?t.tracking_creativeView+=" "+h[d].childNodes[0].nodeValue:t.tracking_creativeView=h[d].childNodes[0].nodeValue,t.tracking_creativeView_tracked=!1),"firstQuartile"==h[d].getAttribute("event")&&(null!=t.tracking_first_quartile?t.tracking_first_quartile+=" "+h[d].childNodes[0].nodeValue:t.tracking_first_quartile=h[d].childNodes[0].nodeValue,t.tracking_first_quartile_tracked=!1),"midpoint"==h[d].getAttribute("event")&&(null!=t.tracking_midpoint?t.tracking_midpoint+=" "+h[d].childNodes[0].nodeValue:t.tracking_midpoint=h[d].childNodes[0].nodeValue,t.tracking_midpoint_tracked=!1),"thirdQuartile"==h[d].getAttribute("event")&&(null!=t.tracking_third_quartile?t.tracking_third_quartile+=" "+h[d].childNodes[0].nodeValue:t.tracking_third_quartile=h[d].childNodes[0].nodeValue,t.tracking_third_quartile_tracked=!1),"complete"==h[d].getAttribute("event")&&(null!=t.tracking_complete?t.tracking_complete+=" "+h[d].childNodes[0].nodeValue:t.tracking_complete=h[d].childNodes[0].nodeValue,t.tracking_complete_tracked=!1),"mute"==h[d].getAttribute("event")&&(null!=t.tracking_mute?t.tracking_mute+=" "+h[d].childNodes[0].nodeValue:t.tracking_mute=h[d].childNodes[0].nodeValue,t.tracking_mute_tracked=!1),"unmute"==h[d].getAttribute("event")&&(null!=t.tracking_unmute?t.tracking_unmute+=" "+h[d].childNodes[0].nodeValue:t.tracking_unmute=h[d].childNodes[0].nodeValue,t.tracking_unmute_tracked=!1),"pause"==h[d].getAttribute("event")&&(null!=t.tracking_pause?t.tracking_pause+=" "+h[d].childNodes[0].nodeValue:t.tracking_pause=h[d].childNodes[0].nodeValue,t.tracking_pause_tracked=!1),"resume"==h[d].getAttribute("event")&&(null!=t.tracking_resume?t.tracking_resume+=" "+h[d].childNodes[0].nodeValue:t.tracking_resume=h[d].childNodes[0].nodeValue,t.tracking_resume_tracked=!1),"fullscreen"==h[d].getAttribute("event")&&(null!=t.tracking_fullscreen?t.tracking_fullscreen+=" "+h[d].childNodes[0].nodeValue:t.tracking_fullscreen=h[d].childNodes[0].nodeValue,t.tracking_fullscreen_tracked=!1),"skip"==h[d].getAttribute("event")&&(null!=t.tracking_skip?t.tracking_skip+=" "+h[d].childNodes[0].nodeValue:t.tracking_skip=h[d].childNodes[0].nodeValue,t.tracking_skip_tracked=!1),"close"==h[d].getAttribute("event")&&(null!=t.tracking_close?t.tracking_close+=" "+h[d].childNodes[0].nodeValue:t.tracking_close=h[d].childNodes[0].nodeValue,t.tracking_close_tracked=!1)}q.Vast=t,q.afterReadVast(q.Vast)}else q.videoPlayerEnded("error")}}catch(e){return console.log("ad reading error "+e),q.videoPlayerEnded("error"),!1}},this.pauseGeneratePlayer=function(){},this.addPixel=function(e){new Image(1,1).src=e},this.videoPlayerTimeupdate=function(e){var t=Math.floor(q.Video.currentTime);if(void 0===q.Vast.tracking_start_tracked){if(0==t){if(!q.Vast.tracking_impressionSended&&"string"!=typeof q.Vast){for(var i=0;q.Vast.impression.length>i;i++)(new Image).src=q.Vast.impression[i].textContent;q.Vast.tracking_impressionSended=!0}if(!1===q.Vast.tracking_creativeView_tracked){if(null!=q.Vast.tracking_creativeView)for(var a=q.Vast.tracking_creativeView.split(" "),i=0;i<a.length;i++)q.addPixel(a[i]);q.Vast.tracking_creativeView_tracked=!0}}}else if(0==t&&0==q.Vast.tracking_start_tracked){if(null!=q.Vast.tracking_start){for(i=0;q.Vast.impression.length>i;i++)(new Image).src=q.Vast.impression[i].textContent;if(!(q.Vast.tracking_impressionSended=!0)===q.Vast.tracking_creativeView_tracked){if(null!=q.Vast.tracking_creativeView)for(a=q.Vast.tracking_creativeView.split(" "),i=0;i<a.length;i++)q.addPixel(a[i]);q.Vast.tracking_creativeView_tracked=!0}for(var n=q.Vast.tracking_start.split(" "),i=0;i<n.length;i++)(new Image).src=n[i]}q.Vast.tracking_start_tracked=!0}if(t>Math.floor(q.Video.duration/4)&&!1===q.Vast.tracking_first_quartile_tracked){if(null!=q.Vast.tracking_first_quartile)for(n=q.Vast.tracking_first_quartile.split(" "),i=0;i<n.length;i++)q.addPixel(n[i]);q.Vast.tracking_first_quartile_tracked=!0}if(t>Math.floor(q.Video.duration/2)&&!1===q.Vast.tracking_midpoint_tracked){if(null!=q.Vast.tracking_midpoint)for(n=q.Vast.tracking_midpoint.split(" "),i=0;i<n.length;i++)q.addPixel(n[i]);q.Vast.tracking_midpoint_tracked=!0}if(t>Math.floor(q.Video.duration/2)+Math.floor(q.Video.duration/4)&&!1===q.Vast.tracking_third_quartile_tracked){if(null!=q.Vast.tracking_third_quartile)for(n=q.Vast.tracking_third_quartile.split(" "),i=0;i<n.length;i++)q.addPixel(n[i]);q.Vast.tracking_third_quartile_tracked=!0}if(t>=Math.floor(q.Video.duration-1)&&!1===q.Vast.tracking_complete_tracked){if(null!=q.Vast.tracking_complete)for(n=q.Vast.tracking_complete.split(" "),i=0;i<n.length;i++)q.addPixel(n[i]);q.Vast.tracking_complete_tracked=!0}},this.setSrcVideoPlayer=function(e){".js"!=e.slice(-3)?this.Video.src=e:q.videoPlayerEnded()},this.videoPlayerEnded=function(e){$(".flowplayer").removeClass("is-ad-visible"),q.removeAllEventListeners(q.Video),q.preroll&&!1===q.prerollStart?q.prerollStart=!0:!0===q.prerollStart&&!1!==q.midroll&&q.midrollStart[q.currentMidroll]&&(q.midrollStart[q.currentMidroll]=!0,q.currentMidroll++),q.actPid=!1,q.Vast="",document.querySelector("div.fp-eng")&&(document.querySelector("div.fp-eng").remove(),"next"!=e?"error"==e&&(q.readState="error",q.cnt<=1)||(e=$("video.fp-engine")[0],$(".flowplayer").hasClass("is-playlist")?serials.firstRun?(q.api.play(1),e.play(),serials.firstRun=!1):e.play():(q.api.play(),e.play()),q.api.mute(!1)):q.createPlayer(q.url))},this.startSkip=!1,this.multiRoll=function(){return getParamFromString(q.url,"count")>q.cnt?(q.cnt++,q.videoPlayerEnded("next"),$(".vast-pagin span").text(q.cnt),!1):q.url1&&"string"==typeof q.url1?(q.cnt++,q.url=q.url1,q.url1=!1,q.videoPlayerEnded("next"),$(".vast-pagin span").text(2),!1):(console.log("stop vast, start vpaid"),!0)},this.skipTimer=function(e){document.getElementById("skip").style.display="block",document.getElementById("ads-skip-timer").style.display="none",document.getElementById("close_button").style.display="none",document.getElementById("vast_time").innerText=e,e--,vastSkipTimer=setInterval(function(){var i,a;!(q.startSkip=!0)!==q.startSkip&&(q.pauseGeneratePlayer(),0<e?(document.getElementById("vast_time").innerText=e,e--):(document.getElementById("skip").style.display="none",(i=document.getElementById("close_button")).style.display="block",(a=document.getElementById("ads-skip-timer")).style.display="block",i.onclick=function(){if(!1===q.Vast.tracking_close_tracked){if(null!=q.Vast.tracking_close)for(var e=q.Vast.tracking_close.split(" "),t=0;t<e.length;t++)q.addPixel(e[t]);q.Vast.tracking_close_tracked=!0}return q.multiRoll()&&q.videoPlayerEnded(),i.onclick=null,!1},a.onclick=function(){if(!1===q.Vast.tracking_skip_tracked){if(null!=q.Vast.tracking_skip)for(var e=q.Vast.tracking_skip.split(" "),t=0;t<e.length;t++)q.addPixel(e[t]);q.Vast.tracking_skip_tracked=!0}return q.multiRoll()&&q.videoPlayerEnded(),a.onclick=null,!1},clearInterval(vastSkipTimer)))},1e3)},this.removeAllEventListeners=function(e){if(void 0!==e._eventListeners&&0!=e._eventListeners.length){for(var t=0,i=e._eventListeners.length;t<i;t++){var a=e._eventListeners[t];e.removeEventListener(a.event,a.callback)}e._eventListeners=[]}},this.videoPlayerMute=function(e){var t=document.getElementsByClassName("adv_volume")[0];if("mute"==t.classList[1]){if(q.Video.muted=!1,$(t).removeClass("mute").addClass("volume_on"),!1===q.Vast.tracking_mute_tracked){if(null!=q.Vast.tracking_mute)for(var i=q.Vast.tracking_mute.split(" "),a=0;a<i.length;a++)q.addPixel(i[a]);q.Vast.tracking_mute_tracked=!0}}else if(q.Video.muted=!0,$(t).removeClass("volume_on").addClass("mute"),!1===q.Vast.tracking_unmute_tracked){if(null!=q.Vast.tracking_unmute)for(i=q.Vast.tracking_unmute.split(" "),a=0;a<i.length;a++)q.addPixel(i[a]);q.Vast.tracking_unmute_tracked=!0}},this.playAdPlayer=function(e,t){!0===q.Video.paused?(q.Video.play(),q.PlayerBlock.className=""):(q.Video.pause(),q.PlayerBlock.className="Play",q.pauseBool=!0)},this.timeQuartile=function(e){var t=q.api.video.duration;return-1<e.indexOf("/")?t/(e=e.replace("/","")):"firstQuartile"==e?Math.floor(t/4):"midpoint"==e?Math.floor(t/2):"thirdQuartile"==e?Math.floor(t/2)+Math.floor(t/4):void 0},this.createHTMLPlayer=function(){var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("span"),a=document.createElement("a"),n=document.createElement("div"),r=document.createElement("div"),l=document.createElement("div"),s=document.createElement("video"),o=document.createElement("div");Engine=document.createElement("div"),e.className="skip_adv skip_adv_referer",t.className="skip_block",t.id="adcblock",a.className="adv_volume volume_on",n.className="skip_button_volume",l.id="close_button",Engine.className="fp-eng fp-eng2",(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&(r.className="Play");var d=getParamFromString(q.url,"count");d&&1<d&&(Pagination=document.createElement("div"),Pagination.className="vast-pagin",Pagination.innerHTML="<i class='vast-pagin-label'></i> <span>1</span><i class='vast-pagin-sepr'></i>"+d,o.insertBefore(Pagination,null)),(q.url1&&"string"==typeof q.url1||!1===q.url1)&&(Pagination=document.createElement("div"),Pagination.className="vast-pagin",Pagination.innerHTML="Реклама <span>1</span>/2",o.insertBefore(Pagination,null)),r.id="PlayerBlock",e.innerHTML="<div style='display:none' id='ads-skip-timer'>"+vastSkipTxt.but+"</div><div style='display:none' class='icon'></div><div id='skip'>"+vastSkipTxt.main+" <span id='vast_time'>15</span> "+vastSkipTxt.timeLabel+"</div>",i.innerText="",n.innerText="",s.id="video_play_2",s.setAttribute("autoplay","autoplay"),s.setAttribute("preload","auto"),s.setAttribute("playsinline","true"),s.setAttribute("webkit-playsinline","true"),s.setAttribute("type","video/mp4"),s.style.backgroundColor="rgb(0, 0, 0)",s.style.position="absolute",s.style.width="100%",s.style.height="100%",s.style.left="0",s.src="",s.volume=.2,o.style.position="absolute",o.style.width="100%",o.style.height="100%",o.style.top="0",o.style.zIndex="9999",o.onclick=function(e){e.preventDefault(),e.stopPropagation()},e.setAttribute("target","_blank"),e.setAttribute("href","#"),t.insertBefore(e,null),a.insertBefore(i,null),n.insertBefore(a,null),r.insertBefore(s,null),o.insertBefore(l,null),o.insertBefore(n,null),o.insertBefore(t,null),o.insertBefore(r,null),Engine.insertBefore(o,null),this.Video=s,this.MuteButton=n,this.SkipButton=t,this.CloseButton=l,this.PlayerBlock=r,this.AdsBlock=o,this.Engine=Engine,delete e,delete t,delete l,delete i,delete a,delete n,delete r,delete s,document.getElementById("fp-player").insertBefore(this.Engine,null)},this.addClickthrough=function(){if(!1===q.Video.paused&&(window.open(q.Vast.clickthrough_url),null!=q.Vast.clickthrough_tracking))for(var e=0;e<q.Vast.clickthrough_tracking.length;e++)for(var t=q.Vast.clickthrough_tracking[e].childNodes,i=0;t.length>i;i++)if(t[i].nodeValue.trim().length){var a=t[i].nodeValue.trim();q.addPixel(a);break}},this.eventResume=function(){if(!1===q.Vast.tracking_resume_tracked){if(null!=q.Vast.tracking_resume)for(var e=q.Vast.tracking_resume.split(" "),t=0;t<e.length;t++)q.addPixel(e[t]);q.Vast.tracking_resume_tracked=!0}q.Video.removeEventListener("resume",q.eventResume)},this.eventPause=function(){if(!1===q.Vast.tracking_pause_tracked){if(null!=q.Vast.tracking_pause)for(var e=q.Vast.tracking_pause.split(" "),t=0;t<e.length;t++)q.addPixel(e[t]);q.Vast.tracking_pause_tracked=!0}q.Video.removeEventListener("pause",q.eventPause)},this.httpBuildQuery=function(e,t,i){var a,n,r,l=0,s=[];for(a in i=i||"&",e)""===e[a]&&"referer"==a||(r=escape(a),null!=e[a]?(n=(n=escape(e[a].toString())).replace(/%20/g,"+"),t&&!isNaN(a)&&(r=t+l),s[l]=r+"="+n):console.error("Ошибка при отправке статистики"),l++);return s.join(i)},this.config={},this.sendStat=function(){var e=$(".flowplayer"),t=$("meta[name=csrf-token]").attr("content"),i=document.referrer,a=q.config;a.partners=e.data("config").partners,a.adSystem=q.Vast.adSystem,a.adSystem||(a.adSystem="other"),"number"==typeof a.adSystem&&(a.adSystem=a.adSystem+"");var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.open("POST","/stat_ads",!0),console.log("sendstat"),i.trim(),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.adSystem=a.adSystem.replace("<![CDATA[","").replace("]]>","");try{localStorage.getItem("lcounter"),sessionStorage.getItem("counter")}catch(e){0}console.log(i),n.send(q.httpBuildQuery({player_type:refFrom,jsReferer:i,adSystem:a.adSystem,token:t,ancestororigins:ancestorOrig,request_full:e.data("requestfull"),type:"vast"})),delete n},this.adSkip=function(){if(!1===q.Vast.tracking_close_tracked){if(null!=q.Vast.tracking_close)for(var e=q.Vast.tracking_close.split(" "),t=0;t<e.length;t++)q.addPixel(e[t]);q.Vast.tracking_close_tracked=!0}q.multiRoll()&&q.videoPlayerEnded()},this.pauseBool=!1,this.playRoll=function(e){q.pauseGeneratePlayer();var n=this;document.querySelector("div.fp-eng").style.display="",document.getElementsByClassName("flowplayer")[0].classList.add("is-ad-visible"),this.readVastFile(e,{media_type:"video/mp4",media_bitrate_min:0,media_bitrate_max:9999}),q.afterReadVast=function(){if(q.Vast&&!1!==q.Vast&&void 0!==q.Vast){if(0===Object.keys(q.Vast).length)return q.videoPlayerEnded("error"),!1;n.setSrcVideoPlayer(q.Vast.media_file),n.skipTimer(q.Vast.time),document.getElementById("video_play_2").play();var e=0;document.getElementById("video_play_2").addEventListener("playing",function(){e<=1&&(e<1?e++:q.startSkip=!0)}),q.Video.addEventListener("pause",function(){if(!(q.PlayerBlock.className="Play")===q.pauseBool){q.pauseBool=!0;try{document.getElementById("video_play_2").play(),console.log("Vast video available")}catch(e){console.log(e),null!=document.getElementById("video_play_2")&&(console.error("Vast video not available"),q.videoPlayerEnded("error"))}}}),q.Video.addEventListener("play",function(){!0===q.Video.paused?q.PlayerBlock.className="Play":q.PlayerBlock.className=""});var t;q.Video;document.addEventListener("visibilitychange",function(){"hidden"==document.visibilityState||$(".flowplayer").hasClass("is-ad-visible")&&(document.getElementById("video_play_2").play(),q.PlayerBlock.className="",q.pauseBool=!1)},!1),!0===q.Video.muted&&(t=document.getElementsByClassName("adv_volume")[0],q.Video.muted=!1,$(t).removeClass("mute").addClass("volume_on"));try{void 0===localStorage.getItem("volume")||null===localStorage.getItem("volume")?("adbetnet"==q.Vast.adSystem?q.Video.volume=.25:q.Video.volume=.5,q.Video.muted=!1):(q.Vast.adSystem,q.Video.volume=.5*Number(localStorage.getItem("volume")),"true"==localStorage.getItem("muted")?q.Video.muted=!0:q.Video.muted=!1)}catch(e){console.log(e)}q.sendStat(),q.videoPlayerTimeupdate();var i=0,a=setInterval(function(){q.videoPlayerTimeupdate(),q.Video.time-1<i&&clearInterval(a),i++},1e3);q.Video.addEventListener("pause",q.eventPause),q.Video.addEventListener("resume",q.eventResume),this.Video.addEventListener("click",q.addClickthrough),q.Video.addEventListener("ended",q.adSkip),q.readState=!0}else q.videoPlayerEnded("error")}},this.convertTime=function(e){var t=q.api.video.duration;return 100+(e-t)/t*100},this.creatTimeStamps=function(e){$(q.timeline).append('<div style="height: 100%; width: 2px; background: gold; z-index: 99; left: '+q.convertTime(e)+'%" ></div>',null)},this.createPlayer=function(e){if(!("undefined"==typeof adblock&&t.indexOf("z.cdn.trafficbass.com")<0)&&""!=e&&null!=e&&void 0!==e){if(q.pauseGeneratePlayer(),q.createHTMLPlayer(),void 0!==e&&"string"==typeof e&&!1===q.actPid){if(q.preroll=e||e.ads.preroll,!1===this.playRoll(q.preroll))return q.Vast="",q.videoPlayerEnded("error"),!1;q.actPid=!0}this.PlayerBlock.addEventListener("click",this.playAdPlayer),this.MuteButton.addEventListener("click",this.videoPlayerMute)}},this.createPlayer(t)};

//v2

function str_rand(){var e="",t="0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",o=t.length-1;for(i=0;i<5;++i)position=Math.floor(Math.random()*o),e+=t.substring(position,position+1);return e}var AdvPlayerHDVB;!function(e){"use strict";var t,v=/^[a-z]+:/,h=/[-a-z0-9]+(\.[-a-z0-9])*:\d+/i,g=/\/\/(.*?)(?::(.*?))?@/,i=/^win/i,f=/:$/,m=/^\?/,A=/^#/,y=/(.*\/)/,C=/^\/{2,}/,o=/'/g,a=/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,r=/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,d=/%([0-7][0-9a-f])/gi,n=/\+/g,s=/^\w:$/,V=/[^/#?]/,S="undefined"==typeof window&&"undefined"!=typeof global&&"function"==typeof require,T=S?e.require:null,b={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},w={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443};function I(){return S?t=t||"file://"+(process.platform.match(i)?"/":"")+T("fs").realpathSync("."):document.location.href}function l(e){return encodeURIComponent(e).replace(o,"%27")}function P(e){return(e=(e=(e=e.replace(n," ")).replace(a,function(e,t,i,o){t=parseInt(t,16)-224,i=parseInt(i,16)-128;if(0==t&&i<32)return e;o=(t<<12)+(i<<6)+(parseInt(o,16)-128);return 65535<o?e:String.fromCharCode(o)})).replace(r,function(e,t,i){t=parseInt(t,16)-192;if(t<2)return e;i=parseInt(i,16)-128;return String.fromCharCode((t<<6)+i)})).replace(d,function(e,t){return String.fromCharCode(parseInt(t,16))})}function x(e){for(var t=e.split("&"),i=0,o=t.length;i<o;i++){var a=t[i].split("="),r=decodeURIComponent(a[0].replace(n," "));r&&(a=void 0!==a[1]?P(a[1]):null,void 0===this[r]?this[r]=a:(this[r]instanceof Array||(this[r]=[this[r]]),this[r].push(a)))}}function D(e,t){!function(e,t,i){var o,a;t=t||I(),S?o=T("url").parse(t):(o=document.createElement("a")).href=t;var r,d=(n={path:!0,query:!0,hash:!0},(r=t)&&v.test(r)&&(n.protocol=!0,n.host=!0,h.test(r)&&(n.port=!0),g.test(r)&&(n.user=!0,n.pass=!0)),n),n=t.match(g)||[];for(a in b)d[a]?e[a]=o[b[a]]||"":e[a]="";if(e.protocol=e.protocol.replace(f,""),e.query=e.query.replace(m,""),e.hash=P(e.hash.replace(A,"")),e.user=P(n[1]||""),e.pass=P(n[2]||""),e.port=w[e.protocol]==e.port||0==e.port?"":e.port,!d.protocol&&V.test(t.charAt(0))&&(e.path=t.split("?")[0].split("#")[0]),!d.protocol&&i){var s=new D(I().match(y)[0]),l=s.path.split("/"),c=e.path.split("/"),p=["protocol","user","pass","host","port"],u=p.length;for(l.pop(),a=0;a<u;a++)e[p[a]]=s[p[a]];for(;".."===c[0];)l.pop(),c.shift();e.path=("/"!==t.charAt(0)?l.join("/"):"")+"/"+c.join("/")}e.path=e.path.replace(C,"/"),e.paths(e.paths()),e.query=new x(e.query)}(this,e,!t)}x.prototype.toString=function(){var e,t,i="",o=l;for(e in this){var a=this[e];if(!(a instanceof Function||null===a))if(a instanceof Array){var r=a.length;if(r)for(t=0;t<r;t++){var d=a[t];i+=i?"&":"",i+=o(e)+(null==d?"":"="+o(d))}else i+=(i?"&":"")+o(e)+"="}else i+=i?"&":"",i+=o(e)+(void 0===a?"":"="+o(a))}return i},D.prototype.clearQuery=function(){for(var e in this.query)this.query[e]instanceof Function||delete this.query[e];return this},D.prototype.queryLength=function(){var e,t=0;for(e in this.query)this.query[e]instanceof Function||t++;return t},D.prototype.isEmptyQuery=function(){return 0===this.queryLength()},D.prototype.paths=function(e){var t,i="",o=0;if(e&&e.length&&e+""!==e){for(this.isAbsolute()&&(i="/"),t=e.length;o<t;o++)e[o]=!o&&s.test(e[o])?e[o]:l(e[o]);this.path=i+e.join("/")}for(o=0,t=(e=("/"===this.path.charAt(0)?this.path.slice(1):this.path).split("/")).length;o<t;o++)e[o]=P(e[o]);return e},D.prototype.encode=l,D.prototype.decode=P,D.prototype.isAbsolute=function(){return this.protocol||"/"===this.path.charAt(0)},D.prototype.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&l(this.user)+(this.pass&&":"+l(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+l(this.hash))},e[e.exports?"exports":"Url"]=D}("undefined"!=typeof module&&module.exports?module:window);var VpaidAd=function(d,n,s,e){var a,l,c,p,u;function r(){if(!d.length)return function(){$("#hdvb_vpaid_div").remove();var e=$("video.fp-engine")[0];$(".flowplayer").hasClass("is-playlist")?serials.firstRun?(a.api.play(1),serials.firstRun=!1):e.play():(a.api.play(),e.play())}(),!1;if("vast"==d[0][0]){try{if(navigator.userAgent.match(/playstation/i))return;var e=new AdvPlayer(s,d[0][1],d[0][2]),t=0,i=setInterval(function(){return"error"===e.readState?(clearInterval(i),void o()):(2e4<=t&&(clearInterval(i),o()),e.readState&&clearInterval(i),void(t+=100))},100)}catch(e){console.log(e),o()}function o(){d.shift(),r.state=!1,r()}}else a.vpaidContinue()}d.length&&(a=this,c=!(l=1),u={shortTimer:p=0,longTimer:0,reserveTimer:0,timerDelay:[],longTimerDelay:vpaidConfig.longTimerDelay,init:function(e){u.state?!e&&a.nextTag.check()?a.nextTag():a.stopVPAIDstartPlayer():(clearTimeout(u.shortTimer),clearTimeout(u.longTimer))},reserveTimerDelay:46e3,state:!0},this.api=s,u.timerDelay.default=1e4,this.started=!0,u.state=!0,this.vpaidContinue=function(){this.url=d,this.vpaid,this.vpaidframe,this.vpaidslot2,this.videoVpaid,this.divVpaid,this.adCnt=0,this.сnt=0,this.adCurrent=0,this.codes=[],this.codes.codeCurrent=0,this.codes.tagCurrent=0,this.codes.codeNext=0,this.codes.tagNext=0,this.preloader=$("#vPreloader").clone(),this.vastFallback=function(){};var t,i,o,V=this;this.css=function(e,t){if(e)for(var i in t)t.hasOwnProperty(i)&&"NaNpx"!=t[i]&&null!=t[i]&&("number"==typeof t[i]&&"opacity"!=i&&"zIndex"!=i&&(t[i]+="px"),(-1<i.indexOf("color")||-1<i.indexOf("Color"))&&-1==t[i].indexOf("#")&&-1==t[i].indexOf("rgba")&&(t[i]="#"+t[i]),"transform"==i&&(e.style["-ms-"+i]=t[i],e.style["-moz-"+i]=t[i],e.style["-webkit-"+i]=t[i],e.style["-o-"+i]=t[i]),"fontFamily"==i&&-1<t[i].indexOf(" ")&&(t[i]='"'+t[i]+'"'),"box-sizing"==i?e.style.setProperty(i,t[i],"important"):e.style[i]=t[i])},this.httpBuildQuery=function(e,t,i){var o,a,r,d=0,n=[];for(o in i=i||"&",e)""===e[o]&&"referer"==o||(r=escape(o),null!=e[o]?(a=(a=escape(e[o].toString())).replace(/%20/g,"+"),t&&!isNaN(o)&&(r=t+d),n[d]=r+"="+a):console.error("Ошибка при отправке статистики"),d++);return n.join(i)},this.sendStat=function(){var e=$(".flowplayer"),t=$("meta[name=csrf-token]").attr("content"),i=document.referrer,o={};o.partners=e.data("config").partners,o.adSystem=V.codes[V.codes.codeCurrent].codeTags[V.codes.tagCurrent].AdSystem,o.adSystem||(o.adSystem="other");var a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("POST","/stat_ads",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.adSystem=o.adSystem.replace("<![CDATA[","").replace("]]>",""),a.withCredentials=!0;try{localStorage.getItem("lcounter"),sessionStorage.getItem("counter")}catch(e){0}a.send(V.httpBuildQuery({player_type:refFrom,jsReferer:i,adSystem:o.adSystem,token:t,ancestororigins:ancestorOrig,request_full:e.data("requestfull"),type:"vpaid"})),delete a};var a=[],S=[];function r(){var e,t,i;getParamFromString(V.codes[V.codes.codeCurrent].codeUrl,"skipbut")&&(t=V.codes[V.codes.codeCurrent].codeTags[0].Skipoffset||10,t=5,(i=$('<div class="fr_skip-wrapper" />')).html('<div class="fr_skip-timer" style="display: none;">Пропустить рекламу</div>                                          <div class="fr_skip">Пропустить рекламу через:                                             <span class="fr_timer-value">'+t+"</span>                                            секунд                                        </div>"),$("#hdvb_vpaid_div").append(i),r.flagSkipButton=!0),e=t;var o=setInterval(function(){e--,$(".fr_timer-value").text(e),e<=0&&(clearInterval(o),$(".fr_skip-timer").show(),$(".fr_skip").hide())},1e3)}this.readVastFile=function(g,f,m){var A;void 0===t?t=0:t++;var e=t;a[A]=g;var y,C;A=0,y=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),function v(){var h=A;return g.length>A?(0==e&&(i="completed"),"vast"==g[h][0]?(A++,v(),void V.codes.push(g[h])):(y.timeout=3e3,y.open("GET",g[h][0],!0),y.withCredentials=!0,y.send(),void(y.onreadystatechange=function(){if(4==y.readyState)if(200!=y.status)console.error(y.status+": "+y.statusText+": "+g[h][0]),A++,v();else if(C=y.responseXML,!f||C.getElementsByTagName("AdParameters").length){if("vast"==g[h][0])throw new Error("Васт может вызываться только перед впаидом");if(!C)return A++,void v();if(0!==C.getElementsByTagName("Wrapper").length){for(var e=C.getElementsByTagName("VASTAdTagURI")[0].childNodes,t=C.getElementsByTagName("VASTAdTagURI")[0].childNodes,i={},o=0;e.length>o;o++)if(C.getElementsByTagName("VASTAdTagURI")[0].childNodes[o].nodeValue.trim().length){var a=C.getElementsByTagName("VASTAdTagURI")[0].childNodes[o].nodeValue.trim();break}for(o=0;t.length>o;o++)if(C.getElementsByTagName("AdSystem")[0].childNodes[o].nodeValue.trim().length){i.adSystem=C.getElementsByTagName("AdSystem")[0].childNodes[o].nodeValue.trim();break}return V.readVastFile([[a,g[h][1]]],!0,i),A++,void v()}var r=C.getElementsByTagName("Ad");if(!r.length)return A++,void v();for(var d={codeUrl:g[h][0],codeTags:[],duration:g[h][1]},n=0;r.length>n;n++){var s,l=S[V.adCurrent]={};try{s=f?m.adSystem:void 0===r[n].getElementsByTagName("AdSystem")[0].childNodes[0]?"":r[n].getElementsByTagName("AdSystem")[0].childNodes[0].nodeValue}catch(e){s="empty"}l.AdSystem=null!=s?s:"";var c=r[n].getElementsByTagName("Linear")[0];null!=c&&(l.Skipoffset=void 0===c.attributes.skipoffset?"10":c.attributes.skipoffset.nodeValue.slice(-2)),null!=(c=r[n].getElementsByTagName("AdParameters")[0])?l.AdParameters=c.textContent.trim():(console.warn("В креативе отсутствует AdParameters"),l.AdParameters=""),null!=(c=r[n].getElementsByTagName("Duration")[0])?(p=60*+(p=(p=c.textContent.trim()).split(":"))[0]*60+60*+p[1]+ +p[2],l.Duration=p):l.Duration="30";var p=$(r[n]).find("MediaFile[type='application/javascript']")[0];if(null==p)return console.error("В креативе отсутствует MediaFile"),A++,void v();l.Width=void 0===p.attributes.width?"100%":p.attributes.width.nodeValue,l.Height=void 0===p.attributes.height?"100%":p.attributes.height.nodeValue,l.Bitrate=void 0===p.attributes.bitrate?"":p.attributes.bitrate.nodeValue,l.Delivery=void 0===p.attributes.delivery?"progressive":p.attributes.delivery.nodeValue,l.Scalable=void 0===p.attributes.scalable?"true":p.attributes.scalable.nodeValue,l.File=p.textContent.trim(),V.adCurrent++,d.codeTags[n]=l}V.codes.push(d),A++,v()}else{A++,v();var u=["vast",g[h][0]];V.codes.push(u)}}))):(f&&(o="completed"),0==e&&0==t?void(V.configs=S):e<t?"completed"==o&&void(V.configs=S):e!=t||"completed"==i?void(V.configs=S):void console.log(S))}()},V.readVastFile(d),this.waitVpaid=function(e){"HDVB_VPAID_LOADED"==e.data&&(window.removeEventListener("message",V.waitVpaid),V.initVpaid())},this.stopVPAIDstartPlayer=function(e){if(!e&&(V.started=!1,clearTimeout(u.shortTimer),clearTimeout(u.longTimer),$("#hdvb_vpaid_div").remove(),V.codes[V.codes.codeCurrent]&&Array.isArray(V.codes[V.codes.codeCurrent])))try{if("vast"==V.codes[V.codes.codeCurrent][0]){new AdvPlayer(s,V.codes[V.codes.codeCurrent][1],V.codes[V.codes.codeCurrent][2]);return}}catch(e){console.error(e)}try{JSON.parse(localStorage.getItem($(".js-flowplayer").data("id")))}catch(e){}$("#hdvb_vpaid_div").remove();e=$("video.fp-engine")[0];$(".flowplayer").hasClass("is-playlist")?serials.firstRun?(V.api.play(1),e.play(),serials.firstRun=!1):e.play():(V.api.play(),e.play())},r.flagSkipButton=!1,this.afterStart=function(){r.flagSkipButton||r(),!0===c&&clearTimeout(p),u.state=!1,function(){var e;try{e=localStorage.getItem("volume")}catch(e){}null==e?V.videoVpaid.volume=.5:(V.videoVpaid.volume=.5*Number(localStorage.getItem("volume")),"true"==localStorage.getItem("muted")&&(V.videoVpaid.muted=!0))}(),function(){if(!$(".flowplayer").hasClass("is-touch")){var e,t;try{e=localStorage.getItem("volume")}catch(e){}t=null==e?.5:"true"==localStorage.getItem("muted")?0:.5*Number(localStorage.getItem("volume")),V.vpaid.getAdVolume()!=t&&V.vpaid.setAdVolume(t)}}()},this.vpaidStartAd=function(){console.log("vpaidStartAd"),"Tubecorporate"==V.codes[V.codes.codeCurrent].codeTags[V.codes.tagCurrent].AdSystem&&V.afterStart(),V.api.pause()},this.vpaidStopAd=function(){console.log("vpaidStopAd"),console.log(V.codes);try{var e=getParamFromString(V.codes[V.codes.codeCurrent].codeUrl,"count");if(e&&l<e)return c=!0,l++,$("#hdvb_vpaid_div video").attr("src",""),$("#hdvb_vpaid_div iframe").remove(),p=setTimeout(function(){V.stopVPAIDstartPlayer()},V.codes[V.codes.codeCurrent].duration),void V.vpaidStart(n)}catch(e){console.error("Ошибка при получении списка тегов:"+e),V.stopVPAIDstartPlayer()}u.state?V.vpaidAdError("from AdStop"):V.stopVPAIDstartPlayer()},this.vpaidSkipAd=function(){console.log("vpaidSkipAd")},this.vpaidAdLoaded=function(){console.log("VPAID Loaded, ad "+V.vpaid.getAdLinear()),V.vpaid.resizeAd(V.vpaidframe.clientWidth,V.vpaidframe.clientHeight),$(window).on("resize",function(){V.vpaid.resizeAd(V.vpaidframe.clientWidth,V.vpaidframe.clientHeight)}),"nonlinear"!=V.vpaid.getAdLinear()?(V.vpaid.startAd(),console.log("nonlinear")):V.vpaidAdError("Nonlinear")},this.vpaidAdReady=function(){console.log("vpaidAdReady"),V.afterStart()},this.vpaidAdLinearChange=function(){console.log("vpaidAdLinearChange")},this.vpaidAdSizeChange=function(){console.log("vpaidAdSizeChange")},this.vpaidAdExpandedChange=function(){console.log("vpaidAdExpandedChange")},this.vpaidAdSkippableStateChange=function(){console.log("vpaidAdSkippableStateChange")},this.vpaidAdDurationChange=function(){console.log("vpaidAdDurationChange")},this.vpaidAdRemainingTimeChange=function(){},this.vpaidAdVolumeChange=function(){console.log("vpaidAdVolumeChange")},this.vpaidAdImpression=function(){console.log("vpaidAdImpression"),V.sendStat(),V.afterStart();var e=getParamFromString(V.codes[V.codes.codeCurrent].codeUrl,"count");e&&l<e&&(e=[[V.codes[V.codes.codeCurrent].codeUrl,V.codes[V.codes.codeCurrent].duration]],V.codes=[],V.readVastFile(e,!1),V.codes.codeCurrent=0,V.codes.tagCurrent=0,V.codes.codeNext=!1,V.codes.tagNext=!1)},this.vpaidAdClickThru=function(){console.log("vpaidAdClickThru")},this.vpaidAdInteraction=function(){console.log("vpaidAdInteraction")},this.vpaidAdVideoStart=function(){console.log("vpaidAdVideoStart"),V.afterStart()},this.vpaidAdVideoFirstQuartile=function(){console.log(V.codes[V.codes.codeCurrent].codeUrl);getParamFromString(V.codes[V.codes.codeCurrent].codeUrl,"pname");var e,t=0,i=setInterval(function(){2e3<=t&&clearInterval(i),(e=$("body").find("iframe[name='reydenx']")).length&&(clearInterval(i),setTimeout(o,1e3)),t+=100},100);function o(){e.contents().find(".reydex-x__header-close").css("transform","scale(1.4)")}console.log("vpaidAdVideoFirstQuartile"),V.afterStart()},this.vpaidAdVideoMidpoint=function(){console.log("vpaidAdVideoMidpoint")},this.vpaidAdVideoThirdQuartile=function(){console.log("vpaidAdVideoThirdQuartile")},this.vpaidAdVideoComplete=function(){console.log("vpaidAdVideoComplete")},this.vpaidAdUserAcceptInvitation=function(){console.log("vpaidAdUserAcceptInvitation")},this.vpaidAdUserMinimize=function(){console.log("vpaidAdUserMinimize")},this.vpaidAdUserClose=function(){console.log("vpaidAdUserClose")},this.vpaidAdPaused=function(){console.log("vpaidAdPaused")},this.vpaidAdPlaying=function(){console.log("vpaidAdPlaying")},this.vpaidAdError=function(e){console.log("vpaidAdError",e),console.log("Возникла ошибка"),this.nextTag.check()&&u.state?(console.log("Следующий тег существует, вызываем его"),V.nextTag()):(console.log("Это был последний тег или объявление было показано. Останавливаемся"),V.stopVPAIDstartPlayer())},this.nextTag=function(e){$("#hdvb_vpaid_div iframe").remove(),clearTimeout(u.shortTimer),V.vpaidStart(n)},this.nextTag.check=function(){return!1===V.codes.codeNext?(console.log("Нету доступных тегов"),!1):!!V.codes[V.codes.codeNext]||!(!V.codes[V.codes.codeCurrent]||!V.codes[V.codes.codeCurrent].codeTags[V.codes.tagNext])},this.vpaidAdErrorVpaid=function(){console.log("vpaidAdErrorVpaid"),V.stopVPAIDstartPlayer()},this.vpaidAdLog=function(){console.log("vpaidAdLog")},this.vpaidAdViewable=function(){console.log("vpaidAdViewable")},this.vpaidCallbacks={AdStarted:V.vpaidStartAd,AdStopped:V.vpaidStopAd,AdSkipped:V.vpaidSkipAd,AdLoaded:V.vpaidAdLoaded,AdLinearChange:V.vpaidAdLinearChange,AdSizeChange:V.vpaidAdSizeChange,AdExpandedChange:V.vpaidAdExpandedChange,AdSkippableStateChange:V.vpaidAdSkippableStateChange,AdDurationChange:V.vpaidAdDurationChange,AdRemainingTimeChange:V.vpaidAdRemainingTimeChange,AdVolumeChange:V.vpaidAdVolumeChange,AdImpression:V.vpaidAdImpression,AdClickThru:V.vpaidAdClickThru,AdInteraction:V.vpaidAdInteraction,AdVideoStart:V.vpaidAdVideoStart,AdVideoFirstQuartile:V.vpaidAdVideoFirstQuartile,AdVideoMidpoint:V.vpaidAdVideoMidpoint,AdVideoThirdQuartile:V.vpaidAdVideoThirdQuartile,AdVideoComplete:V.vpaidAdVideoComplete,AdUserAcceptInvitation:V.vpaidAdUserAcceptInvitation,AdUserMinimize:V.vpaidAdUserMinimize,AdUserClose:V.vpaidAdUserClose,AdPaused:V.vpaidAdPaused,AdPlaying:V.vpaidAdPlaying,AdError:V.vpaidAdError,AdErrorVpaid:V.vpaidAdErrorVpaid,AdLog:V.vpaidAdLog,AdViewable:V.vpaidAdViewable,AdReady:V.vpaidAdReady},this.addPixel=function(e){new Image(1,1).src=e},this.vpaidStart=function(e){$("#hdvb_vpaid_div").length||(V.videoVpaid=document.createElement("video"),V.videoVpaid.setAttribute("preload","auto"),V.videoVpaid.setAttribute("x-webkit-airplay","allow"),V.videoVpaid.setAttribute("webkit-playsinline","true"),V.videoVpaid.setAttribute("cursor","pointer"),V.videoVpaid.setAttribute("playsinline","1"),V.videoVpaid.setAttribute("src","//seplay.net/player/v2.mp4"),V.videoVpaid.id="video_s_bars",V.css(V.videoVpaid,{position:"relative",width:"100%",height:"100%","object-fit":"contain","min-height":"auto","max-height":"none","min-width":"auto","max-width":"none","z-index":"998"}),V.divVpaid=document.createElement("div"),V.divVpaid.id="hdvb_vpaid_div",V.css(V.divVpaid,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",color:"white","z-index":"999",background:"rgba(0, 0, 0, 1)"}),V.divVpaid.appendChild(V.videoVpaid),V.videoVpaid.play(),V.videoVpaid.setAttribute("src",""),document.getElementById(e).appendChild(V.divVpaid),i=$("#hdvb_vpaid_div"),$("#vPreloader").length?i.append($("#vPreloader").clone()):i.append(V.preloader)),V.vpaidframe=document.createElement("iframe"),V.vpaidframe.id="hdvb_vpaid",V.vpaidframe.allow="autoplay",V.vpaidframe.scrolling="no",V.vpaidframe.setAttribute("allowFullScreen",""),V.divVpaid.appendChild(V.vpaidframe);var t,i=document.createElement("base");i.href=window.location.protocol+"//"+window.location.host+"/",V.vpaidframe.contentWindow.document.getElementsByTagName("head")[0].appendChild(i),V.css(V.vpaidframe,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",border:0,"z-index":"999"}),V.configs?V.vpaidframeloaded():t=setInterval(function(){V.configs&&(V.vpaidframeloaded(),clearInterval(t))},100)},this.vpaidframeloaded=function(){if(!V.configs.length)return console.error("нету доступных компаний"),void V.stopVPAIDstartPlayer();try{if(V.vpaidframe.contentWindow){if(!0!==c){if(V.adCnt&&(V.codes[V.codes.codeCurrent].codeTags.length>V.codes.tagCurrent+1?(console.log("Увеличиваем счетчик текущего тега"),V.codes.tagCurrent++):(console.log("Увеличиваем счетчик текущего кода и обнуляем счетчик тега"),V.codes.codeCurrent++,V.codes.tagCurrent=0)),"vast"==V.codes[V.codes.codeCurrent][0])return void V.stopVPAIDstartPlayer();V.codes[V.codes.codeCurrent].codeTags.length>V.codes.tagCurrent+1?this.codes.tagNext=V.codes.tagCurrent+1:this.codes.length>V.codes.codeCurrent+1?(this.codes.codeNext=V.codes.codeCurrent+1,this.codes.tagNext=0):(this.codes.codeNext=!1,this.codes.tagNext=!1)}var e='<!DOCTYPE html><html><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><script type="text/javascript" id="js-media" src="'+(V.сnt?V.codes[V.codes.codeCurrent].codeTags[V.codes.tagCurrent]:V.configs[0]).File+'"><\/script><script type="text/javascript">window.parent.postMessage("HDVB_VPAID_LOADED","*");<\/script></body></html>';window.addEventListener("message",V.waitVpaid),setTimeout(function(){V.vpaidframe.contentWindow.document.open(),V.vpaidframe.contentWindow.document.write(e),V.vpaidframe.contentWindow.document.close()},0)}}catch(e){if("vast"==V.codes[V.codes.codeCurrent][0])return void V.stopVPAIDstartPlayer(!0);console.log("VPAID frame error"),console.log(901)}},this.advancedTimer=function(e){console.log("Запущен дополнительный таймер для кода с несколькими тегами и общим временем");var t=this.advancedTimer;return(t.codeUrl&&t.codeUrl!=V.codes[V.codes.codeCurrent].codeUrl||!0===c)&&(t.cnt=0),0==t.cnt?(t.cnt++,t.startDate=new Date,t.codeUrl=V.codes[V.codes.codeCurrent].codeUrl,e):e-(new Date-t.startDate)},this.advancedTimer.cnt=0,this.initVpaid=function(){if(V.vpaidframe.contentWindow){var e=V.codes[V.codes.codeCurrent],t=e.duration;if(delay=Array.isArray(t)?t[V.codes.tagCurrent]||u.timerDelay.default:1<e.codeTags.length?V.advancedTimer(t):t||u.timerDelay.default,console.log("Время на загрузку объявления - "+delay/1e3+" сек."),delay<500)return console.log("Прерываем инициализацию креатива, недостаточно времени для загрузка"),!1!==this.codes.codeNext&&V.codes[V.codes.codeCurrent+1]?(console.log("Переходим к следующему коду"),V.codes.codeCurrent=V.codes.codeCurrent+1,V.codes.tagCurrent=0,V.adCnt=0,void V.nextTag(!0)):(console.log("Это был последний код. Останавливаемся"),void V.stopVPAIDstartPlayer());u.shortTimer=setTimeout(function(){u.init()},delay);t=V.vpaidframe.contentWindow.getVPAIDAd;t&&"function"==typeof t?(V.vpaid=t(),V.vpaid?V.Vpaid():(console.log("initVpaid error1"),V.adCnt++,V.сnt++,V.nextTag())):(console.log("initVpaid error2"),V.adCnt++,V.сnt++,V.nextTag())}},this.Vpaid=function(){if(console.log(V.vpaid),"function"==typeof V.vpaid.handshakeVersion){for(var e in V.vpaidCallbacks)V.vpaidCallbacks.hasOwnProperty(e)&&V.vpaid.subscribe(V.vpaidCallbacks[e],e,this);var t;V.adCnt++,V.vpaidslot2=document.createElement("div"),V.vpaidframe.contentDocument.body.appendChild(V.vpaidslot2),V.css(V.vpaidslot2,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%","z-index":"999"}),V.сnt++,t=V.codes[V.codes.codeCurrent].codeTags[V.codes.tagCurrent].AdParameters||"",V.vpaid.initAd(V.vpaidframe.clientWidth,V.vpaidframe.clientHeight,"fullscreen",720,{AdParameters:t},{slot:V.vpaidslot2,videoSlot:V.videoVpaid,videoSlotCanAutoPlay:!0}),$("body").on("click","#hdvb_vpaid_div .fr_skip-timer",function(){V.vpaid.stopAd(),$(".fr_skip-wrapper").remove(),r.flagSkipButton=!1})}else console.log("VPAID incorrect")},clearTimeout(u.shortTimer),u.longTimer=setTimeout(function(){u.init(!0),console.log("Сработал общий таймер")},u.longTimerDelay),V.vpaidStart(n)},r())};


/* Radish.js */

"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VAST={})}(void 0,function(e){function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function t(t,e){var r,i=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)),i}function a(i){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?t(Object(n),!0).forEach(function(e){var t,r=i;e=n[t=e],t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(n,e))})}return i}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r=s(i);return t=this,!(r=n?(e=s(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments))||"object"!=_typeof(r)&&"function"!=typeof r?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):r}}function d(e){return{id:(e=0<arguments.length&&void 0!==e?e:{}).id||null,adId:e.adId||null,sequence:e.sequence||null,apiFramework:e.apiFramework||null,universalAdId:{value:null,idRegistry:"unknown"},creativeExtensions:[]}}var p=["ADCATEGORIES","ADCOUNT","ADPLAYHEAD","ADSERVINGID","ADTYPE","APIFRAMEWORKS","APPBUNDLE","ASSETURI","BLOCKEDADCATEGORIES","BREAKMAXADLENGTH","BREAKMAXADS","BREAKMAXDURATION","BREAKMINADLENGTH","BREAKMINDURATION","BREAKPOSITION","CLICKPOS","CLICKTYPE","CLIENTUA","CONTENTID","CONTENTPLAYHEAD","CONTENTURI","DEVICEIP","DEVICEUA","DOMAIN","EXTENSIONS","GDPRCONSENT","IFA","IFATYPE","INVENTORYSTATE","LATLONG","LIMITADTRACKING","MEDIAMIME","MEDIAPLAYHEAD","OMIDPARTNER","PAGEURL","PLACEMENTTYPE","PLAYERCAPABILITIES","PLAYERSIZE","PLAYERSTATE","PODSEQUENCE","REGULATIONS","SERVERSIDE","SERVERUA","TRANSACTIONID","UNIVERSALADID","VASTVERSIONS","VERIFICATIONVENDORS"];function h(e){var t,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=[],o=v(e);for(t in!i.ERRORCODE||n.isCustomCode||/^[0-9]{3}$/.test(i.ERRORCODE)||(i.ERRORCODE=900),i.CACHEBUSTING=A(Math.round(1e8*Math.random()).toString()),i.TIMESTAMP=(new Date).toISOString(),i.RANDOM=i.random=i.CACHEBUSTING,i)i[t]=y(i[t]);for(r in o){var s=o[r];"string"==typeof s&&a.push(m(s,i))}return a}function m(e,t){return!(t=(e=f(e,t)).match(/[^[\]]+(?=])/g))||0===(t=t.filter(function(e){return-1<p.indexOf(e)})).length?e:f(e,t=t.reduce(function(e,t){return e[t]=-1,e},{}))}function f(e,t){var r,i=e;for(r in t)var n=t[r],i=i.replace(new RegExp("(?:\\[|%%)(".concat(r,")(?:\\]|%%)"),"g"),n);return i}function v(e){return Array.isArray(e)?e.map(function(e){return e&&e.hasOwnProperty("url")?e.url:e}):e}function g(e,t){for(var r=0;r<t.length;r++)if(T(t[r],e))return!0;return!1}function T(e,t){if(e&&t){var r=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);return r.length===i.length&&(e.id===t.id&&e.url===t.url)}return!1}function y(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%".concat(e.charCodeAt(0).toString(16))})}function A(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:8;return(e=String(e)).length<t?k(0,t-e.length,!1).map(function(){return"0"}).join("")+e:e}function k(e,t,r){for(var i=[],n=e<t,a=r?n?t+1:t-1:t,o=e;n?o<a:a<o;n?o++:o--)i.push(o);return i}var R={track:function(e,t,r){h(e,t,r).forEach(function(e){"undefined"!=typeof window&&null!==window&&((new Image).src=e)})},resolveURLTemplates:h,extractURLsFromTemplates:v,containsTemplateObject:g,isTemplateObjectEqual:T,encodeURIComponentRFC3986:y,replaceUrlMacros:m,leftpad:A,range:k,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},flatten:function r(e){return e.reduce(function(e,t){return e.concat(Array.isArray(t)?r(t):t)},[])},joinArrayOfUniqueTemplateObjs:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],e=Array.isArray(e)?e:[],t=Array.isArray(t)?t:[];return e.concat(t).reduce(function(e,t){return g(t,e)||e.push(t),e},[])}};function E(e){return-1!==["true","TRUE","True","1"].indexOf(e)}var b={childByName:function(e,t){var r,i=e.childNodes;for(r in i){var n=i[r];if(n.nodeName===t)return n}},childrenByName:function(e,t){var r,i=[],n=e.childNodes;for(r in n){var a=n[r];a.nodeName===t&&i.push(a)}return i},resolveVastAdTagURI:function(e,t){return t?0!==e.indexOf("//")?-1!==e.indexOf("://")?e:(t=t.slice(0,t.lastIndexOf("/")),"".concat(t,"/").concat(e)):(t=location.protocol,"".concat(t).concat(e)):e},parseBoolean:E,parseNodeText:function(e){return e&&(e.textContent||e.text||"").trim()},copyNodeAttribute:function(e,t,r){(t=t.getAttribute(e))&&r.setAttribute(e,t)},parseAttributes:function(e){for(var t=e.attributes,r={},i=0;i<t.length;i++)r[t[i].nodeName]=t[i].nodeValue;return r},parseDuration:function(e){if(null==e)return-1;if(R.isNumeric(e))return parseInt(e);var t=e.split(":");if(3!==t.length)return-1;var r=t[2].split("."),e=parseInt(r[0]);return 2===r.length&&(e+=parseFloat("0.".concat(r[1]))),r=parseInt(60*t[1]),t=parseInt(60*t[0]*60),isNaN(t)||isNaN(r)||isNaN(e)||3600<r||60<e?-1:t+r+e},splitVAST:function(r){var i=[],n=null;return r.forEach(function(e,t){if(e.sequence&&(e.sequence=parseInt(e.sequence,10)),1<e.sequence){if((t=r[t-1])&&t.sequence===e.sequence-1)return void(n&&n.push(e));delete e.sequence}n=[e],i.push(n)}),i},assignAttributes:function(e,t){if(e)for(var r in e){var i,n=e[r];n.nodeName&&n.nodeValue&&t.hasOwnProperty(n.nodeName)&&(i=n.nodeValue,"boolean"==typeof t[n.nodeName]&&(i=E(i)),t[n.nodeName]=i)}},mergeWrapperAdData:function(e,i){e.errorURLTemplates=i.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=i.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=i.extensions.concat(e.extensions),e.followAdditionalWrappers=i.followAdditionalWrappers,e.allowMultipleAds=i.allowMultipleAds,e.fallbackOnNoAd=i.fallbackOnNoAd;var t=(i.creatives||[]).filter(function(e){return e&&"companion"===e.type}),n=t.reduce(function(t,e){return(e.variations||[]).forEach(function(e){(e.companionClickTrackingURLTemplates||[]).forEach(function(e){R.containsTemplateObject(e,t)||t.push(e)})}),t},[]);e.creatives=t.concat(e.creatives);var a=i.videoClickTrackingURLTemplates&&i.videoClickTrackingURLTemplates.length,o=i.videoCustomClickURLTemplates&&i.videoCustomClickURLTemplates.length;e.creatives.forEach(function(e){if(i.trackingEvents&&i.trackingEvents[e.type])for(var t in i.trackingEvents[e.type]){var r=i.trackingEvents[e.type][t];Array.isArray(e.trackingEvents[t])||(e.trackingEvents[t]=[]),e.trackingEvents[t]=e.trackingEvents[t].concat(r)}"linear"===e.type&&(a&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(i.videoClickTrackingURLTemplates)),o&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(i.videoCustomClickURLTemplates)),!i.videoClickThroughURLTemplate||null!==e.videoClickThroughURLTemplate&&void 0!==e.videoClickThroughURLTemplate||(e.videoClickThroughURLTemplate=i.videoClickThroughURLTemplate)),"companion"===e.type&&n.length&&(e.variations||[]).forEach(function(e){e.companionClickTrackingURLTemplates=R.joinArrayOfUniqueTemplateObjs(e.companionClickTrackingURLTemplates,n)})}),i.adVerifications&&(e.adVerifications=e.adVerifications.concat(i.adVerifications)),i.blockedAdCategories&&(e.blockedAdCategories=e.blockedAdCategories.concat(i.blockedAdCategories))}};function N(e){var t=[];return e.forEach(function(e){(e=function e(t){if("#comment"===t.nodeName)return null;var r,i,n,a={name:null,value:null,attributes:{},children:[]},o=t.attributes,s=t.childNodes;if(a.name=t.nodeName,t.attributes)for(var l in o)!o.hasOwnProperty(l)||(r=o[l]).nodeName&&r.nodeValue&&(a.attributes[r.nodeName]=r.nodeValue);for(i in s)!s.hasOwnProperty(i)||(n=e(s[i]))&&a.children.push(n);return(0===a.children.length||1===a.children.length&&0<=["#cdata-section","#text"].indexOf(a.children[0].name))&&(""!==(t=b.parseNodeText(t))&&(a.value=t),a.children=[]),null===(t=a).value&&0===Object.keys(t.attributes).length&&0===t.children.length?null:a}(e))&&t.push(e)}),t}var L={Wrapper:{subElements:["VASTAdTagURI","Impression"]},BlockedAdCategories:{attributes:["authority"]},InLine:{subElements:["AdSystem","AdTitle","Impression","AdServingId","Creatives"]},Category:{attributes:["authority"]},Pricing:{attributes:["model","currency"]},Verification:{oneOfinLineResources:["JavaScriptResource","ExecutableResource"],attributes:["vendor"]},UniversalAdId:{attributes:["idRegistry"]},JavaScriptResource:{attributes:["apiFramework","browserOptional"]},ExecutableResource:{attributes:["apiFramework","type"]},Tracking:{attributes:["event"]},Creatives:{subElements:["Creative"]},Creative:{subElements:["UniversalAdId"]},Linear:{subElements:["MediaFiles","Duration"]},MediaFiles:{subElements:["MediaFile"]},MediaFile:{attributes:["delivery","type","width","height"]},Mezzanine:{attributes:["delivery","type","width","height"]},NonLinear:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},Companion:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},StaticResource:{attributes:["creativeType"]},Icons:{subElements:["Icon"]},Icon:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"]}};function w(t,e){var r;L[t.nodeName]&&L[t.nodeName].attributes&&0<(r=L[t.nodeName].attributes.filter(function(e){return!t.getAttribute(e)})).length&&I({name:t.nodeName,parentName:t.parentNode.nodeName,attributes:r},e)}function U(t,e,r){var i=L[t.nodeName],n=!r&&"Wrapper"!==t.nodeName;i&&!n&&(!i.subElements||0<(n=i.subElements.filter(function(e){return!b.childByName(t,e)})).length&&I({name:t.nodeName,parentName:t.parentNode.nodeName,subElements:n},e),r&&i.oneOfinLineResources&&(i.oneOfinLineResources.some(function(e){return b.childByName(t,e)})||I({name:t.nodeName,parentName:t.parentNode.nodeName,oneOfResources:i.oneOfinLineResources},e)))}function C(e){return e.children&&0!==e.children.length}function I(e,t){var r=e.name,i=e.parentName,n=e.attributes,a=e.subElements,e=e.oneOfResources,r="Element '".concat(r,"'");t("VAST-warning",{message:r+=n?" missing required attribute(s) '".concat(n.join(", "),"' "):a?" missing required sub element(s) '".concat(a.join(", "),"' "):e?" must provide one of the following '".concat(e.join(", "),"' "):" is empty",parentElement:i,specVersion:4.1})}var x={verifyRequiredValues:function e(t,r,i){if(t&&t.nodeName)if("InLine"===t.nodeName&&(i=!0),w(t,r),C(t)){U(t,r,i);for(var n=0;n<t.children.length;n++)e(t.children[n],r,i)}else 0===b.parseNodeText(t).length&&I({name:t.nodeName,parentName:t.parentNode.nodeName},r)},hasSubElements:C,emitMissingValueWarning:I,verifyRequiredAttributes:w,verifyRequiredSubElements:U};function S(e,t,r){var i,n=(r=2<arguments.length&&void 0!==r?r:{}).allowMultipleAds,a=r.followAdditionalWrappers,o=e.childNodes;for(i in o){var s=o[i];if(-1!==["Wrapper","InLine"].indexOf(s.nodeName)&&("Wrapper"!==s.nodeName||!1!==a)){if(b.copyNodeAttribute("id",e,s),b.copyNodeAttribute("sequence",e,s),b.copyNodeAttribute("adType",e,s),"Wrapper"===s.nodeName)return{ad:function(e,t){var i=O(e,t),r=e.getAttribute("followAdditionalWrappers"),n=e.getAttribute("allowMultipleAds"),t=e.getAttribute("fallbackOnNoAd");if(i.followAdditionalWrappers=!r||b.parseBoolean(r),i.allowMultipleAds=!!n&&b.parseBoolean(n),i.fallbackOnNoAd=t?b.parseBoolean(t):null,(t=b.childByName(e,"VASTAdTagURI"))?i.nextWrapperURL=b.parseNodeText(t):(t=b.childByName(e,"VASTAdTagURL"))&&(i.nextWrapperURL=b.parseNodeText(b.childByName(t,"URL"))),i.creatives.forEach(function(r){if(-1!==["linear","nonlinear"].indexOf(r.type)){if(r.trackingEvents)for(var e in i.trackingEvents||(i.trackingEvents={}),i.trackingEvents[r.type]||(i.trackingEvents[r.type]={}),r.trackingEvents)!function(t){var e=r.trackingEvents[t];Array.isArray(i.trackingEvents[r.type][t])||(i.trackingEvents[r.type][t]=[]),e.forEach(function(e){i.trackingEvents[r.type][t].push(e)})}(e);r.videoClickTrackingURLTemplates&&(Array.isArray(i.videoClickTrackingURLTemplates)||(i.videoClickTrackingURLTemplates=[]),r.videoClickTrackingURLTemplates.forEach(function(e){i.videoClickTrackingURLTemplates.push(e)})),r.videoClickThroughURLTemplate&&(i.videoClickThroughURLTemplate=r.videoClickThroughURLTemplate),r.videoCustomClickURLTemplates&&(Array.isArray(i.videoCustomClickURLTemplates)||(i.videoCustomClickURLTemplates=[]),r.videoCustomClickURLTemplates.forEach(function(e){i.videoCustomClickURLTemplates.push(e)}))}}),i.nextWrapperURL)return i}(s,t),type:"WRAPPER"};if("InLine"===s.nodeName)return{ad:function(e,t,r){return!1===(2<arguments.length&&void 0!==r?r:{}).allowMultipleAds&&e.getAttribute("sequence")?null:O(e,t)}(s,t,{allowMultipleAds:n}),type:"INLINE"}}}}function O(e,t){t&&x.verifyRequiredValues(e,t);var r,i=e.childNodes,n=function(e){return{id:(e=0<arguments.length&&void 0!==e?e:{}).id||null,sequence:e.sequence||null,adType:e.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:{},system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}(b.parseAttributes(e));for(r in i){var a=i[r];switch(a.nodeName){case"Error":n.errorURLTemplates.push(b.parseNodeText(a));break;case"Impression":n.impressionURLTemplates.push({id:a.getAttribute("id")||null,url:b.parseNodeText(a)});break;case"Creatives":n.creatives=function(e){var u=[];return e.forEach(function(e){var t,r,i,n,a,o={id:e.getAttribute("id")||null,adId:(s=e).getAttribute("AdID")||s.getAttribute("adID")||s.getAttribute("adId")||null,sequence:e.getAttribute("sequence")||null,apiFramework:e.getAttribute("apiFramework")||null},s=b.childByName(e,"UniversalAdId");for(i in s&&(t={idRegistry:s.getAttribute("idRegistry")||"unknown",value:b.parseNodeText(s)}),(s=b.childByName(e,"CreativeExtensions"))&&(r=N(b.childrenByName(s,"CreativeExtension"))),e.childNodes){var l=e.childNodes[i],c=void 0;switch(l.nodeName){case"Linear":c=function(e,t){var i,s=function(e){return{id:(e=d(0<arguments.length&&void 0!==e?e:{})).id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"linear",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(t);s.duration=b.parseDuration(b.parseNodeText(b.childByName(e,"Duration"))),null==(t=e.getAttribute("skipoffset"))?s.skipDelay=null:"%"===t.charAt(t.length-1)&&-1!==s.duration?(r=parseInt(t,10),s.skipDelay=s.duration*(r/100)):s.skipDelay=b.parseDuration(t);var r=b.childByName(e,"VideoClicks");return r&&(t=b.childByName(r,"ClickThrough"),s.videoClickThroughURLTemplate=t?{id:t.getAttribute("id")||null,url:b.parseNodeText(t)}:null,b.childrenByName(r,"ClickTracking").forEach(function(e){s.videoClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:b.parseNodeText(e)})}),b.childrenByName(r,"CustomClick").forEach(function(e){s.videoCustomClickURLTemplates.push({id:e.getAttribute("id")||null,url:b.parseNodeText(e)})})),(r=b.childByName(e,"AdParameters"))&&(s.adParameters=b.parseNodeText(r)),b.childrenByName(e,"TrackingEvents").forEach(function(e){b.childrenByName(e,"Tracking").forEach(function(e){var t=e.getAttribute("event"),r=b.parseNodeText(e);if(t&&r){if("progress"===t){if(!(i=e.getAttribute("offset")))return;t="%"===i.charAt(i.length-1)?"progress-".concat(i):"progress-".concat(Math.round(b.parseDuration(i)))}Array.isArray(s.trackingEvents[t])||(s.trackingEvents[t]=[]),s.trackingEvents[t].push(r)}})}),b.childrenByName(e,"MediaFiles").forEach(function(e){b.childrenByName(e,"MediaFile").forEach(function(e){s.mediaFiles.push(function(e){var t={id:null,fileURL:null,fileSize:0,deliveryType:"progressive",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null};t.id=e.getAttribute("id"),t.fileURL=b.parseNodeText(e),t.deliveryType=e.getAttribute("delivery"),t.codec=e.getAttribute("codec"),t.mimeType=e.getAttribute("type"),t.mediaType=e.getAttribute("mediaType")||"2D",t.apiFramework=e.getAttribute("apiFramework"),t.fileSize=parseInt(e.getAttribute("fileSize")||0),t.bitrate=parseInt(e.getAttribute("bitrate")||0),t.minBitrate=parseInt(e.getAttribute("minBitrate")||0),t.maxBitrate=parseInt(e.getAttribute("maxBitrate")||0),t.width=parseInt(e.getAttribute("width")||0),t.height=parseInt(e.getAttribute("height")||0);var r=e.getAttribute("scalable");return r&&"string"==typeof r&&(t.scalable=b.parseBoolean(r)),(e=e.getAttribute("maintainAspectRatio"))&&"string"==typeof e&&(t.maintainAspectRatio=b.parseBoolean(e)),t}(e))});var t=b.childByName(e,"InteractiveCreativeFile");t&&(s.interactiveCreativeFile=(r=t,(o=function(e){return{type:(e=0<arguments.length&&void 0!==e?e:{}).type||null,apiFramework:e.apiFramework||null,variableDuration:b.parseBoolean(e.variableDuration),fileURL:null}}(b.parseAttributes(r))).fileURL=b.parseNodeText(r),o));var r=b.childByName(e,"ClosedCaptionFiles");r&&b.childrenByName(r,"ClosedCaptionFile").forEach(function(e){var t=function(e){return{type:(e=0<arguments.length&&void 0!==e?e:{}).type||null,language:e.language||null,fileURL:null}}(b.parseAttributes(e));t.fileURL=b.parseNodeText(e),s.closedCaptionFiles.push(t)});var i,n,a,o=b.childByName(e,"Mezzanine");(r=(i=o,a=!(n={}),["delivery","type","width","height"].forEach(function(e){i&&i.getAttribute(e)?n[e]=i.getAttribute(e):a=!0}),a?null:n))&&((e={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:"2D"}).id=o.getAttribute("id"),e.fileURL=b.parseNodeText(o),e.delivery=r.delivery,e.codec=o.getAttribute("codec"),e.type=r.type,e.width=parseInt(r.width,10),e.height=parseInt(r.height,10),e.fileSize=parseInt(o.getAttribute("fileSize"),10),e.mediaType=o.getAttribute("mediaType")||"2D",s.mezzanine=e)}),(e=b.childByName(e,"Icons"))&&b.childrenByName(e,"Icon").forEach(function(e){s.icons.push(function(e){var t={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:"1",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null};t.program=e.getAttribute("program"),t.height=parseInt(e.getAttribute("height")||0),t.width=parseInt(e.getAttribute("width")||0),t.xPosition=(r=e.getAttribute("xPosition"),-1===["left","right"].indexOf(r)?parseInt(r||0):r),t.yPosition=(r=e.getAttribute("yPosition"),-1===["top","bottom"].indexOf(r)?parseInt(r||0):r),t.apiFramework=e.getAttribute("apiFramework"),t.pxratio=e.getAttribute("pxratio")||"1",t.offset=b.parseDuration(e.getAttribute("offset")),t.duration=b.parseDuration(e.getAttribute("duration")),b.childrenByName(e,"HTMLResource").forEach(function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=b.parseNodeText(e)}),b.childrenByName(e,"IFrameResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=b.parseNodeText(e)}),b.childrenByName(e,"StaticResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=b.parseNodeText(e)});var r=b.childByName(e,"IconClicks");return r&&(t.iconClickThroughURLTemplate=b.parseNodeText(b.childByName(r,"IconClickThrough")),b.childrenByName(r,"IconClickTracking").forEach(function(e){t.iconClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:b.parseNodeText(e)})})),t.iconViewTrackingURLTemplate=b.parseNodeText(b.childByName(e,"IconViewTracking")),t}(e))}),s}(l,o);break;case"NonLinearAds":c=function(e,t){var i=function(e){return{id:(e=d(0<arguments.length&&void 0!==e?e:{})).id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"nonlinear",variations:[],trackingEvents:{}}}(t);return b.childrenByName(e,"TrackingEvents").forEach(function(e){var t,r;b.childrenByName(e,"Tracking").forEach(function(e){t=e.getAttribute("event"),r=b.parseNodeText(e),t&&r&&(Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(r))})}),b.childrenByName(e,"NonLinear").forEach(function(e){var t={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:"static",adType:"nonLinearAd",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};t.id=e.getAttribute("id")||null,t.width=e.getAttribute("width"),t.height=e.getAttribute("height"),t.expandedWidth=e.getAttribute("expandedWidth"),t.expandedHeight=e.getAttribute("expandedHeight"),t.scalable=b.parseBoolean(e.getAttribute("scalable")),t.maintainAspectRatio=b.parseBoolean(e.getAttribute("maintainAspectRatio")),t.minSuggestedDuration=b.parseDuration(e.getAttribute("minSuggestedDuration")),t.apiFramework=e.getAttribute("apiFramework"),b.childrenByName(e,"HTMLResource").forEach(function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=b.parseNodeText(e)}),b.childrenByName(e,"IFrameResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=b.parseNodeText(e)}),b.childrenByName(e,"StaticResource").forEach(function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=b.parseNodeText(e)});var r=b.childByName(e,"AdParameters");r&&(t.adParameters=b.parseNodeText(r)),t.nonlinearClickThroughURLTemplate=b.parseNodeText(b.childByName(e,"NonLinearClickThrough")),b.childrenByName(e,"NonLinearClickTracking").forEach(function(e){t.nonlinearClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:b.parseNodeText(e)})}),i.variations.push(t)}),i}(l,o);break;case"CompanionAds":n=l,(a=function(e){return{id:(e=d(0<arguments.length&&void 0!==e?e:{})).id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"companion",required:null,variations:[]}}(a=o)).required=n.getAttribute("required")||null,a.variations=b.childrenByName(n,"Companion").map(function(e){var r=function(e){return{id:(e=0<arguments.length&&void 0!==e?e:{}).id||null,adType:"companionAd",width:e.width||0,height:e.height||0,assetWidth:e.assetWidth||null,assetHeight:e.assetHeight||null,expandedWidth:e.expandedWidth||null,expandedHeight:e.expandedHeight||null,apiFramework:e.apiFramework||null,adSlotID:e.adSlotID||null,pxratio:e.pxratio||"1",renderingMode:e.renderingMode||"default",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,xmlEncoded:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}(b.parseAttributes(e));r.htmlResources=b.childrenByName(e,"HTMLResource").reduce(function(e,t){return(t=b.parseNodeText(t))?e.concat(t):e},[]),r.iframeResources=b.childrenByName(e,"IFrameResource").reduce(function(e,t){return(t=b.parseNodeText(t))?e.concat(t):e},[]),r.staticResources=b.childrenByName(e,"StaticResource").reduce(function(e,t){var r=b.parseNodeText(t);return r?e.concat({url:r,creativeType:t.getAttribute("creativeType")||null}):e},[]),r.altText=b.parseNodeText(b.childByName(e,"AltText"))||null;var t=b.childByName(e,"TrackingEvents");return t&&b.childrenByName(t,"Tracking").forEach(function(e){var t=e.getAttribute("event"),e=b.parseNodeText(e);t&&e&&(Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(e))}),r.companionClickTrackingURLTemplates=b.childrenByName(e,"CompanionClickTracking").map(function(e){return{id:e.getAttribute("id")||null,url:b.parseNodeText(e)}}),r.companionClickThroughURLTemplate=b.parseNodeText(b.childByName(e,"CompanionClickThrough"))||null,(e=b.childByName(e,"AdParameters"))&&(r.adParameters=b.parseNodeText(e),r.xmlEncoded=e.getAttribute("xmlEncoded")||null),r}),c=a}c&&(t&&(c.universalAdId=t),r&&(c.creativeExtensions=r),u.push(c))}}),u}(b.childrenByName(a,"Creative"));break;case"Extensions":var o=b.childrenByName(a,"Extension");n.extensions=N(o),n.adVerifications.length||(n.adVerifications=function(){var t=null,e=[];return o.some(function(e){return t=b.childByName(e,"AdVerifications")}),t&&(e=D(b.childrenByName(t,"Verification"))),e}());break;case"AdVerifications":n.adVerifications=D(b.childrenByName(a,"Verification"));break;case"AdSystem":n.system={value:b.parseNodeText(a),version:a.getAttribute("version")||null};break;case"AdTitle":n.title=b.parseNodeText(a);break;case"AdServingId":n.adServingId=b.parseNodeText(a);break;case"Category":n.categories.push({authority:a.getAttribute("authority")||null,value:b.parseNodeText(a)});break;case"Expires":n.expires=parseInt(b.parseNodeText(a),10);break;case"ViewableImpression":n.viewableImpression=function(e){var t={};t.id=e.getAttribute("id")||null;var r,i=e.childNodes;for(r in i){var n=(a=i[r]).nodeName,a=b.parseNodeText(a);"Viewable"!==n&&"NotViewable"!==n&&"ViewUndetermined"!==n||!a||(n=n.toLowerCase(),Array.isArray(t[n])||(t[n]=[]),t[n].push(a))}return t}(a);break;case"Description":n.description=b.parseNodeText(a);break;case"Advertiser":n.advertiser={id:a.getAttribute("id")||null,value:b.parseNodeText(a)};break;case"Pricing":n.pricing={value:b.parseNodeText(a),model:a.getAttribute("model")||null,currency:a.getAttribute("currency")||null};break;case"Survey":n.survey=b.parseNodeText(a);break;case"BlockedAdCategories":n.blockedAdCategories.push({authority:a.getAttribute("authority")||null,value:b.parseNodeText(a)})}}return n}function D(e){var a=[];return e.forEach(function(e){var t,r={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},i=e.childNodes;for(t in b.assignAttributes(e.attributes,r),i){var n=i[t];switch(n.nodeName){case"JavaScriptResource":case"ExecutableResource":r.resource=b.parseNodeText(n),b.assignAttributes(n.attributes,r);break;case"VerificationParameters":r.parameters=b.parseNodeText(n)}}(e=b.childByName(e,"TrackingEvents"))&&b.childrenByName(e,"Tracking").forEach(function(e){var t=e.getAttribute("event"),e=b.parseNodeText(e);t&&e&&(Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(e))}),a.push(r)}),a}var V=(n(P,[{key:"on",value:function(e,t){if("function"!=typeof t)throw new TypeError("The handler argument must be of type Function. Received type ".concat(r(t)));if(!e)throw new TypeError("The event argument must be of type String. Received type ".concat(r(e)));return this._handlers.push({event:e,handler:t}),this}},{key:"once",value:function(e,t){return this.on(e,(r=this,i=e,n=t,(a={fired:!1,wrapFn:void 0}).wrapFn=function(){a.fired||(r.off(i,a.wrapFn),a.fired=!0,n.bind(r).apply(void 0,arguments))}));var r,i,n,a}},{key:"off",value:function(t,r){return this._handlers=this._handlers.filter(function(e){return e.event!==t||e.handler!==r}),this}},{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];var n=!1;return this._handlers.forEach(function(e){"*"===e.event&&(n=!0,e.handler.apply(e,[t].concat(r))),e.event===t&&(n=!0,e.handler.apply(e,r))}),n}},{key:"removeAllListeners",value:function(t){return this._handlers=t?this._handlers.filter(function(e){return e.event!==t}):[],this}},{key:"listenerCount",value:function(t){return this._handlers.filter(function(e){return e.event===t}).length}},{key:"listeners",value:function(r){return this._handlers.reduce(function(e,t){return t.event===r&&e.push(t.handler),e},[])}},{key:"eventNames",value:function(){return this._handlers.map(function(e){return e.event})}}]),P);function P(){c(this,P),this._handlers=[]}var B=function(e,t,r){r(new Error("Please bundle the library for node to use the node urlHandler"))};function F(){try{var e=new window.XMLHttpRequest;return"withCredentials"in e?e:null}catch(e){return null}}function M(e,t,r){var i=r?408:e.status,e=(r?"XHRURLHandler: Request timed out after ".concat(e.timeout," ms ("):"XHRURLHandler: ".concat(e.statusText," (")).concat(i,")");t(new Error(e),null,{statusCode:i})}var W=function(e,t,r){if("https:"===window.location.protocol&&0===e.indexOf("http://"))return r(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{var i=F();i.open("GET",e),i.timeout=t.timeout||12e4,i.withCredentials=t.withCredentials||!1,i.overrideMimeType&&i.overrideMimeType("text/xml"),i.onload=function(){return t=r,void(200===(e=i).status?t(null,e.responseXML,{byteLength:e.response.length,statusCode:e.status}):M(e,t,!1));var e,t},i.onerror=function(){return M(i,r,!1)},i.onabort=function(){return M(i,r,!1)},i.ontimeout=function(){return M(i,r,!0)},i.send()}catch(e){r(new Error("XHRURLHandler: Unexpected error"))}},j=function(){return!!F()},q={get:function(e,t,r){return r||("function"==typeof t&&(r=t),t={}),"undefined"==typeof window||null===window?B(e,t,r):j()?W(e,t,r):r(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))}},H={ERRORCODE:900,extensions:[]},_=function(){o(r,V);var t=u(r);function r(){var e;return c(this,r),(e=t.call(this)).remainingAds=[],e.parentURLs=[],e.errorURLTemplates=[],e.rootErrorURLTemplates=[],e.maxWrapperDepth=null,e.URLTemplateFilters=[],e.fetchingOptions={},e.parsingOptions={},e}return n(r,[{key:"addURLTemplateFilter",value:function(e){"function"==typeof e&&this.URLTemplateFilters.push(e)}},{key:"removeURLTemplateFilter",value:function(){this.URLTemplateFilters.pop()}},{key:"countURLTemplateFilters",value:function(){return this.URLTemplateFilters.length}},{key:"clearURLTemplateFilters",value:function(){this.URLTemplateFilters=[]}},{key:"trackVastError",value:function(e,t){for(var r=arguments.length,i=new Array(2<r?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];this.emit("VAST-error",Object.assign.apply(Object,[{},H,t].concat(i))),R.track(e,t)}},{key:"getErrorURLTemplates",value:function(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}},{key:"fetchVAST",value:function(s){var l=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return new Promise(function(n,a){l.URLTemplateFilters.forEach(function(e){s=e(s)}),l.parentURLs.push(s);var o=Date.now();l.emit("VAST-resolving",{url:s,previousUrl:u,wrapperDepth:c,maxWrapperDepth:l.maxWrapperDepth,timeout:l.fetchingOptions.timeout}),l.urlHandler.get(s,l.fetchingOptions,function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=Math.round(Date.now()-o),r=Object.assign({url:s,previousUrl:u,wrapperDepth:c,error:e,duration:i},r);l.emit("VAST-resolved",r),e?a(e):n(t)})})}},{key:"initParsingStatus",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.errorURLTemplates=[],this.fetchingOptions={timeout:e.timeout||12e4,withCredentials:e.withCredentials},this.maxWrapperDepth=e.wrapperLimit||10,this.parentURLs=[],this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.remainingAds=[],this.rootErrorURLTemplates=[],this.rootURL="",this.urlHandler=e.urlHandler||e.urlhandler||q,this.vastVersion=null}},{key:"getRemainingAds",value:function(e){var t=this;return 0===this.remainingAds.length?Promise.reject(new Error("No more ads are available for the given VAST")):(e=e?R.flatten(this.remainingAds):this.remainingAds.shift(),this.errorURLTemplates=[],this.parentURLs=[],this.resolveAds(e,{wrapperDepth:0,url:this.rootURL}).then(function(e){return t.buildVASTResponse(e)}))}},{key:"getAndParseVAST",value:function(t){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(i),this.URLTemplateFilters.forEach(function(e){t=e(t)}),this.rootURL=t,this.fetchVAST(t).then(function(e){return i.previousUrl=t,i.isRootVAST=!0,i.url=t,r.parse(e,i).then(function(e){return r.buildVASTResponse(e)})})}},{key:"parseVAST",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(r),r.isRootVAST=!0,this.parse(e,r).then(function(e){return t.buildVASTResponse(e)})}},{key:"buildVASTResponse",value:function(e){return e={ads:(e={ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion}).ads||[],errorURLTemplates:e.errorURLTemplates||[],version:e.version||null},this.completeWrapperResolving(e),e}},{key:"parseVastXml",value:function(e,t){var r=t.isRootVAST,i=void 0!==r&&r,n=void 0===(r=t.url)?null:r,a=void 0===(r=t.wrapperDepth)?0:r,o=t.allowMultipleAds,s=t.followAdditionalWrappers;if(!e||!e.documentElement||"VAST"!==e.documentElement.nodeName)throw this.emit("VAST-ad-parsed",{type:"ERROR",url:n,wrapperDepth:a}),new Error("Invalid VAST XMLDocument");var l,c=[],u=e.documentElement.childNodes,d=e.documentElement.getAttribute("version");for(l in i&&d&&(this.vastVersion=d),u){var p=u[l];if("Error"===p.nodeName){var h=b.parseNodeText(p);(i?this.rootErrorURLTemplates:this.errorURLTemplates).push(h)}else if("Ad"===p.nodeName){if(this.vastVersion&&parseFloat(this.vastVersion)<3)o=!0;else if(!1===o&&1<c.length)break;(p=S(p,this.emit.bind(this),{allowMultipleAds:o,followAdditionalWrappers:s})).ad?(c.push(p.ad),this.emit("VAST-ad-parsed",{type:p.type,url:n,wrapperDepth:a,adIndex:c.length-1,vastVersion:d})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return c}},{key:"parse",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=void 0===(a=t.url)?null:a,i=t.resolveAll,n=void 0===i||i,a=void 0===(o=t.wrapperSequence)?null:o,o=void 0===(i=t.previousUrl)?null:i,s=void 0===(i=t.wrapperDepth)?0:i,l=void 0!==(i=t.isRootVAST)&&i,c=t.followAdditionalWrappers,u=t.allowMultipleAds,d=[];this.vastVersion&&parseFloat(this.vastVersion)<3&&l&&(u=!0);try{d=this.parseVastXml(e,{isRootVAST:l,url:r,wrapperDepth:s,allowMultipleAds:u,followAdditionalWrappers:c})}catch(e){return Promise.reject(e)}return 1===d.length&&null!=a&&(d[0].sequence=a),!1===n&&(this.remainingAds=b.splitVAST(d),d=this.remainingAds.shift()),this.resolveAds(d,{wrapperDepth:s,previousUrl:o,url:r})}},{key:"resolveAds",value:function(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length?arguments[1]:void 0,i=t.wrapperDepth,n=t.previousUrl,a=t.url,o=[],n=a;return e.forEach(function(e){e=r.resolveWrappers(e,i,n),o.push(e)}),Promise.all(o).then(function(e){var t=R.flatten(e);return!t&&0<r.remainingAds.length?(e=r.remainingAds.shift(),r.resolveAds(e,{wrapperDepth:i,previousUrl:n,url:a})):t})}},{key:"resolveWrappers",value:function(n,a,o){var s=this;return new Promise(function(t){var e;if(a++,!n.nextWrapperURL)return delete n.nextWrapperURL,t(n);if(a>=s.maxWrapperDepth||-1!==s.parentURLs.indexOf(n.nextWrapperURL))return n.errorCode=302,delete n.nextWrapperURL,t(n);n.nextWrapperURL=b.resolveVastAdTagURI(n.nextWrapperURL,o),s.URLTemplateFilters.forEach(function(e){n.nextWrapperURL=e(n.nextWrapperURL)});var r=null!==(e=s.parsingOptions.allowMultipleAds)&&void 0!==e?e:n.allowMultipleAds,i=n.sequence;s.fetchVAST(n.nextWrapperURL,a,o).then(function(e){return s.parse(e,{url:n.nextWrapperURL,previousUrl:o,wrapperSequence:i,wrapperDepth:a,followAdditionalWrappers:n.followAdditionalWrappers,allowMultipleAds:r}).then(function(e){return delete n.nextWrapperURL,0===e.length?(n.creatives=[],t(n)):(e.forEach(function(e){e&&b.mergeWrapperAdData(e,n)}),void t(e))})}).catch(function(e){n.errorCode=301,n.errorMessage=e.message,t(n)})})}},{key:"completeWrapperResolving",value:function(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(var t=e.ads.length-1;0<=t;t--){var r=e.ads[t];!r.errorCode&&0!==r.creatives.length||(this.trackVastError(r.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:r.errorCode||303},{ERRORMESSAGE:r.errorMessage||""},{extensions:r.extensions},{system:r.system}),e.ads.splice(t,1))}}}]),r}(),G=null,z={data:{},length:0,getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem:function(e){delete this.data[e],this.length=Object.keys(this.data).length},clear:function(){this.data={},this.length=0}},Y=(n(J,[{key:"initStorage",value:function(){if(G)return G;try{G="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){G=null}return G&&!this.isStorageDisabled(G)||(G=z).clear(),G}},{key:"isStorageDisabled",value:function(e){var t="__VASTStorage__";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}},{key:"getItem",value:function(e){return this.storage.getItem(e)}},{key:"setItem",value:function(e,t){return this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){return this.storage.removeItem(e)}},{key:"clear",value:function(){return this.storage.clear()}}]),J),X=(n(Q,[{key:"getParser",value:function(){return this.vastParser}},{key:"hasRemainingAds",value:function(){return 0<this.vastParser.remainingAds.length}},{key:"getNextAds",value:function(e){return this.vastParser.getRemainingAds(e)}},{key:"get",value:function(i){var n=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=Date.now();return(a=Object.assign({},this.defaultOptions,a)).hasOwnProperty("resolveAll")||(a.resolveAll=!1),this.totalCallsTimeout<o?(this.totalCalls=1,this.totalCallsTimeout=o+36e5):this.totalCalls++,new Promise(function(t,r){if(n.cappingFreeLunch>=n.totalCalls)return r(new Error("VAST call canceled – FreeLunch capping not reached yet ".concat(n.totalCalls,"/").concat(n.cappingFreeLunch)));var e=o-n.lastSuccessfulAd;if(e<0)n.lastSuccessfulAd=0;else if(e<n.cappingMinimumTimeInterval)return r(new Error("VAST call canceled – (".concat(n.cappingMinimumTimeInterval,")ms minimum interval reached")));n.vastParser.getAndParseVAST(i,a).then(function(e){return t(e)}).catch(function(e){return r(e)})})}},{key:"lastSuccessfulAd",get:function(){return this.storage.getItem("vast-client-last-successful-ad")},set:function(e){this.storage.setItem("vast-client-last-successful-ad",e)}},{key:"totalCalls",get:function(){return this.storage.getItem("vast-client-total-calls")},set:function(e){this.storage.setItem("vast-client-total-calls",e)}},{key:"totalCallsTimeout",get:function(){return this.storage.getItem("vast-client-total-calls-timeout")},set:function(e){this.storage.setItem("vast-client-total-calls-timeout",e)}}]),Q),K=function(){o(l,V);var s=u(l);function l(e,t,r){var i,n,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;for(n in c(this,l),(i=s.call(this)).ad=t,i.creative=r,i.variation=a,i.muted=!1,i.impressed=!1,i.skippable=!1,i.trackingEvents={},i.lastPercentage=0,i._alreadyTriggeredQuartiles={},i.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],i.creative.trackingEvents){var o=i.creative.trackingEvents[n];i.trackingEvents[n]=o.slice(0)}return"linear"===i.creative.type?i._initLinearTracking():i._initVariationTracking(),e&&i.on("start",function(){e.lastSuccessfulAd=Date.now()}),i}return n(l,[{key:"_initLinearTracking",value:function(){this.linear=!0,this.skipDelay=this.creative.skipDelay,this.setDuration(this.creative.duration),this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates}},{key:"_initVariationTracking",value:function(){if(this.linear=!1,this.skipDelay=-1,this.variation){for(var e in this.variation.trackingEvents){var t=this.variation.trackingEvents[e];this.trackingEvents[e]?this.trackingEvents[e]=this.trackingEvents[e].concat(t.slice(0)):this.trackingEvents[e]=t.slice(0)}"nonLinearAd"===this.variation.adType?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates,this.setDuration(this.variation.minSuggestedDuration)):"companionAd"===this.variation.adType&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)}}},{key:"setDuration",value:function(e){this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}}},{key:"setProgress",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=this.skipDelay||-1;if(-1===i||this.skippable||(e<i?this.emit("skip-countdown",i-e):(this.skippable=!0,this.emit("skip-countdown",0))),0<this.assetDuration){var n=Math.round(e/this.assetDuration*100),a=[];if(0<e){a.push("start");for(var o,s=this.lastPercentage;s<n;s++)a.push("progress-".concat(s+1,"%"));for(o in a.push("progress-".concat(Math.round(e))),this.quartiles)this.isQuartileReached(o,this.quartiles[o],e)&&(a.push(o),this._alreadyTriggeredQuartiles[o]=!0);this.lastPercentage=n}a.forEach(function(e){t.track(e,{macros:r,once:!0})}),e<this.progress&&this.track("rewind",{macros:r})}this.progress=e}},{key:"isQuartileReached",value:function(e,t,r){var i=!1;return t<=r&&!this._alreadyTriggeredQuartiles[e]&&(i=!0),i}},{key:"setMuted",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.muted!==e&&this.track(e?"mute":"unmute",{macros:t}),this.muted=e}},{key:"setPaused",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.paused!==e&&this.track(e?"pause":"resume",{macros:t}),this.paused=e}},{key:"setFullscreen",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen",{macros:t}),this.fullscreen=e}},{key:"setExpand",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.expanded!==e&&(this.track(e?"expand":"collapse",{macros:t}),this.track(e?"playerExpand":"playerCollapse",{macros:t})),this.expanded=e}},{key:"setSkipDelay",value:function(e){"number"==typeof e&&(this.skipDelay=e)}},{key:"trackImpression",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates,e),this.track("creativeView",{macros:e}))}},{key:"error",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.trackURLs(this.ad.errorURLTemplates,e,{isCustomCode:t})}},{key:"errorWithCode",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.error({ERRORCODE:e},t),console.log("The method errorWithCode is deprecated, please use vast tracker error method instead")}},{key:"complete",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("complete",{macros:e})}},{key:"notUsed",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("notUsed",{macros:e}),this.trackingEvents=[]}},{key:"otherAdInteraction",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("otherAdInteraction",{macros:e})}},{key:"acceptInvitation",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("acceptInvitation",{macros:e})}},{key:"adExpand",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("adExpand",{macros:e})}},{key:"adCollapse",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("adCollapse",{macros:e})}},{key:"minimize",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("minimize",{macros:e})}},{key:"verificationNotExecuted",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!this.ad||!this.ad.adVerifications||!this.ad.adVerifications.length)throw new Error("No adVerifications provided");if(!t)throw new Error("No vendor provided, unable to find associated verificationNotExecuted");var r=this.ad.adVerifications.find(function(e){return e.vendor===t});if(!r)throw new Error("No associated verification element found for vendor: ".concat(t));(r=r.trackingEvents)&&r.verificationNotExecuted&&(r=r.verificationNotExecuted,this.trackURLs(r,e),this.emit("verificationNotExecuted",{trackingURLTemplates:r}))}},{key:"overlayViewDuration",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t.ADPLAYHEAD=e,this.track("overlayViewDuration",{macros:t})}},{key:"close",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track(this.linear?"closeLinear":"close",{macros:e})}},{key:"skip",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("skip",{macros:e})}},{key:"load",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.track("loaded",{macros:e})}},{key:"click",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates,t),e=this.clickThroughURLTemplate||e,t=a({},t),e&&(this.progress&&(t.ADPLAYHEAD=this.progressFormatted()),t=R.resolveURLTemplates([e],t)[0],this.emit("clickthrough",t))}},{key:"track",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=void 0===(n=t.macros)?{}:n,i=t.once,n=void 0!==i&&i;"closeLinear"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e="close"),t=this.trackingEvents[e],i=-1<this.emitAlwaysEvents.indexOf(e),t?(this.emit(e,{trackingURLTemplates:t}),this.trackURLs(t,r)):i&&this.emit(e,null),n&&(delete this.trackingEvents[e],i&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}},{key:"trackURLs",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},t=a({},t);this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(t.ASSETURI=this.creative.mediaFiles[0].fileURL),this.progress&&(t.ADPLAYHEAD=this.progressFormatted())),this.creative&&this.creative.universalAdId&&this.creative.universalAdId.idRegistry&&this.creative.universalAdId.value&&(t.UNIVERSALADID="".concat(this.creative.universalAdId.idRegistry," ").concat(this.creative.universalAdId.value)),this.ad&&(this.ad.sequence&&(t.PODSEQUENCE=this.ad.sequence),this.ad.adType&&(t.ADTYPE=this.ad.adType),this.ad.adServingId&&(t.ADSERVINGID=this.ad.adServingId),this.ad.categories&&this.ad.categories.length&&(t.ADCATEGORIES=this.ad.categories.map(function(e){return e.value}).join(",")),this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length&&(t.BLOCKEDADCATEGORIES=this.ad.blockedAdCategories)),R.track(e,t,r)}},{key:"convertToTimecode",value:function(e){var t=1e3*e,r=Math.floor(t/36e5),i=Math.floor(t/6e4%60),e=Math.floor(t/1e3%60),t=Math.floor(t%1e3);return"".concat(R.leftpad(r,2),":").concat(R.leftpad(i,2),":").concat(R.leftpad(e,2),".").concat(R.leftpad(t,3))}},{key:"progressFormatted",value:function(){return this.convertToTimecode(this.progress)}}]),l}();function Q(e,t,r){c(this,Q),this.cappingFreeLunch=e||0,this.cappingMinimumTimeInterval=t||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new _,this.storage=r||new Y,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}function J(){c(this,J),this.storage=this.initStorage()}e.VASTClient=X,e.VASTParser=_,e.VASTTracker=K,Object.defineProperty(e,"__esModule",{value:!0})});


function cEventDispatcher(e){var A=e.__listeners={},t="CustomEvent";return e["add"+t]=function(e,t){A[e]=A[e]||[],A[e].push(t)},e["remove"+t]=function(e,t){for(var a=A[e],i=0;i<a.length;i++)a[i]===t&&a.splice(i,1)},function(){var e=Array.prototype.slice.call(arguments),t=A[e.shift()];if(t)for(var a=0;a<t.length;a++)t[a].apply(t[a],e)}}!function(){var p="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAr9tZGF0AAACoAYF//+c3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDEyNSAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTIgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0xIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDM6MHgxMTMgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTEgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MyBiX3B5cmFtaWQ9MiBiX2FkYXB0PTEgYl9iaWFzPTAgZGlyZWN0PTEgd2VpZ2h0Yj0xIG9wZW5fZ29wPTAgd2VpZ2h0cD0yIGtleWludD0yNTAga2V5aW50X21pbj0yNCBzY2VuZWN1dD00MCBpbnRyYV9yZWZyZXNoPTAgcmNfbG9va2FoZWFkPTQwIHJjPWNyZiBtYnRyZWU9MSBjcmY9MjMuMCBxY29tcD0wLjYwIHFwbWluPTAgcXBtYXg9NjkgcXBzdGVwPTQgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAA9liIQAV/0TAAYdeBTXzg8AAALvbW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAAACoAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAhl0cmFrAAAAXHRraGQAAAAPAAAAAAAAAAAAAAABAAAAAAAAACoAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAgAAAAIAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAAqAAAAAAABAAAAAAGRbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAAwAAAAAgBVxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAABPG1pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAPxzdGJsAAAAmHN0c2QAAAAAAAAAAQAAAIhhdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAgACABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAMmF2Y0MBZAAK/+EAGWdkAAqs2V+WXAWyAAADAAIAAAMAYB4kSywBAAZo6+PLIsAAAAAYc3R0cwAAAAAAAAABAAAAAQAAAgAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAACtwAAAAEAAAAUc3RjbwAAAAAAAAABAAAAMAAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTQuNjMuMTA0";function m(e,t){var a;a=$(".flowplayer").hasClass("is-playlist")?"2":"1";var i,A=$(".flowplayer"),o=$("meta[name=csrf-token]").attr("content"),s=window.location.ancestorOrigins[window.location.ancestorOrigins.length-1],n=A.data("requestfull")||playerData.request_full;try{i=sessionStorage.getItem("referrer")}catch(e){i=document.referrer}i=i&&"empty";A=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");A.open("POST","/stat_ads",!0),A.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),A.withCredentials=!0,A.send(self.httpBuildQuery({player_type:a,jsReferer:i,adSystem:e,token:o,ancestororigins:s,request_full:n,type:"Radish "+t}))}function i(n,r){var d,l;this.create=function(){console.log("CreateHtml");var e=this.wrap=$(n);if(!e.find(".v-player").length){d={wrap:$("<div class='v-player' />"),vastSlots:$("<div class='v-slots' />"),skipWrap:$("<div class='v-player__skip-wrap' />"),close:$("<div class='v-player__close' />"),vol:$("<div class='v-player__vol' />"),skip:$("<div class='v-player__skip' />"),skipBefore:$("<div class='v-player__skip-before' />"),skipTime:$("<div />",{class:"v-player__time"}),skipAfter:$("<div />",{class:"v-player__skip-after"}),nav:$("<div />",{class:"v-player__pagin"}),navCurrent:$("<div />",{class:"v-player__current-page"}),navAmount:$("<div />",{class:"v-player__pages"})},l={divWrap:"<div class='v-player__item' />",divSlot:"<div class='v-player__slot' />",video:"<video class='v-player__video' preload='auto' playsinline='true' webkit-playsinline='true' type='video/mp4' x-webkit-airplay='allow' />",iframe:"<iframe class='v-player__iframe' allow='autoplay' scrolling='no' allowFullscreen=''/>"};var t="Пропустить",a="секунд",i="Пропустить",A="",t=r&&r.skipText?(o=r.skipText.pre||t,s=r.skipText.post||a,r.skipText.skip||i):(o=t,s=a,i),a=$("<div />",{class:"v-player__pre",html:o}),i=$("<div />",{class:"v-player__post",html:s}),o=r&&r.preloader?r.preloader:"<div>Загрузка...</div>",s=$("<div />",{class:"v-player__loader fp-preloader"});return s.append(o),A=r&&r.navText?r.navText:A,d.nav.html(A),d.nav.append(d.navCurrent,d.navAmount),d.wrap.on("click",function(){return!1}),d.wrap.append(d.vastSlots,s),d.skipBefore.append(a,d.skipTime,i),d.skipAfter.html(t),d.skip.append(d.skipBefore,d.skipAfter),d.skipWrap.append(d.close,d.skip),d.wrap.append(d.video,d.vol,d.skipWrap,d.vpaid,d.nav),e.append(d.wrap),d}console.warn("[CREATE_HTML] - Контейнер уже создан")},this.addSlot=function(e){console.log("[CREATE_HTML].addSlot");var t,a="v-player__item",i=$(l.divSlot),A=$(l.iframe),o=$(l.video);return A.attr({allow:"autoplay",scrolling:"no",allowFullScreen:""}),A.css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%",border:0,"z-index":"2"}),o.attr({preload:"auto","x-webkit-airplay":"allow","webkit-playsinline":"true",cursor:"pointer",playsinline:"1",src:p}),o.css({position:"relative",width:"100%",height:"100%","object-fit":"contain","min-height":"auto","max-height":"none","min-width":"auto","max-width":"none","z-index":"1"}),void 0!==e&&$(n+" ."+a+"[data-index="+e+"]").length?(t=$(n+" ."+a+"[data-index="+e+"]")).attr("data-index",e).append(i):((t=$("<div />",{class:a})).attr("data-index",e).append(i),d.vastSlots.children().length?(d.vastSlots.prepend(t),d.vastSlots.children().each(function(){$(this).data("index")<e&&$(this).after(t)})):d.vastSlots.append(t)),i.append(A,o),o[0].play(),i.iframe=A,i.video=o,{item:t,slot:i}};this.clean=function(){},this.destroy=function(){}}function k(e,t,a,A,o,s){var n=cEventDispatcher(this),i=A[0].data,r=o[0].data,d=o.iframe,l=d[0].contentWindow.document,t=t.fileURL,c=(i.index,r.index,e.adParameters),p="<!DOCTYPE html><head><meta charset='UTF-8'></head><body style='margin:0;padding:0'><script src='"+t+"'><\/script><script>window.parent.postMessage('V_PLAYER_LOADED','*');<\/script></body></html>";setTimeout(function(){l.open(),l.write(p),l.close()},0),d[0].onload=function(){!function(){try{var e=d[0].contentWindow.getVPAIDAd;if(e&&"function"==typeof e){var t=r.api.vpaid=e();if("function"==typeof t.handshakeVersion){for(var a in u)u.hasOwnProperty(a)&&t.subscribe(u[a],a,this);e=$("<div />").css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:"999",color:"white"});d.contents().find("body").append(e),console.log("[VPAID]["+i.systemName+"] - initAd"),t.initAd(s.ui.wrap.width(),s.ui.wrap.height(),"fullscreen",720,{AdParameters:c},{slot:e[0],videoSlot:o.video[0],videoSlotCanAutoPlay:!0})}else console.log("VPAID incorrect")}else console.error("initVpaid error2")}catch(e){console.error(e),n("error",e)}}()};t={vpaidStartAd:function(){console.log("[VPAID.EVENT] - AdStarted",A[0].data.systemName);"yomeno"===A[0].data.systemName&&setTimeout(function(){1+!!A.find("iframe").contents().find("iframe").contents().find("iframe[src*='youtube']").attr("src").indexOf("youtube")&&A.is(":first-child")&&v()},200),A[0].data.adready=!0},vpaidStopAd:function(e){console.log("[VPAID.EVENT] - stopAd",A[0].data.systemName),n("vpaidEnd",A)},vpaidSkipAd:function(){console.log("[VPAID.EVENT] - AdSkipped",A[0].data.systemName)},vpaidAdLoaded:function(e){console.log("[VPAID.EVENT] - vpaidAdLoaded",A[0].data.systemName),n("loaded",e)},vpaidAdError:function(e){console.log("[VPAID.EVENT] - AdError",e,A[0].data.systemName),n("vpaidEnd",A)},vpaidAdImpression:function(){var e;console.log("[VPAID.EVENT] - AdImpression",A[0].data.systemName),console.log("[EVENT] Impression vpaid sended"),r.api.tracker.trackImpression(),e=""===s.rollIndex?"":"_mid"+s.rollIndex,m(A[0].data.systemName+e,"vpaid "+s.rollType+s.rollIndex),v()},vpaidAdLinearChange:function(){console.log("[VPAID.EVENT] - AdLinearChange",A[0].data.systemName)},vpaidAdSizeChange:function(){console.log("[VPAID.EVENT] - AdSizeChange",A[0].data.systemName)},vpaidAdExpandedChange:function(){console.log("[VPAID.EVENT] - AdExpandedChange",A[0].data.systemName)},vpaidAdSkippableStateChange:function(){console.log("[VPAID.EVENT] - AdSkippableStateChange",A[0].data.systemName)},vpaidAdDurationChange:function(){console.log("[VPAID.EVENT] - AdDurationChange",A[0].data.systemName)},vpaidAdRemainingTimeChange:function(){},vpaidAdVolumeChange:function(){console.log("[VPAID.EVENT] - AdVolumeChange",A[0].data.systemName)},vpaidAdClickThru:function(){console.log("[VPAID.EVENT] - AdClickThru")},vpaidAdInteraction:function(){console.log("[VPAID.EVENT] - AdInteraction")},vpaidAdVideoStart:function(){v(),r.api.tracker.track("start"),console.log("[VPAID.EVENT] - AdVideoStart",A[0].data.systemName)},vpaidAdVideoFirstQuartile:function(){console.log("[VPAID.EVENT] - AdVideoFirstQuartile",A[0].data.systemName),r.api.tracker.track("firstQuartile"),v()},vpaidAdVideoMidpoint:function(){console.log("[VPAID.EVENT] - AdVideoMidpoint",A[0].data.systemName),r.api.tracker.track("midpoint")},vpaidAdVideoThirdQuartile:function(){console.log("[VPAID.EVENT] - AdVideoThirdQuartile",A[0].data.systemName),r.api.tracker.track("thirdQuartile")},vpaidAdVideoComplete:function(){console.log("[VPAID.EVENT] - AdVideoComplete",A[0].data.systemName)},vpaidAdUserAcceptInvitation:function(){console.log("[VPAID.EVENT] - AdUserAcceptInvitation")},vpaidAdUserMinimize:function(){console.log("[VPAID.EVENT] - AdUserMinimize")},vpaidAdUserClose:function(){console.log("[VPAID.EVENT] - AdUserClose")},vpaidAdPaused:function(){console.log("[VPAID.EVENT] - AdPaused")},vpaidAdPlaying:function(){console.log("[VPAID.EVENT] - AdPlaying")},vpaidAdErrorVpaid:function(){console.log("[VPAID.EVENT] - AdErrorVpaid")},vpaidAdLog:function(){console.log("[VPAID.EVENT] - AdLog")},vpaidAdViewable:function(){console.log("[VPAID.EVENT] - AdViewable")},vpaidAdReady:function(){console.log("[VPAID.EVENT] - AdReady",A[0].data.systemName),A[0].data.adready=!0,A.is(":first-child")&&v()}};function v(){var i=r.api.vpaid;A.is(":first-child")||A.remove(),v.state||(s.fpApi.pause(),n("started",A),v.state=!0),function(){var e,t,a;try{e=localStorage.getItem("volume"),console.log("volumeLevel",e)}catch(e){}null==e?(t=.5,console.log("val",t)):(a=Number(localStorage.getItem("volume")),"true"==localStorage.getItem("muted")?t=0:(console.log("val",t),t=.5*a,console.log("val",t))),i.getAdVolume()!=t&&i.setAdVolume(t),o.video[0].volume=t}()}v.state=!1;var u={AdStarted:t.vpaidStartAd,AdStopped:t.vpaidStopAd,AdSkipped:t.vpaidSkipAd,AdLoaded:t.vpaidAdLoaded,AdLinearChange:t.vpaidAdLinearChange,AdSizeChange:t.vpaidAdSizeChange,AdExpandedChange:t.vpaidAdExpandedChange,AdSkippableStateChange:t.vpaidAdSkippableStateChange,AdDurationChange:t.vpaidAdDurationChange,AdRemainingTimeChange:t.vpaidAdRemainingTimeChange,AdVolumeChange:t.vpaidAdVolumeChange,AdImpression:t.vpaidAdImpression,AdClickThru:t.vpaidAdClickThru,AdInteraction:t.vpaidAdInteraction,AdVideoStart:t.vpaidAdVideoStart,AdVideoFirstQuartile:t.vpaidAdVideoFirstQuartile,AdVideoMidpoint:t.vpaidAdVideoMidpoint,AdVideoThirdQuartile:t.vpaidAdVideoThirdQuartile,AdVideoComplete:t.vpaidAdVideoComplete,AdUserAcceptInvitation:t.vpaidAdUserAcceptInvitation,AdUserMinimize:t.vpaidAdUserMinimize,AdUserClose:t.vpaidAdUserClose,AdPaused:t.vpaidAdPaused,AdPlaying:t.vpaidAdPlaying,AdError:t.vpaidAdError,AdErrorVpaid:t.vpaidAdErrorVpaid,AdLog:t.vpaidAdLog,AdViewable:t.vpaidAdViewable,AdReady:t.vpaidAdReady}}window.Radish=function(h,l,g){this.shownCnt=0,this.allowReplay=!1,this.isReplay=!1,this.data={},this.isStarted=!1,this.html={},this.ui=!1,this.active={},this.config=g,this.fpApi=l,g.showAfterStart&&(g.autostart=!0);var f,t,y=this,E=cEventDispatcher(this);g.template||(g.template={}),this.init=function(){console.log("[RADISH.init]");var e=this.html=new i(g.wrapper,g.template),a=this.ui=e.create();this.adsArr=[],t=function(){console.log("Создание разметки для всех кодов завершено"),e.isCreated=!0,a.vastSlots.children().length||y.destroy()},y.addCustomEvent("created",t),a.close.on("click",function(e){var t=y.active.slot.data.api.tracker;return console.log("[EVENT] close sended"),t.track("close"),(a.skipWrap.hasClass("active")||a.skipWrap.hasClass("active_close"))&&y.end(),!1}),a.skipAfter.on("click",function(e){var t=y.active.slot.data.api.tracker;return console.log("[EVENT] skip sended"),t.track("skip"),a.skipWrap.hasClass("active")&&y.end(),!1}),a.vol.on("click",function(e){var t=y.active.data.api,a=t.video,t=t.tracker;return y.mute(a,"toggle"),a.muted?(console.log("[EVENT] mute sended"),t.track("mute")):(console.log("[EVENT] unmute sended"),t.track("unmute")),!1}),a.navAmount.text(g.maxAds),a.navCurrent.text(1),this.load(g.url)},this.load=function(e){h.get(e,{resolveAll:!1,allowMultipleAds:!0}).then(function(e){var t,s=h.vastParser.remainingAds.slice();e.ads.length&&(y.adsArr[0]={iOpts:{index:0,url:h.vastParser.parentURLs[h.vastParser.parentURLs.length-1]},ads:e.ads,item:{},slots:[]},n(t=y.adsArr[0]),setTimeout(function(){w(t,0)},500)),setTimeout(function(){for(var A,o=0,e=1;;e++)if("break"===function(a){var i;if(a<=s.length&&(i=s[a-1][0].nextWrapperURL),!h.hasRemainingAds())return r(o,A=a),"break";h.getNextAds().then(function(e){var t;e.ads.length&&(y.adsArr[a]={iOpts:{index:a,url:i},ads:e.ads,item:{},slots:[]},n(t=y.adsArr[a]),setTimeout(function(){w(t,0)},1e3)),r(++o,A)}).catch(function(e){console.log("CATCH"),r(++o,A),console.log(e)})}(e))break},1e3)})},this.rollType="",this.rollIndex="",this.start=function(e,t){var a;function i(){console.log("[START] - checkState"),y.removeCustomEvent("update",i),y.isAlready&&y.start(e,t)}console.log("[START]"),y.isAlready=!0,clearTimeout(this.reserveClose),function e(){try{this.reserveClose=setTimeout(function(){y.html.wrap.hasClass("active")?setTimeout(function(){y.ui.skipWrap.addClass("active_close")},3e4):(console.log("reservTimer Вызван ещё раз"),e())},5e3)}catch(e){console.log(e)}}(),$(g.wrapper).children().length?(this.rollType=e||"",this.rollIndex=t||"",y.ui?(a=this.ui.wrap.find(".v-player__item").eq(0),!y.html.isCreated||a.length?a.length&&a.hasClass("ready")?(y.isStarted=!0,g.autostart=!0,a[0].data.adready||y.waitTime.start(a[0].data.waitTime),g.showAfterStart||y.html.wrap.addClass("active"),a.hasClass("ready")?(y.play(a),window.adIsShowen=!0):(y.addCustomEvent("update",i),console.warn("Креатив ещё не подгрузился"))):y.addCustomEvent("update",i):y.destroy()):y.addCustomEvent("update",i)):console.log("wrapper is empty")},this.play=function(e){console.log("[PLAY] - 1");var t=e.children(".v-player__slot").eq(0),a=e[0].data,i=t[0].data;if(t.addClass("active"),!y.shownCnt&&(0<a.replay||"yes"==a.showNext)&&y.ui.nav.addClass("visible"),y.ui.navCurrent.text(y.shownCnt+1),"vast"==i.type){var t=function e(){1+!this.src.indexOf(p)&&(o.style.zIndex=5,o.removeEventListener("timeupdate",e))},A=i.api.tracker,o=i.api.video;l.pause(),0<=["iPad","iPhone","iPod"].indexOf(navigator.platform)&&"midroll"===y.rollType&&(o.muted=!0);var s,n=!1,r=!1,d=!1;o.addEventListener("timeupdate",function(){var e=Math.floor(o.currentTime);1<e&&!d&&(console.log("[EVENT] firstQuartile sended"),A.track("firstQuartile"),d=!0),e>Math.floor(o.duration/2)&&!n&&(console.log("[EVENT] midpoint sended"),A.track("midpoint"),n=!0),e>Math.floor(o.duration/2)+Math.floor(o.duration/4)&&!r&&(console.log("[EVENT] thirdQuartile sended"),A.track("thirdQuartile"),r=!0)}),o.addEventListener("ended",function(){console.log("[EVENT] complete sended"),A.track("complete"),y.end()}),o.addEventListener("timeupdate",t),y.ui.wrap.addClass("vast_active"),c.start(i),T(),o.play();try{void 0===localStorage.getItem("volume")||null===localStorage.getItem("volume")?(o.volume=.5,o.muted=!1):(s=Number(localStorage.getItem("volume")),o.volume=.5*s,"true"==localStorage.getItem("muted")?o.muted=!0:o.muted=!1)}catch(e){console.log(e)}console.log("[EVENT] Impression vast sended "+a.systemName),i.api.tracker.trackImpression(),A.track("start"),a=""===y.rollIndex?"":"_mid"+y.rollIndex,m(e[0].data.systemName+a,"vast "+y.rollType+y.rollIndex)}else y.ui.wrap.addClass("vpaid_active"),i.api.vpaid.startAd()},this.replay=function(){console.log("REPLAY");var e=new VAST.VASTClient,a=y.active.item.data,t=a.url;a.isShowed=!1,y.isReplay=!0,e.get(t,{resolveAll:!0,allowMultipleAds:!0}).then(function(e){var t;e.ads.length?(t=a.index,console.log(y.adsArr[t].iOpts),y.adsArr[t].ads=e.ads,n(t=y.adsArr[t]),w(t,0)):(console.error("replay error","Нет доступных объвлений"),y.destroy())}).catch(function(e){throw console.log(e),"replay error "+e})},this.update=function(){},this.end=function(e){E("ended",e);var t=!1;if(e&&(t=e.is(":first-child")),!e||t){var a=(e=e||y.ui.wrap.find(".v-player__item").eq(0))[0].data,t=y.adsArr[a.index];if(0==y.shownCnt)return e.remove(),y.ui.wrap.removeClass("vast_active vpaid_active"),E("update"),void(!y.ui.wrap.find(".v-player__item").length&&y.html.isCreated?y.destroy():y.html.isCreated&&y.isAlready&&y.start(y.rollType,y.rollIndex));if(g.maxAds>y.shownCnt){if(a.replay&&a.isShowed)return t.iOpts.replay--,e.remove(),y.ui.wrap.removeClass("vast_active vpaid_active"),E("update"),void y.replay();"yes"==a.showNext?(e.remove(),y.ui.wrap.removeClass("vast_active vpaid_active"),y.ui.wrap.find(".v-player__item").length?y.isAlready&&y.start(y.rollType,y.rollIndex):y.destroy()):y.destroy()}else y.destroy()}else e.remove();console.log(y.shownCnt)},this.destroy=function(){console.log(opts),this.rollType=void 0,this.rollIndex=void 0,window.adIsShowen=!1,$("#hdvb_vpaid_div").length||$(".js-flowplayer").hasClass("is-ad-visible")||!$(g.wrapper).hasClass("active")||l.play(),$(g.wrapper).removeClass("active").empty(),this.removeCustomEvent("created",t),radishState=0,console.log("[DESTROY] DESTROY"),document.removeEventListener("visibilitychange",f),this.waitTime.stop(),this.shownCnt=0,this.allowReplay=!1,this.isReplay=!1,this.data={},this.isStarted=!1,this.html={},this.ui=!1,this.active={}};var c={timer:!(this.convertTime=function(e){console.log(e);var t=y.api.video.duration;return 100+(e-t)/t*100}),start:function(e){var t=+e.skipDelay-1,a=y.ui;a.skipWrap.removeClass("active"),clearInterval(this.timer),this.timer=setInterval(function(){t<=0?(a.skipTime.text(g.skipDelay),clearInterval(this.timer),a.skipWrap.addClass("active")):a.skipTime.text(t),--t},1e3)},stop:function(){clearInterval(this.timer)}};function T(){console.log("startedShow"),g.showAfterStart&&y.html.wrap.addClass("active");var e=y.ui.wrap.find(".v-player__item").eq(0),t=e.children(".v-player__slot").eq(0),a=e[0].data,i=t[0].data;a.isShowed=!0,y.active.item=e[0],y.active.slot=t[0],y.active.data=i,y.waitTime.stop(),y.active.allowReplay=!0,y.shownCnt++}function n(e){var a;(a=e).ads[0].extensions&&a.ads[0].extensions.length?a.ads[0].extensions[0].children.forEach(function(e){var t;"#text"!==e.name&&(t=e.name[0].toLowerCase()+e.name.slice(1),a.iOpts[t]=e.value)}):console.warn("Item Extensions not found");for(var t=0;t<e.ads.length;t++){var i=y.html.addSlot(e.iOpts.index);e.slots[t]=i.slot,0==t&&(e.item=i.item)}for(key in e.item[0].data={},e.iOpts)"replay"==key?e.item[0].data[key]=+e.iOpts[key]:e.item[0].data[key]=e.iOpts[key]}function w(t,a){try{var i,e=t.ads[a],A=t.item,o=t.slots[a],s=arguments,n=y.ui,r=e.creatives,d=o[0].data={},l=A[0].data;if(d.api={},d.index=a,d.api.video=o.video[0],r.some(function(e,t,a){if("linear"===e.type)return i=e,!0})){d.api.tracker=new VAST.VASTTracker(h,e,i);var c=o[0].data.api.tracker,p=i.mediaFiles;i.duration&&(d.duration=i.duration);var v,r=g.skipDelay;i.duration<r?d.skipDelay=i.duration:d.skipDelay=r,p.some(function(e,t,a){if("VPAID"===e.apiFramework&&"application/javascript"==e.mimeType)return v=e,!0}),i.videoClickThroughURLTemplate&&(d.clickTrough=i.videoClickThroughURLTemplate.url),d.events=i.trackingEvents;o.video[0];if(v){console.log("[RADISH.load]["+l.systemName+"] - vpaidMedia");try{d.type="vpaid";var u=new k(i,v,0,A,o,y);u.addCustomEvent("loaded",function(e){console.log("СustomEvent LOADED"),A.addClass("ready"),E("update",o),g.autostart&&A.is(":first-child")&&o.is(":first-child")}),u.addCustomEvent("vpaidEnd",function(){console.log("beforeEnd"),o.remove(),A.is(":first-child")&&0<y.shownCnt?(console.log("beforeEnd IF"),y.end(A)):(console.log("beforeEnd ELSE"),t.ads.length>a+1?w(s[0],++s[1]):y.end(A))}),u.addCustomEvent("started",function(e){T()})}catch(e){console.log("[RADISH.load] - возникла ошибка при инициализации объвяления в "+l.systemName+". Тип - VPAID"),console.warn(e)}}else{console.log("[RADISH.load] - vastMedia");try{d.type="vast",n.skipTime.text(g.skipDelay);var m=function(e){for(var t,a=0;e.length>a;a++){var i=e[a].bitrate;if(e[a].mimeType==g.mimeType&&i>=g.bitrateMin&&i<=g.bitrateMax){t=e[a];break}}return t=t||e[0]}(p).fileURL;d.clickTrough&&o.on("click",function(){window.open(d.clickTrough),console.log("[EVENT] click sended"),c.click()}),o.video.attr("src",m),A.addClass("ready"),E("update",o)}catch(e){console.log("[RADISH.load] - возникла ошибка при инициализации объвяления в "+l.systemName+". Тип - VAST"),console.warn(e)}}A.is(":first-child")&&o.is(":first-child")&&y.isReplay&&(y.isReplay=!1,y.start(y.rollType,y.rollIndex))}else console.log("[RADISH.load] - в "+l.systemName+" не найдено линейных объявлений"),vast.next();f=function(){var e;$(".v-player").length&&$(".v-player").hasClass("vast_active")&&(e=y.ui.wrap.find(".v-player__item").eq(0).children(".v-player__slot").eq(0)[0].data.api,"hidden"==document.visibilityState?(e.video.pause(),e.tracker.track("pause")):(e.video.play(),e.tracker.track("resume")))},document.addEventListener("visibilitychange",f,!1)}catch(e){console.error("loadAd error",e),t.ads.length>a+1&&w(s[0],++s[1])}}function r(e,t){console.log("Запрошен васт "+(e+1)+" из "+t),e+1==t&&E("created",y)}this.timeout={timer:null,time:Number(g.timeout),start:function(){var e;null===this.timer&&((e=this).timer=setInterval(function(){e.time<=0&&(clearInterval(e.timer),y.waitTime.timer&&clearInterval(y.waitTime.timer),console.log("Закрытие по таймауту")),--e.time},1e3))},stop:function(){console.log("timeout timer stop"),clearInterval(this.timer),this.timer=!1}},this.waitTime={timer:!1,start:function(e){g.showAfterStart&&(e=30),clearInterval(this.timer),console.log("Запускаем waitTimer");var t=this;e=+e,this.timer=setInterval(function(){e<=0&&(clearInterval(t.timer),console.log("Время ожидания вышло, переходим к следующему коду"),y.end()),--e},1e3)},stop:function(){console.log("waitTimer stop"),clearInterval(this.timer),this.timer=!1}},this.next=function(){y.end(),y.isAlready&&y.start(y.rollType,y.rollIndex)},this.mute=function(e,t){"toggle"===t?e.muted?(y.ui.vol.removeClass("muted"),$(e).prop("muted",!1)):(y.ui.vol.addClass("muted"),$(e).prop("muted","muted")):1==t?($(e).prop("muted","muted"),$(e).prop("muted","muted")):($(this).removeClass("muted"),$(e).prop("muted",!1))}}}();var radishState=0;
// onion.js

function onion(u){var b;if(window.adIsShowen=!0,u.conf||(u.conf=""),void 0!==document.hidden?(b="hidden",0):void 0!==document.msHidden?(b="msHidden",0):void 0!==document.webkitHidden&&(b="webkitHidden",0),$("onion_wrap").length)console.warn("Onion уже запущен или не был корректно завершён");else{console.log("ONION START");var n=$("<iframe />",{id:"onion_frame",allow:"autoplay",scrolling:"no",allowFullScreen:""}),g=$("<div id='onion_wrap'></div>");$(".flowplayer").hasClass("is-touch")&&g.addClass("is-touch"),g.append(n);var e,w=$("<div class='onion_close'>×</div>");switch(g.append(w),$(".fp-player").append(g),e=' src="'+u.code+'"',u.partn){case"adera":break;case"rocket":e+=" "+u.conf;break;case"adstera":case"buzzoola":break;case"clickadilla":e+=' data-admpid="21796"';break;case"playbuy":break;default:console.error("Onion type не определён"),v()}var t,y,o='<!DOCTYPE html><html><head><meta charset="UTF-8"><script '+e+'><\/script></head><body id="mainBody"><script type="text/javascript">window.parent.postMessage("onion_frame","*");<\/script></body></html>';window.addEventListener("message",a),setTimeout(function(){n[0].contentWindow.document.open(),n[0].contentWindow.document.write(o),n[0].contentWindow.document.close()},0)}function a(){!function(){var d,l,c;t=n.contents().find("head"),y=n.contents().find("body");var p=!1,m=!1,e=$("<style />",{rel:"stylesheet"});switch(u.partn){case"adera":console.log("Onion type - adera"),l="ins:first > ins",e.text("*{margin: 0;}html, body{min-height: 100%; height: 100%;} body > ins{max-width: 80%; max-height: 80%; position: absolute; transform: translate(-50%, -50%); top: 50%; left: 50%;}");break;case"rocket":console.log("Onion type - rocket"),l="#rt-sticker-ins",d="[class*='rocketme-close']",e.text("*{margin: 0;}html, body{min-height: 100%; height: 100%;}");break;case"adstera":console.log("Onion type - adstera"),c="iframe",l="[class*='__wrap']",d="[class*='__closelink']",e.text("*{margin: 0;}html, body{min-height: 100%; height: 100%;}body iframe{position: absolute !important; left: 50% !important; right: auto !important; top: 50% !important; bottom: auto !important; transform: translate(-50%, -50%);}"),p=!0;break;case"buzzoola":console.log("Onion type - buzzoola"),c="iframe",d=!(l=".buzz-container"),e.text("*{margin: 0;}html, body{min-height: 100%; height: 100%;}.buzz-container{position: absolute !important; left: 50%; top: 50%; transform: translate(-50%, -50%);}"),y.append("<div id='buz_wrap'></div>");break;case"clickadilla":console.log("Onion type - clickadilla"),c="iframe",l="div",d="[data-izone='close']",e.text("*{margin: 0;}html, body{min-height: 100%; height: 100%;}body>div{position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; animation: none !important;}"),m=!0;break;case"playbuy":console.log("Onion type - playbuy");break;default:console.error("Onion type не определён"),v()}t.append(e);var h=0,f=setInterval(function(){var n,t,o,e;if(c&&(t=y.find(c).eq(0)),o=p?t.contents().find("body").find(l):y.find(l).eq(0),3e4<=h)return console.log("ONION TIMEOUT"),v(),void clearInterval(f);if(o.length){clearInterval(f),console.log("ONION SHOWED"),d&&(n=m?t.contents().find("body").find(d):o.find(d)).on("click",function(){return v(),!1}),w.add(y).on("click",function(e){return!(!$(e.target).closest(o).length&&!$(e.target).closest(t).length)||(n&&n.length&&n.click(),g.length&&v(),!1)}),e=o;var a,i=$("<div/>",{class:"onion_spacer"});switch(i.css({position:"absolute",left:0,top:0,width:"100%",height:"100%"}),u.partn){case"buzzoola":a=t.contents().find(".buzz_wrapper").length?t.contents().find(".buzz_wrapper"):t.contents().find("div").eq(0);var r,s=t.contents().find("iframe");s.length&&(r=s.contents().find("body")),(r||a).prepend(i),e=i;break;case"clickadilla":(a=t.contents().find("div").eq(0)).prepend(i),e=i}e.on("click",function(){setTimeout(function(){document[b]&&g.length&&v()},500)}),g.show()}h+=100},200)}(),console.log("new ad frame loaded")}function v(){window.adIsShowen=!1,g.remove(),window.removeEventListener("message",a)}}onion.runTime=0;

// Cabbage.js

function Cabbage(a){var n,l,A,s,c="",d="",I="",r=a.timeout,p=0;this.cnt=a.cnt,this.shown=!1,this.start=function(){if(p>=a.cnt)console.log("Достигнут лимит показов");else{window.adIsShowen=!0;var o=this;d&&clearInterval(d),l=$("<div />",{class:"cabbage_wrapper"}),(n=document.createElement("iframe")).allow="autoplay",n.scrolling="no",n.setAttribute("allowFullScreen",""),document.createElement("base").href=window.location.protocol+"//"+window.location.host+"/",l.append(n),A=$("<div />",{class:"cabbage_wrap-inner"}),$wrapInner2=$("<div />",{class:"cabbage_wrap-inner2"}),$wrapInner2.css({position:"relative",height:0,width:"100%",zIndex:1}),$wrapInner2.append(n),A.append($wrapInner2),l.append(A),"center"===a.position?(l.css({position:"absolute",left:0,top:0,width:"100%",height:"100%","z-index":"999"}),A.css({position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",maxWidth:a.width})):(l.css({position:"absolute",bottom:"44px",right:"0","max-width":"100%",border:0,"z-index":"999"}),A.css({position:"absolute",right:"0",bottom:"0",maxWidth:a.width,width:"60%"})),$(n).css({position:"absolute",width:"100%",height:"100%",left:0,top:0,border:0}),$(".fp-player").append(l);var I="",g="",e=' src="'+a.url+'"';switch(a.type){case"videoroll":e+="",I="<div id='vid_vpaut_div' style='display:inline-block;width:100%;height:100%' vid_vpaut_pl='12404'></div>",adWrapperSel="",adCloseSel="",g="html, body {height: 100%}","center"===a.position?A.css({width:"60%"}):l.css({width:500,height:330}),$wrapInner2.css({paddingTop:"66%"});break;case"movie_video":"center"===a.position?A.css({width:"100%"}):l.css({width:a.width,height:a.height}),$wrapInner2.css({paddingTop:"63.6%"}),e+="",I="<div id='movie_video'></div>",adWrapperSel="",g="html, body {height: 100%} ",adCloseSel="";break;default:console.error("Onion type не определён"),o.stop()}var t='<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="referrer" content="strict-origin-when-cross-origin"><style>'+g+'</style><script type="text/javascript" '+e+' async><\/script></head><body style="margin:0;padding:0">'+I+'<script type="text/javascript">window.parent.postMessage("cabbage_frame_loaded","*");<\/script></body></html>';window.addEventListener("message",function I(g){"cabbage_frame_loaded"==g.data&&(window.removeEventListener("message",I),i())}),setTimeout(function(){n.contentWindow.document.open(),n.contentWindow.document.write(t),n.contentWindow.document.close()},0);var C=r/1e3,i=function(){var i=$(n).contents().find("body");console.log("onload"),n.onload=function(){switch(a.type){case"movie_video":var I=75e3,g=300;console.log("movie_video ONLOAD"),"SCRIPT"==i.children().last()[0].tagName?(console.log("movie_video sctipr not found"),o.stop()):(console.log("movie_video is correct"),t=!1,s=setInterval(function(){I<=0&&(console.log("Cabbage check state stopped. Timeout"),o.stop()),console.log("Cabbage check state"),I-=g,i.find("div").each(function(I){$(this).find("iframe").length&&($(this).append(A),t=!0)}),1==t&&(clearInterval(s),console.log("Flyroll timeout stopped"),o.updateSizeStart(),l.addClass("active"),i.css("opacity",1))},g));break;case"videoroll":console.log("VIDEOROLL ONLOAD");var e,t,C=i.find("#vid_vpaut_div"),I=75e3,g=300;C.length&&(console.log("Cabbage videoroll is found"),"none"==C.css("display")?(console.log("Cabbage videoroll wrong country"),o.stop()):(console.log("Cabbage videoroll country is correct"),e=C.find("#tmp_div_vid_vpaut"),t=!1,s=setInterval(function(){I<=0&&(console.log("Cabbage check state stopped. Timeout"),o.stop()),console.log("Cabbage check state"),I-=g,e.length?t="none"!=e.css("pointer-events"):e=C.find("#tmp_div_vid_vpaut"),1==t&&(clearInterval(s),console.log("Flyroll timeout stopped"),l.addClass("active"))},g)));break;default:console.error("Onion type не определён"),o.stop()}},l.on("click",function(){return o.stop(),!1}),a.close&&(I=$("<div class='cb_close'>×</div>"),l.append(I),I.on("click",function(){return o.stop(),!1}));var A=$('<img class="cabbage_preloader" alt="" src="data:image/svg+xml;base64, PCEtLSBCeSBTYW0gSGVyYmVydCAoQHNoZXJiKSwgZm9yIGV2ZXJ5b25lLiBNb3JlIEAgaHR0cDovL2dvby5nbC83QUp6YkwgLS0+CjwhLS0gVG9kbzogYWRkIGVhc2luZyAtLT4KPHN2ZyB3aWR0aD0iNTciIGhlaWdodD0iNTciIHZpZXdCb3g9IjAgMCA1NyA1NyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBzdHJva2U9IiNmZmYiPgogICAgPGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDEpIiBzdHJva2Utd2lkdGg9IjIiPgogICAgICAgICAgICA8Y2lyY2xlIGN4PSI1IiBjeT0iNTAiIHI9IjUiPgogICAgICAgICAgICAgICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iY3kiCiAgICAgICAgICAgICAgICAgICAgIGJlZ2luPSIwcyIgZHVyPSIyLjJzIgogICAgICAgICAgICAgICAgICAgICB2YWx1ZXM9IjUwOzU7NTA7NTAiCiAgICAgICAgICAgICAgICAgICAgIGNhbGNNb2RlPSJsaW5lYXIiCiAgICAgICAgICAgICAgICAgICAgIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiAvPgogICAgICAgICAgICAgICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iY3giCiAgICAgICAgICAgICAgICAgICAgIGJlZ2luPSIwcyIgZHVyPSIyLjJzIgogICAgICAgICAgICAgICAgICAgICB2YWx1ZXM9IjU7Mjc7NDk7NSIKICAgICAgICAgICAgICAgICAgICAgY2FsY01vZGU9ImxpbmVhciIKICAgICAgICAgICAgICAgICAgICAgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIC8+CiAgICAgICAgICAgIDwvY2lyY2xlPgogICAgICAgICAgICA8Y2lyY2xlIGN4PSIyNyIgY3k9IjUiIHI9IjUiPgogICAgICAgICAgICAgICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iY3kiCiAgICAgICAgICAgICAgICAgICAgIGJlZ2luPSIwcyIgZHVyPSIyLjJzIgogICAgICAgICAgICAgICAgICAgICBmcm9tPSI1IiB0bz0iNSIKICAgICAgICAgICAgICAgICAgICAgdmFsdWVzPSI1OzUwOzUwOzUiCiAgICAgICAgICAgICAgICAgICAgIGNhbGNNb2RlPSJsaW5lYXIiCiAgICAgICAgICAgICAgICAgICAgIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiAvPgogICAgICAgICAgICAgICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iY3giCiAgICAgICAgICAgICAgICAgICAgIGJlZ2luPSIwcyIgZHVyPSIyLjJzIgogICAgICAgICAgICAgICAgICAgICBmcm9tPSIyNyIgdG89IjI3IgogICAgICAgICAgICAgICAgICAgICB2YWx1ZXM9IjI3OzQ5OzU7MjciCiAgICAgICAgICAgICAgICAgICAgIGNhbGNNb2RlPSJsaW5lYXIiCiAgICAgICAgICAgICAgICAgICAgIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiAvPgogICAgICAgICAgICA8L2NpcmNsZT4KICAgICAgICAgICAgPGNpcmNsZSBjeD0iNDkiIGN5PSI1MCIgcj0iNSI+CiAgICAgICAgICAgICAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJjeSIKICAgICAgICAgICAgICAgICAgICAgYmVnaW49IjBzIiBkdXI9IjIuMnMiCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlcz0iNTA7NTA7NTs1MCIKICAgICAgICAgICAgICAgICAgICAgY2FsY01vZGU9ImxpbmVhciIKICAgICAgICAgICAgICAgICAgICAgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIC8+CiAgICAgICAgICAgICAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJjeCIKICAgICAgICAgICAgICAgICAgICAgZnJvbT0iNDkiIHRvPSI0OSIKICAgICAgICAgICAgICAgICAgICAgYmVnaW49IjBzIiBkdXI9IjIuMnMiCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlcz0iNDk7NTsyNzs0OSIKICAgICAgICAgICAgICAgICAgICAgY2FsY01vZGU9ImxpbmVhciIKICAgICAgICAgICAgICAgICAgICAgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIC8+CiAgICAgICAgICAgIDwvY2lyY2xlPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+" />');A.css({position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:1,display:"none"}),$wrapInner2.append(A);var I=$("<div/>",{class:"cabbage_timer",text:"закроется через "});I.css({position:"absolute",left:"10px",top:"20px",zIndex:9999999991,color:"#fff",fontFamily:"Arial"}),$after=" сек";var g=$("<span></span>");I.append(g),g.after($after),$(n).contents().find("body").append(I),g.text(C),a.timeout?(d=setInterval(function(){g.text(--C)},1e3),c=setTimeout(function(){o.stop()},a.timeout)):I.css("display","none"),p++,o.shown=!0}}},this.stop=function(){window.adIsShowen=!1,clearInterval(d),clearInterval(s),clearTimeout(c),clearInterval(I),l&&l.remove(),this.shown=!1},this.updateSizeStart=function(){var g=this;I=setInterval(function(){var I;$(n).length?(I=$(n).contents().find("iframe"),A.width(I.width())):g.stop()},500)}}
